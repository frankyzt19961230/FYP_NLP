Linear Systems         lege, relege, labora et invenies Linear Systems               Henri Bourlès                           First published 2010 in Great Britain and the United States by ISTE Ltd and John Wiley & Sons, Inc. Adapted and updated from Systèmes linéaires published 2006 in France by Hermes Science/Lavoisier  © LAVOISIER 2006  Apart from any fair dealing for the purposes of research or private study, or criticism or review, as permitted under the Copyright, Designs and Patents Act 1988, this publication may only be reproduced, stored or transmitted, in any form or by any means, with the prior permission in writing of the publishers, or in the case of reprographic reproduction in accordance with the terms and licenses issued by the  CLA. Enquiries concerning reproduction outside these terms should be sent to the publishers at the undermentioned address:  ISTE Ltd  John Wiley & Sons, Inc.  27-37 St George’s Road  111 River Street London SW19 4EU Hoboken, NJ 07030 UK  USA  www.iste.co.uk  www.wiley.com © ISTE Ltd 2010  The rights of Henri Bourlès to be identified as the author of this work have been asserted by him in accordance with the Copyright, Designs and Patents Act 1988.  Library of Congress Cataloging-in-Publication Data  Bourlès, Henri.   [Systèmes linéaires. English]   Linear systems / Henri Bourlès.        p. cm.   Includes bibliographical references and index.   ISBN 978-1-84821-162-9  1.  Linear systems.  I. Title.    QA402.B62713 2010   003'.74--dc22 2010016973  British Library Cataloguing-in-Publication Data A CIP record for this book is available from the British Library  ISBN 978-1-84821-162-9 Printed and bound in Great Britain by CPI Antony Rowe, Chippenham and Eastbourne.   ContentsPreface.........................................xiiiChapter1.PhysicalModels............................11.1.Electricsystem................................11.1.1.Meshrule................................11.1.2.Nodalrule................................21.2.Mechanicalsystem..............................31.2.1.Fundamentalprincipleofdynamics.................31.2.2.Lagrangianformalism.........................111.3.Electromechanicalsystem..........................131.4.Thermalhydraulicsystem..........................141.4.1.Balanceinvolume...........................141.4.2.Exitrate:Torricelli’sformula.....................151.4.3.Energybalance.............................151.5.Exercises...................................16Chapter2.SystemsTheory(I)...........................192.1.Introductoryexample.............................192.2.Generalrepresentationandproperties...................202.2.1.Variables................................202.2.2.Equations................................212.2.3.Time-invariantsystems........................212.2.4.Linearsystems.............................212.2.5.Lineartime-invariantsystems.....................222.2.6.Equilibriumpoint...........................232.2.7.Linearizationaroundanequilibriumpoint.............242.3.Controlsystems................................252.3.1.Inputs..................................252.3.2.Outputs.................................272.3.3.Latentvariables.............................28vviLinearSystems2.3.4.Classiﬁcationofsystems.......................302.3.5.Rosenbrockrepresentation......................312.3.6.State-spacerepresentation.......................332.3.7.Polesandorderofasystem......................332.3.8.Freeresponseandbehavior......................332.4.Transfermatrix................................362.4.1.Laplacetransforms...........................362.4.2.Transfermatrix:deﬁnition.......................372.4.3.Examples................................382.4.4.Transmissionpolesandzeros.....................392.4.5.*MacMillanpolesandzeros.....................412.4.6.Minimalsystems............................442.4.7.Transmissionpolesandzerosatinﬁnity...............462.5.Responsesofacontrolsystem.......................482.5.1.Input–outputoperator.........................482.5.2.Impulseandstepresponses......................512.5.3.Proper,biproperandstrictlypropersystems.............512.5.4.Frequencyresponse..........................552.6.Diagramsandtheiralgebra.........................562.6.1.Diagramofacontrolsystem.....................562.6.2.Generalalgebraofdiagrams.....................572.6.3.Speciﬁcityoflinearsystems......................602.7.Exercises...................................61Chapter3.Open-LoopSystems..........................633.1.Stabilityandstaticgain...........................633.1.1.Stability.................................633.1.2.Staticgain................................643.2.First-ordersystems..............................653.2.1.Transferfunction............................653.2.2.Timedomainresponses........................653.2.3.Frequencyresponse..........................673.2.4.Bodeplot................................673.2.5.Caseofanunstableﬁrst-ordersystem................693.3.Second-ordersystems............................703.3.1.Transferfunction............................703.3.2.Timedomainresponses........................713.3.3.Bodeplot................................753.4.Systemsofanyorder.............................783.4.1.Stability.................................783.4.2.Decompositionofthetransferfunction...............793.4.3.AsymptoticBodeplot.........................803.4.4.Amplitude/phaserelation.......................823.5.Time-delaysystems.............................85Contentsvii3.5.1.Leftformtime-delaysystems.....................853.5.2.Transferfunction............................863.5.3.Bodeplot................................863.5.4.Example:ﬁrst-ordertime-delaysystem...............863.5.5.Approximationsofatime-delaysystem...............873.6.Exercises...................................91Chapter4.Closed-LoopSystems.........................954.1.Closed-loopstability.............................954.1.1.Standardfeedbacksystem.......................954.1.2.Closed-loopequations.........................954.1.3.Stabilityofaclosed-loopsystem...................974.1.4.Nyquistcriterion............................994.1.5.Smallgaintheorem...........................1034.2.Robustnessandperformance........................1044.2.1.Generalities...............................1044.2.2.Robustnessmargins..........................1054.2.3.UseoftheNicholschart........................1104.2.4.Robustnessagainstneglecteddynamics...............1114.2.5.Performance..............................1134.2.6.Sensitivitytomeasurementnoise...................1144.2.7.LoopshapingofL(s).........................1154.2.8.Degradationofrobustness/performancetrade-off..........1164.2.9.*ExtensiontotheMIMOcase....................1194.3.Exercises...................................127Chapter5.CompensationandPIDController.................1295.1.Onedegreeoffreedomcontroller......................1295.1.1.Closed-loopsystem..........................1295.1.2.Closed-loopequationsandstaticerror................1295.2.Leadcompensator..............................1315.2.1.Characteristicsofaleadcompensator................1315.2.2.Principlesofaleadcompensator...................1325.2.3.PDcontroller..............................1345.3.PIcontroller..................................1355.3.1.Principle.................................1355.3.2.Example.................................1365.4.PIDcontroller.................................1385.4.1.Integralactionandleadcompensator.................1385.4.2.ClassicformofaPIDcontroller...................1395.5.Exercises...................................142Chapter6.RSTController.............................1436.1.StructureandimplementationofanRSTcontroller............143viiiLinearSystems6.2.Closedloop..................................1456.2.1.Closed-loopequations.........................1456.2.2.Poleplacementandstability......................1466.3.Usualcase...................................1466.3.1.Disturbancerejection.........................1466.3.2.Absenceofstaticerror.........................1476.3.3.Measurementnoiseﬁltering......................1476.3.4.Problemresolution...........................1486.3.5.Choiceofthepoles...........................1506.3.6.Examples................................1566.4.*Generalcase.................................1626.4.1.Disturbancerejection.........................1626.4.2.Referencetracking...........................1626.4.3.Internalmodelprinciple........................1636.4.4.Filteringofmeasurementnoise....................1646.4.5.Problemresolution...........................1646.4.6.Choiceofpoles.............................1666.4.7.Examples................................1676.5.Exercises...................................171Chapter7.SystemsTheory(II)..........................1757.1.Structureofalinearsystem.........................1767.1.1.*Thenotionofalinearsystem....................1767.1.2.State-spacerepresentation.......................1767.1.3.Controllability.............................1787.1.4.Observability..............................1827.1.5.Canonicalstructureofasystem....................1867.2.Zerosofasystem...............................1897.2.1.Invariantzerosandtransmissionzeros................1897.2.2.Input-decouplingzeros........................1907.2.3.Output-decouplingzeros........................1917.2.4.Input–ouputdecouplingzeros.....................1927.2.5.Hiddenmodes.............................1927.2.6.Relationshipsbetweenpolesandzeros................1947.3.Stability,stabilizabilityanddetectability..................1957.4.Realization..................................1977.4.1.Introduction...............................1977.4.2.SISOsystems..............................1977.4.3.*MIMOsystems............................2027.5.Flatness....................................2097.5.1.*Flatnessofnonlinearsystems....................2107.5.2.Flatnessoflinearsystems.......................2107.6.Exercises...................................211ContentsixChapter8.StateFeedback.............................2178.1.Elementarystatefeedback..........................2178.1.1.Generalprinciple............................2178.1.2.Poleplacementbystatefeedback...................2198.1.3.ChoiceofthepoleplacementintheSISOcase...........2238.1.4.*ChoiceofthepoleplacementintheMIMOcase.........2248.2.Statefeedbackwithintegralaction.....................2378.2.1.Insufﬁciencyofstatefeedback....................2378.2.2.Feedbackcontrolinthepresenceofdisturbances..........2378.2.3.Resolutionofthestaticproblem...................2388.2.4.Resolutionofthedynamicproblem.................2398.3.*Internalmodelprinciple..........................2438.3.1.Problemsetting.............................2438.3.2.Solution.................................2458.4.Exercises...................................248Chapter9.Observers................................2519.1.Full-orderobservers.............................2519.1.1.Generalprinciple............................2519.1.2.Statefeedback/observersynthesis..................2539.1.3.Statefeedback/observersynthesisandRSTcontroller.......2559.1.4.LTRmethod...............................2579.2.Statefeedback/observersynthesiswithintegralaction..........2649.2.1.Problemsetting.............................2649.2.2.Algebraicsolution...........................2659.2.3.ExtensionoftheLTRmethod.....................2679.3.*Generaltheoryofobservers........................2759.3.1.Reduced-orderobserver........................2759.3.2.Generalformalism...........................2779.4.Exercises...................................279Chapter10.Discrete-TimeControl........................28110.1.Introduction.................................28110.2.Discrete-timesignals............................28110.2.1.Discretizationofasignal.......................28110.2.2.z-transform..............................28210.2.3.Sampledsignal............................28210.2.4.Poissonsummationformula.....................28310.2.5.Samplingtheorem..........................28410.2.6.Hold..................................28810.3.Discrete-timesystems...........................28910.3.1.Generaldescription..........................28910.3.2.Sampledsystem............................29010.3.3.Discretizedsystem..........................291xLinearSystems10.3.4.State-spacerepresentationofadiscrete-timesystem.......29310.3.5.Calculationofthestateofadiscretizedsystem..........29510.4.Structuralpropertiesofdiscrete-timesystems..............29610.4.1.Polesandzeros............................29610.4.2.Controllability.............................29710.4.3.Observability.............................30110.4.4.Rosenbrockrepresentation......................30410.4.5.Stability................................30410.5.Pseudocontinuoussystems.........................30610.5.1.Bilineartransform..........................30610.5.2.Pseudocontinuousrepresentations..................30810.5.3.*Intrinsicdeﬁnitionofapseudocontinuoussystem........31010.5.4.Structuralpropertiesofpseudocontinuoussystems........31310.6.Synthesisofdiscrete-timecontrol.....................31310.6.1.Directapproaches...........................31310.6.2.Discretizationbyapproximation..................31310.6.3.Passagethroughapseudocontinuoussystem............31410.7.Exercises...................................319Chapter11.Identiﬁcation.............................32111.1.Randomsignals...............................32111.1.1.Momentsoforder1and2......................32211.1.2.Correlationandcross-correlation..................32211.1.3.Pseudo-randomsignals........................32511.1.4.Filteringandfactorization......................32611.1.5.Ergodicrandomsignals.......................32911.2.Open-loopidentiﬁcation..........................33111.2.1.Notation................................33111.2.2.Leastsquaresmethod.........................33111.2.3.Modelsandprediction........................34011.2.4.OutputErrormethodandARMAXmethod............34211.2.5.Consistencyoftheestimatorandresidues.............34411.2.6.Filteringofdata............................34711.3.Closed-loopidentiﬁcation.........................35611.3.1.Directandindirectapproach.....................35611.3.2.Consistencyofestimatorinthedirectapproach..........36011.3.3.Athirdpath..............................36311.4.Exercises...................................365Chapter12.Appendix1:Analysis........................36912.1.Topology...................................36912.1.1.Topologicalspaces..........................36912.1.2.Topologicalvectorspaces......................37112.1.3.Continuouslinearoperators.....................374Contentsxi12.2.Sequences,functionsanddistributions..................37512.2.1.Sequences...............................37512.2.2.Functions...............................37712.2.3.Distributions..............................38012.3.Fourier,Laplaceandztransforms.....................38712.3.1.Fouriertransformsofdistributions.................38712.3.2.Fourierseries.............................38912.3.3.Fouriertransformsofsequences...................39312.3.4.Laplacetransform...........................39412.3.5.z-transform..............................40112.4.Functionsofonecomplexvariable....................40412.4.1.Holomorphicfunctions........................40412.4.2.Functionsofamatrix.........................40612.4.3.Integrationinthecomplexplane..................40812.4.4.Applicationstoinversetransforms.................41212.4.5.Argumentprinciple..........................41612.5.Differentialequations............................41712.5.1.Generalities..............................41712.5.2.Lineardifferentialequations:constantcoefﬁcients........42112.6.Functionsofseveralvariables;optimization...............42812.6.1.FunctionsofclassC1.........................42812.6.2.FunctionsofclassC2.........................42912.6.3.Taylor’sformula...........................42912.6.4.Convexity,coercivity,ellipticity...................43012.6.5.Optimizationalgorithms.......................43212.7.Probabilisticnotions............................43812.7.1.Probabilityspace...........................43812.7.2.Randomvariable...........................43912.7.3.Conditionalexpectation.......................443Chapter13.Appendix2:Algebra.........................44713.1.Commutativeringsandﬁelds.......................44713.1.1.Generalities..............................44713.1.2.Divisibility...............................45013.1.3.Principalidealdomains.......................45313.1.4.Matricesovercommutativerings..................45513.1.5.Bézoutequation............................46013.2.Matricesoverprincipalidealdomains..................46313.2.1.Invertiblematricesoverprincipalidealdomains..........46313.2.2.Hermiteform.............................46313.2.3.Smithform..............................46413.2.4.Elementarydivisors..........................46813.2.5.Smithzeros..............................46913.2.6.Divisibilityofmatrices........................470xiiLinearSystems13.2.7.Coprimefactorizations........................47113.2.8.Bézoutmatrixequations.......................47213.3.Homomorphismsofvectorspaces.....................47313.3.1.Vectorspaces.............................47313.3.2.Homomorphismsandmatrices...................47513.3.3.Endomorphismsofvectorspaces..................47913.3.4.*Jordanform.............................48513.4.*Thelanguageofmodules.........................49113.4.1.Generalnotions............................49113.4.2.Modulesoverprincipalidealdomains...............49613.4.3.Structureofendomorphisms.....................50113.5.Orthogonalityandsymmetry........................50413.5.1.Orthonormalbasis..........................50513.5.2.Orthogonality.............................50513.5.3.Adjointendomorphism........................50613.5.4.Unitaryendomorphism........................50713.5.5.Normalendomorphism........................50713.5.6.Self-adjointendomorphism.....................50813.5.7.Singularvalues............................51013.6.Fractionsandspecialrings.........................51513.6.1.Rationalfunctions..........................51513.6.2.Algebra(cid:1)H∞.............................51613.6.3.*AlgebraH∞.............................51813.6.4.*Classiﬁcationofrings........................51913.6.5.*Changeofrings...........................519Chapter14.SolutionsofExercises........................52114.1.ExercisesofChapter1...........................52114.2.ExercisesofChapter2...........................52214.3.ExercisesofChapter3...........................52414.4.ExercisesofChapter4...........................52614.5.ExercisesofChapter5...........................52814.6.ExercisesofChapter6...........................52914.7.ExercisesofChapter7...........................53114.8.ExercisesofChapter8...........................53714.9.ExercisesofChapter9...........................54014.10.ExercisesofChapter10..........................54314.11.ExercisesofChapter11..........................549Bibliography.....................................553Index..........................................561PrefaceThenotionofsystemThenotionofsystemisthebasicconceptofcontroltheory.Whatisasystem?Itisquitedifﬁculttoaddressthisquestioninallitsaspects.Wecansaysomewhatlooselythatitisanentityconsistingofinteractingparts;anentitythatisitself,mostoften,alsointeractingwithothersystems.Thesolarsystem,acomputersystem,etc.areexamplesofasystem.Thecontrolsystemanalystisinterestedinsystemswhichare,atleastinpart,designedandconstructedbyman,inordertobeutilized–acarengineortheentireautomobile;analternatorinapowerstationorthe“powersystem”initsentirety(consistingofproductioncenters,linesofenergytransportandconsumptioncenters);anairplane,suchastheA380Airbus,wherecontrolsystemsplayaveryimportantrole;afactoryproductionline,etc.Wecanactuponthesesystemsandthesereacttoactionsexertedonthem.ObjectivesofsystemstheorySeveralobjectivesexistincontrolsystemstheory.ModelingTheabove-mentionedsystemsarepartofthematerialworldandarethusgovernedbythelawsofphysics.Byputtingthesysteminanequationbasedontheselaws,weobtainamathematicalmodelwhichwillgreatlyfacilitateitsunderstanding.Therefore,modelingisoneoftheimportantactivitiesofthecontrolsystemsanalyst.Themodelingprocessdoesnotalwaysstartwiththelawsofphysics;itcansimplybebasedonamoreorlessempiricalandqualitativeobservationofthebehaviorofthesystem.Withintheframeworkofthisbook,wewillhoweverlimitourselvestocaseswhereamathematicaldescriptionofthesystembehaviorispossible.Ingeneral,themodelobtainedconsistsofasetofdifferentialequations(sometimesofpartialdifferentialequations)orofdifferenceequations.xiiixivLinearSystemsIdentiﬁcationThemodelingprocess,asunderstood,involvesdeterminingthestructureoftheequationswhichgovernthebehaviorofthesystem,andalsoinﬁxingapriorithevaluesofcertainsystemparameters:forexample,thelengths,masses,resistancevalues,capacitancevalues,etc.Butitisoftenimpossibletocometoanaprioricompleteandpreciseunderstandingofalltheparametersofthismodel.Inordertoreﬁneandcompletethisunderstanding,itbecomesnecessarytoproceedtoanidentiﬁcationofthesystem:fromthereactionsofthelattertoknownandgivenstimulations,wecan,undercertainconditions,identifytheyetunknownparameters.Identiﬁcationisoneofthemajoraspectsincontroltheory.AnalysisOncethesystemismodeledandidentiﬁed,itbecomespossibletoanalyzeitsbehavior.Thisanalysiscanbeverycomplex.Asanexample,theanalysisoftheEuropeanandNorthAmericanelectricsystemsisdifﬁcultandrequirespowerfulcomputingresourcesandenormousdatabasesbecausewedealwithverylargesystems.Andunderstandingthesesystemswellisessentialforsecurityreasons:pointssuchasthepossibilityof“black-out”risk?Ingeneral,theanalysisofasystemmakesitpossibletodetermineitsessentialproperties.ControlThus,systemstheoryisa“theoretical”scienceinwhichoneofitsobjectivesisknowingsystems,throughmodeling,identiﬁcationandanalysis.Butitisalso(wemaybetemptedtosayessentially)a“practical”science,ascienceof“action”.Wetrytounderstandsystemsinordertobeabletocontrolthem,andtoregulatetheminthebestpossibleway.Thelastmajorchapterofsystemstheoryisthatofcontrol.Open-loopandclosed-loopsystemsAfundamentaldifferenceexistsbetween“open-loop”and“closed-loop”systems.Controllinganopen-loopsystemisdoingitblindly,withouttakingintoaccounttheresultsoftheactiontaken.Weknowtheexpression:“Icouldwalkdownthispathblind-folded”.BecauseIknowatwhichmomentIneedtoturnleft,andthenright.IknowwhenIneedtoaccelerate,whentoslowdown,...Anditistruethatif,aswithLaplace’sgenius,wehadaperfectknowledgeoftheworld,wecouldcontrol,inopen-loop,everysystembelongingtoit.However,ourknowledgeofthingsisincomplete.Evenwitharouteweknowbyheart,unpredictableeventsmayoccur:achildunexpectedlycrossingthestreet,aspellofrainmakingtheroadmoreslipperythanusual,etc.Itisthusnecessarytonoteatalltimes,andtoadjustactions,takingintoaccounttherealitythatappearsfrommomenttomoment.Controltheoryistheart(orscience)ofmakingthisunceasingadjustment,whichwecallalooporafeedbackoraservo-mechanism.Itisacommonconceptwhichneverthelessposesnumerousproblems.PrefacexvOneofthemajordifﬁcultiesencounteredwithfeedbacksystemsistheirpossibleinstability.Therearecertainlyunstableopen-loopsystems,buttheyarerelativelyrare:ahelicopter,analternatorconnectedwithalongpowerline,certaintypesofﬁghterjets,etc.Ontheotherhand,nothingismorecommonplacethanmakingasystemunstablewithapoor-performingfeedbackloop.Letusthinkofachildstrivingtotakeashower:whenthewateriscold,hewantstoheatitup,turnsthehotwatertapontooquickly,andgetsboilinghotwater;then,over-doingitthesamewaywiththecoldwatertap,hemakesthewatericecold,andsoon.Thenotionoffeedbackcontrolisthusverypowerful,butcannotbeappliedwithoutproperknowledge.PresentationThisbookisdividedintochapters,andsections;forexample,section2.1istheﬁrstsectionofChapter2,andsection2.1.3isthethirdsubsectionofsection2.1.Itcontainsthebasicsthatanon-specializedengineermustknowincontrolengineering.IhadtheopportunitytoteachthiscourseatConservatoireNationaldesArtsetMétiers(Paris),severalengineeringinstitutesGrandesEcoles,EcoleNormaleSupérieuredeCachan,and,forthemostdifﬁcultparts,atParisXIUniversity(Master2level).Thecoursecontainedinthisbookisprogressive,makingitaccessibletoanyreaderwithanL2levelinscience,andincludesmanyexamples.Nevertheless,tomakeitcoherent,passages(sectionsorgroupsofsentences)hadtobeincludedintheﬁrstchaptersthatcalluponsomewhatmoredifﬁcultnotionswhichmayneedasecondorthirdreading.Thesepassagesareprecededbyasterisksforsections,andsituatedbetweentwoasterisksforgroupsofwordsorsentences.Thepurposeofthisbookistostudysystemmodeling,identiﬁcation,analysisandcontrol.Amongthesefourthemes,modelingisperhapsthetrickiestproblem:toknowhowtomodelelectrical,mechanical,thermal,hydraulic,orothersystems–astheyarecomplex–apersonhastobeanelectrical,mechanical,thermal,hydraulicengineer.Itisphysicsingeneral,allofphysics,whichisusefulformodeling;andmodeling,whichisthesubjectmatterofChapter1,isnotexclusivetothecontrolengineer.Someexampleswillserveasbasicremindersofhydraulicsandthermodynamics.Remindersrelativetoelectricityaresomewhatlesssuccinct.Withrespecttomechanics,Ithoughtthatitwouldbeusefultogointomoredetails.However,theonlyobjectiveofthepresentationistoenablethereadertounderstandexamplesandresolveexercises.Obviously,itcannotreplaceatreatiseonmechanics.FromChapters2to11,thecontrolengineerﬁndshimself/herselfinhis/herownprivatedomain.Thesechaptersdealwithlinearsystemsanalysis,control,andidentiﬁcation.IhaveputtogethersomemathematicalelementswhichIdeemedessentialintheappendicesincludedinChapters12and13.ThiswillsparethereaderxviLinearSystemsfromconstantlyreferringtothebibliography:elementsofanalysisﬁrst,andthenofalgebra.Someofthem(Smithformofapolynomialmatrix,(cid:1)H∞algebra,moduletheoryetc.)areprobablynewtomostreaders.ButIpreferrednottodiscusstheminthemainbodyofthetext,tosavethelatter,totheextentpossible,forwhattrulycomeswithinthescopeofcontroltheory.Likewise,theLaplacetransformandthez-transform,whicharemathematicaltoolsthatclassicallyappearhighintextbooksoncontroltheory,areincludedintheseappendices.Theseareorganizedasapresentationof“mathematicsforsystemstheory”withproofswhentheyareconstructiveorsimplyusefulforthereader’sunderstanding.Thereadercanthuschoosetorefertotheappendicesifneededortoreadthementirelyasactualchapters.Ihavedecidednottopresentthetheoryofmeasureandintegration.Concerningthelatter,Ireferthereadertothesecondvolumeof[35]orto[103].Iachievedthiswiththehelpofsomemathematicalgymnasticshereandthere.About80exercisesaregiventothereaderstotestandreﬁnetheirunderstandingofthesubject.Solutionstomostoftheexercisesareprovided(sometimesinbrief)inChapter14.MATLABand/orSCILABﬁlestorunexamplesandsolveexercisescanbefoundatwww.iste.co.uk/bourles/LS.zip.CourseoutlineBeginner’scourseThebeginneratL3(i.e.third-yearundergraduate)levelcanstartwiththeeasiestpartsofChapter1.Thepartthatmightbedifﬁcultforthebeginnerissection1.2whichisdevotedtothemodelingofamechanicalsystem.Iadvisethereadertoapproachthispartinapragmaticway,usingtheexamplesandexerciseswhichshowwhatresultsareessentialandhowtomakegooduseofthem.InChapter2,readersshouldleaveasideeverythingthatrelatestomulti-inputmulti-outputsystems.Itisbetteriftheyfocuson“left-forms”,“right-forms”,andonmethodswhichmakeitpossibletoobtainsystemtransferfunctions.Theywilleventuallydevelopparticularinterestintreatedexamplesandexercises.ThereadershouldstudyChapters3to6indepth(leavingaside,ofcourse,thestarredpassages“intendedforasecondreading”).Frommypointofview,thereader’scoursethereforeendswiththeRSTcontroller(“usualcase”section).AdvancedcourseThereaderatM1(i.e.ﬁrst-yeargraduate)levelshouldbegintogodeeperintowhathe/sheonlyskimmedoverwhenhe/shewasabeginner,i.e.section1.2ofChapter1,andChapter2.Afterwards,thereaderwillresolutelymoveontoChapter7,whichincludescomplementarymaterialonsystemstheory,andwillthenbereadytostudyPrefacexviiChapters8to11.Iadvisethereadertosystematicallyskipthepassagesrelatedtomoduletheory.AdvancedgraduatelevelThereaderatM2(i.e.second-yeargraduate)levelstillhasmanythingstodiscoverbeforelaunchingintospecializedcourses.Theseareallthepassagesthathe/sheskippedduringpreviousreadings,inparticularthosepresentingthetheoryofsystemsinthelanguageofmodules.Itmayalsobeintheinterestofthereaderstosystematicallyre-readtheelementsofmathematicsinAppendices1and2(Chapters12and13).Coherentcourseand“butterﬂy”courseThisbookshouldbereadinamoresystematicwaytounderstandthecontents.Anotherapproachtothisbookisalsopossibleforreaderswhowishtobesystematicwhilenotnecessarilybelongingtotheabovecategories:thesereadersshouldreadthechaptersofthebook,withoutskippinganypassage,intheorderIhavepresentedthem(withtheexceptionoftheappendices–Chapters12and13–whichtheyshouldreadﬁrst).Ihaveoftenstartedreadingasciencebookinthatspirit,andonlyalackoftimehasmademetakeanoppositeturn,whichisto“ﬂitabout”,tryingtogoasfastaspossible(astrategy,besides,whichdoesnotalwayspayoff).Idonothaveanywaytoproposetothe“butterﬂy”readers,butIhaveincludedadetailedindexattheendofthebookforthem.ChoicesandnecessitiesSincethisbookisaboutlineartime-invariantsystems,Ihavedeemeditessentialtopresentthisconceptcorrectly.Suchasystemcannolongerbeproperlydeﬁnedbyitstransfermatrix(toopoorarepresentation),orbyKalman’sapproach,asoneofitsstaterealizations,orbyRosenbrock’sapproach,asa“systemmatrix”(toocontingentarepresentation).Wonham’s“geometricapproach”,whichwasproposedinthe1980s,intheend,onlyreformulatesKalman’sapproachinalittlemoremodernmathematicallanguage,anddoesnotseemtobeagoodanswer.Followingtheworksofexpertsindifferentialalgebra,itappearedthat,whatcontrolengineerscall“system”and“linearsystem”,shouldbedeﬁnedasanextensionofadifferentialﬁeldandamoduledeﬁnedoveraringofdifferentialoperators,respectively.Intheearly1990s,thispropertywasrevealedbyM.Fliesstothecommunityofcontrolengineering(seethesynthesispresentedin[47]).Suchalanguagemayhavediscouragedabeginner,butitisthisconceptionthatIhaveattemptedtomakethereadergraduallysensitiveto,inChapters2and7.Inreality,moduletheory,atthelevelusedhere(ﬁnitelygeneratedmodulesoverprincipalidealdomains)isverysimpleforareadersomewhataccustomedtoabstraction.Itdoesclarifymanipulationsthatcanbedonewithpolynomialmatrices,aswellastheJordancanonicalform.Forthisreason,Ihavemadeitthemainthemeof“passagesintendedforathirdreading”.ThereaderwishingtogofurtherintosystemsxviiiLinearSystemstheorycanreferto[47]onnonlinearaspects,and[22]onlineartime-varyingsystems([15]isapreliminaryversionof[22]).Moduletheoryishelpfulinpresenting(inthecaseoflinearsystems)thenotionofﬂatness(duetoFliessandhiscollaborators[48]),whichhasbecomeessentialtoefﬁcientlyresolvetheproblemofmotionplanning(seesection7.5).Iwantedtoshowthatcontrolengineeringisnotmagicbutscience.Onthatpremise,Ihaveinsisted,inChapter4,onthelimitationsduetocertaincharacteristicsofthesystemtobecontrolled(unstablepolesandzeros,speciﬁcally).Formoredetailsonthispoint,see[51].Thecontrolengineerispermanentlyconfrontedwiththeproblemofuncertaintiesinmodeling.Thus,thisbookisconstantlypreoccupiedwiththerobustnessofcontrollaws.However,thisisnotabookonrobustcontrol.Thetheoryofrobustnesshasbecomeextremelysophisticated,anditsrecentdevelopmentisnotcoveredhere.Besides,excellentbooksonthisissue([107]and[122],amongothers)doexist.Ihaveemphasizedinthisbookoncontrol(whetherinpolynomialorstateformalism)thatsystemstabilizationisexceptionallytheroleofthefeedbackloop;thepointisoftentocompeltheoutputofsuchasystemtofollowareferencesignal,inspiteofvariousdisturbancesthatitmaybesubjectedto.Thisiswhy–inordertodesignanRSTcontrolleraswellasacontrolbystatefeedback,possiblywithanobserver–itisessentialtoﬁrstmakethenecessarymodelaugmentations(followingwhatWonhamcalledthe“internalmodelprinciple”).Withoutthisprerequisite,“modernmethods”onlygeneratenonsense.Italsoappearedtomethatitwasimportanttoshowthat,inthemulti-inputmulti-outputcase,acontrollawwithexecrablequalitiescancorrespondtoagoodpoleplacement,becausethelatterdoesnotdeterminetheformer.Theworstmethod(eventhoughitisquiteelegantfromastrictlytheoreticalpointofview)isprobablytheonethatconsistsofrevertingtoacyclicstatematrixthroughaﬁrstloop,andthenproceedingasinthesingle-inputsingle-outputcase.Ihaveabstainedfrompresentingthelinear-quadratic(LQ)optimalcontrolandits“dual”version,theKalmanﬁlter.Fortheconceptionofcontrolbystatefeedbackandobserver,Ihaveindeedpreferredtoproposeessentiallyalgebraicmethodsforseveralreasons.Oncethesemethodsarewellassimilated,itbecomeseasytoimplementanefﬁcient“LQGcontrol”.1ThetheoryofLQGcontrol(whichencompassesLQcontrolandKalmanﬁltertheories)isnowclassicand,atabasiclevel,iswellcoveredintreatisessuchas[1]and[2].Ontheotherhand,theminimizationofacriterionisonlyaconvenientintermediatestepforthecontrolengineertoobtainacontrollawwiththedesiredproperties[78].Anotherelementthatkeptmefromincludingoptimalcontrol1.“LQG”standsfor“LinearQuadraticGaussian”.Prefacexixisthatitwouldhavemadethisbooklonger(especiallytocorrectlypresentcontinuous-timestochasticoptimalcontrol,with,inthebackground,Ito’sdifferentialcalculus[68],[118]).Ifoundthevolumeofthisbooktobelargeenough.Nevertheless,exceptforafewsubtleties,themethodsproposedinthemulti-inputmulti-outputcaseinChapters8and9onlydifferfromLQcontrolandKalmanﬁlteringintheirpresentationstyle(theminimizationofacriterionisnotpresentedasagoal–seeRemark245insection8.1.4).Iencouragethereadertocontinuethestudyofthisbookalongwiththatof“LQGcontrolwithfrequency-shapedweights”[2],whichisagoodcomplement.OnlyChapter10dealswithdiscrete-timesystemsandcontrol.Allpreviouschapters(includingtheoneonRSTcontroller)arethuspresentedinthecontextofcontinuous-time,whichisabitunusual.Despitetheideasspreadbysomepeople,Ihaveexperiencedthatcontinuous-timeformalismoffersmuchmoreﬂexibilityforthedesignofcontrollaws,especiallywithrespecttothechoiceofpolesandthequestionof“roll-off”,whichareessentialtorobustness.Oncethesynthesisofcontinuous-timecontrollawsismastered,itisverysimpletoswitchtothesynthesisofdiscrete-timecontrollaws–withoutanyapproximation(thispointisofcoursediscussedindetailinChapter10).Chapter11discussesparametricidentiﬁcationofdiscrete-timesystemsbyminimizationofthel2normofthepredictionerror.Thepresentationisrelativelyclassicasfarasopen-loopidentiﬁcationisconcerned;asforclosed-loopidentiﬁcation,itessentiallyincludesLjungandForsell’scontribution[82](asacomplement,thereadercanconsult[75]andChapter10of[110]).Manyothertopicswouldhavebeenworthpresenting:forexample,anti-windupmethodsinthepresenceofsaturations(whichisclearlyexpoundedin[4])orgainscheduling(seesurveypapers[104]and[80]),nottomentionnonlinearcontrol(forageneralpresentationofthistheme,see[108]and[62],andbeginwiththeﬁrstreferencebecauseitissimple;robustnonlinearcontrolisdiscussedin[49];seealso[48]whichdealswithﬂatnessfromboththeoreticalandpracticalviewpoints,inadditiontosection7.5ofthisbook).Wecanalsocitethefollowingsubjects:adaptivecontrol(whichisthesubjectofalotofliterature,but[57],[3]and[108]canberecommendedasagoodinitiationonthistheme);fuzzyorneuralcontrol(thereadercanﬁndagenuinelyscientiﬁcpresentationofthelasttwotypesofcontrolin[40]);thecontrolofsystemsgovernedbydelayeddifferentialequationsorpartialdifferentialequations(onthissubject,see[55]and[33]inthelinearcontext,aswellas[58]and[59]wherenonlinearproblemsarediscussed).Asalreadymentioned,theextensionofmanymethodspresentedinthisbooktolineartime-varyingsystemscanbefoundin[22].NoteontheEnglisheditionThisEnglisheditionhasgivenmetheopportunitytocorrectmanyerrorswhich,despiteproof-reading,hadbeenleftintheoriginalFrenchedition,andalsoincludexxLinearSystemsadditionalinformationwhichmightbeuseful.Furthermore,ithasgivenmetheopportunitytocompleteChapter7withasectiononﬂatnessandtoentirelyreviseChapter11onidentiﬁcation:themathematicalbasesincludedthereinaregiveninAppendix1,andasectiononclosed-loopidentiﬁcationhasalsobeenadded.Finally,thiseditioncontainsadditionalexercisesandoneofthempresentsthebasicsofwhatneedstobeknownaboutthe“deltatransform”.AcknowledgmentsIwouldﬁrstliketothankmy“elders”,especiallyE.Irving,I.D.LandauandP.deLarminat,whohavesharedtheirexperiencewithmeduringinformal,butalwayspassionate,discussions.IalsothankM.Fliesswhohasopenedmyeyestothealgebraictheoryofsystems–whichIhopethisbookhasbeneﬁtedfrom–andP.Chantreforourexchangesonidentiﬁcation.IthankmysonNicolaswhohashelpedmeﬁnalizeﬁgures.IalsothankmytranslatorG.K.Kwanforhiseffortsandhiskindness.Lastbutnottheleast,IthankmywifeCorinne,whosepatiencehasoftenbeenseverelytestedduringthisworkwhichhasdemandedalotoftimeandenergyfromme.Chapter1PhysicalModels1.1.ElectricsystemElectriccircuitscanbemodeledbyapplyingKirchhoff’stwolaws:Kirchhoff’sCurrentLawandKirchhoff’sVoltageLaw.Theyarealsoknownasthenodalruleandthemeshrule.Followingarethetwoexamplesinwhichthesetwolawshavebeenapplied.1.1.1.MeshruleConsiderthe“RLC”circuitshowninFigure1.1.Thiscircuitconstitutesamesh.Themeshrulestatesthatbetweenanytwopointsonamesh,pointsAandBinthiscircuitforexample,thepotentialdifferenceisindependentofthepaththatistaken(which,inphysics,isafundamentalpropertyofapotential,inthiscasetheelectricpotential).Therefore,wehaveVA−VB=V=VR+VL+VC,whereVR,VL,andVCarethevoltagesacrosstheresistanceR,theinductanceL,andthecapacitanceC,respectively.WehaveVR=Ri,VL=Ldidt,VC=1C(cid:1)t−∞i(τ)dτ;thereforeweobtaintheintegro-differentialequationV=Ri+Ldidt+1C(cid:1)t−∞i(τ)dτ.Differentiatingthisequationwegetthefollowinglineardifferentialequation:LCd2idt2+RCdidt+i−CdVdt=0.(1.1)1Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.2LinearSystemsBARLCViVRVLVCFigure1.1.RLCcircuit1.1.2.NodalruleConsidertheelectriccircuitgiveninFigure1.2,whichisa“picircuit”usedtorepresentatransmissionlineinthedomainofelectricnetworks.Accordingtothemeshruledescribedabove,wehaveVA=1C(cid:2)t−∞i1(τ)dτ,VB=1C(cid:2)t−∞i2(τ)dτ,VA−VB=Ri+Ldidt.Thenodalruleisbasedontheconservationofcharge.Accordingtothisrule,atanynodeofacircuit,whichcanbeanypointwithinthecircuit,thesumofcurrententeringanodeisequaltothesumofcurrentleavingthatnode.Hence,wehavethefollowingtwoequations:iA=i+i1andi=iB+i2.Eliminatingthevariablei,wecannowre-arrangetheequationsasfollows:⎧⎪⎪⎨⎪⎪⎩CdVAdt−i1=0,CdVBdt−i2=0,VA−VB−R(iA−i1)−Lddt(iA−i1)=0,iA−i1−(iB+i2)=0.(1.2)VBVAiAiiBi1i2RLCCABFigure1.2.PicircuitPhysicalModels31.2.MechanicalsystemTherearetwomainapproachestomodelamechanicalsystem.Theﬁrstoneusesthefundamentalprincipleofdynamics,andisbasedontheanalysisofforcesandmomentsappliedtothevariouselementsofthesystem(particularly,internalforces,i.e.forcesappliedbysubsystemsononeanother).ThesecondapproachusestheLagrangianformalismandisbasedontheenergyofthesystem(kineticandpotentialenergy).Theanalysisofinternalforcesisthenunnecessary.Thesetwoapproachesaresuccinctlyexpoundedandappliedtotwoexamples.1.2.1.FundamentalprincipleofdynamicsTorsorAtorsorisaﬁeldofantisymmetricvectorsinathree-dimensionalafﬁnespace.Let−→M•beaﬁeldofsuchvectors;thisisafunctionA(cid:3)→−−→MA,and−−→MAiscalledthemomentofthetorsor−→M•atpointA.Thereexistsavector−→V,calledthecharacteristicvector,suchthatforanypointsAandB,wehavetherelation−−→MA=−−→MB+−−→AB∧−→V.Thetorsoristhusentirelydeterminedby−→Vandthemoment−−→MA,foranypointAunderconsideration.Weareagreedonthenotation(cid:7)−→V(cid:8)Aforthepair(cid:9)−→V,−−→MA(cid:10)and(cid:7)−→V(cid:8)forthetorsor−→M•.Thetwovectors−→Vand−−→MAarecalledtheelementsofreductionoftorsor(cid:7)−→V(cid:8)atpointA.Thecomomentof(cid:7)−→V(cid:8)A=(cid:9)−→V,−−→MA(cid:10)and(cid:7)−→V(cid:2)(cid:8)A=(cid:9)−→V(cid:2),−−→M(cid:2)A(cid:10)isthescalar−→V.−−→M(cid:2)A+−→V(cid:2).−−→MA.ThiscomomentisinvariantinthesensethatitisindependentofthepointAconsidered(ascaneasilybeveriﬁedbythereader).Therefore,thecomomentofthetorsors(cid:7)−→V(cid:8)and(cid:7)−→V(cid:2)(cid:8)iswelldeﬁnedandisdenotedby(cid:7)−→V(cid:8).(cid:7)−→V(cid:2)(cid:8).KinematictorsorAnexampleofatorsoristheﬁeldofvelocitiesofarigidbodyS,calledthekinetictorsorofS;thistorsorisdeﬁnedrelativetoanorthonormalframeofreferenceR(wealsosaythetorsorisdeﬁnedinthisframeofreference).ThisistosaythatthetranslationalvelocitiesandangularvelocitiesaremeasuredrelativetotheoriginandalongtheaxesofR.Itscharacteristicvectoristhevectorof“instantaneousrotation”−→ω(thistorsoristhusdenotedby{−→ω}).Indeed,aseasilyshown,thevelocitiesattwopointsAandBonthisrigidbodyarerelatedby−→vA=−→vB+−−→AB∧−→ω.(1.3)Now,letusconsideraframeofreferenceR(cid:2)attachedtotherigidbodyS.ThisconsistsofanoriginAandthreebasisvectors−→ei,i=1,2,3.Put−→ei=−−→AAi,where4LinearSystemsAi’sarepointsonS.Wehaved−→eidt=−→vAi−−→vA=−−→AiA∧−→ωaccordingto(1.3),andthusd−→eidt=−→ω∧−→ei.Let−→Ybeanyvector;itscoordinateswithinR(cid:2)arethoseYi’ssuchthat−→Y=(cid:11)3i=1Yi−→ei.Differentiatingthisexpression,wegetd−→Ydt=3(cid:12)i=1dYidt−→ei+3(cid:12)i=1Yid−→eidt=3(cid:12)i=1dYidt−→ei+−→ω∧−→Y.Thisquantity,denotingitbyd−→Ydt/R,isthederivativeof−→YinthereferenceframeR.Thevector(cid:11)3i=1dYidt−→eiisthederivativeof−→YinthismovingreferenceframeR(cid:2)andisdenotedbyd−→Ydt/R(cid:1).Wehavethusobtainedtheformulaestablishingtherelationbetweenthedifferentiationinamovingreferenceframeandthedifferentiationinaﬁxedreferenceframeasfollows:d−→Ydt/R=d−→Ydt/R(cid:1)+−→ω∧−→Y.(1.4)KinetictorsorKineticmomentThekineticmomentofamaterialsystemS(i.e.acollectionofmaterialpointsandrigidbodies–amaterialpointcanbeconsideredapunctualrigidbody)withrespecttoanypointAinreferenceframeRis−→σA(cid:1)(cid:1)S−−→AM∧−→vMdmwheredmisthedensityofmassatpointM;thisdensityisassumedtobeconstantovertime.1ElementsofreductionTheﬁeldofvectors−→σ•isatorsor,aswillbeshownbelow,anditiscalledthekinetictorsor.Indeed,ifBisanyotherpoint,wehave−→σA=(cid:2)S−−→(AB+−−→BM)∧−→vMdm=−−→AB∧(cid:2)S−→vMdm+(cid:2)S−−→BM∧−→vMdm.NowletObetheoriginofR;wethenget−→vM=d−−→OMdt,thus(cid:1)S−→vMdm=ddt(cid:1)S−−→OMdm.BydeﬁnitionofthecenterofmassGofS,wehave(cid:2)S−−→OMdm=m−−→OG1.Thesymbol(cid:1)means“equalsbydeﬁnition”.PhysicalModels5wheremisthetotalmassofS.Therefore,−→σA=−→σB+−−→AB∧−→p(1.5)where−→pisthemomentumofS,deﬁnedas−→p(cid:1)m−→vG.Accordingto(1.5),−→σ•isactuallyatorsor{−→p}withcharacteristicvector−→p.CaseofarigidbodySupposeSisarigidbodyandAisanypointonthisrigidbody;accordingto(1.3)weget−→vM=−→vA+−−→MA∧−→ω=−→vA+−→ω∧−−→AM,thus−→σA=(cid:2)S−−→AM∧(cid:9)−→vA+−→ω∧−−→AM(cid:10)dm=(cid:2)S−−→AMdm∧−→vA+(cid:2)S−−→AM∧−→ω∧−−→AMdm.ThelinearmappingIA:−→ω(cid:3)→(cid:1)S−−→AM∧−→ω∧−−→AMdmiscalledtheinertiatensorofSwithrespecttoA,andhencewehave(cid:1)S−−→AM∧−→ω∧−−→AMdm=IA−→ω.(1.6)WecanexpressthistensorintermsofitscoordinatesinanorthonormalsystemofreferenceR(cid:2).Let(x,y,z)bethecomponentsof−−→AMinR(cid:2).Developingexpression(1.6),thelinearmappingIAisidentiﬁed2withtheinertiamatrixofSwithrespecttoAinR(cid:2),givenbyIA=⎡⎣(cid:1)S(cid:15)y2+z2(cid:16)dm−(cid:1)Sxydm−(cid:1)Sxzdm−(cid:1)Sxydm(cid:1)S(cid:15)x2+z2(cid:16)dm−(cid:1)Syzdm−(cid:1)Sxzdm−(cid:1)Syzdm(cid:1)S(cid:15)x2+y2(cid:16)dm⎤⎦.Wethusobtain−→σA=m−−→AG∧−→vA+IA−→ω.(1.7)ThisexpressioncanbesimpliﬁedwhenA=GorwhenAisaﬁxedpointonS(ifSrotatesaroundthispoint);then(1.7)reducesto−→σA=IA−→ω.(1.8)2.Oncethechoiceofbasesismade,alinearmapping(alsocalledahomomorphism)isrepresentedbyamatrix(seesection13.3.2).Abusingthelanguage,wecanidentifythislinearmappingwiththismatrix.Andthisiswhatwedohere.“Abuseoflanguage”(inthesensewidelyusedinmathematics)and“abuseofnotation”areconsideredtobesynonymousinthisbook.6LinearSystemsInertiamatrixMatrixIAisonlyconstantwhenthereferenceframeR(cid:2)isrigidlylinkedtorigidbodySanditisthereforeourinteresttolookatthingsinthecontextofthiscase.Ofcourse,thisreferenceframeisinmotion,andthederivativeof(1.8)isobtainedbyapplying(1.4).Ontheotherhand,thematrixIAissymmetricreal,andthuscanbediagonalizedinanorthonormalreferenceframe(seesection13.5.6),andwhoseaxesarebydeﬁnitiontheprincipalaxesofinertiaofS.ThediagonalelementsobtainedinsuchamatrixarecalledtheprincipalmomentsofinertiaofS(withrespecttoAandrelativetotheprincipalaxesinquestion).TorqueInthecasewhere−→p=0,thekineticmomentisindependentofthepointbeingconsidered,accordingto(1.5):foranypointsAandB,−→σA=−→σB.Suchakineticmomentiscalledatorque,whichweshalldenoteby−→C.KineticenergyThekineticenergyTofamaterialsystemSisequaltothecomoment{−→ω}.{−→p}.Incaseofarigidbody,weobtainT=12(cid:15)mv2G+−→ω.IG−→ω(cid:16).(1.9)ForcetorsorNowconsiderasetofexternalforces−→f1,...,−→fnbeingappliedtopointsA1,...,AnofamaterialsystemS.Theresultantforceisgivenby−→f=(cid:11)nk=1−→fk,whiletheresultantmomentoftheseforceswithrespecttoapointO,arbitraryatthistime,is−−→MO=(cid:11)nk=1−−→OAk∧−→fk.IfAisanotherarbitrarypoint,weimmediatelyobtaintheequality−−→MA=−−→MO+−→AO∧−→f(1.10)whichshowsthattheﬁeld−−→M•deﬁnesatorsorwithcharacteristicvector−→f;thistorsor(cid:7)−→f(cid:8)iscalledtheforcetorsor(or,moreprecisely,thetorsorofexternalforces).Fundamentalprincipleofdynamics(Newton’slaw)ExpressioninaGalileanreferenceframeLetObeaﬁxedpointinaGalileanreferenceframe(alsoknownasinertialreferenceframe)R,andSbeamaterialsystem.ThefundamentalprincipleofPhysicalModels7dynamicsorNewton’slawiswrittenas(cid:7)−→f(cid:8)O=ddt{−→p}O.(1.11)Thisequalitybetweentorsorsshowsthatwehavethefollowingtworelations−→f=d−→pdt(1.12)−−→MO=d−→σOdt.(1.13)Itisreasonabletoemphasizethefactthat(1.11)isvalidinthereferenceframeR(orinanyotherGalileanreferenceframe).Inanon-Galileanframeofreference,itisnecessarytotakeintoaccountthetorsorofinertialforcesaswellasCoriolisforces[76]–notionsthatcanbederivedfrom(1.4).ExpressioninamovingframeofreferenceﬁrmlyﬁxedinthecenterofmassNevertheless,letusconsiderthecenterofmassGofthematerialsystemS;from(1.5)weget−−→dσGdt=−−→dσOdt+ddt(cid:9)−−→GO∧−→p(cid:10)=−−→MO−−→vG∧−→p+−−→GO∧d−→pdt=−−→MO+−→faccordingto(1.12).Therefore,−−→dσGdt=−−→MGwhichshowsthat(cid:7)−→f(cid:8)G=ddt{−→p}G.ExpressioninanarbitrarymovingframeofreferenceLetAbeanyarbitrarypoint.Wehave,accordingto(1.8),−→σO=−→σA+−→OA∧−→p,andthusd−→σOdt=d−→σAdt+−→vA∧−→p+−→OA∧d−→pdt.From(1.10)and(1.12)wealsohave−−→MA=−−→MO+−→AO∧d−→pdt.(1.14)8LinearSystemsFrom(1.13)weobtain−−→MA=d−→σAdt+−→vA∧−→pwhichisageneralizationof(1.13).Movingframeofreference:caseofarigidbodyLetAbeapointonrigidbodyS.Thekineticmoment−→σAisgivenbyexpression(1.7),therefored−→σAdt=m−→AG∧d−→vAdt+m−→vG∧−→vA+IAd−→ωdt+−→ω∧IA−→ω.Accordingto(1.14)weobtainthefollowing:−−→MA=IAd−→ωdt+−→AG∧md−→vAdt+−→ω∧IA−→ω.(1.15)Thisexpressioncanbesimpliﬁedinthefollowingcases:i)AisﬁxedandSrotatesaroundA,orA=G(thesecondtermontheright-handsidedropsout);ii)rotationisaroundoneoftheprincipalaxesofinertia(thethirdtermdropsout).CaseofarigidbodyrotatingaroundanaxisConsiderthecasewhereSisarigidbodyrotatingaroundoneoftheprincipalaxesofinertia,denotedby−→Ozforexample.Let−→CbetheresultanttorqueexertedonS(directedalong−→Oz)andwrite−→C=C−→k,where−→kistheunitvectorof−→Oz.TherotationvectorofSis−→ω=ω−→k.WehaveIO−→ω=J−→ω=Jω−→k,whereJistheprincipalmomentofinertiaofΣwithrespecttotheaxis−→Oz,i.e.J=(cid:1)Σ(cid:15)x2+y2(cid:16)dm.(1.16)Equation(1.15)reducestoJdωdt=C.(1.17)PrincipleofactionandreactionInthecaseofamaterialsystemSthatconsistsofNinteractingrigidbodiesSi,theglobalequation(1.11)isnotsufﬁcienttodeterminethemotionofeachoftherigidbodies.WethereforeareledtodecomposethesystemintoeachofitselementsSiandtotakeintoaccounttheforcesandmomentstheserigidbodiesexertononeanother.PhysicalModels9z2l+z1kzm1m2fFigure1.3.TrainAccordingtotheprincipleofactionandreaction,if(cid:7)−−→fi→j(cid:8)and(cid:7)−−→fj→i(cid:8)representthetorsoroftheforcesexertedonSjbySi,andonSibySj,respectively,wehave(cid:7)−−→fi→j(cid:8)+(cid:7)−−→fj→i(cid:8)=0.(1.18)ExampleofafrictionlesstrainConsideratraincomposedofalocomotiveandawagonsuchasdepictedinFigure1.3.Theequationsofthissystemareformulatedwiththehelpof(1.12)and(1.18).Thecouplingbetweenthelocomotiveofmassm1andthewagonofmassm2isrepresentedbyaspringwithconstantk(accordingtoHooke’slaw).Thepositionsofcenterofmassofthelocomotiveandthatofthecenterofmassofthewagonaredenotedbyz2andl+z1,wherelisthedistancebetweenthetwocentersofmasswhenthetrainisatrest.Themotionalforceputintoactionbythelocomotiveisdenotedbyf.Thefrictionalforcesareneglectedalongwiththemassofthespring.Theresultantforceexertedonthelocomotiveisthereforef−fr,wherefristheforceexertedbythespringonthelocomotive.Asaresult,wehavem1d2z1dt2=f−fr,andfr=k(z1−z2),withz1−z2beingthelengtheningofthespring.Thespringtransmitstheintegralforcefraccordingto(1.12).Thewagonisonlysubjecttothisforcefrandwethushavem2d2z2dt2=fr.Eliminatingthevariablefr,weobtaintheequations(cid:19)m1d2z1dt2+k(z1−z2)−f=0m2d2z2dt2+k(z2−z1)=0.(1.19)ExampleoftheinvertedpendulumConsidertheinvertedpenduluminFigure1.4.Itconsistsofacarriagewithwhicharodoflengthlterminatedbyamassmisarticulated.Thefrictionalforcesaswell10LinearSystemsy1yMmAfr-frz1fmgFigure1.4.Invertedpendulumasthemassoftherodareconsiderednegligible;inaddition,massmisconsideredpunctual.Theinvertedpendulumisacteduponbyahorizontalforcefthatisexertedontothecarriage.First,letusexaminetheforcesthatareexertedonthecarriage.Sincethecarriagemoveshorizontally,onlythehorizontalcomponentsoftheforceshavetobeconsidered.Thehorizontalresultantforceonthecarriageisf−fr,wherefristhehorizontalcomponentoftheforceexertedbytherigidbody(rod+massm)ontothecarriage.Accordingto(1.12)wethushaveMd2ydt2=f−fr.Now,letusexaminetherigidbody(rod+mass),whosecenterofmassGhascoordinates(y1,z1).Theonlyhorizontalforceexertedonthisrigidbodyisfr,hencemd2y1dt2=fr.Wehavethegeometricalrelations(cid:20)y1=y+lsinθz1=lcosθ.(1.20)Bywayoftheﬁrstoftheseequationsandbyeliminatingfr,weobtain(M+m)d2ydt2−mlsinθ(cid:21)dθdt(cid:22)2+mlcosθd2θdt2=f.Wecanwriteequation(1.15)atthepointA.Theterm−→ω∧IA−→ωiszero,sincetherotationiseffectedaroundoneoftheprincipalaxesofinertia.Therefore,(1.15)iswrittenasIAd−→ωdt=−−→MA−−→AG∧md−→vAdtandthesecondtermontheright-handsidecanbeinterpretedasthemomentwithrespecttoAoftheinertialforce−md−→vAdtPhysicalModels11appliedatG.Theothermomenttobeaccountedforisthatofthegravitationalforce.WethusobtainJd2θdt2=mglsinθ−mld2ydt2cosθ,whereJisthemomentofinertiaofmwithrespecttoA,i.e.ml2.Finally,weobtain(cid:19)(M+m)d2ydt2−mlsinθ(cid:15)dθdt(cid:16)2+mlcosθd2θdt2−f=0ld2θdt2−gsinθ+d2ydt2cosθ=0.(1.21)1.2.2.LagrangianformalismForcertaintypesofmechanicalsystems,itmaybemoreconvenienttousetheLagrangianformalisminsteadofthefundamentalprincipleofdynamics,fortheformulationoftheequations.Asmentionedabove,oneoftheadvantagesisthattheinternalforcesofthesystemdonothavetobeconsidered.HolonomicsystemAmechanicalsystemSissaidtobeholonomicifthepositionofitsdifferentpartscanbecharacterizedbynindependentvariablesq1,...,qn,calledthegeneralizedcoordinatesofthesystem.WethensaythatSisaholonomicsystemwithndegreesoffreedom.Forexample,thetrainaboveisaholonomicsystemwithgeneralizedcoordinatesq1=y1andq2=y2.Theinvertedpendulumisalsoaholonomicsystemwithgeneralizedcoordinatesq1=yandq2=θ.Thevectorspaceofdimensionninwhichthesecoordinatesaredeﬁnediscalledtheconﬁgurationspace.HolonomicrelationsThevariablesq1,...,qnareonlyindependentifallexistingrelationsbetweenthesubsystemshavebeentakenintoaccountandallredundantcoordinateshavebeeneliminated.*Forexample,supposethat,whenallrelationsareremoved,thesystemSonlydependsonNcoordinatesq1,...,qN.LetusalsoassumethattheonlyrelationsbywhichSisconstrainedareprelationsoftheformgk(q1,...,qN)=0,k=1,...,p(1.22)wheregkarescalarfunctions.Relationsoftheform(1.22),involvingonlythepositionsqi,arecalledtheholonomicrelations.Theserelationsareofapuregeometricalnature.Letn=N−pandsupposethattheJacobian∂(g1,...,gp)∂(qn+1,...,qN)isnon-zero.Then,accordingtotheImplicitMappingTheorem,wecanexpress(locally)qn+1,...,qNasafunctionofq1,...,qnwhichareindependentvariables.Inthiscase,Sisaholonomicsystemandq1,...,qnareitsgeneralizedcoordinates.*12LinearSystemsNon-holonomicrelationsThesituationbecomesmorecomplicatedinthecasewheretherelationsinvolvethevelocities.q1,...,.qN,accordingtohj(cid:15)q1,...,qN,.q1,...,.qN(cid:16)=0.Theserelations,ofkinematic(notgeometric)nature,arecallednon-holonomic.Then,thesystemSitselfisalsocallednon-holonomic.Thissituationwillnotbeconsideredinthesequel.Kineticandpotentialenergies;externalforcesandtorquesLetSbeaholonomicsystemwithndegreesoffreedom.Itskineticenergyisthesumofthekineticenergiesofitssubsystems;itdependsonthetimederivativesofthegeneralizedcoordinatesandveryoftendependsonthesecoordinatesthemselves.ForeachpartoftherigidbodyS,itisgivenby(1.9).ThekineticenergyofSisdenotedbyT(cid:15)q1,...,qn,.q1,...,.qn(cid:16).Inthesamemanner,thepotentialenergyofSisthesumofthepotentialenergiesofitssubsystems.Thisenergyonlydependsonthegeneralizedcoordinates;itisdenotedbyU(q1,...,qn).Moreover,Scanalsobesubjectedtoexternalforcesandtorques,i.e.whicharenotderivedfromthepotentialU(whetherwehavechosennottotakethemintoaccountinU,orwhethertheycannotbederivedfromanypotential).So,theforcefhastobetreatedasanexternalforceintheexampleofthetrainandthatoftheinvertedpendulum.GeneralizedforcesConsidertheexternalforcesandtorquesexertingonaholonomicsystemS.Whileoneofthegeneralizedcoordinatesqivarieswithaninﬁnitesimalquantityδqi,andwhiletheothergeneralizedcoordinatesremainconstant,aninﬁnitesimalworkδWi=Qiδqiisdoneasaresultoftheseexternalforcesandtorques.ThenQiissaidtobethe(external)generalizedforceintheithdirectionoftheconﬁgurationspace–or,inshort,thegeneralizedexternalforcealongqi.Intheexampleofthetrain,fisthegeneralizedexternalforcealongy1,whereasintheexampleoftheinvertedpendulum,fisthegeneralizedexternalforcealongy.LagrangianequationsTheLagrangianofthesystemisL=T−U(1.23)andtheLagrangianequationsareddt(cid:9)∂L∂˙qi(cid:10)−∂L∂qi=Qi,i=1,...,n(1.24)where˙qi(cid:1)dqidt.PhysicalModels13ExampleofthetrainWehaveT=12(cid:15)m1˙y21+m2˙y22(cid:16).Thepotentialenergyisthatofwhatisstoredinsidethespring,andisgivenbyU=12k(y1−y2)2.Wecanderive(1.19)from(1.24).ExampleoftheinvertedpendulumThekineticenergyofthecarriageisT1=12M˙y2;andthatoftheassembly(rod+mass)isT2=12m(cid:15)˙y21+˙z21(cid:16).Bywayoftheholonomicrelations(1.20),weobtainT=T1+T2=12(cid:23)M˙y2+m(cid:9)˙y2+2l˙y˙θcosθ+l2˙θ2(cid:10)(cid:24).Thepotentialenergyisthatoftheweight,whichisgivenbyU=mglcosθ.Applying(1.24),weimmediatelyobtain(1.21).1.3.ElectromechanicalsystemAlotofsystemsconsistofanelectricalandamechanicalpart.Thisisthecase,forexample,ofanalternatorconnectedtoanelectricnetwork[70].Thisisalsothecaseofasynchronousmotor[112]orthatofanasynchronousmotor[24].Themodelingofthesesystemsrequirestoomuchcircuittheoryandtechniquestobecoveredinthiswork.WewillcontentourselveswithconsideringonlythecaseofaDCmotor[112],eventhoughthereseemstobeatrendwheretheDCmotorisbeingreplacedbythemotorswejustmentioned.Thewindingsoftherotorareconnectedtothearmaturebyringsandbrush.Thestatorgeneratesaﬁxedﬁeld(eitherusingpermanentmagnetsorusingwindingsinwhichaDCcurrentisﬂowing)whereintheturnsoftherotorarerotatedwithangularspeedω.WithavoltageVappliedtothearmature,acurrentipassesthroughtheseturns.ThechargeischaracterizedbyitsmomentofinertiaJ(seeFigure1.5).Armature VRLeiJConstant fieldFigure1.5.DCmotor14LinearSystemsAccordingtothemeshrule,V=Ri+Ldidt+ewhereeisthebackelectromotiveforce.AccordingtoFaraday’slaw,e=dϕdt,whereϕisthemagneticﬂuxinthewindingsoftherotor.Thisﬂuxisconstantwithrespecttothestator,andvariesinproportiontoωandwithrespecttotherotor.Wecanthenlete=Kω;thecoefﬁcientK(cid:5)=0iscalledthemotorconstant.ThepowerexchangedbetweenthestatorandtherotorisP=ei(inelectricalterms)orP=Cmω(inmechanicalterms).Therefore,Cmω=Kωi,fromwhichwededucethatCm=Ki.Finallyweget,accordingto(1.17),Jdωdt=Cm−CrwhereCristheresistivetorque,duetofriction.ThisresistivetorqueisoftheformCr=λω,whereλisthefrictionalcoefﬁcient.Inaddition,theangularpositionθoftherotorsatisﬁestheequationdθdt=ω.Wecannowregrouptheequationsinthefollowingform:⎧⎨⎩Ri+Ldidt+Kω−V=0Jdωdt+λω−Ki=0dθdt−ω=0.(1.25)1.4.ThermalhydraulicsystemThermalorhydraulicsystemsarelargelyformulatedusingrelationsofbalance:conservationofmass,conservationofenergy.“Mattercanneitherbecreatednordestroyed,onlytransformed”.ThisformulaofLavoisierisundoubtedlythemostuniversalprincipleofscience.Consider,forexample,theheatedtankinFigure1.6.ThistankconsistsofareservoirwithsectionS.ItcontainswaterwhichisheatedbyaresistanceR.Qeistherateofdischargeofwater(ataconstanttemperatureTe)enteringthereservoir.Thetankisemptyingthroughanopeningofcross-sectionσlocatedatthebottomofthereservoir;rateofwaterdischargingfromthetankisdenotedbyQs.ThetemperatureofthewaterinsidethetankisassumedtobeuniformanddenotedbyTs.TheheatingpowerisP.1.4.1.BalanceinvolumeForaninﬁnitesimalintervaloftimedt,letdVbetheincreaseinvolumeofwaterinsidethereservoir.WehavedV=Sdh,wheredhistheincreaseinheightPhysicalModels15RTeQehPTsQsSFigure1.6.Heatedtankofwater.ThevolumeofwaterenteringthereservoirduringthistimeintervalisQedt.AndthevolumeexitingisQsdt.Wehavetherefore(undertheassumptionofincompressibility)Sdhdt=Qe−Qs.1.4.2.Exitrate:Torricelli’sformulaThisformulagivesvelocityvsofwaterexitingthereservoirunderheightofwaterh:vs=√2ghwheregisthegravitationalacceleration.SinceQs=σvs,weobtainQs=σ√2gh.1.4.3.EnergybalanceLetdWbetheamountofelectricenergyfurnishedduringtheinﬁnitesimaltimeintervaldt.LetalsodWebethecaloriﬁcenergy(i.e.heatenergy)furnishedbytheliquidenteringthetank,anddWibetheincreaseincaloriﬁcenergyintheinteriorofthetankthatproducesvariationofthetemperatureTs.Accordingtotheﬁrstprincipleofthermodynamics,orprincipleofconservationofenergy:dW+dWe=dWi.Ontheotherhand,dW=Pdt.Denotingbyµthemassofthevolumeofliquidandbycthespeciﬁcheat,wehavedWe=Qeµc(Te−Ts)dtanddWi=ShµcdTs.16LinearSystemsVCLR1R2iFigure1.7.ElectriccircuitRe-arrangingtheequations,weobtain(cid:20)Sdhdt+σ√2gh−Qe=0ShdTsdt+Qe(Ts−Te)−Pµc=0.(1.26)1.5.ExercisesEXERCISE1.–ConsidertheelectriccircuitinFigure1.7.DeterminethedifferentialequationrelatingcurrentitovoltageV.EXERCISE2.–ConsiderthedoubleinvertedpendulumasshowninFigure1.8.Determinetheequationsofitsmotion.EXERCISE3.–[72]ConsiderthemixergiveninFigure1.9.Thismixerconsistsofareservoirthatreceivestwoliquidsofconstantconcentrationsc1andc2andwhosedischargeratesQ1andQ2areregulatedbymeansofvalves.Theliquidisstirredwithinthereservoir,forconcentrationcstoremainuniform.Themixtureexitsthroughanopeningofcross-sectionσlocatedatthebottomofthetank.Determinetheequationsofthissystem.yMmf12ml1l2Figure1.8.DoubleinvertedpendulumPhysicalModels17c1Q1hcsQsSc2Q2Figure1.9.MixerEXERCISE4.–Weconsideranothermixer,butthistimethehotwaterattemperatureT1entersthetankwithrateQ1,andthecoldwaterwithtemperatureT2enterswithrateQ2.(Itisabathtub.)ThetemperaturesT1andT2areﬁxed.Waterﬂowstothebottomofthetubwherewehaveomittedtoplugtheopeninghavingcross-sectionσ;temperatureofwaterinsidethetubisTs.Determinethesystemequations.WhataretheconnectionsbetweenthisexerciseandExercise3?Chapter2SystemsTheory(I)Theobjectiveofthischapteristospecifythenotionofsystemandtointroduceafewbasicconcepts.Chapter7providesthecomplementarymaterialthatisnecessaryforagoodunderstandingofthenotionsandmethodspresentedinChapters3to6.Inthispresentwork,wearemainlyinterestedin“lineartime-invariant”systems(seesection2.2.5).Theothertypesofsystemswillonlybebrieﬂymentioned.2.1.IntroductoryexampleConsidertheRLCcircuitinFigure1.1(section1.1.1).Itisgovernedbyequation(1.1).Tosimplifythecalculations,letusassumeR=0.Equation(1.1)canbewrittenasd2idt2+ω20i−kdVdt=0(2.1)withω20=1LC,k=1L.Representationbyasecond-orderscalardifferentialequationThesystemvariablesthatareusedinrepresentation(2.1)arew1=iandw2=V.Equation(2.1)takestheform(cid:25)∂2+ω20−k∂(cid:26)(cid:27)w1w2(cid:28)=0(2.2)where∂isthedifferentialoperatorddt.19Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.20LinearSystemsThisrepresentationisasecond-orderscalardifferentialequation,withtwovariablesw1andw2.Thesevariablesarephysicalquantities,andaswewillseeinthesequel,theyareofparticularinteresttous.Representationbyasystemofﬁrst-orderdifferentialequationsTheaboverepresentationisnottheonlypossibleone.Indeed(2.2)canbewrittenas∂(∂w1−kw2)+ω20w1=0.Introducingthevariablew3=∂w1−kw2,weobtaintherepresentation(cid:27)∂−k−1ω200∂(cid:28)⎡⎣w1w2w3⎤⎦=0.(2.3)Thisrepresentationisasystemofﬁrst-orderdifferentialequations(composedoftwoscalardifferentialequations).Itisequivalentto(2.2).Thistime,threevariablesareinvolved:w1,w2andw3.Variablew3hasnophysicalmeaning:itissimplyanintermediatevariable.Thisiswhatiscalledalatentvariable[96].Therefore,systemvariablesandequationsarenotunique.2.2.GeneralrepresentationandpropertiesThesystemsstudiedinChapter1havebeenmodeledusingvariablesandequations.Thesearedifferential(oralgebraic-differential)equationsinvolvingtime.Fromamathematicalpointofview,timeisarealvariablewhichwecallcontinuoustime.Later(inChapter10),wewillstudycomputer-controlledsystems.Acomputeronly“knows”“discretetime”,analogoustothesetofintegers.Forthemoment,weareonlyconcernedwiththecontextofcontinuoustime.2.2.1.VariablesInageneralfashion,wemakeuseofvariablesw1,...,wk.CaseoftheRLCcircuitinFigure1.1(section1.1.1):w1=i,w2=V.CaseofthetraininFigure1.3(section1.2.1):w1=y1,w2=y2,w3=f.CaseoftheinvertedpenduluminFigure1.4(section1.2.1):w1=y,w2=θ,w3=f.CaseoftheheatedtankinFigure1.6(section1.4):w1=h,w2=Ts,w3=P.Etc.Wewritew=[w1,...,wk]T.SystemsTheory(I)212.2.2.EquationsThealgebraicanddifferentialequationsrelatingthevariablescanbegatheredintheformF(w,˙w,...w(α))=0.(2.4)TheabovefunctionFisveryoftenavector-valuedfunction,havingqcomponentswhenqisthenumberofscalarequations.Equation(2.4)isthegeneralrepresentationofanonlinearsystem(inthesenseof:possiblynonlinear).(Here,weexclude“inﬁnite-dimensionalsystems”,althoughsuchsystemscanbeencounteredinpractice:forexampletime-delaysystems.)Wedenotethesystemdeﬁnedby(2.4)asΣ.2.2.3.Time-invariantsystemsThefunctionFinvolvesanumberofcoefﬁcients(incaseoftheRLCcircuit,thesecoefﬁcientsareR,LandC;incaseoftheinvertedpendulum,thesecoefﬁcientsareM,m,l,g,etc.).Ifallthesecoefﬁcientsareconstant(i.e.realnumbers),Σissaidtobetime-invariant,anditissaidtobetime-varyingintheoppositecase,thatiswhenthecoefﬁcientsdependontime(*e.g.whentheyareelementsofadifferentialﬁeld*).2.2.4.LinearsystemsIfthefunctionFislinear,Σissaidtobelinear.Equation(2.4)canthenbewrittenintheformα(cid:12)i=0Eiw(i)=0(2.5)wherethematricesEiareofsizeq×k(q=numberofequationsandk=numberofvariables).REMARK5.–Quiteoftenasystemissaidtobelinearwhenitsatisﬁestheprincipleofsuperposition.Letusclarifythis.(i)SupposeΣistime-invariantand,toclarifyideas,thatthefunctionFof(2.4)isrationalwithrealcoefﬁcients.Then,Σislinearifandonlyif,foranyvariableswAandwBsolutionsof(2.4)andforanyscalarsλA,λB∈R,λAwA+λBwBisagainasolutionof(2.4).ThissigniﬁesthatthesetofsolutionsisanR-vectorspace.(ii)*Considernowthecaseofatime-varyingsystem,fbeingarationalfunctionwithcoefﬁcientsinadifferentialﬁeldK.Then,Σislinearifandonlyifthesetofsolutionsof(2.4)isak-vectorspacewherekisthesubﬁeldofconstantsofK(seesection13.1.1).ThissetisnotaK-vectorspace[22].*22LinearSystems2.2.5.Lineartime-invariantsystemsLetE(∂)bethepolynomialmatrix(seesection13.1.4,Example490)deﬁnedbyE(∂)=α(cid:12)i=0Ei∂i.IfΣisassumedtobelinearandtime-invariant,theentriesofE(∂)arefromtheringR=R[∂]ofpolynomialsin∂withrealcoefﬁcients;E(∂)isofsizeq×k.Equation(2.5)canbeputintheequivalentformE(∂)w=0.(2.6)Theqequationsof(2.6)aresaidtobelinearlyindependentiftherankoverRofE(∂)(denotedbyr=rkRE(∂):seesection13.1.4)isequaltoq.Thisisofcourseonlypossibleifk,thenumberofvariables,issuchthatk≥r.Itfollowsthatthetwoelectriccircuitsofsection1.1aswellasthetrainandtheDCmotorofsections1.2and1.3arealllinearsystems.Inreality,however,asystemisneverlinearintherigoroussense.Takeanextremelysimpleexample:accordingtoOhm’slaw,thepotentialdifferenceVacrossaresistanceRisrelatedtothecurrentitraversingitbythelinearrelationV=Ri.ButwhenthevoltageV,andthusthecurrentintensityi,takesontooimportantvalues(evenwithoutgettingtothepointofburningofftheresistance!),therelationbetweenVandibecomesnonlinearandneedstobewrittenintheformV=ρ(i).Thisfunctionρisthenonlinearcharacteristicoftheresistance.Butunderthecircumstancesof“normal”functioning,wecanwritewithgoodprecisionthatf(i)=Ri.Therefore,linearsystemsareonlypurelytheoreticalviewsandresultsofsimpliﬁcations.Butthematerialworldisimmenselycomplex;wecanonlyclaimtounderstandandmasterit,atleastpartially,ifwemakeadequatesimpliﬁcations.Thisconstitutes,parexcellence,theknow-howofengineersandscientists.Itistruethatlinearsystemsdonotexistintheabsolute,butasnotions,theyplayaveryimportantroleincontroltheoryaswellasinothersciences.DEFINITION6.–Foralineartime-invariantsystemΣ,wecallthem=k−rtherankofthesystemwherer=rkRE(∂).DEFINITION7.–Alineartime-invariantsystemΣissaidtobedeterminedifitsrankiszero.Itissaidtobeunderdeterminedifitsrankispositive.REMARK8.–*(i)Equation(2.6)isthatofthemoduleM=[w]R(seesection13.4.1,Theorem540)sothatwecanassociatetheﬁnitelypresentedR-moduleMwiththelinearsystemΣ.Fromamoreabstractpointofview,wecanidentifyΣandMinsuchSystemsTheory(I)23awaythatalinearsystemisdeﬁned(fromamathematicalpointofview)asbeingaﬁnitelypresentedR-module([42],[22]).(ii)TherankofΣ,accordingtoDeﬁnition6,coincideswiththerankofthemoduleM,accordingtoDeﬁnition552ofsection13.4.2.*AmongtheexamplesofChapter1,therearenonlinearsystemsandtheyaremodeledassuch:theinvertedpendulumandtheheatedtankofsections1.2and1.4.Bylinearizingasystemaroundanequilibriumpoint,wecomebacktothelinearcase.Thislinearizationisaﬁrst-orderTaylorexpansion.Therepresentationobtainedisofcourseonlyvalidfortinyvariationsaroundthechosenequilibriumpoint.Wearenowgoingtospecifythesenotions.2.2.6.EquilibriumpointConsiderthetime-invariantsystemΣdeﬁnedby(2.4).DEFINITION9.–Thepointw∗=[w∗1,...,w∗k]TisanequilibriumpointofΣifF(w∗,0,...,0)=0.Inotherwords,welocatetheequilibriumpoint(s)ofasystembyzeroingthederivativesofallordersofallvariables.CaseoftheinvertedpendulumByzeroingthederivativesin(1.21)(section1.2.1),weobtain(cid:20)f∗=0sinθ∗=0.Thissystemhasinﬁniteequilibriumpoints:y∗isarbitrary,θ∗=0orπ(mod2π),f∗=0.Thephysicalinterpretationisclear:thependulumcanbeatequilibriuminanyregionoftheyaxis.Forittobeatequilibrium,theforceappliedontothecarriagemustbezero(otherwise,amovementofaccelerationwillbegiventothelatter).Finally,thereareonlytwopossiblepositionsofequilibriumforthependulumitself:therodbeingvertical,withthemassontop,oratbottom;wewillseelaterthatintheﬁrstsituation,theequilibriumpointisunstable(whichisthecaseofthependulumsaidtobeinverted)andthatitisstableinthesecondcase.CaseoftheheatedtankProceedingsimilarlywith(1.26)(section1.4.3),weobtain(cid:20)σ√2gh∗−Q∗e=0Q∗e(T∗s−Te)−1µcP∗=0.Theﬁrstoftheseequationsexpressestheequilibriuminvolume:therateofﬂowintothetankisequaltotherateofﬂowoutofit.Thesecondequationexpressestheequilibriuminenergy.24LinearSystems2.2.7.LinearizationaroundanequilibriumpointConsiderthesystemΣdeﬁnedbyequation(2.4);assumethatitistime-invariantandadmitsanequilibriumpointw∗.Thissystemislinearizableatthepointw∗ifFisdifferentiableinaneighborhoodof(w∗,0,...0).Letw=w∗+∆w,where∆wisa“smallincrement”inthesensethat∆wanditsderivativesuptoorderαare“smallincrements”.1Wehave,neglectingsecond-orderterms,F(w,.w,...w(α))(cid:9)F(w∗,0,...,0)+α(cid:12)i=0∂F∂w(i)(w∗,0,...,0)∆w(i)=α(cid:12)i=0∂F∂w(i)(w∗,0,...,0)∆w(i)andthereforeα(cid:12)i=0∂F∂w(i)(w∗,0,...,0)∆w(i)(cid:9)0.DEFINITION10.–ThelinearapproximationofthesystemΣaroundtheequilibriumpointw∗isthelinearsystemΣlwithequation(cid:11)αi=0∂F∂w(i)(w∗,0,...0)∆w(i)=0.TheequationofΣlisoftheform(2.5)withEi=∂F∂w(i)(w∗,0,...,0),thevariablewbeingreplacedbytheincrement∆w=w−w∗.Caseoftheinvertedpendulum(section1.2.1)Linearizing(1.21)inthevicinityof(y∗=0,θ∗=0,f∗=0),weobtaintheequationsofthelinearizedinvertedpendulum:(cid:19)(M+m)d2ydt2+mld2θdt2−f=0ld2θdt2−gθ+d2ydt2=0.(2.7)Caseoftheheatedtank(section1.4.3)Thelinearizationof(1.26)leadsto(cid:20)Sd∆hdt+σ√2gh∗∆h−∆Qe=0Sh∗d∆Tsdt+Q∗e∆Ts+(T∗s−Te)∆Qe−1µc∆P=0.1.*Fromthepointofviewoffunctionalanalysis,wecan,forexample,endowthecodomainofthefunctionwwiththenorm(cid:1)w(cid:1)=(cid:11)αi=0(cid:29)(cid:29)(cid:29)w(i)(cid:29)(cid:29)(cid:29)∞where(cid:1).(cid:1)∞denotesthenorminthespaceL∞.*SystemsTheory(I)25Setτ=Sσ(cid:30)2h∗gandV∗=Sh∗.Usingtheequilibriumrelations,weobtain(cid:19)d∆hdt+1τ∆h−1S∆Qe=0d∆Tsdt+2τ∆Ts−(T∗s−Te)(cid:9)−∆QeV∗+2τ∆PP∗(cid:10)=0.Tosimplifyandimproveconditionequations,itisnowinourinteresttonormalizevariables,or,tobemoreprecise,to“reduce”them.Setw1=∆hh∗,w2=∆TsT∗s−Te,w3=τ∆QeV∗,andw4=∆PP∗(oncondition,ofcourse,thatnoneofthedenominatorsofthesefractionsiszero);thesevariableswi=i=1,...,4,whichareunitless,arecalledthereducedvariables.Wethenobtainthereducedequations:(cid:20)dw1dt+1τw1−1τw3=0dw2dt+2τw2−1τ(−w3+2w4)=0.(2.8)Itequallymakessensetochoosetheunitoftimeproperlyinsuchawaythatτtakesanumericalvaluecloseto1.2.3.Controlsystems2.3.1.InputsGeneralpropertiesofinputvariablesAsalreadymentionedintheprefaceofthisbook,thesystemsweareinterestedinarethesystemsausercanactupon.Thissigniﬁesthatbymeansofactuators,wecanimposetheevolutionofcertainvariables,whichwecallthecontrolvariables.TheenvironmentcanalsoactupontheconsideredsystemΣ(theenvironmentisitselfasystem).Thisimposesupontheevolutionofothervariables:whicharethedisturbances(asopposedtothecontrols,thedisturbancesarevariablesoverwhichtheuserhasnomastery).ThecontrolvariablesandthedisturbancesconstitutetheinputvariablesofΣ.Letu1,...,umbethosevariables;weputu=[u1,...,um]T,andwesuccinctlycallittheinputofΣ.Wewillmakethefollowingthreehypotheses:i)Oncetheinputisﬁxed,theevolutionoftheremainingvariablesξ1,...,ξk−mofΣdependsonlyontheirinitialconditions.ii)Theinputuisan“independent”variable,inthesensethattheredoesnotexistanon-zerofunction2fandanorderofdifferentiationβsuchthatf(cid:15)u,˙u,...,u(β)(cid:16)=0.2.Toberigorous,itisofcoursenecessarytomakesomehypothesesabouttheregularityoffunctionf.*Intheframeworkofdifferentialalgebra,forexample[47],itis(andsoarealsothecomponentsoffunctionFofequation(2.4))arationalfunctionofseveralvariables,withcoefﬁcientsinRorinadifferentialﬁeld.*26LinearSystemsItisimportanttounderstandthishypothesiswell.Consider,forexample,asystemΣwhoseonlyinputisadisturbanceu.ForthemodelingofΣ,weassumethatuisindependent.Now,thisdisturbancecanbeaconstant,andthen˙u=0.ThislastequationisamodeloftheenvironmentofΣ,andisthereforenotpartoftheequationsofthissystem.Let˘ΣbethesystemthatconsistsofΣanditsenvironment,whoseequationsarethoseofΣtogetherwiththeequation˙u=0.Thevariableu(whichis“dependent”)isnotaninputof˘Σ.iii)WhentheinitialconditionsofsystemΣareﬁxed,theevolutionofitsvariablesdependsonlyontheinputu.Lineartime-invariantcaseTheabovecanonlyfurtherbespeciﬁed(exceptifnotionsoutsideofthescopeofthistextarecalledupon)inthelineartime-invariantcase.Considersystem(2.6),wherethematrixE(∂)isofsizer×kandofrankr.ItfollowsthatthereexistsasubmatrixD(∂)ofE(∂),ofsizer×randnon-singular,i.e.thedeterminantofD(∂)isnon-zeroandisanelementofR=R[∂](seesection13.1.4).ItisclearthatD(∂)iscomposedofcolumnsofE(∂).Afterrenumberingthesecolumnsifnecessary,wecanassumethatthesearetheﬁrstrcolumns,correspondingtotheﬁrstrvariablesξ1=w1,...,ξr=wr.Letwr+1=u1,...,wk=um.Inaddition,letE(∂)=(cid:25)D(∂)−N(∂)(cid:26).(2.9)Then,settingξ=[ξ1...ξr]Tandu=[u1...um]T,(2.6)iswrittenasD(∂)ξ=N(∂)u.(2.10)Let¯ξbethevariableξwhenu=0.WethushaveD(∂)¯ξ=0.(2.11)Thesystemdeﬁnedby(2.11)isdetermined(seeDeﬁnition7,section2.2.5).Asshowninsection2.3.8,theevolutionof¯ξisdeterminedbytheinitialconditions,thereforehypothesisi)issatisﬁed.Ontheotherhand,equation(2.10)doesnotinvolveanyrelationbetweenthecomponentsofuanditssuccessivederivatives;thisvariableuistherefore“independent”.Asaresult,hypothesisii)issatisﬁed.Finally,wewillseefromsection2.5.1thathypothesisiii)isalsosatisﬁed.SystemsTheory(I)27Thevariableu,constructedasmentionedabove,canthereforebetheinputofthesystem.Thisisnottheonlypossibility,sincethereareseveralwaystoextractfromE(∂)asquaresubmatrixD(∂)ofrankr.Butwhatevermethodwetake,wewillalwaysﬁndanindependentvariableuhavingmcomponents.Wethereforearriveatthefollowingresult:THEOREM11.–(i)Theinputofasystemhasanumberofcomponentsequaltoitsrank.(ii)Itisalwayspossibletoselectaﬁnitesequence(u1,...,um)fromthesystemvariablesthatsatisﬁeshypothesesi),ii),iii)givenabove(insuchawaythatu=[u1,...,um]Tcanbethesysteminput).REMARK12.–*ConsiderthemoduleM=[w]Rdeﬁnedby(2.6)(seeRemark8,section2.2.5).Themodule[u]RisasubmoduleofM(sincetheinputvariablesbelongtoM).(i)Theindependenceoftheinputmeansthat[u]RisafreeR-moduleofrankm.(ii)WehaveM=[ξ]R+[u]Randaccordingto(2.10),equation(2.11)isthatofthequotientmoduleM/[u]R(where¯ξisthecolumnmatrix(cid:15)¯ξi(cid:16)1≤i≤rsuchthat¯ξiisthecanonicalimageofξiinM/[u]R).Thefactthatthesystem(2.11)isdeterminedmeansthatthemoduleM/[u]Ristorsion(seesection13.4.2,Corollary555(ii)).*ExampleLettherebeasystemofequations(cid:20)˙w1=w2−w3w2+w3=0.Inviewoftheﬁrstequation,wemayperhapstrytochooseinputvariables:u1=w2andu2=w3.Butthisisnotpossiblefromthesecondequationwhereweneedu1+u2=0.Theorem11conﬁrmsthisimpossibility.WehaveE(∂)=(cid:27)∂−11011(cid:28).Thismatrixisofrankr=2overR[∂];thenumberofvariablesisk=3;thustherankofthesystemism=k−r=1.Thereisthereforeonlyoneindependentinput.2.3.2.OutputsTheuserwishestokeepwatchovertheevolutionofthesystem,andthereforeofacertainnumberofitsvariables(oroffunctionsofsuchvariablesaswellastheirderivatives,theirsecond-orderderivatives,etc.).Thesequantitiesaremeasuredbymeansofsensorsand,fromthenon,constitutethemeasurementsofthesystem.Inmanycases,theuserwouldliketomorepreciselyregulatecertainvariablestosomereferencevalues,ﬁxedbytheformer.Forthattobepossible,thesevariables28LinearSystemsOutputs Inputs Latent variables Figure2.1.Controlsystemneedtobemeasured(unlesssomecomplexproceduresofestimationaredeveloped).Thecontrolledvariablesareingeneralpartofthemeasurements.Theoutputvariablesconsistofthosemeasuredvariablesandpossiblyothermanifestationsofthesystem,its(non-measured)actionsonothersystemsforexample.2.3.3.LatentvariablesThesystemvariablesoftendonotreducetoinputandoutputvariables.Thesupplementaryvariablesarecalledthelatentvariables[117].Thesevariablesarenot“intrinsic”,aswewillshowbelowusingtheexampleoftheDCmotor.Bydistinguishingitsinputandoutputvariablesfromalltheothervariables,weendowasystemwithasupplementarystructure.Thisiswhatisexpressedbythefollowingdeﬁnition:DEFINITION13.–Acontrolsystem3isatriple(Σ,u,y),whereΣisasystem,u=[u1,...,um]Tistheinput,andy=[y1,...,yp]Tistheoutput.AcontrolsystemcanberepresentedasinFigure2.1.ExamplesCaseofRLCcircuitInthecaseoftheRLCcircuitgiveninFigure1.1(section1.1.1),wecanimpressavoltageVbymeansofapotentiometer.Afterthis,equation(1.1)canbewrittenasLCd2idt2+RCdidt+i=CdVdt.(2.12)3.Inwhatfollows,wewillcalla“controlsystem”simplya“system”wherethereisnoambiguity.Thiswillallowustoreturntotheterminologycommonlyusedintheliterature.SystemsTheory(I)29Theright-handmemberofthisequationbeingﬁxed,thecurrentiisgovernedbyasecond-orderlineardifferentialequationanditsevolutiononlydependsoni(0)anddidt(0)(t=0takenastheinitialinstant);inotherwords,theinitialconditionofthesystematinitialinstant0is(cid:31)i(0),didt(0) .Wecanmonitortheevolutionofiusinganammeter.Letu=Vandy=i:uisthecontrolandyisthemeasurementofthecontrolsystemasdeﬁned.Wecanalsodothereverse,ﬁxingthevalueofiusingacurrentgenerator;andhencenowthevoltageVdependsonlyonV(0).Weobtainanothercontrolsystem,withinputiandoutputV.Wewillseelaterthatthisapproachcreatessomeinconvenience,eventhoughitistheoreticallypossible.Inbothcases,therearenolatentvariables.CaseofthetrainVerynaturally,thecontrolvariableofthetrain(section1.2.1)istheforcef.Theconductorofthetrain,usingthisvariable,candecidehowtopositionthewagon,hencecontrollingz2.Ifallhemonitorsisz2,thisvariableisthemeasurementandz1isthelatentvariable.Ifitusestheinformationofthepositionofthewagonaswellasthatofthelocomotive(whichmakesthetaskeasier),themeasurementbecomesy=[z1,z2]Tandtherewillnolongerbeanylatentvariable.Letusverifythatthecontrolcanbechosenastheforcef:puttingξ1=z1,ξ2=z2,andu=f,equations(1.19)canbewrittenintheform(2.10)withD(∂)=(cid:27)m1∂2+k−k−km2∂2+k(cid:28),N(∂)=(cid:27)10(cid:28).Therefore,detD(∂)=m1m2∂2(cid:21)∂2+km1+m2m1m2(cid:22)(cid:5)=0(2.13)andtherankconditionissatisﬁed.RecallthatwritingdetD(∂)(cid:5)=0meansthatdetD(∂)isnotthezeropolynomial.Later,wewillhavetoconsidervaluesofthecomplexvariablesforwhichdetD(s)iszero:thatisacompletelydifferentquestion:wethencalculatetherootsofdetD(s),andthatonlymakessenseifdetD(s)isnotthezeropolynomial.CaseoftheDCmotorThissystem(seesection1.3)hasr=3linearlyindependentequationsandk=4variables(includingamongthemthevelocityω),hencethenumberofinputsis30LinearSystemsm=k−r=1.LetusshowthatwecanchoosethevoltageVtobethecontrolvariable.Equations(1.25)canbewrittenintheform⎡⎣R+L∂K0−KJ∂+λ00−1∂⎤⎦⎡⎣iωθ⎤⎦=⎡⎣100⎤⎦V.(2.14)ThedeterminantofthematrixD(∂)ontheleftofthisequationis:detD(∂)=∂(cid:25)(J∂+λ)(R+L∂)+K2(cid:26)(cid:5)=0.ItisthereforequitepossibletochoosevoltageVtobethecontrolvariable.Thereexisttwomodesofcontrol:“positioncontrol”,wherethecontrolledvariableisθ,and“velocitycontrol”,wherethecontrolledvariableisω.Intheﬁrstcase,apositionsensorisalwaysavailabletous,rarelyavelocitysensorandingeneralthecurrentiisnotmeasured.Wecanthereforeconsidery=θastheoutput,iandωarethenlatentvariables.Butnotethatwecanrewrite(1.25)byreplacingintheﬁrsttwoequationsωbydθdt,andbysuppressingthelastequation.Inthiscase,thereareonlyr=2linearlyindependentequationsandk=3variables.Therankm=k−rremainsunchanged:itisanintrinsicquantity,thatisitisindependentoftherepresentationchosen(*seeRemark8(ii),section2.2.5*).However,thelatentvariablesdependontherepresentationchosen,asseeninthisexample.CaseoftheheatedtankEquations(2.8)(section2.2.5)canbewrittenintheform(cid:27)∂+1τ0−1τ00∂+2τ1τ−2τ(cid:28)⎡⎢⎢⎣w1w2w3w4⎤⎥⎥⎦=0.Wecantakey1=w1andy2=w2asoutputvariables,andu1=w3andu2=wasinputvariables.Physically,thisislogicalaswell:thetwomeansofactionareactuallytheinputdischargeandtheheating,i.e.w3andw4upto“reductionfactors”;andthetwovariablestoberegulatedaretheheightofthewaterinsidethetankandthetemperatureofwaterofthesame,i.e.w1andw2afterreduction.Theaboveequationscanthenbewrittenas(cid:27)∂+1τ00∂+2τ(cid:28)y=(cid:27)1τ0−1τ2τ(cid:28)u.(2.15)2.3.4.ClassiﬁcationofsystemsWerefertothesystemshavingoneinputandoneoutputvariableasSingle-InputSingle-Output(SISO)systems,andthosewithmorethanoneinput-andSystemsTheory(I)31output-variableasMulti-InputMulti-Output(MIMO)systems.Thereareofcoursesystemsthatareintermediateinnature(SIMOandMISOsystems,buttheseexpressionsarelessoftenusedintheliterature).2.3.5.RosenbrockrepresentationGeneralformulationTheoutputvariablesy1,...,yp,asalreadyseen,arelinearcombinationsofthevariablesw1,...,wk,oftheirderivatives,oftheirsecond-orderderivatives,etc.Thusycanbewrittenintheformy=H(∂)wwhereH(∂)isapolynomialmatrixofsizep×k.BydecomposingH(∂)inthesamewayasin(2.9)(section2.3.1),whichisH(∂)=(cid:25)Q(∂)W(∂)(cid:26),whereQ(∂)andW(∂)arepolynomialmatricesofsizep×randp×m,respectively,weﬁnallyobtain(cid:20)D(∂)ξ=N(∂)uy=Q(∂)ξ+W(∂)u(2.16)whereD(∂)isanon-singularmatrixofsizer×roverR=R[∂];(2.16)isaverygeneralrepresentationofacontrolsystem[100].DEFINITION14.–Thesetofequations(2.16)iscalledaRosenbrockrepresentationandisnotedas{D,N,Q,W}.Thevectorξofsucharepresentationiscalledthepartialstate(orthepseudo-state).REMARK15.–*ConsiderthesystemΣasanR-module,denotedbyM(seeRemark8,section2.2.5).Theﬁrstequationof(2.16)hasalreadybeeninterpretedinRemark12(section2.3.1).Thesecondonesimplymeansthatthevariablesyi(1≤i≤p)belongtoM.See[19]formoredetails.*LeftformThepartialstategenerallyconsistsoflatentvariables,except,inparticular,whenthesecondequationof(2.16)isy=ξ(withQ(∂)=Ip,W(∂)=0);inthiscase,indeed,theRosenbrockrepresentationreducestooneequationwhoselatentvariablesareeliminated:thisequation,calledaleftform,iswrittenasD(∂)y=N(∂)u.(2.17)Therepresentation(2.15)oftheheatedtankisofthisform.32LinearSystemsItisalsothecaseinrepresentation(2.12)oftheRLCcircuitwithu=V,y=iand(cid:20)D(∂)=∂2+RL∂+1LCN(∂)=1L∂afterexpression(2.12)hasbeendividedbyLC,forD(∂)tobeamonicpolynomial.RightformEquationsoftheRLCcircuitinFigure1.1canalsobeobtainedbyusingthechargeqofthecapacitorasalatentvariable.Wethenobtain(cid:20)V=(cid:15)L∂2+R∂+1C(cid:16)q.i=∂q.Inordertogetamonicpolynomialofseconddegreeintheﬁrstequation,putξ=Lq;weobtain,withu=Vandy=i,(cid:20)u=(cid:15)∂2+RL∂+1LC(cid:16)ξ.y=1L∂ξ.(2.18)ThisisaRosenbrockrepresentationsuchas(2.16)whereN(∂)=1andW(∂)=0:(cid:20)u=D(∂)ξy=Q(∂)ξ.(2.19)Arepresentationofthisformiscalled,ingeneral,arightform.Inthepresentcase,wehaveD(∂)=∂2+RL∂+1LCandQ(∂)=1L∂.Leftform↔rightformdualityFortheleftform(2.17)andtherightform(2.19)torepresentthesamecontrolsystem,itisnecessarytohavethefollowingcorrespondences(assumingthatD(∂)isamonicpolynomial):(cid:20)D(∂)←→D(∂)N(∂)←→Q(∂)(seee.g.theRLCcircuitcase).Thisiswhatwecalltheleftform↔rightformduality(foralineartime-invariantSISOsystem).Soon,wewillseefromsection7.1thataleftformanditsdual(whichsatisﬁesthedualityrelationabove)maynotalwaysberepresentationsofthesamecontrolsystem.Thesameappliesforarightformanditsdual.SystemsTheory(I)332.3.6.State-spacerepresentationAstate-spacerepresentationisaparticulartypeofRosenbrockrepresentation,whereD(∂)isoftheform∂In−A,A∈Rn×n,N(∂)=B∈Rn×mandQ(∂)=C∈Rn×p.Sucharepresentationisoftheform(cid:20)˙x=Ax+Buy=Cx+W(∂)u.(2.20)Thistypeofrepresentation(calledastate-pacesystem)willbestudiedindetailfromChapter7onwards.REMARK16.–ThecodomainofthestatexisRn,i.e.thestate-spaceisofdimensionn.Abusingthelanguage,wecanalsosaythatthestate-spacerepresentationconsidered,oritsstatevector,isofdimensionn.2.3.7.PolesandorderofasystemConsideracontrolsystemΣdescribedbytheRosenbrockrepresentation(2.16).DEFINITION17.–(i)ThepolesofΣaretherootsofdetD(s)(takingintoaccountmultiplicities).(ii)TheorderofΣisthedegreeofthepolynomialdetD(s).Theorderofasystemisthereforeequaltothenumberofitspoles.Thefollowingresultisobvious:THEOREM18.–SupposeΣisgivenbythestaterepresentation(2.20).Then,thepolesofΣaretheeigenvaluesofAanditsorderisthedimensionofitsstatevector.REMARK19.–*ConsiderthesystemΣandtheassociatedR-moduleM(seeRemarks8,12,and15).Then,thepolesofΣaretheSmithzerosofthetorsionmoduleM/[u]R(seesection13.4.2).*2.3.8.FreeresponseandbehaviorLetΣbealineartime-invariantsystemofordern.DEFINITION20.–WecallfreebehaviorofΣthesetofitsvariableswhenthesysteminputismaintainedatzero(foranyinitialconditions).Thefreeresponseofthissystemisitsoutputinthesamesituation.34LinearSystemsSupposeagainthatΣisdescribedbytheRosenbrockrepresentation(2.16).Let¯ΣbethesystemobtainedfromΣbyforcingtheinpututo0.Itspartialstate¯ξisasolutionofD(∂)¯ξ=0.(2.21)CaseofascalarpartialstateOneofthefundamentalresultsintheclassictheoryoflineardifferentialequationswithconstantcoefﬁcientsisthefollowing[36](seealsosection12.5.2,Theorem449):THEOREM21.–Letp1,...,pqbethedistinctrootsofD(s)(alsocalledthedistinctpolesofΣorof¯Σ),withorderofmultiplicityρ1,...,ρq,respectively.Thenanysolutionofequation(2.21)isoftheform¯ξ(t)=q(cid:11)j=1ρj(cid:11)k=1αjktk−1epjtwhereαjk∈C.Thesetofthesesolutions(whichisthefreebehaviorofthesystem)isaC-vectorspaceofdimensionn;abasisofthisspaceconsistsofthenfunctionsjk:t(cid:3)→tk−1epjt,1≤k≤ρj,1≤j≤q.Examples–Considerﬁrstthedoublyintegratingsystem¨y=u.(2.22)Thisequationisaleftform(2.17)(section2.3.5)withD(∂)=∂2andN(∂)=1.Thepolynomialdet(D(s))=D(s)=s2hasdoubleroots=0.Thesetofsystempolesistherefore{0,0}.Thisisasecond-ordersystem.–Considernowthesystem¨y=˙u.(2.23)ItisagainaleftformwithD(∂)=∂2andN(∂)=∂.Thesetofsystempolesis,likepreviously,{0,0},andthissystemisofthesecondorder.ItpresentsaparticularitywhichwillbestudiedinChapter7.*GeneralcaseGeneralizationofTheorem21Considernowthegeneralcasewherethepartialstatehasr>1components.ThereexistmatricesP(∂)andR(∂),invertibleoverR=R[∂],suchthatP(∂)D(∂)R(∂)=S(∂)SystemsTheory(I)35whereS(∂)=diag(α1(∂),...,αr(∂))istheSmithformofD(∂)(seesection13.2.3).Let˜ξ=R−1(∂)ξ(whichislicitsinceR−1(∂)isapolynomialmatrixin∂).Then,thematrixdifferentialequation(2.21)isequivalenttorscalardifferentialequations⎧⎪⎨⎪⎩α1(∂)˜ξ1=0...αr(∂)˜ξr=0.Foreachoftheseequations,wecanapplyTheorem21.Wecanthereforefactorizetheinvariantfactorsαk(∂),1≤k≤r,intoprimesandthusmakeapparenttheelementarydivisorsofD(∂).ThesedivisorsdeterminetheSmithzerosofthematrixD(s)aswellastheirstructuralindices(seesection13.2.5).DEFINITION22.–ApoleofΣisaSmithzeroofD(s)*(or,moreintrinsically,ofM/[u]R:seeRemark19,section2.3.7)*.Thestructuralindices,theorderandthedegreeofsuchapolearethestructuralindices,theorderandthedegreeofthisSmithzero.Oneobtainsthefollowingtheorem([12],IV.2.9):THEOREM23.–Letp1,...,pqbethedistinctpolesofΣ,andletσ(pj)bethesetofstructuralindicesofthepolepj(1≤j≤q).Anysolutionof(2.21)isoftheform¯ξ(t)=q(cid:11)j=1(cid:11)k∈σ(pj)ajktk−1epjt(2.24)whereajk∈Cr.Thesetofthesesolutions(thatisthefreebehaviorofthesystem)isaC-vectorspaceofdimensionn.ExampleLetustakeasimplecasewherethematrixD(∂)isalreadyinSmithform:D(∂)=⎡⎣∂−1000(∂−1)3(∂−2)00(∂−1)3(∂−2)2⎤⎦.Theorderofthesystemisn=degdetD(∂)=10.36LinearSystemsOntheotherhand,(2.21)canbewrittenintheformofthreescalarequations:⎧⎨⎩(∂−1)¯ξ1=0(∂−1)3(∂−2)¯ξ2=0(∂−1)3(∂−2)2¯ξ3=0.Wethusobtainthefollowingsolutions(inthespaceE(R)consistingofallindeﬁnitelydifferentiablefunctionsR→C)⎧⎨⎩¯ξ1(t)=c1et,¯ξ2(t)=c2et+c3tet+c4t2et+c5e2t,¯ξ3(t)=c6et+c7tet+c8t2et+c9e2t+c10te2t,wherethe10constantsc1,...,c10arearbitrary.Weobtaintheform(2.24)inthefollowingmanner:¯ξ(t)=⎡⎣c1c2c6⎤⎦et+⎡⎣0c3c7⎤⎦tet+⎡⎣0c4c8⎤⎦t2et+⎡⎣0c5c9⎤⎦e2t+⎡⎣00c10⎤⎦te2t.Asexpected,thesolutionsformaC-vectorspaceofdimension10.2.4.Transfermatrix2.4.1.LaplacetransformsTheLaplacetransformisdetailedinsection12.3.4.Asfarasweareconcernedhere,theessentialpointsareasfollows:Letu:R→Rmbeafunctionwithpositivesupport,i.e.whichiszerofort<0.ItsLaplacetransformisafunctionofthecomplexvariableˆu,fromCtoCm,deﬁnedforRe(s)>γ(whereγistheabscissaofconvergence)byˆu(s)=(cid:2)+∞0−u(t)e−stdt(2.25)(thedeﬁnitioninsection12.3.4isextendedheretothecaseofvector-valuedfunctions).Ifˆu(s)isarationalfunction,theabscissaofconvergenceisgivenbyγ=maxp∈PRepwherePisthesetofpolesofˆu(s).SystemsTheory(I)37TheLaplacetransformationL:u(cid:3)→ˆuislinear.Ittransformstheconvolutionproductintoanordinaryproduct.Ifuandallitsderivativesarezeroatt=0,then(cid:15)Lu(n)(cid:16)(s)=snˆu(s),irrespectiveofwhattheordernofthederivativeis.Inotherwords,withzeroinitialconditions,Laplacetransformationtransformsdifferentialoperator∂intothemultiplicationbythe“Laplacevariable”s,whichisacomplexvariable.2.4.2.Transfermatrix:deﬁnitionTHEOREM24.–Let(Σ,u,y)beacontrolsystem.ThereexistsauniquematrixofrationalfunctionsG(s)suchthatforzeroinitialconditions,ˆy(s)=G(s)ˆu(s).(2.26)PROOF.WecanassumethatthesystemisdescribedbyaRosenbrockrepresentation,because,asalreadysaid,thisisthemostgeneraltypeofrepresentationofalinearcontrolsystem.ByapplyingtheLaplacetransformwithzeroinitialconditionsto(2.16),weobtain(cid:20)D(s)ˆξ(s)=N(s)ˆu(s)ˆy(s)=Q(s)ˆξ(s)+W(s)ˆu(s).ThematrixD(s)isasquare,non-singular,thusinvertibleovertheﬁeldR(s),andwehaveˆξ(s)=D−1(s)N(s)ˆu(s);from(2.26)weobtainG(s)=Q(s)D−1(s)N(s)+W(s).(2.27)ThisprovestheexistenceofG(s).Itsuniquenessisalsoensured,sincetheequalityG1ˆu=G2ˆuforeveryˆu(wheretheinputvariablesareindependent)impliesG1=G2.DEFINITION25.–ThematrixG(s)∈R(s)p×m(whereR(s)denotestheﬁeldofrationalfunctionswithrealcoefﬁcients)iscalledthetransfermatrixofthecontrolsystem.Inthecasem=p=1(SISO),G(s)iscalledthetransferfunctionofthecontrolsystem.Fromanalgebraicpointofview,themajordifferencebetweenworkingwithtemporalsignalsorwiththeirLaplacetransformsisthat,inthecaseoftemporalsignals,theoperatorsbelongtotheringR[∂]ofpolynomialsin∂;theseelementsarenotinvertibleingeneral.InthecaseofLaplacetransforms,onthecontrary,theoperatorsarerationalfunctions,i.e.belongingtotheﬁeldR(s),andsoare38LinearSystemsinvertiblewhenevertheyarenon-zero.ThissimpliﬁcationbroughtalongbytheLaplacetransformationwithzeroinitialconditionsisofcoursepaidforbyalossofinformationwhichwillbestudiedinChapter7.Notethataleftformandarightformwhicharedualhavethesametransfermatrix.2.4.3.ExamplesLetusre-examinesomeoftheexamplesstudiedinChapter1.RLCcircuitConsiderequation(2.12)(section2.3.3).–First,supposetheinputchosenisu=V,andtheoutputisy=i.ThetransferfunctionisthenG(s)=CsLCs2+RCs+1.(2.28)–Ifonthecontrarywechooseu=iasinputandy=Vasoutput,thetransferfunctionistheinverseofthepreviousone,whichisG(s)=LCs2+RCs+1Cs.(2.29)DCmotorEquation(2.14)(section2.3.3)isoftheformD(∂)ξ=N(∂)u.Supposetheoutputisy=θ(positioncontrol).Wethenhavetherelationy=Q(∂)ξ+W(∂)uwithQ(∂)=(cid:25)001(cid:26)andW(∂)=0.SincewehaveaRosenbrockrepresentation,wecanmakeuseoftherelation(2.27)tocalculatethetransferfunctionG(s).Inthepresentcase,anyhow,itismoreeffectivetoreturntoequations(1.25)(section1.3)andthenpassintotheLaplacedomain.Wehave⎧⎨⎩(R+Ls)ˆı(s)+Kˆω(s)=ˆV(s)(Js+λ)ˆω(s)=Kˆı(s)sˆθ(s)=ˆω(s).Fromtheﬁrsttwoequations,weget(cid:25)(R+Ls)(Js+λ)+K2(cid:26)ˆω(s)=KˆV(s)SystemsTheory(I)39fromwhichweﬁnallyobtainˆθ(s)=Ks[(R+Ls)(Js+λ)+K2]ˆV(s).ThetransferfunctionofthecontrolsystemisthereforeG(s)=Ks[(R+Ls)(Js+λ)+K2].(2.30)HeatedtankThisisanMIMOsystem;itthereforehasatransfermatrix.Accordingto(2.15)(section2.3.3),itisG(s)=#11+τs0−121+τ2s11+τ2s$.(2.31)2.4.4.TransmissionpolesandzerosSISOcaseConsideraSISOsystemΣ,withrationaltransferfunctionG(s).WewillseelaterthatthebehaviorofΣislargelycharacterizedbythepolesandzerosofG(s)(deﬁnedinsection13.6.1).DEFINITION26.–ThepolesandzerosofG(s)arecalledthetransmissionpolesandzerosofΣ.ExamplesCaseofRLCcircuitConsiderthecaseoftheRLCcircuitwithtransferfunction(2.28).ThistransferfunctioncanbeputintheformG(s)=kω0ss2+2ςω0s+ω20(2.32)withk=(cid:30)CL,ω0=1√LC,ς=R2(cid:30)CL.Ifς≥1,thesystemhastworealtransmissionpoles,formingtheset(cid:7)−ω0(cid:9)ς−%ς2−1(cid:10),−ω0(cid:9)ς+%ς2−1(cid:10)(cid:8).If0≤ς<1,thenthesystemhastwocomplexconjugatetransmissionpoles:(cid:7)−ω0(cid:9)ς−i%1−ς2(cid:10),−ω0(cid:9)ς+i%1−ς2(cid:10)(cid:8).Moreover,thesetoftransmissionzerosofthesystemis{0}.40LinearSystemsCaseoftheDCmotorThetransferfunction(2.30)canbeputintheformG(s)=ks(s2+2ςω0s+ω20).(2.33)Thesystemthereforehasthreetransmissionpoles:{0,p1,p2},wherep1andp2aretherootsofthepolynomials2+2ςω0s+ω20,andwhicharecalculatedabove.Thissystemhasnotransmissionzero.MIMOcaseDeﬁnition26remainsvalidintheMIMOcase.Weareledtodeﬁnewhatwemeanbyapoleandazeroofatransfermatrix.NaivedeﬁnitionLetusﬁrstlookatanaivedeﬁnitionofthesenotionsanditslimitations.Inasecondstep,wewillfollowamorerigorousapproach,butamorecomplicatedonefromamathematicalpointofview.TransmissionpolesApoleofatransferfunctionG(s)isacomplexnumberpsuchthatlims→p|G(s)|=+∞.Letusexaminethecaseofatransfermatrix.ElementsofsuchamatrixG(s)aredenotedbyGij(s).ApoleofG(s)isacomplexnumberpsuchthatatleastoneoftheelementsGij(s)satisﬁeslims→p|Gij(s)|=+∞.Consider,forexample,theheatedtank,whosetransfermatrixisgivenby(2.31).Fromtheabovedeﬁnition,weget−1τand−2τasthetransmissionpolesofthissystem.Thedifﬁcultyhere(resultingfromthelackofprecisionofthedeﬁnition)isthatweknownothingaboutthemultiplicity(ororder)ofthepole−2τ.Indeed,twoelementsofG(s)haveanabsolutevaluethattendsto+∞whens→−2τ.IsthesetofpolesofG(s)(repeatingapoleanumberoftimesequaltoitsmultiplicity)(cid:31)−1τ,−2τ or(cid:31)−1τ,−2τ,−2τ ?Wewillanswerthisquestioninsection2.4.5.TransmissionzerosandblockingzerosAzeroofatransferfunctionG(s)isacomplexnumberzsuchthatG(z)=0.InthecaseofMIMOsystems,astraightforwardextensionofthisdeﬁnitionallowsustoobtainthenotionof“blockingzero”:SystemsTheory(I)41DEFINITION27.–AblockingzeroofsystemΣ(orofitstransfermatrixG(s))isacomplexnumberzsuchthatG(z)=0.Wecanneverthelessenvisageasecondtypeofextensiontotheclassicnotionofzeroofarationalfunction,proceedinginthefollowingmanner:TherankofthetransferfunctionG(s)overtheﬁeldR(s)ofrationalfunctions(thisrankisdenotedbyrkR(s)G(s)andissometimescalledthe“normalrank”ofG(s))isequalto1.So,azeroofG(s)isacomplexnumberzsuchthatrkCG(z)<rkR(s)G(s).Wecannowenvisagetoextendthisdeﬁnitiontothecaseofatransfermatrix.Forexample,ifweconsiderthetransfermatrixG(s)oftheheatedtank,rkR(s)G(s)=2andrkCG(z)=2forallvaluesofzatwhichG(z)isdeﬁned,i.e.foranyzthatisnotapoleofG(s).“Therefore”,thissystemhasnotransmissionzero.Butthereareproblematiccases.Consider,forexample,G(s)=(cid:27)1s00s(cid:28).Thesecondcolumnbecomeszerowhens=0,“therefore”0isazeroofG(s),i.e.atransmissionzeroofthesystem.But,ontheotherhand,s=0isapoleofG(s),whichrendersG(0)undeﬁned.Inviewofsuchanincoherence,onemustuseamorepreciseapproach,leadingustodeﬁnethe“MacMillanpolesandzeros”.Deﬁnition26extendstotheMIMOcaseinthefollowingmanner:DEFINITION28.–ThetransmissionpolesandtransmissionzerosofasystemaretheMacMillanpolesandMacMillanzerosofitstransfermatrix.2.4.5.*MacMillanpolesandzerosSmith–MacMillanformofatransfermatrixLetG(s)beatransfermatrix,theelementsGij(s)ofwhicharerationalfunctions.Letd(s)betheleastcommondenominatoroftheserationalfunctions(i.ethelcmofitsdenominators).ThenwehaveG(s)=N(s)d(s)whereN(s)isapolynomialmatrix.WeknowthereexistpolynomialmatricesU(s)andV(s),invertibleoverR=R[∂],suchthatN(s)=U−1(s)S(s)V(s)42LinearSystemswhereS(s)=diag(α1(s),...,αr(s),0,...,0)istheSmithformofN(s)(seesection13.2.3).Thepolynomialsα1(s),...,αr(s)aretheinvariantfactorsofN(s);theyarenon-zeroandsuchthatα1(s)|...|αr(s).Asaresult,wehaveG(s)=U−1(s)diag(cid:21)α1(s)d(s),...,αr(s)d(s),0,...,0(cid:22)V(s).Letαi(s)d(s)=εi(s)ψi(s)(1≤i≤r)wheretherationalfunctionontheright-handsideisirreducible.WeobtainG(s)=U−1(s)Σ(s)V(s),(2.34)Σ(s)=diag(cid:21)ε1(s)ψ1(s),...,εr(s)ψr(s),0,...,0(cid:22).(2.35)Itiseasytoshowthatε1(s)|...|εr(s),ψr(s)|...|ψ1(s).(2.36)Ontheotherhand,theuniquenessoftheSmithformS(s)ofN(s)impliestheuniquenessofΣ(s)satisfying(2.34),(2.35)withthedivisibilityconditions(2.36).DEFINITION29.–ThematrixΣ(s)iscalledtheSmith–MacMillanformofG(s).DeﬁnitionoftheMacMillanpolesandzerosLet(s)=diag(ε1(s),...,εr(s),0,...,0)Ψ(s)=diag(ψr(s),...,ψ1(s),1,...,1)sothatΣ(s)=(s)Ψ−1(s)=Ψ−1(s)(s)wherethepolynomialmatrices(s)andΨ(s)areleft-andright-coprime(seesection13.2.6).SystemsTheory(I)43DEFINITION30.–(i)TheMacMillanpoles(resp.,theMacMillanzeros)ofG(s)aretheSmithzerosofΨ(s)(resp.,of(s)).(ii)Thestructuralindices,theordersandthedegreesoftheseMacMillanpoles(oroftheseMacMillanzeros)arethestructuralindices,theordersandthedegrees,respectively,oftheseSmithzeros.(iii)IfG(s)isapropertransfermatrix(seesection13.6.1),itsMacMillandegreeisthesumofthedegreesofthepolynomialsψi(s)(1≤i≤r).REMARK31.–(i)Accordingto(2.34)and(2.35),G(s)=D−1l(s)Nl(s)whereDl(s)=Ψ(s)U(s)andNl(s)=(s)V(s).Wehavetheequality(cid:25)Dl(s)Nl(s)(cid:26)=(cid:25)Ψ(s)(s)(cid:26)diag{U(s),V(s)}.ThematricesU(s)andV(s)areinvertibleoverR=R[∂],soisalsodiag{U(s),V(s)},thereforethematrices{Dl(s),Nl(s)}areleft-coprime.Therefore,(Dl(s),Nl(s))is,like(Ψ(s),(s)),aleft-coprimefactorizationofG(s)overR.AccordingtoTheorem509(section13.2.7),theMacMillanpoles(resp.,theMacMillanzeros)ofG(s)aretheSmithzerosofDl(s)(resp.,Nl(s)).(ii)WecanequallywriteG(s)=Nr(s)D−1r(s)whereDr(s)=V−1(s)Ψ(s)andNr(s)=U−1(s)(s).Since(cid:27)DrNr(cid:28)=(cid:27)V−100U−1(cid:28)(cid:27)Ψ(cid:28),(Nr(s),Dr(s))isaright-coprimefactorizationofG(s)overR.TheMacMillanpoles(resp.,zeros)ofG(s)aretheSmithzerosofDr(s)(resp.,Nr(s)).DEFINITION32.–Acontrolsystemwhichhasatransmissionpole(resp.,zero)ats=0iscalledanintegratorsystem(resp.,aderivatorsystem).ExampleoftheheatedtankThetransfermatrix(2.31)oftheheatedtankcanbewrittenasG(s)=a(cid:27)1s+a0−1s+2a1s+2a(cid:28)witha=1τ.ItisclearthatthetransmissionpolesandzerosofG(s)areidenticaltothoseof˜G(s)=G(s)a;itisthereforethislastmatrixthatwewillnowbeinterestedin.Wehave˜G(s)=1(s+a)(s+2a)(cid:27)s+2a0−(s+a)s+a(cid:28)=1(s+a)(s+2a)N(s).TheSmithformofN(s)isS(s)=(cid:27)100(s+2a)(s+a)(cid:28).44LinearSystemsAsaresult,theSmith–MacMillanformof˜G(s)isΣ(s)=(cid:27)1(s+2a)(s+a)001(cid:28).Theheatedtankthereforehastwotransmissionpoles{−a,−2a}.Thesearesimplepoles(meaningthattheirorderandtheirdegreeareequalto1).Ontheotherhand,thissystemhasnotransmissionzero.2.4.6.MinimalsystemsRelationbetweenthepolesofasystemanditstransmissionpolesConsiderasystemdescribedbytheRosenbrockrepresentation(2.16).Accordingto(2.27),itstransfermatrixisG(s)=Q(s)D−1(s)N(s)+W(s)=1detD(s)[Q(s)adj(D(s))N(s)+det(D(s))W(s)](2.37)whereadj(D(s))designatestheclassicaladjointofD(s)(seesection13.1.4).Now,therootsofdetD(s)arethepolesofthesystembeingconsidered(seesection2.3.7,Deﬁnition17).Itfollowsfrom(2.37)that{transmissionpoles}⊂{systempoles}.(2.38)Thisinclusionisanequality,exceptwhenthefraction(2.37)isnotirreducible,i.e.whendetD(s)and[Q(s)adj(D(s))N(s)+det(D(s))W(s)]havecommonfactors.Indeed,oncethesecommonfactorsarecancelled,the(MacMillan)polesofG(s)becomenomorethanjustastrictsubsetoftherootsofdet(D(s)).Thiscase,whichinawayis“pathological”,isstudiedinChapter7.SystemsTheory(I)45MinimalcontrolsystemDEFINITION33.–Acontrolsystemissaidtobeminimaliftheinclusion(2.38)isanequality.4Thereadercanverifythatallsystemshavingbeenenvisageduptillnowintheexamplesandexercisesareminimal,withtheexceptionofsystem(2.23)insection2.3.8.Indeed,thisoneherehaspoles{0,0},whileithasauniquetransmissionpole{0}.TransmissionorderTheorderofasystemisdeﬁnedatsection2.3.7(seeDeﬁnition17(ii),whichwemayreformulatebysayingthattheorderofasystemisthenumberofitspoles,countingmultiplicities).DEFINITION34.–Wecallthenumberoftransmissionpolesofasystemthetransmissionorderofthissystem(countingmultiplicities).Accordingto(2.38),(transmissionorder)≤(systemorder).(2.39)Forexample,thesystem(2.23)isoforder2,butitstransmissionorderis1.Itisclearthatacontrolsystemisminimalifandonlyif,(transmissionorder)=(systemorder).Whenacontrolsystemisminimal,wecantalkaboutits“order”withoutambiguity.Asaresult:TheRLCcircuitwithtransferfunction(2.28)isoforder2.TheDCmotorwithtransferfunction(2.30)isoforder3.*Theheatedtankwithtransfermatrix(2.31)isoforder2.*4.Notethatin[42]and[96],theminimalitycorrespondstoadifferentsituation.Ourdeﬁnitioncorrespondstothenotionofminimal(orirreducible)realizationintroducedbyKalman[65].46LinearSystems2.4.7.TransmissionpolesandzerosatinﬁnitySISOcaseConsideratransferfunctionG(s)=b(s)a(s),whereb(s)anda(s)belongtoR[s],arebothnon-zero,andofdegreenandm,respectively;writeb(s)=b0sm+b1sm−1...+bm,a(s)=a0sn+a1sn−1...+an,wherea0b0(cid:5)=0.TherelativedegreeoftherationalfunctionG(s)isthereforeδ(G)=n−m(seesection13.6.1).WecanembedtheringR[s]intheﬁeldR((σ))oftheLaurentserieswithindeterminateσ=1/s(seesection13.1.1).Indeed,anyelementc(σ)(cid:5)=0ofR((σ))isoftheformc(σ)=(cid:12)i≥νciσi,cν(cid:5)=0;thiselementbelongstoR[s]ifandonlyifci=0fori>0.Asaresult,wecanembedtheﬁeldR(s)inR((σ)).Weobtainc(σ)=cνσν(cid:21)1+cν+1cνσ+···(cid:22)=cνσνυ(σ)whereυ(σ)isaunitoftheringR[[σ]].ApplyingthistotherationalfunctionG(s),weobtainG(s)=b0a0σn−mυ(σ).Remembernowthatσ=0ifandonlyifs=∞.Asaresult:–ifn−m>0,wesaythatG(s)hasazeroatinﬁnityofordern−m(orthatG(s)hasn−mzerosatinﬁnity);–ifm−n>0,wesaythatG(s)hasapoleatinﬁnityoforderm−n(orthatG(s)hasm−npolesatinﬁnity).Thesepoles(resp.,zeros)atinﬁnityarethetransmissionpoles(resp.,zeros)atinﬁnityofthesystemwithtransferfunctionG(s).ThetransferfunctionG(s)hasmﬁnitezeros(inC,forexample),whicharetherootsofb(s),andnﬁnitepoles–therootsofa(s).Therefore:–ifn−m>0,G(s)hasmﬁnitezerosandn−mzerosatinﬁnity,saynzerosinthesetCeconsistingofthecomplexplanetowhichweaddedthe“pointinﬁnity”;ontheotherhand,G(s)hasnpolesinCe;SystemsTheory(I)47–ifm−n>0,G(s)hasnﬁnitepolesandm−npolesatinﬁnity,saympolesinCe;andG(s)hasmzerosinCe.Fromwhichwegetthefollowingresult:PROPOSITION35.–LetG(s)bearationalfunction.Ithasasmanypolesasithaszeros,ifwealsoaccountforthepointatinﬁnity.Ontheotherhand,thefollowingresultisasimpleconsequenceofthedeﬁnitions(seesection13.6.1):PROPOSITION36.–Atransferfunctionisproperifandonlyifithasnopoleatinﬁnity.*MIMOcaseTherationalebehindsection2.4.4fordeﬁningﬁniteMacMillanpolesandzerosofatransfermatrixcanalsobeusedforthepolesandzerosatinﬁnity.LetG(s)∈R(s)p×mbeatransfermatrixandconsiderG(s)asanelementofR((σ))p×m,whereσ=1/s.WeknowthatR((σ))istheﬁeldoffractionsofS=R[[σ]],theringofformalseriesinσ,andthattheringSisaprincipalidealdomain(seesection13.1.1).Thusletσκ(κ≥0)betheleastcommondenominatoroftheelementsofG(s),whentheelementsareconsideredthewaywehavejustindicated.WeobtainG(s)=N∞(σ)σκwhereN∞(σ)∈Sp×m.ThematrixN∞(σ)admitsaSmithformS∞(σ),andthereexistmatricesU∞(σ)andV∞(σ),invertibleovertheringS,suchthatN∞(σ)=U−1∞(σ)S∞(σ)V∞(σ)whereS∞(σ)=diag(σµ1,...,σµr,0,...,0),0≤µ1≤...≤µr.Therefore,G(s)=U−1∞(σ)Σ∞σV∞(σ)whereΣ∞(σ)=1σκS∞(σ)=diag(σν1,...,σνr,0,...,0)withνi=µi−κ,andthusν1≤···≤νr.DEFINITION37.–(i)ThematrixΣ∞(σ)iscalledtheSmith–MacMillanformofG(s)atinﬁnity.(ii)Let(¯ςi)1≤i≤rand(¯πi)1≤i≤rbetheﬁnitesequenceofnaturalnumbersdeﬁnedby:¯ςi=max(0,νi)and¯πi=max(0,−νi).Amongthenaturalnumbers¯ςi(resp.,¯πi),thosethatarenon-zero(ifany)arecalledthestructuralindicesofthezerosatinﬁnity(resp.,thepolesatinﬁnity)ofthetransfermatrixG(s);theyarearrangedinincreasing(resp.,decreasing)orderandaredenotedbyςi,1≤i≤ρ(resp.,48LinearSystemsπi,1≤i≤).(iii)Ifρ≥1(resp.,≥1),G(s)issaidtohaveρzeros(resp.,poles)atinﬁnity,theithonewithorderςi(resp.,πi).(iii)Theinteger(cid:11)1≤i≤πi(resp.,(cid:11)1≤i≤ρςi)iscalledthedegreeofthepoles(resp.,thezeros)ofG(s)atinﬁnity.REMARK38.–WecanwriteG(s)(asanelementofR((σ))p×m)intheformG(s)=(cid:12)i≥ν1ΘiσiwhereΘi∈Rp×m.Therefore,G(s)isproperifandonlyifν1≥0,i.e.ifG(s)hasnopolesatinﬁnity;G(s)isstrictlyproperifandonlyifν1≥1,andthenG(s)issaidtohaveablockingzeroatinﬁnityoforderν1.WecannowgeneralizeDeﬁnition30(iii):DEFINITION39.–TheMacMillandegreeofatransfermatrix(notnecessarilyproper)isthesumofthedegreesofallitspoles(includingitspolesatinﬁnity).REMARK40.–WenaturallywillaskthequestionofwhetherProposition36willgeneralizetotheMIMOcase.Theanswerisnegative:see([64],section6.5).Thenumberofpoles(ﬁniteandinﬁnite)ofatransfermatrixcanexceeditsnumberofzeros(ﬁniteandinﬁnite)byaquantitycalledthedefectofthetransfermatrixG(s).Thedefectofaninvertiblesquaretransfermatrixiszero.2.5.Responsesofacontrolsystem2.5.1.Input–outputoperator*GeneralcaseConsideratime-invariantcontrolsystemΣ,possiblynonlinear,deﬁnedbyanequationsuchas(2.4)(section2.2.2).Indistinguishingtheinputsfromtheothervariablesofthesystem,wecansupposethatthesystemequationisoftheformF(cid:9)ξ,...,ξ(β),u,...,u(γ)(cid:10)=0.Accordingtosection2.2.6,anequilibriumpointw∗=(ξ∗,u∗)issuchthatF(ξ∗,0,...,0,u∗,0...,0)=0.Lett0beaninitialinstantandubeaninputsuchthat(cid:20)u(t0)=u∗,u(i)(t0)=0,1≤i≤γ.(2.40)SystemsTheory(I)49AccordingtoConditioniii)ofsection2.3.1,thereexistsoneandonlyonesolutionξsuchthat(cid:20)ξ(t0)=ξ∗,ξ(j)(t0)=0,1≤j≤β.(2.41)Inparticular,oncetheinitialconditions(2.40)and(2.41)areimposedattimet0,theoutputyofΣdependsonlyonu.Therefore,thereexistsauniquenonlinearoperator˜Σt0,w∗suchthaty=(cid:9)˜Σt0,w∗(cid:10)(u).(2.42)DEFINITION41.–Theoperator˜Σt0,w∗iscalledtheinput–outputoperatorassociatedwithΣfortheinitialcondition(t0,w∗).Thefunctionydeﬁnedby(2.42)iscalledtheresponseofΣfortheinputuandtheinitialcondition(t0,w∗).*Caseofalinearortime-invariantsystemIfΣisalinearsystem,thenw∗=0isanequilibriumpoint.Itisnotnecessarilytheonlyone–asthereadercanshow,aspartofanexercise,usingtheexampleofthesystem(2.23)(section2.3.8)–buttheproblemcanalwayscomedowntothecasewherew∗=0bytranslatingtheoriginofthespacewherewis“living”.Theinput–outputoperatorassociatedwithΣfortheinitialcondition(t0,0)canthenbedenotedmoreconciselyby˜Σt0.Likewise,ifΣislinearandtime-invariant,theproblemcomesdowntothecasewheret0=0byatranslationoftheoriginoftime.Theinput–outputoperatorassociatedwithΣfortheinitialcondition(0,w∗)canthenbedenotedby˜Σw∗.Last,ifΣislinearandtime-invariant,wedenoteby˜Σtheinput–outputoperatorassociatedwithΣfortheinitialcondition(0,0).Thisoperatorisexploredinwhatfollowsnext.Caseofalineartime-invariantSISOsystemConsideralineartime-invariantSISOsystemΣ,withtransferfunctionG(s)assumedtobearationalfunction.Withzeroinitialconditions,wehaverelation(2.26)betweentheLaplacetransformoftheinputandthatoftheoutput(seesection2.4.2).LetgbetheinverseLaplacetransformofG(s).Intimedomain,wehavey(t)=(g∗u)(t),t≥0.(2.43)Consequently,theinput–outputoperatorassociatedwithΣistheconvolutionoperator˜Σ:u(cid:3)→g∗u.50LinearSystemsCaseofalineartime-invariantMIMOsystemLetΣbealineartime-invariantMIMOsystemwithtransfermatrixG(s)=(Gij(s))ofsizep×m.SupposethateachelementGij(s)isarationalfunction.Atzeroinitialconditions,wehaveagainrelation(2.26).LetgijbetheinverseLaplacetransformofGij(s)andletgbethematrixwithentriesoftheelementsgij.Byextension,wecancallGtheLaplacetransformofgandwecaneasilyverifythatG(s)=(cid:2)+∞0−g(t)e−stdtforRe(s)>γ,(2.44)γ=maxp∈PRep,wherePisthesetofpolesofG(s).Thisexpressionisidenticalto(2.25)(section2.4.1).Wehavethereforeg=L−1(G(s)).Letubeaninput,assumedtobealocallyintegrablefunctionwithvaluesinRm.Theinitialconditionsareassumedtobezero,andtheinputisassumedtobepositivelysupported:u(t)=0fort<0.Theconvolutionproductg∗ucanthenbedeﬁned:itisafunctionywithvaluesinRptheithcomponentyiofwhichisgivenbyyi=m(cid:12)j=1gij∗uj(1≤i≤p).Withthisdeﬁnitionoftheconvolutionproduct,theexpression(2.26)inLaplacedomaincorrespondstoexpression(2.43)intimedomain,whichisthusextendedtotheMIMOcase.Wehavethusobtainedthefollowinggeneralresult:THEOREM42.–Theinput–outputoperatorassociatedwiththecontrolsystemΣistheconvolutionoperator˜Σ:u(cid:3)→g∗u.Abusingthelanguage,wecansaythatG(s)isthetransfermatrixoftheconvolutionoperator˜Σ(aswellasofsystemΣ).Controlsystemandassociatedinput–outputoperatorTheknowledgeofthetransfermatrixG(s)isequivalenttothatoftheconvolutionoperator˜Σ.ButitdoesnotdeterminethecontrolsystemΣunlessitisminimal.Ifthatisnotthecase,indeed,theinclusion(2.38)isnotanequality,sothereexistpolesofthesystemΣwhicharenotrepresentedinthetransfermatrix.WewillseeinChapter7thattheminimalityofalineartime-invariantsystemisanecessaryandsufﬁcientconditionforsuchsystemtobeentirelycharacterizedbyitstransfermatrix(orbyitsassociatedconvolutionoperator).SystemsTheory(I)512.5.2.ImpulseandstepresponsesImpulseresponseInmathematics,giscalledthekerneloftheconvolutionoperator˜Σ.Fromthepointofviewofsystemstheory,letusﬁrstconsiderthecaseofaSISOsystem:gistheoutputofthesystemΣwhentheinputuisthe“Diracimpulse”(which,inmathematicallanguage,istheDiracdistribution)δ,andtheinitialconditionsarezero.ThatiswhywecallgtheimpulseresponseofΣ.Therefore,wecanidentifyasystembysubjectingittoaDiracimpulse:weonlyhavetomeasurethecorrespondingresponse,whichistheimpulseresponse,anditremainstocalculateitsLaplacetransformtogetthetransferfunctionG(s).StepresponseThemethodjustdescribedis,however,notverypracticalbecausetheDiracdistributionisnotaninputwhichisphysicallyrealizable.Itispreferabletoreplaceitbytheunitstep1(t),deﬁnedby1(t)=(cid:20)0,t<01,t≥0.(2.45)Thecorrespondingresponse(withzeroinitialconditions)istheunitstepresponse(orthestepresponse).TheLaplacetransformofthestepresponseisG(s)s.Thederivativeofthestepresponse(inthesenseofdistributions)istheimpulseresponse(forthederivativeoftheunitstepistheDiracdistribution):seeequation(12.23),section12.2.3.ExtensiontoMIMOcaseIntheMIMOcase,recallthatgisamatrix(ofsizep×m).Itisagaincalledtheimpulseresponseofthesystem(orsometimesthematrixofimpulseresponses).Theentrygijistheithcomponentoftheoutputwhenthejthcomponentoftheinputisδandtheothercomponentsarezero.TheextensionofthenotionofstepresponsetotheMIMOcase(sometimescalled,inthiscase,thematrixofstepresponses)isdoneinasimilarmanner.2.5.3.Proper,biproperandstrictlypropersystemsPropersystemsTHEOREM43.–LetΣbealineartime-invariantcontrolsystem.Thefollowingconditionsareequivalent:(i)itsstepresponseisapiecewisecontinuousfunction(havingnodiscontinuityexceptattheorigin);(ii)itstransfermatrixG(s)isproper.52LinearSystemsPROOF.Theproofofthistheoremmakesuseoftheresultsofsection13.6.1;itisdetailedintheSISOcase,anditsextensiontotheMIMOcaseislefttothereader.(1)IfG(s)isproper,wehaveG(s)=q0+H(s)whereq0=lim|s|→+∞G(s)andwhereH(s)isastrictlyproperrationalfunction.TheinverseLaplacetransformofH(s)isalocallyintegrablefunctionh.Therefore,theimpulseresponseofΣisg=q0δ+h,anditsresponsetoalocallyintegrableinputuisy(t)=q0u(t)+(cid:2)t0h(t−τ)u(τ)dτwhichisagainalocallyintegrablefunction.Ifuistheunitstep,weobtainy(t)=q01(t)+(cid:2)t0h(τ)dτ(2.46)whichisacontinuousfunction,exceptatt=0ifq0(cid:5)=0.(2)Conversely,supposeG(s)isimproper.Then,thereexistsapolynomialQ(s),withpositivedegree,suchthatG(s)=Q(s)+H(s)whereH(s),justasbefore,admitsaninverseLaplacetransformhwhichisalocallyintegrablefunction.PutQ(s)=(cid:11)nk=0qksk,wheren=d◦(Q)≥1.Thestepresponseisy(t)=n(cid:12)k=1qkδ(k−1)(t)+q01(t)+(cid:2)t0h(τ)dτ(2.47)whichisasingulardistribution,sinceqn(cid:5)=0.DEFINITION44.–ThecontrolsystemΣissaidtobeproperifitsatisﬁesoneoftheequivalentconditionsinTheorem43.REMARK45.–AswasshownintheproofofTheorem43,alineartime-invariantcontrolsystemisproperifandonlyifitsresponsetoalocallyintegrablefunctionisagainlocallyintegrable.Thecontrolengineermustalwayschoosetheinputsandoutputsofasysteminsuchawaythattheresultingcontrolsystembeproper.Indeed,theunitstepisaninputcommonlyusedandifthesystemisnotproper(wesaythatitisimproper),theresultingoutputisa“singulardistribution”fromamathematicalpointofview(seetheSystemsTheory(I)53proofofTheorem43).Suchasignaldoesnotexistinrealityand,inmoreconcreteterms,whatactuallyhappensisthedestructionofthesystem(orthesaturationofitscomponents).Animpropersystemisthereforeabadlydesignedsystem.Suchasystemisconsiderednotphysicallyrealizableingeneral.Thispointmaybecontested;butitistruethatanimpropersystemisnotpracticallyrealizable.ExamplesConsideragaintheRLCcircuitinsection1.1.1.Withinputu=Vandoutputy=i,itstransferfunctionis(2.28),andthusitisapropercontrolsystem.Ontheotherhand,withinputu=iandoutputy=V,itstransferfunctionis(2.29)andthistimeitisanimpropercontrolsystem.Withtheconventionsofsection2.3.3,theDCmotorinsection1.3andtheheatedtankinsection1.4areproper,sincetheyhaveastransferfunctions(2.30)and(2.31),respectively.StrictlyproperSystemTheproofofthefollowingtheoremissimilartothatofTheorem43:THEOREM46.–LetΣbealineartime-invariantcontrolsystem.Thefollowingconditionsareequivalent:(i)itsstepresponseisacontinuousfunction;(ii)itstransfermatrixG(s)isstrictlyproper.DEFINITION47.–ThecontrolsystemΣissaidtobestrictlyproperifitsatisﬁesoneoftheconditionsinTheorem46.THEOREM48.–Thesysteminstate-spaceform(2.20)(section2.3.6)isproper(resp.,strictlyproper)ifandonlyifW(∂)∈Rp×m(resp.,W(∂)=0).PROOF.NoticethatthetransfermatrixofthissystemisG(s)=C(sIn−A)−1B+W(s).(2.48)Onecanprovethefollowingproperty:theoutputofapropersystemisatleast“asregularas”itsinput;forexample,itsresponseforaninputhavingacertainnumberofdiscontinuitiescanhavethesamediscontinuities,butnotmore.Whiletheoutputofastrictlypropersystemis“moreregular”thanitsinput,theoutputofsuchasystemiscontinuousevenifitsinputisadiscontinuousfunction.Astrictlypropersystemthereforehasa“regularizing”effect.TheRLCcircuithavinginputu=Vandoutputy=iisastrictlypropercontrolsystem,soisthecaseofDCmotorwithtransferfunction(2.30),andtheheatedtankwithtransfermatrix(2.31).54LinearSystemsWeinsistedaboveonthefactthattheinputsandoutputsofasystemhavetobechoseninsuchamannerthattheresultingcontrolsystembeproper.Generally,thissystemisstrictlyproperforthissystemasitdoesnotinstantaneouslyreacttoasolicitationbecauseofits“inertia”.Toclarifyideas,consideranSISOsystematrestatinitialtimet=0(zeroinitialconditions).Taketheunitstepasinput,theresultingoutputisthereforethestepresponse(2.47).Forasystemwithacertaininertia,liketheDCmotor(whereitsoutputisy=θory=ω)forexample,thisstepresponsecannotgofromthevaluey=0(atinstantt=0−)toavalue≥α,α>0,att=0+:theangularspeedofthemotorcannot“jump”fromzerotoaquantity≥αwhenweapplyavoltagestepastheinput,andthisisequallytrue,afortiori,fortheangularposition.Physicalcontrolsystemsare,ingeneral,designedinsuchawaythattheyarestrictlyproper.REMARK49.–WehaveseenfromTheorem11thatitispossibletochooseaﬁnitesequence(u1,...,um)amongthevariablesofasystemsuchthatu=[u1,...,um]Tcanbeaninputofthissystem.Anotherquestioniswhethertheinputucanbechoseninsuchawaythattheresultingcontrolsystembeproper.Thisquestionisstudiedin[22].Obviously,thepropernessofacontrolsystemdependsnotonlyonthechoiceofitsinputs,butalsoonthechoiceofitsoutputs.Thedetailedanalysismadeinthecitedreference,whereanalgorithmisalsoproposedtorealizeinasystematicmannerthechoiceofu,showedtheimportanceofthenon-controllablepolesatinﬁnity,alsocalledtheinput-decouplingzerosatinﬁnity(anotionthatisbeyondthescopeofthiswork:see[16]or[22]).Consideraproper(orevenstrictlyproper)controlsystem;ifthatsystemhasuncontrollablepolesatinﬁnity,itcanstillgenerate–inresponsetoastepinputforexample–“impulsivemotions”,consistingoflinearcombinationsoftheDiracdistributionanditsderivatives,whichwillleadtothesystemdestruction.BipropersystemSomepurelyelectricalorelectronicsystemsareproperbutnotstrictlyproper,thesimplestexamplebeinganelectriccircuitconsistingofaresistanceRandavoltagegenerator.Theinputu=V(voltageacrosstheresistance)isrelatedtotheoutputy=i(electriccurrentintensitythroughtheresistance)bytherelationV=Ri.ThesystemtransferfunctionisthereforeG(s)=1R:whichisproper,butnotstrictlyproper.ItsinverseG−1(s)=Risdeﬁnedandisproper,thusG(s)isbiproper(seesection13.6.1).Forthisreason,thecorrespondingcontrolsystemisalsoqualiﬁedasbiproper.Itisquiterarehavingtocontrolaphysicalsystemofthisnature;ontheotherhand,itisquitecommonforacontrollertobebiproper.Ingeneral:DEFINITION50.–Alineartime-invariantsystemΣisbiproperifitstransfermatrixhasthisproperty.SystemsTheory(I)552.5.4.FrequencyresponseDeﬁnitionWeconsideronlytheSISOcasehere,theextensiontotheMIMOcaseistrivial(see,insection2.5.2,howthenotionofimpulseresponseisextendedtotheMIMOcase).Letu(t)=Acos(ω0t),t∈(−∞,+∞),asinusoidalsignal,betheinputofsystemΣ.Tocalculatetheoutputofthesystem,itisconvenienttowriteu(t)=Reuc(t),whereuc(t)=Aeiω0t.Letusexaminewhythisisso.TheresponseyofΣtotheinputuisequaltotheconvolutionproductg∗u,wheregdenotestheimpulseresponseofΣ.Likewise,the(ﬁctitious)responseycofΣtothe(ﬁctitious)inputucisequaltotheconvolutionproductg∗uc.WehavethereforeRe(g∗uc)=Reg∗Reuc,andsincegisreal,y=Reyc.1◦Firstofall,considerthecasewhereG(s)hasnopoleswithpositiverealpart.Theimpulseresponsegisthereforeatempereddistributionanditresultsaccordingtosection12.3.1in:F(g∗uc)=FgFuc.Now,(Fuc)(ω)=A(cid:2)+∞−∞ei(ω−ω0)tdt=2πAδ(ω−ω0)(see(12.34),section12.3.1).Therefore,FgFuc=(Fg)(ω0)FucandbytakingtheinverseFouriertransform,weobtainyc(t)=(Fg)(ω0)uc(t),andﬁnallyyc(t)=G(iω0)uc(t).(2.49)Bydeﬁnition,thefunction(ordistribution)ω(cid:3)→G(iω)iscalledthefrequencyresponseofthesystemΣ.ThisistheFouriertransformoftheimpulseresponse.Itisnoweasytocalculatetheoutputy(t)byusingthepolardecompositionofG(iω0):G(iω0)=|G(iω0)|eiargG(iω0).Weget:yc(t)=A|G(iω0)|e[iω0t+argG(iω0)],fromwhichy(t)=A|G(iω0)|cos[ω0t+argG(iω0)].(2.50)Expression(2.49),usingcomplexsignals,issimplerthan(2.50),whichusesrealsignals.Thatiswhyitisinterestingtoworkwithcomplexnumbers.REMARK51.–ThefrequencyresponseFgisalsodeﬁnedinthecasewhereG(s)haspolesontheimaginaryaxis,butitisasingulardistribution(notafunction).56LinearSystemsNevertheless,theoutput(2.50)isonlydeﬁnedifs=iω0isnotapoleofG(s).Thisoutputisthusdeﬁnedforallﬁnitevaluesofω0ifandonlyifG(s)hasnopolesontheimaginaryaxisandthusonlyhaspolesthathaveanegativerealpart(i.e.allpolesbelongtothelefthalf-plane5).Moreover,thesetoftheseresponsesisboundedwhenω0varies(andinparticulartendsto+∞)ifandonlyifG(s)isaproperrationalfunction,thenbelongingto(cid:1)H∞:seesection13.6.2.2◦TheabovedeﬁnitioncanbeextendedtoanytransferfunctionG(s)havingnopolesontheimaginaryaxis:itsfrequencyresponseisthefunctionω(cid:3)→G(iω).Ontheotherhand,thisfrequencyresponsecannolongerbedeﬁnedastheFouriertransformoftheimpulseresponse,sincethisFouriertransformdoesnotexist.Withthisgeneralizeddeﬁnition,thefrequencyresponseisstillthequantitywhichmultipliesasinusoidalinputeiωttoproducetheoutputsignal,providedthatthesystemisstabilizedbyfeedback.ExperimentaldeterminationofthefrequencyresponseofasystemThefrequencyresponseofasystemcanbedeterminedexperimentallyifthetransferfunctionG(s)isproperandhasonlypoleswithnegativerealpart(thisdoubleconditionisessential,asshowninRemark51;butasitturnsoutfromn◦2above,theproceduremaybeextendedtothecasewhereG(s)alsohaspoleswithpositiverealpartprovidedthatthesystemisstabilizedbyfeedback.Itisappropriatetooperateinthefollowingmanner:–Forarepresentativesetoffrequenciesω,putasinusoidalsignaluω(t)=Acos(ωt)atthesysteminput.Waitforasufﬁcientlylongtimeforthesteadystatetobereached(intheory,aswehaveseenabove,wehavetowaitaninﬁnitelylongtime).–Foreachofthefrequenciesωabove,measuretheoutputyω(t).Accordingto(2.50),theratiobetweentheamplitudeofyωandthatofuωisequalto|G(iω)|,andthephasedifferencebetweenyωanduωisgivenbyargG(iω).–Wethusobtain,pointbypoint,thefrequencyresponseG(iω).2.6.Diagramsandtheiralgebra2.6.1.DiagramofacontrolsystemLetΣbeasystemwithinputuandoutputy.AcommonusageincontroltheoryistorepresentΣbyaboxandsomearrows,asshowninFigure2.2.Wecallthisthesystemdiagram.5.Thisexpressionreferstothecomplexplane.Inwhatfollows,wecallthe“lefthalf-plane”theopensetC−={s∈C:Re(s)<0}.Itsclosure¯C−={s∈C:Re(s)≤0}iscalled“closedlefthalf-plane”.Similarly,wecalltheopensetC+={s∈C:Re(s)>0}the“righthalf-plane”anditsclosure¯C+={s∈C:Re(s)≥0}the“closedrighthalf-plane”.SystemsTheory(I)57uyFigure2.2.SystemdiagramSucharepresentationcanbeusedinverygeneralcasesandinparticularevenforasystemΣthatisnonlinearand/ortime-varying.Nevertheless,thisrepresentationsuggeststhatweareonlyinterestedintheinput–outputoperator˜ΣassociatedwithΣ.Inthelineartime-invariantcase,itdoesnotresultinalossofinformationifandonlyifΣisminimal(seesection2.5.1).Thisremainstrueinthenonlinearand/ortime-varyingcase[18].Inthelineartime-invariantcase,wecan(seeFigure2.2)replaceΣbyitstransfermatrixG(s).2.6.2.GeneralalgebraofdiagramsTherecanbeextremelydiverseconnectionsamongsystems[46].Weconsiderbelowconnectionsinparallel,inseries,andwithunitfeedback.Theﬁrsttwoconnectionscorrespondtoanadditionandtoamultiplication,respectively;thethirdisspeciﬁctosystemstheoryandisafundamentaloperationofthisscience.SystemsinparallelThesystemsΣ1andΣ2inFigure2.3aresaidtobe“inparallel”.LetΣbetheresultingsystem,withinputuandoutputy.Lety1andy2betheoutputsofΣ1andΣ2,respectively.Wehavey1=˜Σ1u,y2=˜Σ2u,y=y1+y2,asaresulty=˜Σu,˜Σ=˜Σ1+˜Σ2.(2.51)Figure2.3.Systemsinparallel58LinearSystemsyzu12Figure2.4.SystemsinseriesNotethatΣisnotnecessarilyminimal,evenifΣ1andΣ2areso[46].Expression(2.51)isvalideveninthenonlinearand/ortime-varyingcase.IfΣ1andΣ2arelineartime-invariantwithtransfermatricesG1(s)andG2(s),respectively,thenΣisagainlineartime-invariantanditstransfermatrixG(s)isgivenbyG(s)=G1(s)+G2(s).(2.52)SystemsinseriesThesystemsΣ1andΣ2inFigure2.4aresaidtobe“inseries”.ConsidertheresultingsystemΣ,withinputuandoutputy.TheoutputzofΣ1isequaltotheinputofΣ2.Wehavez=˜Σ1u,y=˜Σ2z,thereforey=˜Σu,with˜Σ=˜Σ2˜Σ1.(2.53)Thecompositionoftheoperatorsisdenotedbyamultiplication.ThesystemΣisnotnecessarilyminimal,evenifΣ1andΣ2areso[46].Expression(2.53)isvalideveninthenonlinearand/ortime-varyingcase.IfΣ1andΣ2arelineartime-invariantwithtransfermatricesG1(s)andG2(s),respectively,thenΣisagainlineartime-invariantanditstransfermatrixG(s)issuchthatG(s)=G2(s)G1(s).(2.54)Itisimportanttobeawarethattheproduct(2.54)isnotcommutativeintheMIMOcase.Regardingthecomposition(2.53),itisnotcommutativeinthenonlinearcase,evenifΣ1andΣ2areSISO.SystemsTheory(I)59v-+yuoFigure2.5.ElementaryfeedbackElementaryfeedbackConsiderthe“elementaryfeedback”inFigure2.5.ThesystemΣ0,withinputyandoutputv,iscalledthe“open-loopsystem”.The“closed-loopsystem”,withinputuandoutputy,isdenotedbyΣ.Wehavethefollowingrelations:v=˜Σ0y,y=u−v,thus(cid:9)Ip+˜Σ0(cid:10)y=u(2.55)wherepisthenumberofcomponentsofy.Wecanexpressyasafunctionofuonlyiftheoperator(cid:9)Ip+˜Σ0(cid:10)isinvertible.6Thenthefeedbacksystemissaidtobe“well-deﬁned”.InthecasewhereΣ0islineartime-invariant,withtransfermatrixG0(s),thefeedbacksystemiswell-deﬁnedifandonlyifIp+G0(s)isinvertibleinthealgebraR(s)p×p.Wewillreturntothisinsection4.1.2.Assumingthatthefeedbacksystemiswell-deﬁned,weobtainfrom(2.55)y=˜Σuwhere˜Σ=(cid:9)Ip+˜Σ0(cid:10)−1.(2.56)Expression(2.56)isvalideveninthecasewhereΣ0isnonlinearand/ortime-varying.Ifitislineartime-invariant,soitisalsoΣanditstransfermatrixG(s)canbeexpressedasafunctionofthetransfermatrixG0(s)ofΣ0asfollows:G(s)=[Ip+G0(s)]−1.6.Wewillnotexplainthemeaningofthisinvertibilityinthegeneralcase(see[116]forfurtherreadingonthissubject).60LinearSystemsFigure2.6.DiagramexampleApplicationexampleConsiderFigure2.6.Thethreerulesdevelopedabovecanbeappliedtodeterminetheinput–outputoperatorrelatingutoy.ThesystemΣdeﬁnedbythisdiagramisconstitutedbyputtingfoursystemsinseries:–thesystemΣ5;–theloopwithinputvandoutpute,whichisanelementaryfeedbacksuchasinFigure2.5with˜Σ0=˜Σ4˜Σ1(payattentiontotheorder!);–thesystemΣ1;–thesystemΣ3.Wehave,therefore,withtheassumptionthattheelementaryfeedbackiswell-deﬁned,y=˜Σuwith˜Σ=˜Σ3˜Σ1(cid:9)I+˜Σ4˜Σ1(cid:10)−1˜Σ5.(2.57)2.6.3.Speciﬁcityoflinearsystems“Multiplication”ofoperators,deﬁnedinsection2.6.2,isalwaysright-distributivewithrespecttoaddition;thismeans(asshownimmediately)(cid:9)˜Σ1+˜Σ2(cid:10)˜Σ3=˜Σ1˜Σ3+˜Σ2˜Σ3.Ontheotherhand,multiplicationisleft-distributivewithrespecttoadditiononlyinthecaseoflinearsystems(time-invariantornot).Moreprecisely,wehavetherelation˜Σ3(cid:9)˜Σ1+˜Σ2(cid:10)=˜Σ3˜Σ1+˜Σ3˜Σ2ifΣ3isalinearsystem.SystemsTheory(I)61TakeagaintheexampleinFigure2.6with,tosimplify,˜Σ3=Iand˜Σ5=I.Wehaveaccordingto(2.57),nomatterofwhatnaturearethesystemsΣ1andΣ4˜Σ=˜Σ1(cid:9)I+˜Σ4˜Σ1(cid:10)−1.SupposenowthatΣ1isalinearsystem.Wecanwritez=˜Σ1(cid:9)v−˜Σ4z(cid:10)fromwhichwehave(cid:9)I+˜Σ1˜Σ4(cid:10)z=˜Σ1vandﬁnally(assumingthattheloopiswell-deﬁned)z=(cid:9)I+˜Σ1˜Σ4(cid:10)−1˜Σ1.Wehavethusobtainedthefollowingresult,whichissimilartoLemma520(section13.3.3):THEOREM52.–IfΣ1isalinearsystem,wehavetheequality˜Σ1(cid:9)I+˜Σ4˜Σ1(cid:10)−1=(cid:9)I+˜Σ1˜Σ4(cid:10)−1˜Σ1.Thealgebraofdiagramsisthereforericherinthecontextoflinearsystemsthaninthatofnonlinearsystems.Itispossibletoderiverulesthatallowthesimpliﬁcationoflineardiagramswithsmallcalculations,inparticularthe“Masonrule”(seee.g.[77]).2.7.ExercisesEXERCISE53.–DeterminethetransferfunctionofthetraininFigure1.3,withinputtheforcefandoutputthepositiony=z2.Whatarethetransmissionpolesandzerosofthissystem?EXERCISE54.–SamequestionsasaboveforthecaseoftheDCmotor,wheretheoutputchosenisy=ω(speedcontrol).EXERCISE55.–*LetG(s)havethefollowingexpression:(a)#s+1(s−1)21(s+1)(s−1)0(s+1)2(s−1)3$;(b)#1(s+1)21(s+1)(s+2)1(s+1)(s+2)s+3(s+2)2$;(c)#1(s+1)21(s+1)(s+2)1(s+1)(s+2)s+1(s+2)2$.62LinearSystemsInthesethreecases,determinetheMacMillanpolesandzerosofthetransfermatrix.Whatisthetransmissionorderofasystemthathassuchatransfermatrix?EXERCISE56.–DeterminetheequilibriumpointsofthedoubleinvertedpendulumofExercise2(section1.5)andlinearizethissystemaroundthepointsy∗=0,θ∗1=θ∗2=0.EXERCISE57.–SameproblembutforthemixerofExercise3.EXERCISE58.–InthecaseoftheinvertedpenduluminFigure1.4,linearizedasabove,whatisthenumberofinputvariables?Whichonecanbereasonablychosenasthecontrolvariable?Thetwomeasuresbeingzandθ,arethereanylatentvariables?Willarepresentationotherthan(2.7)havelatentvariables?EXERCISE59.–WeconsiderthemixerlinearizedinExercise57.Whatisthenumberofinputvariables?Whichonesaretobechosen?Howmanyvariableswillneedtoberegulated?Andwhatarethey?EXERCISE60.–Manynonlinearcontrolsystemsaredescribedbyanonlinearstaterepresentationofthefollowingform:˙x=f(x,u),y=g(x,u),wherefandgareofclassC1.(i)Let(x∗,u∗,y∗)beanequilibriumpoint.Whataretherelationsthatthesequantitiesmustsatisfy?(ii)Writedownthestateequationsofthelinearizedsystemaboutthisequilibriumpoint.Chapter3Open-LoopSystemsInthischapter,weonlyconsiderlineartime-invariantSISOsystemsunlessotherwisestated.3.1.Stabilityandstaticgain3.1.1.StabilityDEFINITION61.–ThelinearsystemΣ(assumedtobeminimal)issaidtobestableifitstransferfunctionG(s)(assumedtoberational)isproperandifallitspolesbelongtothelefthalf-plane.1ThisdeﬁnitionisalsovalidinthecaseofanMIMOsystem;thenG(s)isthetransfermatrixoftheminimalsystemΣandthepolesofthissystemcoincidewiththeMacMillanpolesofG(s)(seesection2.4.4).Wehavealreadyseenthisdoublecondition(seeRemark51insection2.5.4).Asaresult,stabilityistheconditionthatallowsforan“open-loop”experimentaldeterminationofthefrequencyresponseofasystem.Thesetoftransferfunctionsthatsatisﬁestheabovedoubleconditioniswrittenas(cid:1)H∞(and(cid:1)Hp×m∞intheMIMOcasewithminputsandpoutputs)(seesection13.6.2).Wecallthisset:thesetofstabletransferfunctions.1.Seesection2.5.4,footnote5.63Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.64LinearSystemsAsaresultofTheorem589(section13.6.2),asystemisstableif,inwaysthatareequivalent:–itsoutputissolongasitsinput,–itsoutputhasﬁniteenergyaslongasitsinputhasﬁniteenergy(with,inaddition,acontinuityconditionthatisspeciﬁedinthepreviouslycitedtheorem).3.1.2.StaticgainCaseofastablesystemLetΣbeastablelinearsystem,andfbeitsstepresponse.Itisgivenasin(2.46),whereh∈L1.Ithasalimitasttendsto+∞,givenbylimt→+∞f(t)=g0+(cid:2)+∞0h(τ)dτ.Wecanapplytheﬁnalvaluetheorem(seesection12.3.4):theLaplacetransformoffisˆf(s)=ˆg(s)s,sothatlimt→+∞f(t)=lims∈R,s→0+sˆf(s)=lims∈R,s→0+ˆg(s)=ˆg(0).(3.1)Thisquantityiscalledthestaticgainofthesystem(orofitstransferfunction).Accordingto(3.1),thestaticgainhasseveralinterpretations,whichofcourseareequivalent:(i)Inthetimedomain,itistheﬁnalvalueofthestepresponse.(ii)Inthefrequencydomain,itisˆg(0)=Fg(0):frequencyresponseofasystematfrequencyzero.(iii)Wecanalsosaythatitisthegainmultiplyingaconstantsignaluproducinganoutputy(alsoconstant).CaseofanunstablesystemLetΣbeanunstablesystemhavingnotransmissionpoleats=0,sothatthequantityˆg(0)isdeﬁned.Wecanalsocallthisquantitythestaticgainofthesystem.Interpretation(i)isnolongervalid(theﬁnalvalueofthestepresponseisnolongerdeﬁned);in(ii)theequalityˆg(0)=Fg(0)isnolongertrue,sincetheFouriertransformFgisnotdeﬁned;and,ﬁnally,(iii)remainsvalidifthesystemisstabilizedbyfeedback.Open-LoopSystems653.2.First-ordersystems3.2.1.TransferfunctionThetransferfunctionofaﬁrst-ordersystem,assumedtobestrictlyproper,isoftheformG(s)=bs−a.(3.2)Asaresult,thissystemhasauniquepoles=a;andtherefore,itisstableifandonlyifa<0.Letusconsidersuchacase(thecaseofanunstablesystemwillbetreatedatsection3.2.5).Letk=−baandτ=−1a.Then,thesystemtransferfunctioniswrittenasG(s)=k1+τs.(3.3)Thequantityτ>0,whichrepresentsaperiodoftime,iscalledthetimeconstantofthesystem.Itisimmediatelyclearthatkisthestaticgain.3.2.2.TimedomainresponsesImpulseresponseTheimpulseresponsegofthissystemistheinverseLaplacetransformofG(s),i.e.g(t)=beat1(t)=kτe−tτ1(t).Inparticular,g(0+)=kτ.ThegraphofthisfunctionisrepresentedinFigure3.1(solidline)wherek=1(unitstaticgain)andτ=10s.StepresponseThestepresponseisthefunctionhdeﬁnedbyh(t)=(cid:2)t0g(τ)dτ=ba(cid:15)eat−1(cid:16)1(t)=k(cid:9)e−tτ−1(cid:10)1(t).(3.4)ThegraphofthisfunctionisrepresentedinFigure3.2(solidline)fork=1(unitstaticgain)andτ=10s.Notethatthestepresponseiscontinuousattheorigin(whichisduetothefactthatthetransferfunctionisproper)contrarytotheimpulseresponse(thederivativeofthestepresponse).WeseeinFigures3.1and3.2howtoconstructtheslopeattheorigin(dashedlines)fromthetimeconstantτ,fortheimpulseresponseandthestepresponse,respectively.66LinearSystems010203040506000.010.020.030.040.050.060.070.080.090.1Impulse ResponseTime (sec)AmplitudeFigure3.1.Impulseresponseofaﬁrst-ordersystem010203040506000.10.20.30.40.50.60.70.80.91Step ResponseTime (sec)AmplitudeFigure3.2.Stepresponseofaﬁrst-ordersystemOpen-LoopSystems673.2.3.FrequencyresponseThefrequencyresponseisthe(complex-valued)functiondeﬁnedbyFg(ω)=G(iω)=k1+iτω.Thereareseveralwaystorepresentthisfrequencyresponse:–Amplitudeandphaseasafunctionofthefrequency:thisistheBodeplotrepresentation.–CurvesthattracetheevolutionofthecomplexnumberFg(ω)=G(iω)inthecomplexplaneasafunctionoftheparameterω:thisistheNyquistplotrepresentation.–Curvesthattracetheevolutionofthecoordinates(|Fg(ω)|,argFg(ω))asafunctionoftheparameterω:thisistheBlackplot.NyquistandBlackplotsareonlyinterestingforthestudyofclosed-loopsystems,whichisdonelater.Atthismoment,wewillstudythefrequencyresponseusingBodeplotsonly.3.2.4.BodeplotMagnitudeWehave,assumingk>0,|G(iω)|=k√1+τ2ω2.(3.5)Thisnumber,expressedindecibels,iscalledthemagnitudeofG(iω).Wehavebydeﬁnition2|G(iω)|dB=20log|G(iω)|.(3.6)Ontheotherhand,wewillonlyconsiderpositivefrequencies,withoutgeneratinganylossofinformationsinceFg(−ω)=Fg(ω)andwewillplotthesefrequenciesonalogarithmicscale.2.Throughoutthistext,wedenotebylogthedecimallogarithm,whereasthenaturallogarithmisdenotedbyln.68LinearSystemsFor0<τω(cid:16)1:|G(iω)|dB∼=20logk(3.7)(withanerrorthattendsto0whileω→0+).Forτω(cid:18)1:|G(iω)|dB=20logk−10|G(iω)|dB=20logk−20log(cid:15)1+τ2ω2(cid:16)=20logk−20log(τω)−10log(cid:21)1+1τ2ω2(cid:22)∼=20logk−20log(τω)(3.8)(withanerrorthattendsto0whileω→+∞).Thislastexpressionisalinethathasaslopeof−20dBperdecade(thefrequencychangesbyadecadewhenitismultipliedby10,anoctavewhenmultipliedby2;arateofchangeof−20dBperdecadecorrespondstoapproximatelyarateofchangeof−6dBperoctave).Asaresult,theBodemagnitudeplothastwoasymptotes:–thehorizontalasymptote(3.7),forlowfrequencies;–theobliqueasymptote(3.8),forhighfrequencies.Thesetwoasymptotesintersectatthe“cornerpoint”atabscissaω=1τ,andformwhatwecallthe“asymptoticBodemagnitudecurve”.Forω=1τ,|G(iω)|dB=20logk−20log2(cid:9)20logk−3.Thus,atthe“cornerfrequency”point,theBodemagnitudecurveis3dBbelowitsasymptoticcurve.PhaseOntheotherhand,wehaveargG(iω)=−arctan(τω).(3.9)Thisargument,expressedindegrees,iscalledthephaseofG(iω).Itisequallytracedasafunctionofω,thislastvariableisrepresentedinalogarithmicscale,andwecallthisgraphthe“Bodephaseplot”.Open-LoopSystems69-20-18-16-14-12-10-8-6-4-20Magnitude (dB)10-2100101-90-60-300Phase (deg)Bode DiagramFrequency  (rad/sec)Figure3.3.Bodeplotofaﬁrst-ordersystemItisclearthatlimω→0argG(iω)=0◦limω→+∞argG(iω)=−90◦.TheBodephaseplothastwohorizontalasymptotes,at0◦forlowfrequenciesandat−90◦forhighfrequencies.Atthecornerfrequencyasdeﬁnedbefore,wehaveargG(cid:21)iτ(cid:22)=−arctan1=−45◦BodeplotThesetofthetwoBodecurves,thatofthemagnitudeandthephase,formthe“Bodeplot”,onwhichweoftenaddthe“asymptoticdiagram”,asisshowninFigure3.3(correspondingtok=1andτ=10);theBodeplotisathinrigidbodylinewhiletheasymptoticplotisathickerdashedline.3.2.5.Caseofanunstableﬁrst-ordersystemAﬁrst-orderunstablesystemhasatransferfunctionoftheform(3.2)witha≥0.70LinearSystemsIntegratorsystemFirst,considerthecasewherea=0,i.e.G(s)=bs.Assumingthatb>0(thecaseb=0istrivialandthecaseb<0isonlydifferentbyachangeofsign),wecanputb=1τ,τ>0.Therefore,G(s)=1τs.Consequently:(cid:127)|G(iω)|=1τω,fromwhichwehaveforω>0:20log|G(iω)|=−20log(τω).TheBodemagnitudeplotisthereforeastraightline,withaslopeof−20dBperdecade.Wehave|G(iω)|=1(whichis0dB)forω=1τ.(cid:127)argG(iω)=−90◦.SystemwithapositivepoleConsidernowthecasewherea>0.WecanwriteG(s)intheformG(s)=k1−τs.Asaresult,G(iω)=k1−τiωandso|G(iω)|=k√1+τ2ω2,whichisidenticalto(3.5):ifthepoleischangedtoitsopposite,theamplituderemainsunchanged.Ontheotherhand,argG(iω)=arctan(τω),anexpressionthatisofoppositesignto(3.9):ifthepoleischangedtoitsopposite,thephaseischangedinthesameway.3.3.Second-ordersystems3.3.1.TransferfunctionConventionsThetransferfunctionofasecond-ordersystem,assumedtobestrictlyproper,isoftheformG(s)=b1s+b2s2+a1s+a2.Open-LoopSystems71Ifb1(cid:5)=0,thissystemhasazero(oftransmission)z=−b2b1;ifb1=0,thissystemhasnozero.Inwhatfollowsinthissection,wewillonlybeinterestedinasystemwithoutzero(b1=0);seesection3.4forastudyofthegeneralcase.PolesThediscriminantofthedenominatoris∆=a21−4a2.–If∆≥0,G(s)hastworealpoles(indistinctfor∆=0)andisthustheproductoftwoﬁrst-ordertransferfunctions.Wearethereforeledtothesamestudyasbefore(seesection3.4formoredetails).–If∆<0,wehavenecessarilya2>0,andwecanputa2=ω20,ω0>0.Toclarifythecalculations,wecanfurtherputa1=2ςω0,b2=kω20.Withtheseconventions,thesystemtransferfunctioncanbewrittenasG(s)=kω20s2+2ςω0s+ω20.Wehavek=G(0),thuskisthestaticgain.Thereduceddiscriminantofthedenominatoris∆(cid:2)=ω20(cid:15)ς2−1(cid:16).Since∆(cid:2)<0,wehave|ς|<1andthepolesare(cid:7)−ςω0−iω0%1−ς2,−ςω0+iω0%1−ς2(cid:8).Thesystemisstableifandonlyifthesetwocomplexconjugatepoleshavenegativerealparts,i.e.ifς>0.ThesetwopolesthenlieinthecomplexplaneasshowninFigure3.4.Thequantityω0istheabsolutevalueofbothpolesconsidered,i.e.thedistanceinthecomplexplanebetweenanyofthesepolesandtheorigin.Wecallthistheundampednaturalfrequency.TheangleΨinFigure3.4isrelatedtoςbytherelationς=sinΨ.Thisςtermiscalledthedampingcoefﬁcient.3.3.2.TimedomainresponsesThetwotypicaltimedomainresponses(impulseandstep)arenowlookedatinthecaseofunitystaticgain(k=1).72LinearSystemsFigure3.4.ComplexconjugatepolesImpulseresponseTheimpulseresponsegisgivenbyg(t)=L−1G(s)=L−1(cid:20)ω20s2+2ςω0s+ω20&=ω0√1−ς2e−ςω0tsin(cid:9)ω0%1−ς2t(cid:10)1(t).(3.10)Thisresponseoscillatesatthenaturalfrequencyωp=ω0√1−ς2.Theimpulseresponse(3.10)isplottedinFigure3.5forω0=10rad/sandfordifferentpositivevaluesofthedampingcoefﬁcientς:0.1(‘-’),0.3(‘--’),0.5(‘-.’),and0.7(‘:’).3Weobservethatthesmallerthevalueofthedampingcoefﬁcient,themoreoscillatorytheimpulseresponse.Forς=0,theimpulseresponsebecomespurelysinusoidalwithfrequencyω0(fromwhichcomesthenameofthisoscillation).3.Thatisrigidbody,dashed,dash-dotted,dottedlines,respectively.Open-LoopSystems73Figure3.5.Impulseresponseofasecond-ordersystemStepresponseThestepresponseisthefunctionhdeﬁnedbyh(t)=(cid:2)t0g(τ)dτ=(cid:27)1−e−ςω0t(cid:21)cosωpt+ς√1−ς2sinωpt(cid:22)(cid:28)1(t).(3.11)ThisstepresponseisplottedinFigure3.6forω0=10rad/sandforς=0.1,0.3,0.5,and0.7(withthesameconventions).Themaindifferencewiththeimpulseresponseistheﬁnalvalue:1(becausethestaticgainofG(s)is1)insteadof0(ofcourse,thisﬁnalvalueisonlydeﬁnedforς>0,i.e.whenthesystemisstable).Themaximumofthestepresponsehisobtainedattheﬁrsttimethatitsderivativegiszero,thatist=πωp.Thismaximumisthereforeh(cid:21)πωp(cid:22)=1+e−ςπ√1−ς2(cid:1)M(ς).Thegraphofthefunctionς(cid:3)→M(ς)isrepresentedinFigure3.7(forς∈[0,1)).Weobservethattheovershootiszeroforς=1,isoftheorderof5%forς=0.7,andoftheorderof10%forς=0.6;ittendsto100%whenςtendsto0.74LinearSystemsFigure3.6.Stepresponseofasecond-ordersystem00.20.40.60.8111.11.21.31.41.51.61.71.81.92Figure3.7.OvershootasafunctionofthedampingcoefﬁcientOpen-LoopSystems753.3.3.BodeplotThefrequencyresponseofthesystemisgivenbyG(iω)=ω20ω20−ω2+2iςω0ω=11−υ2+2iςυwhereυ(cid:1)ωω0isthenormalizedfrequency.StudyoftheamplitudeThesquareoftheamplitudeofG(iω)is|G(iω)|2=1(1−υ2)2+4ς2υ2.Thisquantityisindependentofthesignofthedampingcoefﬁcientς;withoutlossofgenerality,letς>0(caseofastablesystem).ThisvaluebecomesamaximumwhenitsdenominatorDisminimum.Ontheotherhand,thisisafunctionofonly=υ2.WehavedDd=2(cid:15)υ2−1(cid:16)+4ς2=2(cid:25)υ2−(cid:15)1−2ς2(cid:16)(cid:26).(3.12)Thereforei)Forς>√22:Thederivative(3.12)willnotbezero,andsothefunctionω(cid:3)→|G(iω)|doesnothaveamaximumon(0,+∞).Wesaythatthesystemdoesnothavearesonance.ii)For0<ς<√22:Thederivative(3.12)becomeszeroforυ=√1−2ς2,i.e.forω=ωrwithωr(cid:1)ω0√1−2ς2.Thisfrequencyωristhatatwhich|G(iω)|attainsitsmaximumon(0,+∞):itistheresonancefrequency.Wecaneasilyverifythat|G(iωr)|=12ς√1−ς2.Thisquantityistheratiobetweenthemaximumvalueof|G(iω)|andthestaticgain(whichis1inthiscase).Thisvalueiscalledtheresonancefactorandisdenotedbyλ.ItissometimesexpressedindecibelsanddenotedbyQ:Q=20logλ.Notethatforthesmallvaluesofς,wehaveωr(cid:9)ω0andλ(cid:9)12ς.76LinearSystemsAsaresult,whenthedampingcoefﬁcientςtendsto0,theresonancefactortendsto+∞.Inaddition,theresonancefrequencyωraswellasthenaturalfrequencyωptendtowardstheundampednaturalfrequencyω0.Letu(t)=Acos(ωt),asinusoidalsignalofamplitudeA,betheinputofthesystem.Asshowninsection2.5.4,theoutputisasinusoidalsignalofamplitudeA|G(iω)|.Thisamplitudeismaximumwhenω=ωr,andthismaximumamplitudetendsto+∞whenςtendsto0.Thisshowsthatthesystembecomesunstablewhenitsdampingcoefﬁcienttendsto0,sincewecanﬁndaboundedinputtowhichcorrespondsanunboundedoutput(whichcontradictsPropertyv)ofTheorem589,giveninsection13.6.1.iii)Forς=√22:Thisisthevaluethatmakesthetransitionbetweentheabsenceorpresenceofresonance.Thisnumber(cid:9)√22(cid:9)0.7(cid:10)iscalledthecriticalvalueofthedampingcoefﬁcient(orofthedamping).Recallthataccordingto(3.12)dDd(0)=−2(cid:15)1−2ς2(cid:16)ω20.Thisquantityiszeroifandonlyifthesystemiscriticallydamped.Itisobviousthatitisalsotrueford|G|dω(0).Thecriticaldampingthereforehappenswhenthegraphoftheamplitude,|G|asafunctionofthefrequencyω,hasaahorizontaltangentatω=0(theamplitudeandthefrequencyarebothplottedinalinear–andnotlogarithmic–scaleinthiscase).StudyofthephaseWehaveargG(iω)(cid:1)ϕ(υ)=(cid:20)−arctan2ς1−υ2ifυ<1⇔ω<ω0,−arctan2ς1−υ2−πifυ>1⇔ω>ω0.Weseethatifwechangeςto−ς,ϕ(υ)ischangedto−ϕ(υ).CaseofastablesystemAssumethatς>0.Wehaveinparticular–Forυ→0,ϕ(υ)→0.–Forυ→+∞,ϕ(υ)→−π.–Forυ→1,ϕ(υ)→−π2,andthisfunctionϕ(υ)iscontinuousatυ=1.Open-LoopSystems77Ontheotherhand,dϕdυ=−11+(cid:9)2ς1−υ2(cid:10)2(2ς)2υ(1−υ2)2=−4ςυ(1−υ2)2+4ς2thereforedϕdυ(1)=−1ς.Thevariationofthephaseinthevicinityofυ=1isthereforeallthemorerapidasthedampingcoefﬁcientisweakened.CaseofanunstablesystemAsalreadymentioned,asignchangeinthedampingcoefﬁcientimpliesasignchangeinphase.Theabovestudyremainsvalid,apartfromadifferenceinsign.BodeplotinlogarithmicscaleAsfortheﬁrst-ordersystemalreadystudied,wecannowplottheamplitudeandthephaseasafunctionoffrequency(toprovideamoreintrinsiccharactertothesecurves,wehavechosentousethenormalizedfrequencyontheabscissa);theamplitudeisexpressedindecibels,thephaseisexpressedindegrees,andalogarithmicscaleisusedforthefrequency.ThisrepresentationmakesapparenttheBodeasymptoticcurves:–Forυ→0,|G(iω)|→1(i.e.0dB).–Forυ→+∞,|G(iω)|∼1υ2,andtherefore20log|G(iω)|=−40logυ+(termsthattendto0whenυ→+∞).Theasymptoticdiagramofthemagnitudethusconsistsoftwolinesegments:–Ahorizontallinesegment,at0dB(or,moregenerally,thevalueofthestaticgainexpressedindecibels).–Alinesegmentofslope−40dBperdecade.Thesetwolinesegmentsintersectattheabscissapointυ=1(i.e.ω=ω0).Theasymptoticdiagramofthephasefollowsimmediatelyfromthestudyofthephasemadeabove.WeﬁnallyobtaintheBodeplotsinFigure3.8,correspondingtodampingratios0.1,0.3,0.5and0.7,withthesameconventionsasabove.Theasymptoticdiagramisalsoplotted.78LinearSystems20Bode DiagramFrequency (rad/sec)0–20–40–60–800–45–90–135–18010–210–1100101102Phase (deg)Magnitude (dB)Figure3.8.Bodeplotofasecond-ordersystem3.4.Systemsofanyorder3.4.1.StabilityConsiderthesystemofordern≥1representedbytheleftform(2.17).ItstransferfunctionG(s)=N(s)/D(s)isproperifandonlyif(i):d◦(N)≤d◦(D)(seesection13.6.1).Thissystemisminimalifandonlyif(ii):thepolynomialsN(s)andD(s)arecoprime(accordingtoDeﬁnition33ofsection2.4.6).SupposeConditions(i)and(ii)aresatisﬁed.Therefore,accordingtoDeﬁnition61(section3.1.1),thesystemconsideredisstableifandonlyifCondition(iii),givenbelow,issatisﬁed:(iii)AllrootsofthepolynomialD(s)belongtolefthalf-plane.DEFINITION62.–ApolynomialD(s)∈R[s]issaidtobeHurwitzifCondition(iii)aboveissatisﬁed.WriteD(s)=n(cid:12)j=0ajsn−j,a0(cid:5)=0.(3.13)PROPOSITION63.–ForapolynomialD(s)tobeHurwitz,itisnecessarythatallthecoefﬁcientsaj(0≤j≤n)beofthesamesign.Open-LoopSystems79PROOF.ThepolynomialD(s)canbefactorizedintothefollowingformD(s)=a0’k(s+αk)’l(s+βl+iγl)(s+βl−iγl)=a0’k(s+αk)’l(cid:15)s2+γ2l+2βl(cid:16)whereαk>0,βl>0ifD(s)isHurwitz.Indevelopingtheaboveexpression,weobtain(3.13)withallthecoefﬁcientsaj(0≤j≤n)ofthesamesignasa0.REMARK64.–(i)TheconditioninProposition63isnecessary,butnotsufﬁcient,forthepolynomialD(s)tobeHurwitz,exceptifn≤2.Inthegeneralcase,anecessaryandsufﬁcientconditionisprovidedbytheRouthcriterion,whichwewillnotelaborate(seee.g.[26]).(ii)Itisequallypossible,thankstoanextensionoftheRouthcriterion,todeterminethenumberofrootsofD(s)thatbelongtotherighthalf-plane[6].(iii)Atlast,supposethecoefﬁcientsajofD(s)areuncertaininthesensethateachofthemsatisﬁestheboundsaj≤aj≤aj,andonlythelowerandupperbounds,ajandaj,areknown.LetDbethesetofpolynomialsD(s)whosecoefﬁcientsaj(0≤j≤n)satisfytheaboveconditions.AcriterionowedtoKharitonovprovidesanecessaryandsufﬁcientcondition,dependingonlyontheboundsajandaj(0≤j≤n),forallpolynomialsbelongingtoDtobeHurwitz(seee.g.[7]).Whenaj=aj(0≤j≤n),theKharitonovcriterionreducestotheRouthcriterion.3.4.2.DecompositionofthetransferfunctionThetransferfunctionG(s)ofasystemofordern≥1isoftheformG(s)=(kNk(s)(kDk(s)where1Nk(s)and1Dk(s)aretransferfunctionsoftheﬁrstorder,orofthesecondorderwithtwocomplexconjugatepoles.Thestudyofthese“elementarytransferfunctions”hasbeendoneabove.Wehavelog|G(iω)|=(cid:12)klog))))1Dk(iω)))))−(cid:12)klog))))1Nk(iω))))),(3.14)argG(iω)=(cid:12)karg(cid:21)1Dk(iω)(cid:22)−(cid:12)karg(cid:21)1Nk(iω)(cid:22).Therefore,weeasilyobtainthecurvesofG(s)(amplitudeandphase)fromtheBodeplotsoftheelementarytransferfunctions1Nk(s)and1Dk(s).80LinearSystemsREMARK65.–From(3.14),itiseasytoshowthattheBodemagnitudeasymptoticdiagramhasaslopeof−20δ(G)dB/decadeinthehighfrequencies,whereδ(G)istherelativedegreeofthetransferfunctionG(s)(seesection13.6.1).3.4.3.AsymptoticBodeplotConstructionofasymptoticplotTheasymptoticBodeplotofG(s)isparticularlysimpletoconstruct.Themethodisasfollows:i)Determinetheabscissaeofthe“cornerfrequencies”oftheasymptoticdiagram,whicharetheabsolutevaluesofthepolesandzeros.Placethemontheaxisoftheabscissae.ii)Foreachofthecornerfrequencies,applythefollowingruletothevariationofslopeofthemagnitudeandthevariationofphase,arulewhichfollowsfrompreviousresults:StablepoleUnstablepoleStablezeroUnstablezero∆(slope)−20dB/dec.−20dB/dec.20dB/dec.20dB/dec.∆(phase)−90◦90◦90◦−90◦TableoftheruleofcornerfrequenciesWecallastable(resp.,unstable)poleapolewhichhasnegative(resp.,non-negative)realpart,andsimilarlyforazero.Example1LetG(s)=100(s−1)s(s+10).–Thecornerfrequenciesare:ω=0(correspondingtothepoles=0),ω=1(correspondingtotheunstablezeros=1)andω=10(correspondingtothestablepoles=−10).–ConstructtheasymptoticBodeplotatlowfrequencies:forω→0,G(iω)∼−10iω.Amplitude:slope−20dB/decadepassingthroughthepoint(cid:15)ω=1,|G|dB=20(cid:16).Phase:90◦(modulo360◦).–Therestofthediagramcanbeobtainedbyapplyingthe“cornerfrequency”rulefromtheabovetable.TheasymptoticplotobtainedisrepresentedinFigure3.9(dashedlines),alongwiththe“true”Bodeplot(solidlines).Thephasevariesfrom90◦to−90◦.Open-LoopSystems81-1001020304050 Magnitude (dB)10-1100101102-90-4504590Phase (deg)Frequency (rad/sec)Figure3.9.Bodeplot–Example1Example2LetG(s)=s(s+10)(s2−s+100)(s+1).–Thecornerpointsareω=0(correspondingtothezeros=0),ω=1(correspondingtothestablepoles=−1),andω=10(correspondingtothestablezeros=−10aswellastotwounstablecomplexconjugatepoleswithabsolutevalue10).–Constructtheasymptoticplotinthelowfrequencies:forω→0,G(iω)∼iω10.Amplitude:slopeof20dB/decadepassingthroughthepoint(cid:15)ω=1,|G|dB=−20(cid:16).Phase:90◦.–Thecornerfrequencyatω=1posesnoproblem.–Atthecornerpointω=10,wemustaccountfor:-theeffectofthezero,whichinducesavariationofslopeofmagnitudeof+20dB/decadeandavariationofphaseof+90◦;-theeffectofthetwocomplexconjugatepoles,whichinducesavariationofslopeofmagnitudeof−40dB/decadeandavariationofphaseof+180◦;-i.e.intotal:avariationofslopeofmagnitudeof−20dB/decadeandavariationofphaseof+270◦.TheasymptoticplotobtainedisdepictedinFigure3.10,togetherwiththe“true”Bodeplot(withthesameconventionsasforFigure3.9).Notethatthetrueplotseparatessigniﬁcantlyfromtheasymptoticplotatthevicinityofresonance.82LinearSystems-50-40-30-20-10010Magnitude (dB)Frequency (rad/sec)10-1101102100-360-270-180-90Phase (deg)Figure3.10.Bodeplot–Example23.4.4.Amplitude/phaserelationAmplitude/phaserelationintheasymptoticBodeplotThetableofthe“cornerfrequencyrule”showsthatthecompleteasymptoticBodeplotofasystemisentirelydeterminedbyitsasymptoticdiagramofmagnitudeifweassumethatthissystemonlyhasstablepolesandzeros.Suchasystemisstable(apropertythatfollowsfromthestabilityofitspoles);wearenowgoingtoidentifywhichpropertyfollowsfromthestabilityofitszeros.MinimumphasesystemsTheoppositeofitsphase,thatis−argG(iω),iscalledthephaseshiftofthesystem(orofitstransferfunction).Letzbeacomplexnumberwithnegativerealpart,andletG(s)andG∗(s)betwostabletransferfunctionssuchthatG∗(s)=s+zs−zG(s).Wehave))))iω+ziω−z))))=1andaccordingtothe“tableofthecornerfrequencyrule”,thephaseofthetransferfunctions+zs−zdecreasesfrom0◦to−180◦whenthefrequencygoesfrom0to+∞.Open-LoopSystems83Asaresult,theamplitudeA(ω)ofG∗(s)isequaltothatofG(s)atallfrequencies,whereasthephaseshiftofG∗(s)ishigherthanthatofG(s).Withthesamerationale,weimmediatelyestablishthefollowingresult:THEOREM66.–Giventheamplitudeω(cid:3)→A(ω)ofthefrequencyresponseofastabletransferfunction,thereexistsaninﬁnitenumberofstabletransferfunctionshavingafrequencyresponsewiththesameamplitude.Amongthesetransferfunctions,thereexistsauniqueoneG(s)whosephaseshiftisminimum:allzerosofthishaveanegativerealpart.AlltheothersareoftheformG∗(s)=G(s)’ks+zks−zkwheretheproductisﬁniteandthezkarecomplexnumbersinthelefthalf-plane(providedthat¯zkappearsintheproductifzkdoes,fortherationalfunctionG∗(s)tohaverealcoefﬁcients).DEFINITION67.–Astablesystemissaidtohaveminimumphaseifallitstransmissionzerosbelongtothelefthalf-plane(inotherwords,ifitstransferfunctionhasastableinverse),andnon-minimumphaseotherwise.REMARK68.–Byextension,aminimalcontrolsystem,possiblyunstableand/orMIMO,issaidtohaveminimumphaseifallitstransmissionzeroslieinthelefthalf-plane.Bode’amplitude/phaserelationsForaminimumphasesystem,wehaveseenabovethattheasymptoticdiagramofthephaseiscompletelydeterminedbytheasymptoticdiagramofthemagnitude.Wecangoalittlefurther,andshowthatthephaseargG(iω)itselfisentirelydeterminedbythemagnitudeA(ω)=ln|G(iω)|.4Indeed,wehavethefollowingresult:foranyfrequencyωc≥0,argG(iωc)−argG(0)=2π(cid:2)+∞0A(ω)−A(0)ω2−ω2cdω=1π(cid:2)+∞−∞dAdν(cid:27)lncoth|ν|2(cid:28)dν(3.15)whereν=ln(cid:9)ωωc(cid:10).(Foracompleteproof,see[9],Chapter14,or[39],section7.2).4.Forconvenience,weconsiderln|G(iω)|,thenaturallogarithmof|G(iω)|,ratherthan20log|G(iω)|,theexpressionofmagnitudeindecibels.84LinearSystems-2.5-2-1.5-1-0.500.511.522.500.511.522.533.544.55Figure3.11.DensityfunctionpsiThisrelation,oftencalledBode’samplitude/phaserelation,isalsocalled(morejustly)theBayard–Boderelation.Putψ(ν)=lncoth|ν|2inawaythataccordingto(3.15),argG(iωc)−argG(0)=1π(cid:2)+∞−∞dAdνψ(ν)dν.(3.16)Thegraphofthe“densityfunction”ψisplottedinFigure3.11.Notethatψisapositiveevenfunctionandthatψ(ν)tendsto+∞asνtendsto0.Inaddition,onecanshowthat(cid:2)+∞−∞ψ(ν)dν=π22.(3.17)ApproximationofphasefrommagnitudeSupposethattheslopeofthemagnitude(i.e.anelementofZis−20ndB/decadeinthevicinityofthefrequencyωc,wherenisarationalinteger).Assumealsothatthisneighborhoodisanintervalofkdecadescenteredaroundωc(frequenciesarerepresentedinalogarithmicscale).Gettingbacktovariableν,thismeansthattheslopeofmagnitudeis−20ndB/decadeforν∈(cid:25)−k2ln10,k2ln10(cid:26).Open-LoopSystems85–Fork→+∞,wehaveexactly,accordingto(3.16)and(3.17),argG(iωc)=argG(0)−nπ2.(3.18)Thisisalsothevaluewegetbyusingthe“tableofcornerfrequencyrule”oftheBodeasymptoticdiagram.–Forﬁnitek,thevalue(3.18)isobviouslyonlyanapproximationofthephase,theprecisionofwhichdependsnotonlyonk,butalsoontheslopeofmagnitudeoutsidetheinterval(cid:25)−k2log10,k2log10(cid:26)ofvaluesofν.Togiveanideaoftheerrorthatcanbemadeifweuse(3.18)tocalculatethephase,letI(k)=2π2(cid:2)k2ln10−k2ln10ψ(ν)dν.WehaveI(0,5)=0.31,I(1)=0.74,I(2)=0.92,I(4)=0.99.(3.19)Thisjustmeansthatwhenk=1,forexample,theerrorincurredonthephasecannotexceed25%,butthispercentagecanconstituteanorderofmagnitudeandmostoftenalowerbound.Therefore,iftheslopeofmagnitudeisapproximately−20dB/decadeoveronedecadecenteredaroundωc,theestimatedphaseisbetween−112◦and−68◦atfrequencyωc.3.5.Time-delaysystems3.5.1.Leftformtime-delaysystemsThegeneraltheoryoftime-delaysystemsisbeyondthescopeofthisbook(seee.g.[55]and[58]).Wewilllimitourselves,here,togivingelementswhichareamongthesimplestbutstillveryusefulones.Consideralineartime-invariantSISOsystemdeﬁnedbytheleftformD(∂)y(t)=N(∂)u(t).Nowsupposethattheinputuisdelayedbecause,forexample,ofatimelapsebetweenthemomenttheorderoftheactionistransmittedandwhentheactuatorstartstoact(thisdelaycanbethetimeofinformationpropagationorthetimeoftransportinthemedium).TheaboveequationbecomesD(∂)y(t)=N(∂)u(t−τ)(3.20)whereτ>0denotesthetimelapseinquestion.Below,wewillonlystudytime-delaysystemsgovernedbyanequationofthisform.86LinearSystems3.5.2.TransferfunctionWeknowthatthedelayedinputu(τ):t(cid:3)→u(t−τ)isequaltotheconvolutionproductδ(τ)∗u,whereδ(τ)isthedelayedDiracdistributionofthetimeτ(section12.2.3).Therefore,accordingtotheexchangetheoremandthefactthatL(cid:15)δ(τ)(cid:16)(s)=e−τs,wehaveL(cid:15)u(τ)(cid:16)(s)=e−τsˆu(s)whereˆu(s)istheLaplacetransformofu.Therefore,thetransferfunctionofsystem(3.20)isG(s)=e−τsH(s)(3.21)whereH(s)=N(s)D(s).3.5.3.BodeplotMagnitudeWehaveaccordingto(3.21)G(iω)=e−iτωH(iω).Asaresult,|G(iω)|=|H(iω)|.(3.22)PhaseOntheotherhand,argG(iω)=argH(iω)−τω.(3.23)3.5.4.Example:ﬁrst-ordertime-delaysystemThesimplestcaseisaﬁrst-ordertime-delaysystem,withtransferfunctionG(s)=ke−τs1+Ts.(3.24)Inthefollowing,weassumethatthestaticgainG(0)=kisequalto1.Open-LoopSystems870510152025303540455000.10.20.30.40.50.60.70.80.91tauTFigure3.12.Stepresponseofaﬁrstordertime-delaysystemStepresponseThestepresponseofthissystemisrepresentedinFigure3.12forT=10sandτ=5s.Weseethatfortheﬁrstﬁveseconds,whichisthedurationofthedelay,theoutputremainsatzero.BodeplotTheBodeplotofthissystemisshowninFigure3.13.Notethatthemagnitudeplotisidenticaltothatofthenon-delayedsystem(conformingto(3.22));ontheotherhand,thephaseplothasaverynovelallureinrelationtowhatwehaveseensofar.Whenωtendsto+∞,wehaveindeed,accordingto(3.23),argG(iω)=−π2−τω+(termstendingto0).Inotherwords,argG(iω)decreaseslinearlywithrespecttoω,andexponentiallywithrespecttologω(recallthatthefrequencyisinlogarithmicscale),fromwhichthereisaveryrapiddecrementofthephaseinhighfrequencies3.5.5.Approximationsofatime-delaysystemThetransferfunction(3.21)isnotrationalandthatiswhatisparticularwithtime-delaysystems.Itishoweverstillpossibletoapproachthiskindoftransferfunctionsinadifferentmanner,bywayofrationalfunctions,leadingtothestudyofthese88LinearSystems10-210-1100101-50-40-30-20-100maginitude(dB)10-210-1100101-3000-2000-10000frequency : rad/sphase:degFigure3.13.Bodeplotofaﬁrst-ordertime-delaysystemtime-delaysystemsintheclassicframeworkofsystemsgovernedbyordinarydifferentialequations.A-approximationsLeten(s)(n≥1)betherationalfunctiondeﬁnedbyen(s)=(cid:9)1−(τs)/(2n)1+(τs)/(2n)(cid:10)n.(3.25)THEOREM69.–Wehave,foreveryn≥1andeveryω,|en(iω)|=1,andlimn→+∞en(s)=e−τs;thisconvergenceisuniformoneverycompactset|s|≤σstartingfromanyranknsuchthatn>τσ2.PROOF.Wecanwriteen(s)=en(ln(1−τs2n)−ln(1+τs2n))withn(cid:9)ln(cid:9)1−τs2n(cid:10)−ln(cid:9)1+τs2n(cid:10)(cid:10)=n(cid:27)−τsn+1nε(cid:21)1n(cid:22)(cid:28)=−τs+ε(cid:21)1n(cid:22)whereε(cid:15)1n(cid:16)isatermthattendsto0whenntendsto+∞.Asaresult,en(s)=e−τse−ε(1n),andthereforeen(s)convergestoe−τsbecausee−ε(1n)tendsto1.ToOpen-LoopSystems89provetheuniformconvergence,wemakeuseoftheﬁrst-orderTaylorexpansionwiththeLagrangeremainder.Letkbeapositiveinteger;thereadercanverifythatinsidethedisc|s|≤kτ,wehave,forn>k2theupperbound))))en(s)−e−τse−τs))))≤k22nwhichshowshowfasttheconvergenceoftherelativeerroris.Writingen(iω)=e−iϕn(ω)andsetting∆ϕn(ω)=ωτ−ϕn(ω)(whichisthephaseerror,whiletheamplitudeerroriszero),weeasilyobtain,fromtheupperboundstatedabove,|∆ϕn(ω)|≤arcsin(cid:9)k22n(cid:10)for|ω|≤kτ.Theorem69showsthatatime-delaysystemcanbeviewedasan“inﬁniteordersystem”.Indeed,thetransferfunctionen(s)hasnpolesequalto−2nτ.Asntendstoinﬁnity,thenumberofthesepolesalsobecomesinﬁnite.Theytendto−∞whileremainingontherealaxis.Asfarasthefunctionofthecomplexvariables(cid:3)→e−τsisconcerned,ithasnopoleinthecomplexplane(itisanentirefunction).Inﬁnite-ordersystemsarethesubjectofextensiveresearchandliterature[85].ExampleConsideragainthesystemwithtransferfunction(3.24),withthesamevaluesask,τ,andTconsideredabove.Replacee−τsbyen(s).ThestepresponsesareshowninFigure3.14forn=1(-),2(--)and3(-.).Theseresponsesaretobecomparedwiththestepresponseoftheexactdelaysystem(Figure3.12).Weseethattheaccuracyoftheapproximationgetsmuchbetterwithn.Theapproximation,alreadysatisﬁedwhenn=1,isgoodwhenn=2andexcellentwhenn=3.PadéapproximationGeneralcaseThePadéapproximationsaremoreclassicthanthepreviousonesthatwehavecalled“A-approximations”.Letn(s)=(cid:11)nk=0hk(−τs)k(cid:11)nk=0hk(τs)k(3.26)wherethecoefﬁcientshkaredeﬁnedbythefollowingrecurrentformula:hk+1=n−k(2n−k)(k+1)hk,0≤k≤n−1h(0)=1.90LinearSystemsStep Response1.210.80.60.4Amplitude0.20–0.251015202530Time (sec)354050450Figure3.14.StepresponsesofA-approximationsFigure3.15.StepresponsesofPadéapproximationsOpen-LoopSystems91OnecanshowthattheTaylorpowerseriesexpansionsofn(s)andofe−τsinscoincideuptotheorder2n.Inaddition,|n(iω)|=1=))e−iτω)).(3.27)Therationalfunctionn(s)iscalledthePadéestimateofordernofe−τs.Accordingto(3.27),n(s)isaperfectapproximationofe−τsasfarastheamplitudeisconcerned;thequalityoftheapproximationofthephasedependsontheordern(andincreaseswithit,uptilltheoccurrenceofnumericalerrors).PadéestimationsoftheﬁrstandsecondorderWehave1(s)=1−τs21+τs22(s)=1−τs2+(τs)2121+τs2+(τs)212.ThereadercanshowthattheTaylorexpansionof1(s)andof2(s)coincidewiththatofe−τsuptotheorders2and4,respectively.ExampleConsideronemoretimethesystemwithtransferfunction(3.24)usingthepreviousvaluesofk,τ,andT.Replacee−τsbyn(s).ThestepresponsesareshowninFigure3.15forn=1,2,and3withthesameconventionsasabove.A-approximations(3.25)andPadéapproximations(3.26)areofaqualitythatisquasi-equivalent.Theadvantageof(3.25)liesinthequantiﬁcationthathasbeendonefortheapproximationerror.3.6.ExercisesEXERCISE70.–WeconsidertheRLCcircuitwithtransferfunction(2.32).i)Determinethestaticgainofthissystem.ii)Determinethefrequencyωratwhich|G(iω)|ismaximum.iii)Determinethemaximumof|G(iω)|.92LinearSystems00.10.20.30.40.50.600.010.020.030.040.050.060.070.080.090.1Step ResponseTime (sec)AmplitudeFigure3.16.Stepresponse–Question(a)EXERCISE71.–Inthisexercise,“identifyingasystem”issynonymouswith“determiningitstransferfunctionexperimentally”.Wecanidentifyasystembyagraphicalmethod,eitherfromthetimedomainresponse(e.g.stepresponse)orfromthefrequencydomainresponse.(a)DeterminethesystemwhichhasastepresponseasshowninFigure3.16.(b)SamequestionforthestepresponseshowninFigure3.17.(c)Apointbypointlist(seesection2.5.4)allowsustoobtainthefrequencyresponseontheBodeplotinFigure3.18.Identifythecorrespondingsystem.EXERCISE72.–“Tohaveanegativestart”.WeherebystudyunderwhatconditionthestepresponseofastablesystemΣ“goesinthewrongdirection”.Thatistosay,itheads,duringtheﬁrstmoments,towardadirectionthatisoppositetotheﬁnalvalue.Weusuallyrefertosuchasystemashavinga“negativestart”oranundershoot(and“havingapositivestart”intheoppositecase).Intuitiontellsusthatasystemwithnegativestartishardtocontrol(ifthereaderimaginesacarwhich,whenweturnthesteeringwheelclockwise,goesforabriefinstanttowardtheleftbeforegoingtowardtheright...).LetΣbeastablesystem,withtransferfunctionG(s)ofrelativedegreer>0(seesection13.6.1).(a)WritedowntheexpressionofG(s)asafunctionofitszeros,itspoles,andagain.(b)Lety(i)(0+)=0,0≤i≤r−1,andy(r)(0+)(cid:5)=0.Whatisthenecessaryandsufﬁcientconditioninvolvingtheratioρ=y(r)(0+)G(0)fortheOpen-LoopSystems93012345602468101214Step ResponseTime (sec)AmplitudeFigure3.17.Stepresponse–Question(b)-20-1001020Magnitude (dB)10-210-1100-180-135-90-450Phase (deg)Frequency (rad/sec)Figure3.18.Bodeplot–Question(c)94LinearSystemssystemtohaveanegativestart?(c)CalculateρasarationalfunctionofthepolesandzerosofG(s).(d)Showthatthedenominatorofthisrationalfunctionispositive.Canwesaythesamethingaboutitsnumerator?(e)ShowthatthesystemΣhasanegativestartifandonlyifthenumberofitspositiverealzerosisodd.(f)IsthereagreementbetweenthisresultandA-approximationsaswellasPadéapproximationsoftheabove-studiedtime-delaysystem?Chapter4Closed-LoopSystems4.1.Closed-loopstability4.1.1.StandardfeedbacksystemWehaveemphasizedintheprefacetothisbooktheimportanceofstabilityforclosed-loopsystems.WecallsuchasystemasthatdepictedinFigure4.1a“standardfeedbacksystem”.ThesystemtobecontrolledP,withtransfermatrixP(s),isfedbackthrougharegulatorKwithtransfermatrixK(s).SystemsPandKareassumedtobeminimal.1RecallthattheLaplacetransformationofasignalxisdenotedbyˆx.4.1.2.Closed-loopequationsLety=(cid:27)y1y2(cid:28),u=(cid:27)u1u2(cid:28),andv=(cid:27)v1−v2(cid:28).AlsoletM=(cid:27)P00K(cid:28)andJ=(cid:27)0−II0(cid:28)(whereIisanidentitymatrixofasuitablesize).Imposingzeroinitialconditions,weobtainˆy=Mˆu,ˆu=ˆv+Jˆy(4.1)1.Thishypothesisismissinginnumerousworksonstabilizationofinﬁnite-dimensionalsystems.Thedeﬁnitionofa“minimalsystem”isindeed,inthiscase,notatrivialproblem.See[14]formoredetails.95Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.96LinearSystems+--+v1u1y1v2u2y2PKFigure4.1.Standardfeedbacksystemfromwhich[I−MJ]ˆy=Mˆv.NotethatI−MJ∈R(s)(p+m)×(p+m),wherep=dim(y)andm=dim(u)(seesection13.6.1).Whatisinquestionnowiswhetherˆycanbeexpressedinauniquemannerasafunctionofˆv;thenitwillalsobethesameforˆuaccordingto(4.1).Thedeﬁnitionbelowspeciﬁesthatgiveninsection2.6.2.DEFINITION73.–Theclosed-loopsysteminFigure4.1iswell-posedifthematrixofrationalfunctionsI−MJisinvertibleinthealgebraR(s)(p+m)×(p+m).RecallthatI−JM=(cid:27)IP−KI(cid:28),thusdet(I−JM)=det(I+PK).Therefore,theclosed-loopsystemiswell-posedifandonlyifdet(I+PK)isnotidenticallyzero.Fromthispointonwards,wewillconsideronlyawell-posedclosed-loopsystem.2LetLo=PK,Li=KP,So=(Ip+Lo)−1,To=Ip−So,Si=(Im+Li)−1,Ti=Im−Si.2.Adetailedanalysisofthosephenomenawhichariseinthecaseofanill-posedclosed-loopsystemisgivenin[46].Closed-LoopSystems97ThetransfermatricesLo,So,andToarecalledtheopen-looptransfermatrix,thesensitivityfunction,andthecomplementarysensitivityfunction,respectively,attheoutputofSystemP.ThetransfermatricesLi,Si,andTiarecalledtheopen-looptransfermatrix,thesensitivityfunction,andthecomplementarysensitivityfunction,respectively,attheinputofSystemP.Wecaneasilyestablishtherelations(cid:27)ˆy1ˆy2(cid:28)=(cid:27)SoPToTi−SiK(cid:28)(cid:27)ˆv1ˆv2(cid:28),(4.2)(cid:27)ˆu1ˆu2(cid:28)=(cid:27)SiSiKSoP−So(cid:28)(cid:27)ˆv1ˆv2(cid:28),(4.3)whicharetheclosed-loopequations.4.1.3.Stabilityofaclosed-loopsystemDEFINITION74.–Theclosed-loopsystemPcinFigure4.1isstableif:(i)itiswell-posed,and(ii)thesystemwithinputv=(cid:27)v1v2(cid:28)andoutputy=(cid:27)y1y2(cid:28)isstable,inthesenseofDeﬁnition61(section3.1.1).3REMARK75.–Accordingto(4.1),Condition(ii)givenaboveisequivalenttothefollowing:(ii’)thesystemwithinputv=(cid:27)v1v2(cid:28)andoutputu=(cid:27)u1u2(cid:28)isstable(inthesenseofDeﬁnition61).Inwhatfollowsinthisparagraph,thesystemsPandKaresupposedtobeSISO.ThetransferfunctionsP(s)andK(s)arethusrationalfunctions,writtenintheformP(s)=B(s)A(s),K(s)=R(s)S(s)(4.4)whereA(s),B(s),R(s),S(s)arepolynomialswithrealcoefﬁcients,i.e.areelementsoftheringR[s](seesection13.1.1).Therationalfunctionsin(4.4)areassumedtobeirreducible.Theopen-looptransferfunctionL(s)=P(s)K(s)(4.5)isidenticalattheinputandtheoutputofP(Li=Lo=L).3.Accordingtosomeauthors,whatisdeﬁnedhereisthe“internalstability”ofafeedbacksystem.98LinearSystemsTHEOREM76.–(i)ThefeedbacksystemPciswell-posedifandonlyifAcl(s)=A(s)S(s)+B(s)R(s)(cid:5)=0inR[s].(ii)ThetransmissionpolesofPcaretherootsofAcl(s).(iii)IfthesystemsPandKareproperandatleastoneofthemisstrictlyproper,thenthefeedbacksystemPciswell-posedandproper.(iv)SupposethefeedbacksystemPcisproper;thenitisstableifandonlyiftherootsofAcl(s)alllieinthelefthalf-plane.PROOF.*(i)Wehave1+PK=1+BARS=AS+BRAS.(ii)Accordingto(4.2),Pc=(cid:27)BSAS+BRBRAS+BRBRAS+BR−ARAS+BR(cid:28)=1AS+BR(cid:27)BSBRBR−AR(cid:28).Let(cid:27)α100α2(cid:28)betheSmithformofthematrix(cid:27)BSBRBR−AR(cid:28).Theﬁrstinvariantfactorα1isthegreatestcommondivisorofthepolynomialsBS,BR,andAR(seesection13.2.3,Proposition502);itdividesBRandARandsoitdividesRsinceBandAarecoprime;itdividesBSandBRandsoitdividesBsinceSandRarecoprime.Thisinvariantfactorα1isthereforeprimewithAS+BR(sinceitdividesBRandisprimewithAS).Moreover,thereexistpolynomialsB1andR1suchthatB=B1α1andR=R1α1.Thesecondinvariantfactorα2isamultipleofα1,andisoftheformβα1whereβ∈R[s].Theproductα1α2=βα21isequaltothedeterminant−(cid:15)ARBS+B2R2(cid:16)=−BR(AS+BR)=−α21B1R1(AS+BR).Asaresult,β=−B1R1(AS+BR)andα2=−α1B1R1(AS+BR).TheSmith–MacMillanformofPcistherefore1AS+BR(cid:27)α100α2(cid:28)=(cid:27)α1AS+BR00−B1R1α1(cid:28).Sinceα1isprimewithAS+BR,theMacMillanpolesofPc(i.e.thetransmissionpolesofPc)aretherootsofAcl(s).(iii):Theveriﬁcationislefttothereader.(iv)ThisisanobviousconsequenceofDeﬁnition61.*REMARK77.–ThetwosystemsPandKcanbeproperwhilePcisnot,asshownbytheexamplewhereP(s)=−s+1sandK(s)=1.ItcanalsohappenthatPcisill-posed,suchasinthecaseP(s)=−1andK(s)=1.DEFINITION78.–Acl(s)=A(s)S(s)+B(s)R(s)isthecharacteristicpoly-nomialofthefeedbacksystemPc(thatisoftheclosed-loop).Closed-LoopSystems994.1.4.NyquistcriterionAssumethattheopen-looptransferfunctionL(s)isstrictlyproper(whichimpliesthatPciswell-posedandproperaccordingtoTheorem76).Letf(s)=Acl(s)(s+1)ν(4.6)whereν=d◦(Acl),sothat0(cid:5)=lim|s|→+∞f(s)<+∞.By(4.5),f(s)=A(s)S(s)(s+1)ν(1+L(s)).LetnP(resp.,nK)bethenumberofpolesofP(s)(resp.,K(s))(countingmultiplicities)locatedintheclosedrighthalf-plane¯C+={s∈C:Re(s)≥0}.CasewhereP(s)andK(s)havenopolesontheimaginaryaxisDEFINITION79.–Thepathω(cid:3)→L(iω),ω∈(−∞,+∞)iscalledtheNyquistplotofL(s)(seesection12.4.3).SinceL(−iω)=¯L(iω)(where¯L(iω)isthecomplexconjugateofL(iω)),theNyquistplotofL(s)isentirelydeterminedbythepath[0,+∞)(cid:20)ω(cid:3)→L(iω).IftheNyquistplotpassesthroughthepoint−1(calledthecriticalpoint),theclosed-loopsystemisunstablebecauseithasanimaginarypole.Ifnot,letNbethenumberofturnstheNyquistplotL(s)goesaroundthepoint−1inthedirectsense(whichisanti-clockwise).Thefollowingtheoremisfundamental(andisgeneralizedtothecaseoflinearsystemswithcommensuratedelaysin[14];seealso[84],[85]).THEOREM80.–(Nyquistcriterion).Theclosed-loopsystemisstableifandonlyiftheNyquistplotdoesnotpassthroughthepoint−1andnP+nK=N.PROOF.LetA>0andconsidertheclosedpathλformedbytheconcatenationofthefollowingpaths:(i)γ1:ω(cid:3)→iω,ω∈(−A,A);(ii)γ2:θ(cid:3)→Ae−iθ,θ∈(cid:15)−π2,π2(cid:16).(Thereaderisrequestedtodrawadiagram.)Theclosedpathλiscalledthe“Bromwichcontour”.LetAbelargeenoughforλtoencircleonetimeclockwiseallthepolesandzerosofP(s)andK(s)thatarelocatedin¯C+,ifany.Letf1(s)=A(s)S(s)(s+1)ν,f2(s)=1+L(s).Accordingto(12.76)(seesection12.4.3),j(0;f◦λ)=j(0;f1◦λ)+j(0;f2◦λ).Ontheotherhand,accordingtoCauchy’sargumentprinciple(Theorem447,section12.4.5),j(0;f1◦λ)=nP+nKandj(0;f2◦λ)=−N.Asaresult,j(0;f◦λ)=nP+nK−N.Accordingto(4.6),j(0;f◦λ)isthenumberofrootsofAcl(s)located100LinearSystemsin¯C+,andso,byTheorem76,anecessaryandsufﬁcientconditionforstabilityoftheclosed-loopsystemPcisj(0;f◦λ)=0,i.e.,nP+nK=N.SinceL(s)isstrictlyproper,asA→+∞,theimageofL◦γ2reducestotheorigin.EXAMPLE81.–LetP(s)=1−s(1+s)3.TheNyquistplotofthistransferfunctionisshowninFigure4.3.Therealaxisiscutat−1k0wherek0=2.01.SupposethesystemPisfedbackbyaproportionalregulatorK(s)=k>0.WehavenP=nK=0,therefore,accordingtotheNyquistcriterion,theclosed-loopsystemisstableifandonlyifk<k0.Werefertok0asthecriticalgain.EXAMPLE82.–LetP(s)=2s+2s2−s−2.TheNyquistplotofP(s)isshowninFigure4.4.ThepolesofP(s)are−1and2,andsonP=1.If,asinExample81,wefeedbackthesystemthroughagaink>0,wehavenK=0.TheNyquistplotofP(s)cutstherealaxisatthepoint−1.Thenecessaryandsufﬁcientconditionforstabilityoftheclosed-loopsystemasprovidedbytheNyquistcriterionisN=1,i.e.k>1.CasewhereP(s)andK(s)havepolesontheimaginaryaxisSupposenowthatA(s)orS(s)hasrootsontheimaginaryaxis.Then,ononehand,nPandnKdonothaveaclearmeaning,and,ontheotherhand,theArgumentprincipleisnolongerapplicableiftheclosedpathλisdeﬁnedasintheproofofTheorem80.Thesolutionconsistsinreplacingtheimaginaryaxisbyan“indentedimaginaryaxis”asdeﬁnedbelow.Letpk=iωk(k=1,...,r)bethedistinctrootsofA(s)S(s)locatedontheimaginaryaxis,arrangedinsuchawaythatωk+1>ωk.LetIk(ε)beasegmentontheimaginaryaxis,centeredatpk,andoflength2ε,whereε>0isarealnumbersufﬁcientlysmallinorderthatIk(ε)∩Ik+1(ε)=∅(k=1,...,r−1).ReplaceeachsegmentIk(ε)bythehalfcircleJk(ε),ofradiusεandcenteredatpkandgoingroundthatpointtotheleft(seeFigure4.2).TheindentedimaginaryaxisisthesetI(ε)obtainedafterreplacingallthesegmentsIk(ε)(k=1,...,r)bythesemi-circlesJk(ε).LetγεdenotethepathtraversedbythecomplexvariableswhenittravelsoverI(ε)withastrictlyincreasingimaginarypart(wecancallγεthe“directedindentedimaginaryaxis”).ThedeﬁnitionoftheBromwichcontourcanclearlybeextendedtothiscase.WearenowgoingtoreplaceDeﬁnition79bythefollowing:DEFINITION83.–TheNyquistplotofL(s)isL◦γε.LetnPandnKbetheintegersasdeﬁnedaboveandNbethenumberofturnstheNyquistplotofL(s)madearoundpoint−1anti-clockwise.Weobtainthefollowing:Closed-LoopSystems101xpkIk()Jk()Figure4.2.ConstructionoftheindentedimaginaryaxisTHEOREM84.–WithNasdeﬁnedabove,thestatementofTheorem80remainsvalid.EXAMPLE85.–LetP(s)=1s(cid:15)s2+s+12(cid:16).Thesystemwithsuchatransferfunctionisfedbackbyaproportionalregulatorwithgaink>0.Therefore,A(s)=s(cid:15)s2+s+12(cid:16).TheproductA(s)S(s)hasarootontheimaginaryaxis,attheorigin.Thedirectedindentedimaginaryaxisconsistsofthefollowingparts:(a)Thequartercircleparameterizedbyεe−iθ,whereθincreasesfrom−πto−π2;(b)Thesetofalliω,whenωincreasesfromε>0to+∞;(c)Thesymmetricwithrespecttotherealaxisoftheconcatenatedpaths(a)and(b).Forε→0+,P(cid:15)εe−iθ(cid:16)∼2εeiθ.Therefore,fora“verysmall”ε,theimageof(a)byP(s)isthequartercircleof(“verylarge”)radius2εcoveredwithanangleθincreasingfrom−πto−π2.ThecompleteNyquistplotisshowninFigure4.5(wherewehavetoimaginethesemi-circleatinﬁnity;itistraversedinthedirectsense).ThepolesofP(s)are0,12(−1+i),12(−1−i).Asaresult,nP=1.WehavenK=0,thereforeanecessaryandsufﬁcientconditionforstabilityoftheclosed-loopsystemisN=1.Now,theNyquistplotcutstherealaxisataround−2.Thus,closed-loopstabilityholdswhen0<k<12.*NyquistcriterionintheMIMOcaseIntheMIMOcase,itisnecessarytodistinguishtheopen-looptransfermatricesattheinputandoutputofthesystemP,aswehaveseeninsection4.1.1.Anyhow,102LinearSystems-1-0.8-0.6-0.4-0.200.20.40.60.81-1-0.8-0.6-0.4-0.200.20.40.60.81Nyquist DiagramReal AxisImaginary AxisFigure4.3.NyquistplotofP(s)–Example81-1.5-1-0.500.5-1-0.8-0.6-0.4-0.200.20.40.60.81Nyquist DiagramReal Axis Imaginary AxisFigure4.4.NyquistplotofP(s)–Example82Closed-LoopSystems103-7-6-5-4-3-2-10123-5-4-3-2-1012345Nyquist DiagramReal AxisImaginary AxisFigure4.5.NyquistplotofP(s)–Example85det(Ip+Lo(s))iszeroifandonlyifdet(Ip+Li(s))isalsozeroaccordingtoLemma520(section13.3.3).Therefore,ifweputgo(s)=det(Ip+Lo(s))−1,gi(s)=det(Im+Li(s))−1,wehavego(s)(cid:5)=−1ifandonlyifgi(s)(cid:5)=−1.LetNbethenumberofturnseffectedbytheNyquistplotofgo(s)(alsocalledthe“MIMONyquistplot”)aroundpoint−1anti-clockwise.Thefollowingtheoremisprovedin([114],section7.4):THEOREM86.–WithNasdeﬁnedabove,thestatementofTheorem80remainsvalid.4.1.5.SmallgaintheoremThesmallgaintheoremisoftenusedinrobustnesstheory.ConsiderthestandardfeedbacksysteminFigure4.1;supposeP(s)∈(cid:1)Hp×m∞andK(s)∈(cid:1)Hm×p∞.Inthelineartime-invariantcaseconsideredhere,thesmallgaintheoremisexpressedasfollows:THEOREM87.–If(cid:23)P(cid:23)∞(cid:23)K(cid:23)∞<1,thenthefeedbacksystemisstable.PROOF.WehaveLi(s)∈(cid:1)Hm×m∞and(cid:23)Li(cid:23)∞≤(cid:23)P(cid:23)∞(cid:23)K(cid:23)∞<1.Lets∈¯C+andλ(s)beaneigenvalueofLi(s).AccordingtoProposition578(section13.5.7),104LinearSystemswehave|1+λ(s)|≥1−|λ(s)|and|λ(s)|≤(cid:23)Li(cid:23)∞.Therefore,|1+λ(s)|>0,andsothematrixIm+Li(s)isinvertibleinCm×m.Itfollowsthatallthetransfermatricesoftheexpression(4.2)havetheirentriesbelongingto(cid:1)H∞;thus,accordingtoDeﬁnition74,theproofiscomplete.4.2.Robustnessandperformance4.2.1.GeneralitiesTherobustnessofafeedbacksystemisthecapacityofsuchasystemtopreservestabilityinthepresenceofmodelerrors(robustnessofstability)oreventomaintainacertainperformanceinthepresenceofsucherrors(robustnessofperformance).Robustnessofperformanceimpliesrobustnessofstability,butconversedoesnothold.Inmostcases,“robustcontrol”issynonymouswith“prudentcontrol”.Thecontrolengineerdesignsthecontrolofasystembasedonamodel(moreorlessexplicit).Therealitybeinginﬁnitelycomplex;themoreprecisethemodelis,themorecomplicateditbecomes(ofthehigherorder,withnonlinearities,etc.)andthelessusableitistosynthesizeacontrollaw.Recallwhatwasstatedinsection2.2.5:anapparentlyverysimplesystem,suchasavoltagegeneratorsupplyingacurrentthrougharesistance;is,withagoodapproximation,representedbytheelementaryequationV=Ri.However,thisequationdoesnottakeintoaccountthefactthat,ifweconsiderimportantvariationsofthevoltage,theresistancebecomesanonlinearelement;itisthereforemoreprecisetowriteV=ρ(i)whereρisthecharacteristicfunctionoftheresistanceandρislinearonlyinthevicinityof0.Moreover,ifwestudythebehaviorofsuchasystem,wehavetotakeintoaccountthepropagationvelocityoftheelectricﬁeld.Themodelobtainedisthengovernedbythewaveequation(whichisapartialdifferentialequation)andisofan“inﬁniteorder”;sinceitisnonlinearaccordingtowhathasbeensaidabove,and,eventhoughitwassimpleatthebeginning,ithasbecomeverycomplicated.Ifsuchbigcomplication(whichbecomesinﬁniteinthelastanalysis)ismostoftenuseless,itisbecause,inpractice,itisnotnecessarytorepresentrealityinthemostaccurateway.Foracontrolengineer,a“goodmodel”hasjustthenecessarycomplexitythatenableshimtodesignthecontrolofhis/hersysteminsuchawayastoobtaintheperformancewhichcorrespondstohis/herspeciﬁcationssheet.Themorestringenttheperformanceisrequired,themorepreciseandthemorecomplexthemodelmustbe.Conversely,iftheonlymodelavailableisveryimprecise,therewillbenoothersolutionbuttorunthesystemwithapoorperformance,andsowithcaution.However,cautionisavirtuethatisnotsufﬁcientinitself:skillisalsonecessary.Robustnesstheoryisnotlimitedtorecommendingservo-controladjustmentﬂabbiness.Itevenhappensthattherobustnessofacontrollawrequirestheuseoflargegains;italldependsonthenatureofmodelerrorsoruncertainties.Closed-LoopSystems105iL0a1rReImFigure4.6.NyquistplotofL(s)Consider,forexample,thesystemwithinputuandoutputy,governedbythedifferentialequation˙y=θy+u(4.7)whereweonlyknowthatthecoefﬁcientθisinsideaninterval[θmin,θmax],0≤θmin<θmax.Usingaproportionalcontrollawu=−ky,wecanonlybesuretostabilizethesystembyusingk>θmax,thuschoosingasufﬁcientlylargegain.Inreality,robustnessisnotanabsolutenotion:itisalwaysrelativetoaclassofmodelingerrors.Inmostofthecasesencounteredinpractice,theseerrorsaresuchthatrobustnessagainsttheseerrorsissynonymouswithprudence,butexample(4.7)showsthatitisimportantnottogeneralizethisruleimproperly.4.2.2.RobustnessmarginsSupposethattheNyquistplotofL(s)=P(s)K(s)isasshowninFigure4.6.Thenominalfeedbacksystem(i.e.withnomodelingerror)isassumedtobestable.GainmarginLet−1/g1and−1/g2bethetwonumbersclosestto−1andsituatedoneithersideofthatpoint,andwheretheNyquistplotcutstherealaxis.ThegainmarginistheintervalMg=(g1,g2)(0≤g1<1<g2≤+∞).AccordingtotheNyquist106LinearSystemscriterion,thesigniﬁcanceofthismarginisasfollows:supposethatthetransferfunctionP(s)isreplaced(duetothemodelerror)bygP(s),wheregispositiverealnumber,thefeedbacksystemremainsstableifandonlyifg∈Mg.Thevaluesg1andg2areoftenexpressedindecibels.Wecanestimatethatagainmarginiscorrectifitincludes[−3dB,6dB].Onemaycallg1dBthegainreductionmargin,andg2dBthegainaugmentationmargin.Butnotethatmanycontrolengineersrefertowhatwecallabovethegainaugmentationmarginasthegainmargin;thisusageisdiscouragedasitisasourceofambiguity.PhasemarginThephaselagmarginistheangleΦr∈[0,2π)asshowninFigure4.6.Ithasthefollowingsigniﬁcance:supposethat,duethetomodelingerror,thetransferfunctionP(s)isreplacedbye−iφP(s)(0≤φ<2π).Thentheclosed-loopsystemremainsstableifandonlyifφ<Φr.ThephaseleadmarginistheangleΦa∈[0,2π)asshowninFigure4.6,foranalogousreasons.However,insteadofconsideringaphaselag−φ,weconsiderthistimeaphaseleadφ.ThephasemarginistheintervalMp=(−Φa,Φr).Theanglesareoftenexpressedindegrees.Onecanconsiderthataphasemarginiscorrectifitincludes[−30◦,30◦].Manycontrolengineersrefertowhatwehavecalledabovethephaselagmarginasthephasemargin.DelaymarginThenotionsofgainmarginandphasemarginareveryclassicandimportant.Theyare,however,veryinsufﬁcientincharacterizingrobustness[20].Innumeroussituations,themodelingerrorisanalogoustoadelayinserieswiththesystem.Thisdelaymaybeduetosampling(inthecaseofacomputer-controlledsystem);itmayalsobedue,forvariousreasons,todelaysbetweenthesensorandtheregulatorandbetweenthisandtheactuator.Intheend,wewillseethatthisdelaycanapproximatecertainkindofneglecteddynamics.Supposenowthatweintroduceaparasiticdelayτ>0intotheloop,withtransferfunctione−τs.Wecallunitygainfrequencyafrequencyωsuchthat|L(iω)|=1.Fors=iω,whereωisaunitygainfrequency,thedelayτintroducesaphaseshift−ωτ,thusaphasedelaythathasalineardependencyonω.Thisphasedelayisthushigherthanthephaselagmarginiftheunitygainfrequencyconsideredistoolarge.Thisexplainswhythephaselagmarginisnotofmuchsigniﬁcanceinsuchasituationandleadsustothefollowingdeﬁnition[20]:thedelaymarginMristheleastupperboundoftheparasiticdelaysforwhichtheclosed-loopsystemremainsstable.LetusseenowhowwecancalculatethedelaymarginbasedontheNyquistplot.(i)If|L(iω)|<1forallω,thedelaymarginisinﬁnite.(ii)SupposethatsuchisnottheClosed-LoopSystems107case,thenthesetoffrequenciesωforwhich|L(iω)|=1non-empty;let{ω1,...ωn}bethisset.4Foreveryk∈{1,...n},letΦkbetheanglein[0,2π)havingavalueargL(iωk)−π(modulo2π).ThedelaymarginisdeﬁnedasMr=min(cid:7)Φkωk,k=1,...,n(cid:8).(4.8)Inthecasewheretheunitygainfrequencyisuniqueandisdenotedbyω0,weobtainMr=Φrω0.WewilltakegreatcareinexpressingtheanglesΦkandthefrequenciesωkincoherentunits.Forexample,ifΦkisexpressedinradians,andωkinrad/s,Mrisobtainedinseconds.Wecannotintheabsoluteprovideavaluewithwhichthedelaymargincanbeconsideredsufﬁcient:suchavalue(whichisoneoftheinterestsinsuchanotion)dependsonthesystemtobecontrolled,theexpectedperformance,thesamplingperiod,etc.Oneoftheruleswecanformulateisthat,inthecasewherecontrolisdiscretized,thedelaymarginhastobeatleastthesamplingperiod[74].ModulusmarginConsidertheNyquistplotasshowninFigure4.7.Inthecaseconsidered,thegainaugmentationmarging2islarge(oftheorderof3,i.e.closeto10dB)whereasthegainreductionmarginisg1=0(or,indB,−∞).Similarly,thephaselagmarginislarge(oftheorderof60◦)whilethephaseleadmarginhasthesamevalue,bysymmetry.However,theNyquistplotofL(s)passesveryclosetothecriticalpoint−1,consequentlyasmallerrorinthemodelcandestabilizethefeedbacksystem.ThisshowsthatthephaseandgainmarginsneedtobecompletedbyanothercriterionwhichisthedistancebetweentheNyquistplotandpoint−1.Thisdistanceiscalledthemodulusmargin.Wecanestimatethatthemodulusmarginiscorrectifitisatleast0.5.Usingthemodulusmargin,wecanobtainalowerboundforthegainandphasemargins.Indeed,elementarygeometryshowsthatMg⊃(cid:21)11+Mm,11−Mm(cid:22)(4.9)Mp⊃(cid:21)−2arcsinMm2,2arcsinMm2(cid:22).(4.10)4.Thissetisnecessarilyﬁnitewhentheopen-loopsystemisﬁnite-dimensional,i.e.whenL(s)isarationalfunction.108LinearSystemsxr-1/g20-1ReImL(i)Figure4.7.ModulusmarginToclarifyideas,withMm=0.5,theabovelowerboundsbecome:Mg⊃(−3.5dB,6dB),Mp⊃(−29◦,29◦).ThemodulusmargincaneasilybeexpressedusingthesensitivityfunctionSi=11+L.Firstnotethatthissensitivityfunctionbelongsto(cid:1)H∞duetothefactthatthenominalfeedbacksystemisstable(seesections3.1.1and4.1.3).WehaveMm=infω≥0|1+L(iω)|=1supω≥0)))11+L(iω))))thusaccordingtosection13.6.2,Mm=1(cid:10)Si(cid:10)∞.(4.11)SinceL(s)isastrictlypropertransferfunction,wehavelimω→+∞|Si(iω)|=1.Asaresult,(cid:23)Si(cid:23)∞canbeinterpretedastheresonancefactorofthesensitivityfunctionSi.Theexpression(4.11)showsthatthemodulusmarginistheinverseofthisresonancefactor.Closed-LoopSystems109ReIm0-1L(i)-Figure4.8.M-circleHallchartItiscommontotraceintheNyquistplanethe“λ-circles”(alsocalled“M-circles”)makingitpossibletogeometricallydeterminetheresonancefactorofthe“complementarysensitivityfunction”To=Ti=1−Si.WethenobtaintheHallchart.The“λ-circle”CλisthelocusofthepointsMsuchthatOMAM=λ(λ≥0)whereArepresentsthecriticalpoint−1.LetM=x+iy.ThereadercaneasilyverifythatthecoordinatesxandyofMinthecomplexplanearesolutionsofthealgebraicequation(cid:15)λ2−1(cid:16)x2+2λ2x+(cid:15)λ2−1(cid:16)y2+λ2=0,andCλisthereforethecirclewithcenter−λ2λ2−1andradiusλ|λ2−1|.OnesuchcircleCλisshowninFigure4.8inthecaseλ>1(themostcommoninpractice).TheNyquistplotofL(s)isalsoplottedinthisﬁgure(atleastthepartoftheplotthatcorrespondstofrequenciesω≥0).Thenorm(cid:23)To(cid:23)∞isλbecausethisNyquistplotistangentialtoCλanddoesnotpenetrateintotheinteriorofthiscircle.Iflims→0|To(s)|=1,(cid:23)To(cid:23)∞=λisthetheresonancefactorofTo(s).ComplementarymodulusmarginThecomplementarymodulusmarginMmcistheleastupperboundofthequantities1/λsuchthattheNyquistplotofL(s)doesnotpenetrateintothecircleCλ(withλ>1).ItthusfollowsthatMmc=1(cid:10)To(cid:10)∞.110LinearSystemsFigure4.9.BlackplotofL(s)4.2.3.UseoftheNicholschartTheBlackplotofatransferfunctionL(s)hasalreadybeendeﬁned(seesection3.2.3):itisthecurvethatrepresentstheevolutionofthecoordinates(|L(iω)|dB,argL(iω))asafunctionoftheparameterω.ItisconvenienttorepresentthiscurveontheNicholschartwherethecurves|To|=constandargTo=const(whereTo=L1+L)areplotted.Consider,forexample,thesystemPwithtransferfunctionP(s)=1−s/3s(1+s/2)(1+2s),fedbackbytheregulatorKwithtransferfunctionK(s)=0.35(thistransferfunctionbeingaconstant,theregulator–orthecontrolitgenerates–issaidtobe“proportional”).ThetransferfunctionL(s)=P(s)K(s)isrepresentedintheNicholschartinFigure4.9.Thephaselagmarginis225◦−180◦=45◦(obtainedatthefrequencyof0.3rad/t.u.,wheret.u.isthetimeunitused).Thegainmarginisabout(−∞,12dB).Thequantity(cid:23)T0(cid:23)∞(dB)isseenonthechart:itisslightlylessthan3dB(aprecisecalculationshowsthat(cid:23)T0(cid:23)∞(cid:9)1.31,i.e.about2.39dB).TheNicholschartcanbeusedtodeterminethegainofanadequateproportionalregulator.Thegaink=0.35isthatofaproportionalregulatorwhich,whenfeedingbackthesystemP,providesaphaselagmarginof45◦.Closed-LoopSystems1114.2.4.RobustnessagainstneglecteddynamicsNeglecteddynamicswithoutresonanceThetransferfunctionofthemodelPisagaindenotedbyP(s).Wemakethehypothesisthattheactualcontrolsystem˜P(assumedtobelineartime-invariant)hasthefollowingtransferfunction:˜P(s)=P(s)11+τ1s···11+τnswheretheτk>0(1≤k≤n)denotetheneglectedtimeconstants.Lets=iωandsuppose|τkω|(cid:16)1(1≤k≤n),thatistosay|τks|(cid:16)1.Itfollowsthat([17],section2.2.1)˜P(s)∼=P(s)(1−τs)∼=P(s)e−τs,τ=n(cid:12)k=1τk.Inotherwords,the“neglectedtimeconstants”haveaneffectanalogoustoaneglecteddelay.Thedelaymarginthereforecorrectlyrepresentstherobustnessofthefeedbacksystemagainstthiskindofneglecteddynamics.NeglecteddynamicsofanykindInamoregeneralcase,thedelaymarginisinsufﬁcientasacriterionforrobustness.Considerthecaseofa“multiplicativemodelingerror”.Thetransferfunction˜P(s)oftheactualcontrolsystem˜PisexpressedasafunctionofthetransferfunctionP(s)ofthemodelPaccordingtoarelationoftheform˜P(s)=(1+E(s))P(s).ThetransferfunctionE(s)(ortheassociatedminimalsystemE)iscalleda“multiplicativemodelingerror”.Considerthefollowingconditions:(i)TheregulatorwithtransferfunctionK(s)stabilizesP(s);(ii)P(s)and˜P(s)havethesamenumberofpolesintheclosedrighthalf-plane.(iii)P(s)and˜P(s)havethesamepolesontheimaginaryaxis(takingintoaccountmultiplicities)–thesetofthesepolescanofcoursebeempty.(iv)ThereexistsatransferfunctionW1(s)∈(cid:1)H∞(seesection13.6)suchthat|E(iω)|<|W1(iω)|,foranyfrequencyω≥0.LetEbethesetoftransferfunctionsE(s)satisfyingConditions(ii)–(iv)above,assumingthatCondition(i)issatisﬁed.112LinearSystemsTHEOREM88.–Anecessaryandsufﬁcientconditionforthefeedbacksystem(consistingofthecontrolsystem˜PfedbackbytheregulatorK)tobestableforanymodelingerrorE(s)∈Eis(cid:23)W1To(cid:23)∞≤1.PROOF.(A)AccordingtoCondition(iii),theBromwichcontoursof˜L(s)=˜P(s)K(s)andthatofL(s)=P(s)K(s)areidentical.(B)LetNbethenumberofturnstheNyquistplotofL(s)goesaroundthepoint−1inthedirectsense.AccordingtoHypothesis(i)andtheNyquistcriterion(Theorem84),wehaveN=nP+nK,wherenPandnKdenote,respectively,thenumberofpolesofP(s)andK(s)thatbelongtotheclosedrighthalf-plane.Accordingtothissametheoremandobservation(A)hereabove,anecessaryandsufﬁcientconditionforKtostabilize˜Pis˜N=n˜P+nK,where˜NisthenumberofturnstheNyquistplotgoesaroundpoint−1inthedirectsenseandn˜Pdenotesthenumberofpolesof˜P(s)belongingtotheclosedrighthalf-plane.AccordingtoConditions(ii)and(iii),wehaven˜P=nP,andthusthenecessaryandsufﬁcientconditionaboveisequivalentto˜N=N.(C)Theonlysupplementaryinformationwehaveon˜P(s)isCondition(iv).Itisequivalentto)))˜L(iω)−L(iω))))<|W1(iω)L(iω)|forallω≥0,whichmeansthatforeveryfrequencyω,˜L(iω)belongstotheopendiskcenteredatL(iω)andwithradius|W1(iω)L(iω)|.Thenecessaryandsufﬁcientconditiondeterminedat(B)isthereforesatisﬁedifandonlyiftheradius|W1(iω)L(iω)|doesnotexceedthedistance|1+L(iω)|fromthepointL(iω)tothepoint−1,andthisforanyfrequencyω(seeFigure4.10).Thisconditioniswrittenas|W1(iω)L(iω)|≤|1+L(iω)|,andisequivalentto|W1(iω)To(iω)|≤1.Thisinequalityissatisﬁedforeveryfrequencyωifandonlyif(cid:23)W1To(cid:23)∞≤1.Supposethatωisafrequencyatwhichtheuncertaintyormodelerrorislarge,thatis|W1(iω)|(cid:18)1.ThenecessaryandsufﬁcientconditioninTheorem88implies|To(iω)|≤1|W1(iω)|(cid:16)1.(4.12)WethushaveTo(iω)∼L(iω),andCondition(4.12)leadsto|L(iω)|(cid:25)1|W1(iω)|(cid:16)1(4.13)wherethesymbol(cid:25)signiﬁes“isdominatedby”([12],sectionV.1).Asaresult,agoodamountofrobustnessagainstamultiplicativeerrorisobtainedusinga“smallloopgain”.Ingeneral,theneglecteddynamicsareessentiallylocatedinhighfrequencies.Andthusthecondition|L(iω)|(cid:16)1needstobesatisﬁedforlargevaluesofω.Closed-LoopSystems113-10ReImL(i)1+L(i)Disquesd'incertitudederayonIW1(i)L(iIUncertainty disksFigure4.10.Uncertaintydisks4.2.5.PerformanceSection4.2.1alreadysuggestedthattheanalysisofrobustnessisnotseparablefromthatofperformance.Oneoftheessentialtasksofthecontrolengineerisindeedtomanagethebestcompromisebetweenrobustnessandperformance.Aswewillseebelow,thesetwopropertiesareingeneralantagonistic.Supposethat,inFigure4.1,thevariablebeingcontrolled(orregulated)5isz=u2,andthat−v2=disadisturbance.Withv1=0,weobtainfrom(4.3)theexpressionˆz(s)=So(s)ˆd(s).Intheabsenceofanyfeedback,wehaveˆz(s)=ˆd(s)underthesameconditionsandthetransferfunctionbetweenthedisturbancedandthevariabletoberegulatedzisthereforeequalto1.Asaresult,thefeedbackisefﬁcient(intermsofperformance)atfrequencyωifandonlyif|So(iω)|<1.Thisisindeedtheconditionunderwhichthefeedbackwillattenuatethedisturbancethataffectsthecontrolledvariable(atfrequencyω).Wesaythatthereisarejectionofthisdisturbance(atthissamesamefrequencyω)ifSo(iω)=0.5.Aregulationproblemisaspecialcaseoftrackingproblem,wherethecontrolledvariableistobemaintainedconstant.Herethisconstantiszero.114LinearSystemsNotethat,becauseL(s)isastrictlypropertransferfunction,wehavelimω→+∞|So(iω)|=1,thereforethefeedbackwillnecessarilynolongerbeefﬁcientatveryhighfrequencies.Wecanquantifytheexpectedperformance(inaccordancewiththespeciﬁcations)bychoosingatransferfunctionW2(s)in(cid:1)H∞,suchthattheperformanceisconsideredtobesatisfactoryif|W2(iω)So(iω)|≤1,foreveryfrequencyω.Thisconditionisequivalentto(cid:23)W2So(cid:23)∞≤1.(4.14)AnadvantageofsuchaformulationisthatCondition(4.14)isinthesameformastheonestatedinTheorem88.Thisallowsustotransformtheproblemofmanagingthecompromiserobustness/performancetoaproblemofoptimizationinthe(cid:1)H∞space–whichisoutsidethescopeofthisbook(seee.g.[122]).Considerafrequencyωatwhichaheavyattenuationofthedisturbanceisrequired.Wehavetherefore|W2(iω)|(cid:18)1.Condition(4.14)leadsto|So(iω)|≤1|W2(iω)|(cid:16)1.(4.15)WethushaveL(iω)∼1/So(iω),and(4.15)yields|L(iω)|(cid:2)|W2(iω)|(cid:18)1.(4.16)ItisclearthatConditions(4.13)and(4.16)arecontradictoryiftheyarerequiredatthesamefrequencyω.Wethereforecannotobtainfromaclosed-loopsystemagoodperformanceatafrequencyatwhichalargemodelingerrorispresent.Ingeneral,performanceisrequiredatlowfrequencies.Andthatisthereasonwhythecondition|L(iω)|(cid:18)1mustbesatisﬁedatsmallvaluesofω.4.2.6.SensitivitytomeasurementnoiseNowsupposethat(seeFigure4.1)v2representsthemeasurementnoiseaddingtothecontrolledvariable(especiallybecauseofimperfectionsofthesensor).Itisveryimportantthatthecontrolu1ofthesystemshouldnotbetoosensitivetothisnoise.Ifnot,indeed,thecontrolwillbeveryagitatedanditwillresultinprematurewearontheactuators(especiallyifthesearemadeofmechanicalparts).Accordingto(4.3),thetransferfunctionbetweenv2andu1isSi(s)K(s)=So(s)K(s)(because,atthismoment,onlytheSISOcaseisconsidered).Theagitationduetothismeasurementnoiseisharmfulessentiallyathighfrequencies,forwhichwehavetherelation(4.13),andthus|So(iω)|∼1and|So(iω)K(iω)|∼|K(iω)|.Itisthereforeimportanttolimitthegainoftheregulatorinhighfrequencies.Closed-LoopSystems115Intheabsenceoffeedback,thetransferfunctionbetweenv2andthecontrolvariabley1isobviouslyzero.Aperverseeffectofthefeedbackcanmakey1agitatedbecauseofthenoisev2.Inclosed-loop,thetransferfunctionbetweenv2andy1is(accordingto(4.2))To(s).Tolimittheperniciouseffectexaminedhere,weareledtoimposeaconditionsuchas(4.12),whichimplies(4.13)ontheopen-looptransferfunction.4.2.7.LoopshapingofL(s)Conditions(4.13)and(4.16),uniquelyimposedontheopen-looptransferfunctionL(s),mustbesatisﬁed:theﬁrstoneinhighfrequenciesandthesecondoneinlowfrequencies.Ontheotherhand,itisnecessarytohavesufﬁcientphasemargin.AssumingthatL(0)>0,letusconsiderthemostfavorablecasewhereL(s)isstableandminimumphase(wewillelaboratelaterwhythiswillbethemostfavorablecase)andassumethatL(0)>0.Letω0betheunitygainfrequency(whichwewillassumetobeuniqueforsimplicity).Let−20ndB/decade(n∈N)betheslopeofthemagnitudeofL(iω)inaneighborhoodofω=ω0.TheasymptoticBodeplotshowsthat,forn=2,thephaseisabout−180◦,whichcorrespondstoazerophasemargin.Ifn>2,itisnothardtoseethattheNyquistplotofL(s)encirclespoint−1clockwise,andsotheclosed-loopsystemisunstable.Theonlytwopossiblevaluesfornare1and0.Inthecasen=1,theBayard–Boderelation(seesection3.4.4,(3.19))showsthat,ifthecorrespondingslopeismaintainedover1decadecenteredlogarithmicallyatω0,thephaseofL(s)atthatfrequencycannotbesmallerthan−90(1+0,26)∼=−113◦,whichguaranteesaphaselagmarginof180−113=67◦,largelysufﬁcient.Ontheotherhand,maintainingthesameslopeoveronlyhalfadecadeguaranteesaninsufﬁcientphaselagmargin.Havinggottentheseresults,wecandeducethetypicalshapeaBodeplotofL(s)hastohave,i.e.theloopshaping6weneedtoachieveforthistransferfunction(seeFigure4.11).ThedifﬁcultproblemsarethosewhereperformanceandrobustnessrequirementsaresuchthatL(s)mustbethetransferfunctionofaveryselectiveﬁlterinthetwotransitionbands:theregiontotheimmediateleftofthelinesegmentofslope−20dB/decade,andtheregionlocatedtotheimmediaterightofthatsamesegment.Thislargeselectivitynecessitatesacontrollerofhighorder.Thevalueofthecutofffrequencyω0islimitedbythenecessarydelaymargin.6.Thisloopshapingdoestakeintoaccountthenecessity,previouslypointedout,oflimiting|K(iω)|inhighfrequencies.116LinearSystemsFigure4.11.LoopshapingofL(s)4.2.8.Degradationofrobustness/performancetrade-offUnstablepolesIntuitively,anunstablesystemishardertocontrolthanastablesystem.WecansupportthisintuitivejudgmentbyreasoningonthesensitivityfunctionSo(s).Theclosed-loopsystempossessesbothagoodmodulusmarginandagoodcapacityofattenuationofadisturbanceaddingtothecontrolledvariable,undertheconditionthatthequantity(cid:23)So(cid:23)∞shouldnotbetoolargecomparedto1.Inparticular,amodulusmarginMm≥0.5isobtainedwhen(cid:23)So(cid:23)∞≤2andthefeedbackintermsofdisturbanceattenuationisefﬁcientatfrequencyωif|So(iω)|≤1(seesections4.2.2and4.2.5).ThefollowingresultwasobtainedbyBode[9]inthecaseofastableopen-loopandgeneralizedbyFreudenbergandLooze[50](seealso[51],section3.4)inthecaseofanarbitraryopen-loop.SupposethetransferfunctionL(s)hasthefollowingtwoproperties:(i)ThesetofpolesofL(s)withpositiverealpartis{pj:j∈J},whereJisaﬁnitesetofindices(possiblyempty);(ii)L(s)hasarelativedegreeδ(L)≥2.Closed-LoopSystems117Thenthefollowingrelation(calledtheBoderelation,ortheBode–Freudenberg–Loozerelation)holds:+∞(cid:2)−∞ln|So(iω)|dω=2π(cid:11)j∈JRepj.(4.17)Thequantityontheright-handsideof(4.17)isnon-negative,andiszeroifandonlyifL(s)onlyhasstablepolesorpolesatthelimitofinstability(meaningtheyareontheimaginaryaxis).Andwededucethefollowingresult:PROPOSITION89.–IfthereexistsanintervaloffrequenciesIb,withnon-emptyinterior,onwhich|So(iω)|<1(i.e.ln|So(iω)|<0),theremustexistanotherintervaloffrequenciesIm,withnon-emptyinterior,onwhich|So(iω)|>1,sothattheintegralontheleft-handsideof(4.17)isnon-negative(andpositiveifL(s)haspolesintherighthalf-plane).Inotherwords,theefﬁciencyofacontrolsystem(intermsofdisturbanceattenuation)atcertainfrequenciesisobtainedatthepriceofaharmfuleffectofsuchacontrolsystem(relativetothesamepoint)atotherfrequencies.Thisislikea“communicatingvessels”effect.WhenL(s)hasunstablepoles,theright-handsideof(4.17)ispositive,which,onthewhole,makesthesituationmoreunfavorable.UnstablezerosContrarytowhatwemightthink,“unstablezeros”aremorepenalizingthan“unstablepoles”.Thisiswhatwewillshowbelow.Supposetheopen-looptransferfunctionL(s)hasthefollowingtwoproperties:(i)thesetofpolesofL(s)withpositiverealpartis{pj:j∈J},whereJisaﬁnitesetofindices(possiblyempty);(ii)L(s)hasatleastonezerozwithpositiverealpart.TheBlaschkeproduct[103]associatedwiththesetofpolesP={pj,j∈J}istherationalfunctionBP(s)=’j∈Jpj−s¯pj+sifJisnon-empty,=1ifJisempty.118LinearSystemsThistransferfunctionBP(s)belongsto(cid:1)H∞.AssumethatJisnon-empty.Sinceforanyindexj∈J,)))pj−s¯pj+s)))≤1ifandonlyifRe(s)≥0,wehave|BP(s)|≤1ifandonlyifRe(s)≥0.Letz=x+iybeazeroofL(s)withrealpartx>0,andletθzbethefunctiondeﬁnedbyθz(ω)=arctanω−yx.Wecanprovethefollowingresult[50]:+∞(cid:2)−∞ln|So(iω)|dθz(ω)=−πln|BP(z)|.(4.18)Theright-handsideof(4.18)isnon-negative.Inaddition,dθz(ω)=Wz(ω)dωwithWz(ω)=dθzdω(ω)=xx2+(y−ω)2>0,whichleadstothefollowingconclusion:PROPOSITION90.–ThepropertystatedinProposition89stillholds.Proposition90isnotaredundantversionofProposition89becauseitisbasedondifferenthypotheses:whilehypotheses(i)and(i’)aresimilar,(ii)and(ii’)areverydifferent.Ifwecomparetheleft-handsideof(4.17)tothatof(4.18),theintegralinthelastquantityincludes,asanadditionalterm,“weightingfunction”Wz(ω)which,beingmaximumatω=y,“focalizes”thisintegralonthefrequenciesintheneighborhoodofy.ThereadercancheckthefollowingusingTheorem432(section12.2.3):if(xn)isasequenceofpositivenumberstendingtozero,then(cid:15)1πdθzn/dω(cid:16)(wherezn=xn+iy)tendstoδy:t(cid:3)→δ(t−y)inD(cid:2);therefore,1π+∞(cid:1)−∞ln|So(iω)|dθzn(ω)→ln|So(iy)|.Asaresult,whentheopen-looptransferfunctionofL(s)hasan“unstablezero”z,itispenalizingforthesensitivityfunctionandthusforthemodulusmargin.Letusseewhatremedywecanﬁndinsuchasituation.LetL(cid:2)(s)=(cid:21)z+sz−s(cid:22)kL(s)wherekisthemultiplicityofthezeroz.ThetransferfunctionL(s)doesnothaveazeroats=zanymore,butats=−z(withamultiplicityequaltok).ProceedinginthismannerforeachunstablezeroofL(s),wearriveatanopen-looptransferfunctionClosed-LoopSystems119whichhasnounstablezeroanymore.Tosimplifytherationale,supposeL(s)hasauniqueunstablezeroz.WehaveL(s)−L(cid:2)(s)=L(cid:2)(s)E(s)(4.19)withE(s)∼2kszass→0.Asaresult,the“multiplicativeerror”thatiscausedbyreplacingL(s)withL(cid:2)(s)issuchthat|E(s)|(cid:16)1,ifandonlyif|s|(cid:16)|z|2k.Letω0bethelargestunitygainfrequencyofL(s),thatisω0=sup{ω:|L(iω)|=1}.Accordingtotheabove,unstablezerozbringsaninsigniﬁcantdeteriorationonthemodulusmarginontheconditionthatω0(cid:16)|z|2k.(4.20)Therefore,anunstablebut“rapid”zero(whichmeanstheabsolutevalue|z|islarge)isattheendonlyalittlepenalizing.Ifitis“slow”,itisnecessaryto“re-shape”theclosed-loopsystemuntilcondition(4.20)issatisﬁed,and,therefore,togiveupobtaininggoodperformance.REMARK91.–TheaboveisonlyvalidwhenRe(z)>0.Indeed,ifL(s)hasazeroz=iy(ontheimaginaryaxis),−zisagainontheimaginaryaxisandthetransferfunctionL(cid:2)(s)asconstructedaboveisunstable.Tosimplifytheanalysisofthissituation,supposethatz=iyisasimplezero(i.e.withmultiplicity1)ofL(s).PutL(cid:2)(s)=z+α+sz−sL(s),α>0.(4.21)ThetransferfunctionL(cid:2)(s)nolongerhasazeroats=zbutats=−z−α,therealpartofwhichis−α<0.Wethenhaverelation(4.19)with|E(iω0)|(cid:16)1ifα(cid:16)|ω0|(cid:16)|y|2.(4.22)Condition(4.22)iscoherentwith(4.20),eventhoughitcorrespondstoaquitedifferentsituation.4.2.9.*ExtensiontotheMIMOcaseRobustnessmarginsToextendtheaboveresultstothecaseofMIMOsystems,itisnecessarytocarefullydistinguishSiandTi,whicharethesensitivityfunctionandthe120LinearSystemscomplementarysensitivityfunction,respectively,attheinputofsystemP,fromSoandTo,whichareattheoutputofP(seesection4.1.2).Thisleadsustodeﬁnetwomodulusmargins:thatattheinputofP,denotedbyMmi,andthatattheoutputofP,denotedbyMmo.Thesequantities(calledtheinputmodulusmarginandtheoutputmodulusmargin)aredeﬁnedbythefollowingrelations:Mmi=1(cid:23)Si(cid:23)∞,Mmo=1(cid:23)So(cid:23)∞(seesection13.6.2forthedeﬁnitionofthe“H∞norm”ofatransfermatrix).Wecansimilarlydeﬁnetwocomplementarymodulusmargins–attheinputofP,denotedbyMmci,andattheoutputofP,denotedbyMmco–bytherelationsMmci=1(cid:23)Ti(cid:23)∞,Mmco=1(cid:23)To(cid:23)∞.TheMIMONyquistplotcannotprovideageometricalinterpretationfortheserobustnessmargins(seeExercise105).WecanalsodeﬁneagainmarginMgiandaphasemarginMpiattheinputoftheMIMOsystemP,andagainmarginMgoandaphasemarginMpoattheoutputofsamesystem,proceedinginthefollowingmanner[13]:DEFINITION92.–(i)Theinput(resp.,output)gainmarginisthelargestintervalMgi(resp.,Mgo),containing1,suchthatthefeedbacksystemremainsstablewhenthetransfermatrixP(s)isreplacedbyP(s)Λ(resp.,ΛP(s))foreverynon-negativesymmetricrealmatrixΛwhoseeigenvaluesbelongtosuchaninterval.(ii)Theinput(resp.,output)phasemarginisthelargestintervalMpi(resp.,Mpo),containing0,suchthatthefeedbacksystemremainsstablewhenthetransfermatrixP(s)isreplacedbyP(s)eiΦ(resp.,eiΦP(s))foreverysymmetricrealmatrixΦwhoseeigenvaluesbelongtosuchaninterval.NotethatΛandΦrepresenttheuncertainties,theﬁrstisonthe“gain”andthesecondisonthe“phase”.THEOREM93.–Relations(4.9)and(4.10)extendtotheMIMOcase,thatisMg∗⊃(cid:21)11+Mm∗,11−Mm∗(cid:22)(4.23)Mp∗⊃(cid:21)−2arcsinMm∗2,2arcsinMm∗2(cid:22)(4.24)with∗=ioro.Closed-LoopSystems121_KPMFigure4.12.UncertainfeedbacksystemPROOF.Theproofismadeforthegainandphasemarginsatsysteminput;thereasoningissimilarforthesamemarginsatsystemoutput.(i)LetΛ=(Im−M)−1.Thentheblockdiagramofthefeedbacksystem,withP(s)replacedbyP(s)Λ,isrepresentedasshowninFigure4.12.ThematrixMisfedbacktothetransfermatrix(Im+KP)−1=Si.Accordingtothesmallgaintheorem(Theorem87,section4.1.5),asufﬁcientconditionfortheclosed-looptoremainstableistherefore¯σ(M)(cid:23)Si(cid:23)∞<1andaccordingto(4.23)thisyields¯σ(M)<Mmi.(4.25)SinceM=Im−Λ−1,condition(4.25)holdsifandonlyifforeveryeigenvalueλofΛ,wehaveλ∈(cid:9)11+Mmi,11−Mmi(cid:10).(ii)LeteiΦ=(Im−M)−1.Thesufﬁcientconditionofstability(4.25)cannowbewrittenas7¯σ(cid:15)Im−e−iΦ(cid:16)<Mmi.(4.26)WehaveIm−e−iΦ=2ie−iΦ/2sinΦ/2([52],section9.12),andtherefore¯σ(cid:15)Im−e−iΦ(cid:16)=2¯σ(sinΦ/2).Condition(4.26)isthereforesatisﬁedifandonlyif|ϕ|<2arcsin(Mmi/2)foreveryeigenvalueϕofΦ.7.ThematrixM=Im−e−iΦhascomplexentries,neverthelessthesmallgaintheoremisstillvalidinthatcase.Ontheotherhand,eiΦisthe“phase”,atagivenfrequency,ofatransfermatrixbelongingto(cid:5)Hm×m∞.122LinearSystemsMIMOdelaymarginDEFINITION94.–Theinput(resp.,output)delaymarginistheleastupperboundMRi(resp.,MRo)oftherealnumbersrforwhichtheclosed-loopsystemremainsstablewhenthetransfermatrixP(s)isreplacedbyP(s)e−Rs(resp.,e−RsP(s))foranysymmetricrealmatrixR≥0whoseristhelargesteigenvalue.THEOREM95.–AnupperboundofthedelaymarginMR∗is(cid:23)sT∗(s)(cid:23)−1∞with∗=ioro.PROOF.*TheproofisdoneforthedelaymarginatinputofP.Since˜P(s)=P(s)(Im+E(s)),replacingP(s)by˜P(s)=P(s)e−RsintroducesamultiplicativeerrorE(s)=e−Rs−Imattheinput.TheratioE(s)/sisfedbacktosTi(s),inthesensewheretheclosed-loophasanequivalentdiagramasdepictedinFigure4.1withP(s)andK(s)replacedbyE(s)/sandsTi(s),respectively(seesections2.6.2and2.6.3).Now,E(s)s=e−Rs/2(cid:9)e−Rs/2−eRs/2(cid:10)/sandthusfors=iω(cid:5)=0,¯σ(cid:21)E(iω)iω(cid:22)≤2¯σ(cid:9)e−Riω/2(cid:10)¯σ(cid:21)sin(Rω/2)ω/2(cid:22).Weimmediatelygetsupω>0¯σ(cid:21)sin(Rω/2)ω/2(cid:22)=r.(4.27)Ontheotherhand,sin(Rs/2)s/2doesnothaveapoleintheclosedrighthalf-plane,andsoaccordingto(4.27),thistransfermatrixbelongstotheHardyspaceHm×m∞(seesection13.6.3).Accordingtothesmallgaintheorem(Theorem87,section4.1.5),thestatementofwhichisstillvalidwhen(cid:1)H∞isreplacedbyH∞,asufﬁcientconditionforstabilityoftheclosed-loopsystemisr(cid:23)sTi(s)(cid:23)∞<1.Thisprovesthetheorem.*RobuststabilitytheoremLetusgeneralizeTheorem88.Considertheso-calledstandarddiagraminFigure4.13.ThesystemPaiscalledtheaugmentedsystemand∆representsthemodeluncertainty.ThesystemsPa,∆andKareassumedtobelineartime-invariantandminimal.Therefore,theycanbeidentiﬁedwiththeirrespectivetransfermatricesPa(s),∆(s)andK(s).Closed-LoopSystems123u1y1y2u2PaKFigure4.13.StandarddiagramDenotebyFl(Pa,K)(resp.,Fu(Pa,∆))thelineartime-invariantsystem–orthecorrespondingtransfermatrix–withinputu1andoutputy1when∆=0(resp.,withinputu2andoutputy2whenK=0);FlandFuarecalledlinearfractionaltransformations(LFTs)and,aseasilyseen,theyaregivenbyFl(Pa,K)=Pa11+Pa12K(I−Pa22K)−1Pa21,Fu(Pa,∆)=Pa21∆(I−Pa11∆)−1Pa12+Pa22wherePa=(cid:27)Pa11Pa12Pa21Pa22(cid:28).LetB1(Pa)bethesetofallrationaltransfermatrices∆forwhichthetwofollowingconditionshold:(i)σ(∆(iω))<1,∀ω≥0;(ii)Fu(Pa,∆)andFu(Pa,0)havethesamenumberofpolesintheclosedright-halfplane,andhavethesamepolesontheimaginaryaxis(ifany),takingintoaccountmultiplicities.Onecanprovethefollowing[89]:THEOREM96.–AssumethatKstabilizesFu(Pa,0).ThenKstabilizesFu(Pa,∆)forevery∆∈B1(Pa)ifandonlyif(cid:23)Fl(Pa,K)(cid:23)∞≤1.ToseehowTheorem96canbeused,consider,e.g.thecaseofamultiplicativemodelerror.Supposethetransfermatrix˜P(s)ofthesystemtobecontrolled˜PcanbeexpressedasafunctionofthetransfermatrixP(s)ofthemodelPfollowing˜P(s)=(Ip+E(s))P(s).Thediagramoftheclosed-loopsystemcanberepresentedasin124LinearSystems-y2u2PKy1u1W1+Figure4.14.Closed-loopwithmultiplicativeerrorFigure4.14whereσ(∆(iω))<1,∀ω≥0.ThisdiagramcanthenbeputintheformgiveninFigure4.13with(cid:27)0P−W1I−P(cid:28).Therefore,Fu(Pa,∆)=−(I+W1∆)P=−(I+E)P=−˜PwhereE=W1∆,andFl(Pa,K)=−PK(I+PK)−1W1.Considerthefollowingconditions:(i)ThecontrollerwithtransfermatrixK(s)stabilizesP(s);(ii)P(s)and˜P(s)havethesamenumberofpolesbelongingtotheclosedrighthalf-plane,takingintoaccountmultiplicities;(iii)P(s)and˜P(s)havethesamepolesontheimaginaryaxis,takingintoaccountmultiplicities;(iv)ThereexistsatransferfunctionW1(s)∈(cid:1)H∞suchthat¯σ(E(iω))<|W1(iω)|,foranyfrequencyω≥0.LetEbethesetoftransfermatricesE(s)satisfyingconditions(ii)–(iv),assumingthatcondition(i)holds.Thefollowing,whichwasprovedin[114](section7.4),isnowanobviousconsequenceofTheorem96(comparewithTheorem88):COROLLARY97.–Anecessaryandsufﬁcientconditionfortheclosed-loopsystemtobestableforanymodelingerrorE(s)∈Eis(cid:23)W1To(cid:23)∞≤1.REMARK98.–(i)Theorem96isprovedusingtheMIMONyquistcriterion(Theorem86),notthesmallgaintheorem.Indeed,itisnotassumedthat∆isatransfermatrixwithentriesin(cid:1)H∞(and∆canactuallyhavepolesintheclosedrighthalf-plane).(ii)InCorollary97,themultiplicativemodelerrorEisassumedtobeattheoutputofP.IfthiserrorisattheinputofP,thenecessaryandsufﬁcientconditionofclosed-loopstabilityischangedto(cid:23)W1Ti(cid:23)∞≤1.Regardingperformance,aninequalitysuchas(4.14)canalsocharacterizeasatisfactoryattenuationofadisturbanceattheoutputofP.ThecompromisebetweenClosed-LoopSystems125robustnessandperformanceremainsclearifthemultiplicativeuncertaintyislocatedattheoutputofP,sinceSo+To=Ip,butthisisnolongerthecasewhenthemultiplicativeuncertaintyisattheinputofP,sincethenwemustcompareSoandTi,andthesetwoquantitiesnolongerhaveasimplerelationship.ShapingofsingularvaluesofLo(s)Theloopshapingstudiedinsection4.2.7canalsobeextendedtotheMIMOcase.ThetransfermatricesLi(s)=K(s)P(s)andLo(s)=P(s)K(s)havetobedistinguished.IfweareinterestedinrobustnessagainstuncertaintieslocatedattheoutputofP,aswellasintheattenuationofadisturbanceaffectingtheoutputofP,thetransfermatrixLo(s)oftheopenloopatoutputofPhastobeconsidered.Supposewehave˜P(s)=(Ip+E(s))P(s)andthatthemultiplicativeerrorE(s)atoutputofPisonlylargeinhighfrequencies,inotherwordstheabovetransferfunctionW1(s)satisﬁes|W1(iω)|(cid:18)1onlyforlargevaluesofω.Then,thenecessaryandsufﬁcientconditioninCorollary97,whichis(cid:23)W1To(cid:23)∞≤1,onlyimplies¯σ(To(iω))(cid:16)1forlargevaluesofω.SinceTo=(Ip+Lo)−1Lo,wehave¯σ(To(iω))∼¯σ(Lo(iω))andthecondition¯σ(To(iω))|W1(iω)|≤1implies¯σ(Lo(iω))(cid:25)1|W1(iω)|(cid:16)1.(4.28)Thisreplacescondition(4.13).SupposealsothatheavyattenuationofthedisturbanceisrequiredbyspeciﬁcationssheetonlyatoutputofPforsmallvaluesofω.Thisrequirementtranslatesintoaninequalitysuchas(4.14)wherethetransferfunctionW2(s)onlysatisﬁes|W2(iω)|(cid:18)1forsmallvaluesofω.SinceSo=(Ip+Lo)−1,wehaveaccordingtoProposition581(section13.5.7)¯σ(So(iω))=1σ(Ip+Lo(iω))andthisquantitycannotbelargerthan1|W2(iω)|,fromwhichwegettheconditionσ(Lo(iω))(cid:2)|W2(iω)|(cid:18)1(4.29)whichreplaces(4.16).Conditions(4.29)(athighfrequencies)and(4.29)(atlowfrequencies),plustheconsiderationsonthemodulusmargin,contributetoshapeofthesingularvaluesofLo(iω)asinFigure4.15.Robustness/performancecompromiseTherobustness/performancecompromiseseemsmoredifﬁculttoachieveinthecaseofMIMOsystems(ascomparedtoSISOones)whenthesingularvaluesofLo(iω)areverydifferent,thatistosaywhenthematrixLo(iω)isill-conditioned(see126LinearSystemsdBlog|W2(i)||W1(i)|1(Li(i))(Li(i))Figure4.15.LoopshapingintheMIMOcasesection13.5.7).ThisisnonethelessinevitablewhenthesystembeingcontrolledPisitself“ill-conditioned”(whichistosaythatitstransfermatrixP(iω)hasnon-zerosingularvaluesofaverydifferentmagnitude),asituationwhichisveryunfavorable.ThemostimportantpointisthatLo(iω)thenmusthaveaconditionnumbercloseto1atfrequenciesωsuchthat¯σ(Lo(iω))(cid:9)1(wethenhave¯σ(Lo(iω))(cid:9)σ(Lo(iω))(cid:9)1):thisistheso-called“singularvaluebalancing”method(whichisvisiblynotusedinthecaseofFigure4.15).Wecannotgointomuchfurtherdetailsonthissubject(seee.g.[90]).Theresultspresentedinsection4.2.8,relativetothedegradationoftherobustness/performancetrade-offduetothepresenceofunstablepolesandzeros,canbegeneralizedforthemostparttothecaseofMIMOsystems(see[51],[27]).SystemconditioningInthepreviousdiscussion,wehavepointedoutamajordifﬁcultypresentedby“ill-conditioned”MIMOsystems.Wearenowgoingtoexamineaseconddifﬁculty.Theshapingofsingularvalues,asshowninFigure4.15,relatestothetransfermatrixLo(s).Assumingthatthisshapingiscorrectlydone,canwededucethattheclosed-looppresentsgoodrobustnessandperformanceattheinputofP?Inotherwords,doesthatalsoimplycorrectloopshapingwiththesingularvaluesofLi(s)?WehavethefollowingresultforthecasewherethetransfermatricesP(s)ofPandK(s)ofKaresquare(ofdimensionm×m)andinvertible(inthealgebraR(s)m×m),denotingbyκ(.)theconditionnumberofthematrixinparentheses(section13.5.7):Closed-LoopSystems127PROPOSITION99.–Wehave1κ(P)σ(Lo)≤σ(Li)≤¯σ(Li)≤κ(P)¯σ(Lo)(4.30)1κ(P)σ(Li)≤σ(Lo)≤¯σ(Lo)≤κ(P)¯σ(Li).(4.31)PROOF.WehaveLi=KP=P−1PKP=P−1LoP,andtherefore¯σ(Li)≤¯σ(cid:15)P−1(cid:16)¯σ(P)¯σ(Lo)=κ(P)¯σ(Lo).Theotherinequalitiesareprovedbysimilarlinesofreasoning.AgoodapproachforrobustcontrolofMIMOsystemshastoleadtoacorrectshapingofboththesingularvaluesofLo(s)andthoseofLi(s).TheH∞synthesismethodbasedontherepresentationofP(s)bya“normalizedcoprimefactorization”,duetoMacFarlaneandGlover[89],issupposedtoleadtosucharesult(however,theirworkisoutsidethescopeofthisbook).FromProposition99,onecanconcludethattheregulationofwell-conditionedMIMOsystemsposesnomajorproblem.However,problemsassociatedwithill-conditionedMIMOsystemsseemalmostintractable,whateverthemethodusedtosynthesizethecontrollaw.4.3.ExercisesEXERCISE100.–ConsiderthetransferfunctionP(s)=1s(1+s)(1+0,25s)ofaminimalsystemP.(i)TracetheasymptoticBodediagramofP(s)andsketchfromtheretheshapeofitsBodeplot.(ii)TracetheshapeoftheNyquistdiagramofP(s).(iii)TracetheshapeofitsBlackplot.(iv)GivenbelowisatableofvaluesoftheBodeplotofP(s):ω(rad/s)0,4412Gain(dB)6,3-3,3-14Phase(◦)-120-149-180Determinetheproportionalcontrollerforwhichtheclosed-loopsystemhasaphasemarginof60◦.Whatarethenthevaluesofthedelaymarginandgainmargin?EXERCISE101.–LetP(s)=1s2bethetransferfunctionofaminimalsystemPfedbackbyaminimalcontrollerKwithtransferfunctionK(s)=ss+1.(i)AccordingtoTheorem76,isthefeedbacksystemstable?(ii)Determinethetransfermatrixofrelation(4.2).Isthatconsistentwith(i)?(iii)TracetheNyquistplotofL(s).(iv)ByapplyingtheNyquistcriterion(Theorem84),studythestabilityoftheclosed-loop128LinearSystemssystem.(v)SomeauthorsstatetheNyquistcriterionwithanindentedimaginaryaxisthatisdifferentfromthatconstructedforTheorem84:thesemi-circlesJk(ε)goroundthepointspklocatedontheimaginaryaxistotheright,insteadoftotheleft(seeFigure4.2),nP(resp.,nK)isthereforethenumberofpolesofP(s)(resp.,K(s))(accountingformultiplicities)thatbelongtotheopenrighthalf-plane.Accordingtothisexample,isthecriterionobtainedcorrect?EXERCISE102.–LetP(s)=1s−1bethetransferfunctionofaminimalsystemPfedbackbytheminimalcontrollerKwithtransferfunctionK(s)=s−1s+1.(i)Answeragainquestions(i)–(iv)ofExercise101(usingTheorem80insteadofTheorem84).(ii)SomeauthorsreplacethestatementofTheorem80bythefollowing:“Theclosed-loopsystemisstableifandonlyifnL=N,wherenListhenumberofpolesofL(s)(accountingformultiplicities)locatedintheclosedrighthalf-plane”.Isthisstatementcorrect?EXERCISE103.–ThehypothesesarethoseofTheorem80.IfP(s)andK(s)bothbelongto(cid:1)H∞,showthat,accordingtotheNyquistcriterion,wehavethefollowingsufﬁcientconditionofstability:“Theclosed-loopsystemisstableifallpointsofintersectionbetweenthecurve{L(iω),ω≥0}andtherealaxisarelocatedtotherightofpoint−1.Isthisanecessarycondition?EXERCISE104.–AtransferfunctionP(s)∈(cid:1)H∞issaidtobepositivereal(PR)ifReP(iω)≥0foranyω≥0,andisquasi-strictlypositivereal(QSPR)ifReP(iω)>0foranyω≥0[61].ThehypothesesarethoseofTheorem80.UsingtheNyquistcriterion,showthatifbothP(s)andK(s)arePRandatleastoneofthemisQSPR,thentheclosed-loopsystemisstable.EXERCISE105.–*LetPγbeasystemdeﬁnedbythedifferentialequation˙y=A0y+BγuwithA0=(cid:27)−100−1(cid:28)andBγ=(cid:27)1−γ01(cid:28),γ≥0,fedbackbythecontrollerK=I2.(i)TracetheMIMONyquistplotofLo(s)=P(s)K(s)=K(s)P(s)=Li(s).Whatisthedistancefromthisplottocriticalpoint−1?(ii)AssumethatthemodelingerrorcanbeeffectedbyreplacingtheabovematrixA0bythematrixAε=(cid:27)−10ε−1(cid:28),ε>0.Showthatforanyε>0,theclosed-loopsystemisunstableforasufﬁcientlylargeγ.(iii)Showthatforγ→+∞,Mmi,γ=Mmo,γtendstoward0,whereMmi,γ(resp.,Mmo,γ)istheinput(resp.,output)modulusmarginofthesystemPγfedbackbythecontrollerK.(iv)Whatcanbeconcluded?Chapter5CompensationandPIDController5.1.Onedegreeoffreedomcontroller5.1.1.Closed-loopsystemWehavealreadyseeninthepreviouschapterthatinsomecases,aproportionalcontrollercouldbeusedtostabilizeasystembyfeedback,oreventoobtainagivenphasemargin(seeExample85,section4.1.4,andExercise100,section4.3).Nevertheless,itisclearthattheclassofproportionalcontrollersisfartoorestrictedtoallowforapropershapingoftheopen-looptransferfunction(seesection4.2.7).Thischapterisdedicatedtothestudyofclassiccontrollersthatcanimprovetherobustness/performancecompromisewhenacontrollerwithonedegreeoffreedom(1-DOF)isused.The1-DOFcontrollerKisshowninFigure5.1.Inthisﬁgure,uandydenote,respectively,thecontrolandtheoutputofP,nisthemeasurementnoise(duetothepresenceofthesensor),duanddyareadditivedisturbancesactingonuandy,respectively,andrisareferencesignal.Theobjectiveoftheregulationistorendertheerrore=y−rassmallaspossibleinsteadystate,assumingthatthespectrumofthedisturbancesandthatofthereferencesignalisonlylocatedatlowfrequencies,andthusthesesignalscanbemodeledasconstants.Thespectrumofthemeasurementnoiseisassumedtobelocatedathighfrequencies.5.1.2.Closed-loopequationsandstaticerrorThesystemPisSISO,thereforethereisnoneedtodistinguishthesensitivityfunctionsatinputandatoutputofP;bothofthemaredenotedbySo.WethushaveSo=11+L,whereL=PK=KPistheopen-looptransferfunction.ThecomplementarysensitivityfunctionisdenotedasTo=1−So.Itiseasytoshow129Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.130LinearSystemsKP+-y+udu+dy+0nFigure5.1.1-DOFcontrollerthattheclosed-loopsystemisgovernedbythefollowingrelations(assumingthattheinitialconditionsarezero):ˆe(s)=So(s)(cid:9)ˆdy(s)−ˆr(s)+P(s)ˆdu(s)(cid:10)−To(s)ˆn(s)(5.1)ˆu(s)=So(s)ˆdu(s)+K(s)So(s)(ˆr(s)−ˆn(s)).(5.2)AlltheanalysisdoneinChapter4remainsvalid.Westillneedtopreciselyestablishunderwhatconditionthestaticerroriszero(i.e.e(t)=0insteadystate);itisunderstoodthattheclosed-loopsystemisstable.Thisonlymakessenseiftheinﬂuenceofnoneisneglected,whichmeansonehastoassumethatcondition(4.13)holdswithanappropriateweightingfunctionW1(s)(seesection4.2.6).Letusconsiderthefollowingtwocases:(i)du=0.ThenthestaticerroriszeroifandonlyifthestaticgainofSo(s)iszero(seesecton3.1.2),i.e.So(0)=0.(ii)du(cid:5)=0.ThenthestaticerroriszeroifandonlyifthestaticgainofbothSo(s)andSo(s)P(s)iszero.Tospecifytheabove-givenconditions,letusexpressthetransferfunctionsP(s)andK(s)intheformofirreduciblerationalfunctionsB(s)A(s)andR(s)S(s),respectively,whereA(s),B(s),R(s),S(s)belongtoR[s].WehaveSo(s)=A(s)S(s)A(s)S(s)+B(s)R(s),So(s)P(s)=B(s)S(s)A(s)S(s)+B(s)R(s).Asaresult:(a)Insituation(i),thestaticerroriszeroifandonlyifA(0)=0orS(0)=0.SinceL(s)=B(s)R(s)A(s)S(s),thismeansthattheopen-looptransferfunctionhasazeroCompensationandPIDController131pole(i.e.theopen-loopisanintegratorsystem:seeDeﬁnition32).IfPisalreadyanintegratorsystem,itisunnecessarythatcontrollerKbeonetoo.(b)Insituation(ii),thestaticerroriszeroifandonlyifthetwofollowingconditionshold:A(0)S(0)=0andB(0)S(0)=0.Supposetheﬁrstequalityholds,thenB(0)cannotbezero,forotherwisethecharacteristicpolynomialoftheclosed-loop,Acl(s)=A(s)S(s)+B(s)R(s),wouldhavearootequalto0,andtheclosed-loopsystemwouldbeunstable(seeTheorem76,section4.1.3).Therefore,itisnecessary(andsufﬁcient)thatS(0)=0,i.e.thatthecontrollerKbeintegrator.5.2.Leadcompensator5.2.1.CharacteristicsofaleadcompensatorAleadcompensatorisaminimalsystemwithtransferfunctionformHα,τ(s)=1+ατs1+τswhereτ>0isatimeconstantandαisarealnumbergreaterthan1.TheBodeplotofHα,τ(s)(withitsasymptoticdiagram)isrepresentedinFigure5.2forthecaseofτ=1andα=5.Themaximumvalueϕdofthephase(denotedasφintheﬁgure)isgivenbyϕd=arcsinα−1α+1(5.3)Figure5.2.Bodeplotofaleadcompensator132LinearSystemsanditisattainedattheangularfrequencyω0=1τ√α(5.4)whichisthelogarithmicmeanof1ατand1τ(thisfrequencyisdenotedasωinFigure5.2).Wecaneasilyverifythatγ=|Hα,τ(iω0)|=√α(5.5)(seeExercise106(i)).5.2.2.PrinciplesofaleadcompensatorNow,wewilldetermineacompensatorthat:(i)producesamaximumphaseleadϕdatagivenfrequencyω0>0(with0<ϕd<90◦);(ii)hasunitygainatthatfrequency.Accordingtosection5.2.1,theminimalsystemwithtransferfunctionH(s)=1γHα,τ(s)answersthequestion,with,accordingto(5.3)and(5.4),α=1+sinϕd1−sinϕd,τ=1ω0√α,(5.6)andﬁnallywegetH(s)=1√α1+√αω0s1+1ω0√αs.(5.7)Consideragaintheexampleinsection4.2.3.Supposewewishtoobtainaphaselagmarginof45◦,nolongeratfrequency0.3rad/t.u.,butat0.5rad/t.u.Itisthusnecessaryto“accelerate”thefeedbacksystemandonecanforthispurposemakeuseofaleadcompensator.TheBlackplotofP(s)=1−s/3s(1+s/2)(1+2s)isrepresentedinFigure5.3,wherethetimeunitisinseconds.Tobringthepointat0.5rad/stoagainof0dBandaphaseof180◦+45◦=225◦,twooperationsarenecessary:(i)toaddagainof−2.91dB,whichcorrespondstoaratioof0.72;(ii)toaddaphaseof225◦−202◦=23◦atafrequencyω0=0.5rad/s.Operation(ii)isdoneusingaleadcompensatorhavingcharacteristics,accordingto(5.6)and(5.7),α=2.28andH(s)=0.661+3.0s1+1.324s.TheappropriatecontrollerthushasatransferfunctionK(s)=0.72H(s)=0.471+3.0s1+1.32s.TheBlackplotofthecompensatedsystem(i.e.L(s)=P(s)K(s))isrepresentedinFigure5.4.CompensationandPIDController133Figure5.3.BlackplotofP(s)Figure5.4.BlackplotofL(s)134LinearSystemsFigure5.5.StepresponsesInFigure5.5,weseeacomparisonoftwostepresponsesofthefeedbacksystem:thatobtainedwiththeproportionalcontrollerdeterminedatsection4.2.3(withgaink=0.35)(--)andthatobtainedwiththecontrollerK(s)determinedhereabove(-).Weclearlyseetheaccelerationduetotheleadcompensator.5.2.3.PDcontrollerThetheoreticaltransferfunctionofaproportionalandderivative(PD)controllerisoftheformKPD(s)=k(1+Tds)(5.8)wherek>0isthe“gainoftheproportionalterm”andTd>0isthe“timeconstantofthederivativeterm”.Suchacontrollerhasanimpropertransferfunction,andthereforeisnotpracticallyrealizable(seesection2.5.3)anddoesnotabidebytheconstraintashighlightedinsection4.2.6.The“purederivative”ofthetransferfunctionTdsisthereforereplacedbya“ﬁlteredderivative”withtransferfunctionTds1+TdNs,whereN>0isarealnumbercalledthe“ﬁlteringcoefﬁcientofthederivativeterm”.Thetransferfunction(5.8)isthusreplacedbyKPDF(s)=k(cid:21)1+Tds1+TdNs(cid:22)=λ1+ατs1+τswithλ=k,τ=TdNandα=N+1.Asaresult,KPDF(s)isthetransferfunctionofaleadcompensatorinserieswithaproportionalcontroller.CompensationandPIDController1355.3.PIcontroller5.3.1.PrincipleIntheexampleconsideredinsection5.2.2,astepresponsewithoutstaticerrorisobtainedbecausethesystemPconsideredisintegrator.Nonetheless,aconstantdisturbanceduaddedattheinputofPwillintroduceastaticerror,whichisalsoinevitableinanotherexamplewherePisnotanintegrator(seesection5.1.2).Thatiswhythemostwidelyusedcontrollershaveanintegralaction.1Amongthesecontrollers,thosethathavethesimpleststructureareofthe“proportionalandintegral”type(acontrollerthatisonlyofintegraltypecannotensurethestabilityoftheclosed-loopforaclassofcontrolsystemsPthatissufﬁcientlylarge).Thetransferfunctionofaproportionalandintegral(PI)controllerisoftheformKPI(s)=k(cid:21)1+1TIs(cid:22)(5.9)wherek>0isthe“gainoftheproportionalterm”andTI>0isthe“timeconstantoftheintegralaction”.Wehaveforω>0argKPI(iω)=arg(1+iTIω)−π2=arctan(TIω)−π2.(5.10)WecanthereforedetermineaPIcontroller,having“high-frequencygain”γ>0,andsuchthatforagivenω0>0,|KPI(iω0)|=1−argKPI(iω0)=ϕI,0<ϕI<90◦(5.11)whereϕIisthephaselagproducedbythePIcontrolleratfrequencyω0.From(5.10),thetwoaboveinequalitiesholdifandonlyifTI=1ω0tanϕI(5.12)γ=TIω0(cid:30)1+(TIω0)2(5.13)(seeExercise106(ii)).1.OnecasewheresuchanactionmustbeavoidedisthatwherePisaderivator,i.e.P(0)=0(seeDeﬁnition32).136LinearSystemsWiththeabovecompensation,weobtainaphaselagmarginequaltoMpontheconditionthatargP(iω0)−ϕI=−180◦+Mp.Accordingto(5.11),thisisrealizableifandonlyifMp−180◦<argP(iω0)<Mp−90◦.(5.14)5.3.2.ExampleConsidertheminimalsystemPwithtransferfunctionP(s)=21−0.1s(1+0.5s)(1+s).Thetimeunitisassumedtobeinseconds.Wewishtomakeuseofthissysteminawaythatthephaselagmarginis60◦.TheBlackplotofP(s)isrepresentedinFigure5.6.Startwithaproportionalcontrol.Bywayofverticaltranslation,wemovepointAPwithaphaseof−120◦(obtainedforanangularfrequencyof2rad/s)tounitygainbytheadditionofagainof3.79dB,whichcorrespondstoaratioof1.55.Theopen-looptransferfunctionthusbecomesLP(s)=3.11−0.1s(1+0.5s)(1+s).Figure5.6.BlackplotofP(s)CompensationandPIDController137Theunitygainangularfrequencyisthenω0P=2rad/s.Nowaddanintegralaction.Sincethisproducesaphaselag,itisnecessarytoﬁrstconsiderapointAPIintheBlackplotthathasaphaselargerthanAP;thispointisobtainedforanangularfrequencysmallerthan2rad/s,ω0PI=1rad/sforexample.Wewillbringthispointtounitygainandaphaseof−120◦bytwosuccessiveoperations:(i)addingagainof−2.06dB,whichcorrespondstoaratioof0.79;(ii)aphaselagof120◦−77.5◦=42.5◦.Operation(ii)canbeobtainedbyaPIcontrollerthathasintegralactiontimeconstantTI=1.09s(accordingto(5.12))andwhosehigh-frequencygainisγ=0.74(accordingto(5.1.2)).ThePIcontrollerfoundthushasatransferfunctionKPI(s)givenby(5.9)withk=0.79×0.74=0.58andTI=1.09s.TheBlackplotsofLP(s)(-)andLPI(s)=KPI(s)P(s)(--)areshowninFigure5.7.Finally,thestepresponsesofthetwofeedbacksystemsareshowninFigure5.8(lineswiththesameconventions).Onecanobservethe“slowing-down”oftheresponsebecauseoftheadditionoftheintegralaction(butalsothesuppressionofthestaticerror).Figure5.7.Blackplotsofcompensatedsystems138LinearSystemsFigure5.8.Stepresponses5.4.PIDcontroller5.4.1.IntegralactionandleadcompensatorAsseenabove,anintegralactionmakesitpossibletoeliminatethestaticerroratthepriceofslowing-downoftheclosed-loopsystem(section5.1.2)whereasaleadcompensatoracceleratestheclosed-loopsystem(section5.2.2).Wethusunderstandthat,bycombiningthesetwoeffects,onecaneliminatethestaticerrorwhilemaintainingasatisfactoryrapidityontheclosed-loopsystem.IfweuseasimplePIcontroller,thefrequencyω0atunitygainisrestrictedbycondition(5.14).Supposewewanttoobtainahigherunitygainfrequencyω0,notsatisfyingthiscondition.Wecanproceedinthefollowingmanner:(i)realizeaphaseleadϕdofunitygainatangularfrequencyω0(0<ϕd<90◦).(ii)putinserieswiththeabovephaseleadaPIcontrollerhavingunitygainatfrequencyω0andphaselagϕIatthissamefrequency(0<ϕI<90◦),whereargP(iω0)+ϕd−ϕI=−180◦+Mp.(5.15)(iii)putinserieswiththetwoabovecompensatorsagain1|P(iω0)|(ifexpressedindB,addagainof−|P(iω0)|dB).Relation(5.15)isrealizablewiththeaboveconstraintsoverϕdandϕIifandonlyifMp−270◦<argP(iω0)<Mp−90◦(5.16)CompensationandPIDController139aconditionthatislessrestrictivethan(5.14).ThecontrollerﬁnallyobtainedisofthePIDtype,aswewillseenext.Notethatrelation(5.15)involvesonlythedifferenceϕd−ϕI;wecanthusarbitrarilyﬁxthesumS=ϕd+ϕIordetermineSinsuchawaysoastominimizeanappropriatecriterion(e.g.theovershootofthestepresponse).AreasonablechoiceisS=90◦.Letusillustratewhathasbeensaidhereabovethroughtheexampleinsection5.3.2.Supposewewouldliketheclosed-loopsystemtohaveaphasemarginMp=60◦,butwithunitygainangularfrequencyω0=2rad/s.WehaveargP(iω0)=−120◦,thuscondition(5.14)isnotsatisﬁed,whereas(5.16)is.Accordingto(5.15),wehaveϕd=ϕI.TakingS=90◦,wethusobtainϕd=ϕI=45◦.Accordingto(5.12),TI=0.5s,andγ=1√2from(5.13);thePIcontrollerhavingunitygainatangularfrequencyω0hasatransferfunctionKPI(s)=1√2(cid:15)1+2s(cid:16)=0.707(cid:15)1+2s(cid:16).From(5.6),α=3+2√2andtheappropriateleadcompensatorhasatransferfunctiongivenby(5.7),i.e.H(s)=0.4141+1.21s1+0.21s.Finally,thelastcompensationtorealizeisagainof3.79dB,correspondingtoaratioof1.55.ThetransferfunctionofthedesiredPIDcontrolleristhereforeKPID(s)=0.4531+1.21s1+0.21s(cid:21)1+2s(cid:22).TheBlackplotofthecompensatedsystemisshowninFigure5.9.TheBodeplotsofthecompensatedsystemsareshowninFigure5.10:withtheproportionalcontroller(-),thePIcontroller(--),andthePIDcontroller(-.).ThestepresponsesofthefeedbacksystemsareshowninFigure5.11,andtheBodeplotsofthethreecontrollersobtainedareshowninFigure5.12(lineswiththesameconventions).5.4.2.ClassicformofaPIDcontrollerThemostclassicformofthetransferfunctionofaPIDcontrollerisK(s)=k*1+1TIs+Tds1+TdNs+(5.17)wherek>0isthe“gainoftheproportionalterm”,TI>0isthe“timeconstantoftheintegralaction”,Td≥0isthe“timeconstantofthederivativeterm”,andwhereN>0isthe“ﬁlteringcoefﬁcientofthederivativeterm”.140LinearSystemsFigure5.9.BlackplotofthecompensatedsystemwithPIDWecanwrite(5.17)intheformK(s)=k(1+N)s2+k(cid:9)NTd+1TI(cid:10)s+kNTITds2+NTds.Figure5.10.BodeplotsofcompensatedsystemsCompensationandPIDController141Figure5.11.Stepresponses(withP,PI,PID)Thetransferfunctionofthecontrollerobtainedinsection5.4.1isoftheformK(cid:2)(s)=κ1+ατ1s1+τ1s(cid:21)1+1τ2s(cid:22).(5.18)Figure5.12.BodeplotsofP,PIandPIDcontrollers142LinearSystemsAsaresult,wehaveK(s)=K(cid:2)(s)ifandonlyifδ=1+(α−1)τ1τ2:N=αδ−1,Td=Nτ1,k=κδ,TI=δτ2(5.19)(seeExercise106(iii)).ThecontrollerobtainedbycascadingaleadcompensatorandaPIcontrolleristhusaclassicPIDcontrollerifandonlyifN>0,i.e.τ1<τ2(5.20)arelationwhichissatisﬁediftheleadcompensatoractsuponfrequenciesthatarehigherthantheintegralaction,whichisoften(butnotalways)thecase.Reconsidertheexampleingiveninsection5.4.1:weobtainedacontrollerK(cid:2)(s)oftheform(5.18)withκ=0.453,τ1=0.21,α=5.83,τ2=0.5.Condition(5.20)issatisﬁed,andthereforethecontrolleriscalledaclassicPID.Therelations(5.19)yieldδ=3.02;N=0.92;Td=0.19s;k=1.37;TI=1.50s.5.5.ExercisesEXERCISE106.–(i)Proveexpressions(5.3),(5.4),and(5.5).(ii)Proveexpressions(5.12)and(5.13).(iii)Provetherelations(5.19).EXERCISE107.–LetPbethesystemconsideredinExercise100(section4.3).(i)SupposethereisaconstantdisturbancethataddstotheoutputofP(priortothecontrolledvariable).DoestheproportionalcontrollercalculatedinExercise100rejectthedisturbance?Inotherwords,istheregulationmadewithoutanystaticerror?(ii)Wewouldnowliketoacceleratethefeedbacksysteminamannertoobtainaunitygainangularfrequencyof1rad/sandalsoretainaphaselagmarginof60◦.Determineanappropriatecontroller.(iii)SupposenowthataconstantdisturbanceisaddedtotheinputofP.Istheanswertoquestion(i)stillexact?(iv)DetermineaPIDcontrollerforwhichthephasemarginis60◦withaunitygainangularfrequencyof1rad/s.Chapter6RSTController6.1.StructureandimplementationofanRSTcontrollerInthepreviouschapter,westudiedaclassofcontrollersofbasicstructure.Althoughthesecontrollersarequitecommonintheindustry,itisclearfromChapter4thattheydonotenableustoﬁndanaccuraterobustness/performancecompromise.Inordertomanagethiscompromiseinasatisfactorymanner–andeven,innumerouscases,justtoobtainastableclosed-loopintheabsenceofmodelingerror–itbecomesnecessarytoconsideramuchlargerclassofcontrollers.Thisisthesubjectofthepresentchapter.ConsideraSISOsystem,governedbythedifferentialequationA(∂)y=B(∂)u+d(6.1)where∂=ddtandwhereA(∂)∈R[∂]andB(∂)∈R[∂]arethepolynomialsA(∂)=∂n+a1∂n−1+···+anB(∂)=b1∂n−1+···+bn;disanunmeasureddisturbance,yisthevariabletoberegulated,anduisthecontrol.Wearealsogivenareferencesignalrandwecalle=y−r(6.2)thetrackingerror.Ourpurposeistodesignacontrollerthatmakesezeroinsteadystate–irrespectiveofthepresenceofthedisturbanced–andensuresagoodtransient143Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.144LinearSystemsresponse.Itisnecessarytomeasurey,andwedenotethemeasuredvariablebyz,sothatz=y+ν(6.3)whereνisthemeasurementnoise.AnRSTcontrollerislinearlyrelatedtotheinputu,themeasuredvariablez,andthereferencer,aswellastoaﬁnitenumberofderivativesofthesevariables.ItisthusgovernedbyadifferentialequationoftheformS(∂)u=−R(∂)z+T(∂)r(6.4)whereS(∂),R(∂),andT(∂)areelementsofR[∂].AnRSTcontrollerthushastwoinputs(zandr)andoneoutput(u).ItstransfermatrixisH(s)=(cid:23)−R(s)S(s)T(s)S(s)(cid:24).(6.5)Itisproperifandonlyifthefollowingconditionholds:max{d◦(R),d◦(T)}≤d◦(S).(6.6)ThestructureoftheRSTcontroller,resultingfromequation(6.4),isrepresentedinFigure6.1.ItcannotbeimplementedassuchbecausethedifferentialpolynomialsR(∂)andT(∂)generatederivativesofsignalszandr(exceptintheveryparticularcasewherethepolynomialsareofdegreezero).LetV(∂)beapolynomialsuchthatmax{d◦(R),d◦(T)}≤d◦(V)≤d◦(S)andallitsrootsbelongtothelefthalf-plane.InpassingintotheLaplacedomainwithzeroinitialconditions,equation(6.4)yieldsS(s)V(s)ˆu(s)=−R(s)V(s)ˆz(s)+T(s)V(s)ˆr(s).TS1Rr+-zuFigure6.1.InitialstructureoftheRSTcontrollerRSTController145sVsTsSsVsVsRsrˆ+-szˆsuˆFigure6.2.ImplementationoftheRSTcontrollerThisequationleadstotheimplementationdiagramgiveninFigure6.2,wherethethreetransferfunctionsR(s)V(s),T(s)V(s),andV(s)S(s)areproper.Suchacontrollerissaidtobewiththreedegreesoffreedom(3-DOF)–withreferencetotheabovethreetransferfunctions.IfT=R,relation(6.4)reducestoS(∂)u=−R(∂)(z−r)andthecontrolleris1-DOF(seesection5.1).Ontheotherhand,ifpolynomialR(∂)hasallitsrootsinthelefthalf-plane,andifd◦(T)≤d◦(R),wecanchooseV=RandthecontrollerinFigure6.2isreducedtotwodegreesoffreedom(2-DOF).6.2.Closedloop6.2.1.Closed-loopequationsAccordingto(6.1),(6.2),(6.3),and(6.4)weobtainAcl(∂)y=S(∂)d−B(∂)R(∂)ν+B(∂)T(∂)r(6.7)Acl(∂)e=S(∂)d+{B(∂)[T(∂)−R(∂)]−A(∂)S(∂)}r−B(∂)R(∂)ν(6.8)Acl(∂)u=−R(∂)d+A(∂)T(∂)r−A(∂)R(∂)ν(6.9)whereAcl(∂)=A(∂)S(∂)+B(∂)R(∂).(6.10)From(6.8)and(6.9),the“characteristicpolynomialofthecontrolledsystem”isAcl(∂)givenby(6.10),whichiscoherentwithTheorem76andDeﬁnition78(section4.1.3).146LinearSystems6.2.2.PoleplacementandstabilityPoleplacementconsistsofﬁxinginadvancepolynomialAcl(∂)or,equivalently,therootsofthispolynomial,i.e.thepolesofthecontrolledsystem.WeareledtodeterminepolynomialsS(∂)andR(∂)suchthatequation(6.10)canbesatisﬁed.ThisequationisaBézoutequation(seesection13.1.5).ItadmitsasolutionifandonlyifAcl(∂)isamultipleofthegreatestcommondivisor(gcd)ofA(∂)andB(∂)(Theorem494).AccordingtoDeﬁnition74(section4.1.3),thecontrolledsystemisstableifandonlyiftherootsofAcl(∂)arealllocatedinthelefthalf-plane(takingintoaccountthefactthatd◦(A)<d◦(B)andcondition(6.6)).Asaresult,itispossibletostabilizethesystemPdeﬁnedbytheleftformA(∂)y=B(∂)u(6.11)ifandonlyifgcd(A(∂),B(∂))hasallitsrootsinthelefthalf-plane;inaddition,itispossibletoobtainarbitrarilychosenpolesforthecontrolledsystemifandonlyifgcd(A(∂),B(∂))=1.Weareledtothefollowingdeﬁnition:DEFINITION108.–System(6.11)iscontrollable(resp.,stabilizable)ifgcd(A(∂),B(∂))=1(resp.,therootsofgcd(A(∂),B(∂))alllieinthelefthalf-plane).Nevertheless,obtainingacontrolledsystemwithcorrectlyplacedpolesresolvesonlypartoftheproblem.Itisnowappropriatetoconsiderthiswholeproblem,andthensolveit.6.3.UsualcaseThecaseweconsiderhereisonewherethereferencesignalandthedisturbancehavetheirspectruminlowfrequencies,andthusaremodeledasconstants,andwherethemeasurementnoisehasitsspectruminhighfrequencies.Thisframeworkhasalreadybeenstudiedinsections4.2.5,4.2.6and5.1.1.Ontheotherhand,system(6.11)isassumedtobecontrollable.6.3.1.DisturbancerejectionLetusstartbyprovidinganinterpretationofdisturbanced:supposethatthesystemtobecontrolledisaffectedbytwoconstantdisturbances,oneatinput,du,andtheotheratoutput,dy,asshowninFigure5.1.WritingP(s)=B(s)A(s),weobtainˆy(s)=ˆdy(s)+B(s)A(s)(cid:9)ˆuc(s)+ˆdu(s)(cid:10)RSTController147whereucisthecontrolsignalprovidedbythecontroller.Asaresult,weobtain(6.1)withu=ucandd=A(∂)dy+B(∂)du.Wecanhavetwocaseswhered=0:(i)du=0andA(0)=0(integratorsystem:seeDeﬁnition32);(ii)dy=0andB(0)=0(derivatorsystem:seeDeﬁnition32).Inthesetwoveryspeciﬁccases,thereisnoneedfordisturbancerejection,whichsimpliﬁesthestructureofthecontroller.Theyfallintothegeneralcontextofsection6.4,butwewillnotbecoveringitintherestofthissection.Theonlyinformationatourdisposalaboutthedisturbancedisthatitsatisﬁestheequation∂d=0.Accordingto(6.8),itis“rejected”–inotherwords,thankstothecontrolmechanism,itdoesnotaffecttheerroreinsteady-state–ifandonlyifS(∂)isamultipleof∂,orequivalentlyifS(∂)hasazeroroot:S(0)=0.(6.12)Theaboveconstraintimposesthecontrollertohaveazeropole(fromexpression(6.5)ofthetransfermatrix),orinotherwordstobeanintegrator(Deﬁnition32).6.3.2.AbsenceofstaticerrorTheonlyinformationwehaveaboutreferencesignalristhatitsatisﬁestheequality∂r=0.Supposecondition(6.12)holds.Accordingto(6.8),thetermrdoesnotaffecttheerroreinsteady-stateifandonlyifB(0)[T(0)−R(0)]=0.IfB(0)=0,from(6.9)and(6.10),s=0isarootofthecharacteristicpolynomialAcl(s)andthefeedbacksystemisnotstable;thispossibilityistoberuledout.Thestaticerroristhereforezero(whenν=0)ifandonlyifT(0)=R(0).(6.13)6.3.3.MeasurementnoiseﬁlteringAsmentionedinsection4.2.6,itisnecessaryforthecontrollertohavelimitedgainathighfrequenciesinsuchawaythatthemeasurementnoisedoesnotintroduceanexcessiveagitationintothecontrolvariable.Accordingto(6.6),therelativedegreeδ(cid:15)RS(cid:16)isnecessarily≥0andwecanarriveatimposingaconditionsuchthatδ(cid:15)RS(cid:16)≥δ0(6.14)148LinearSystemswhereδ0≥0isanon-negativeintegerchoseninadvance.Ifδ0=0,condition(6.14)imposesnothingmorethan(6.6).Withδ0≥1,condition(6.14)imposesablockingzeroatinﬁnityoforderδ0tothetransferfunctionRSofthecontroller(seesection2.4.7,Remark38).AccordingtoRemark65(section3.4.2),theBodediagramofthetransferfunctionRShasaslopethatisatmost−20δ0dB/decadeathighfrequencies.Itisthusthetransferfunctionofalow-passﬁlter(forδ0≥1);thelargertheδ0,themoreselectivetheﬁlter.Theintegerδ0istheroll-offofthecontroller(alreadymentionedinthepreface).Notethatthetransferfunctionthatrelatesνtoeis−To(s)(accordingtosections4.2.6and(6.8))andδ(To)=δ(cid:15)BA(cid:16)+δ(cid:15)RS(cid:16)(seesection13.6.1).Sinceδ(cid:15)BA(cid:16)≥1,condition(6.14)impliesδ(To)≥δ0+1.Theerroreisthuslesssensitivetothehigh-frequencymeasurementnoisethanthecontrolvariableu.6.3.4.ProblemresolutionStabilizabilityconditionPolynomialS(∂)isoftheform∂SI(∂),whereSI(∂)∈R[∂].PutAI(∂)=A(∂)∂,i.e.AI(∂)=∂n+1+a1∂n+···+an∂.(6.15)From(6.10),wehaveAI(∂)SI(∂)+B(∂)R(∂)=Acl(∂).(6.16)Nowletusapplythetheoryinsection13.1.5witha(s)=AI(s),b(s)=B(s),x(s)=SI(s),y(s)=R(s),andc(s)=Acl(s).PROPOSITION109.–ThereexistpolynomialsSI(∂)andR(∂)suchthatthepolynomialAcl(∂)hasallitsrootsinthelefthalf-planeifandonlyifB(0)(cid:5)=0,orequivalentlyifandonlyifthesystem(6.11)hasnozeroequalto0(i.e.isnotaderivatorsystem).PROOF.(i)IfB(0)(cid:5)=0,polynomialsAI(∂)andB(∂)arecoprime.Indeed,A(∂)andB(∂)hasnorootsincommon,forthesystem(6.11)isassumedtobecontrollable,andlikewise∂andB(∂)donothaveanyrootincommon.Asaresult,accordingtoTheorem494(section13.1.5),equation(6.16)admitsasolution(SI(s),R(∂))foranypolynomialAcl(∂).(ii)IfB(0)=0,Acl(0)=0becauseSI(0)=0.RSTController149DegreesofthepolynomialsAssumethatB(0)(cid:5)=0fromnowon.ThepolynomialR(s)isoftheformy0sυ+y1sυ−1+···+yυ.Sincethepolynomialsa(s)andb(s)arecoprime,thereexistsauniquesolution(x,y)=(SI,R)forwhichυ=α−1,whereα=n+1,thusυ=n.From(6.14),wehaved◦(S)=n+δ0,thereforeξ(cid:1)d◦(SI)=n+δ0−1.Sinceβ=n−1andδ0≥0,wehaveξ≥β,andthereforethesimpliﬁcationindicatedattheendofsection13.1.5canbemade.ThepolynomialsSIandAclarechosentobemonic.Wehaved◦(AS)=2n+δ0andd◦(BR)≤2n−1,thusd◦(Acl)=2n+δ0.PutS(∂)=∂n+δ0+σ1∂n+δ0−1+···+σn+δ0−1∂,R(∂)=r0∂n+r1∂n−1+···+rn,Acl(∂)=∂2n+δ0+c1∂2n+δ0−1+···+c2n+δ0.SylvestersystemTakingintoaccounttheabove-mentionedsimpliﬁcation,theSylvestersystem(13.13)(section13.1.5)canbewrittenas⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣10······00······0a11..................a1.........0......an......0b1...00......1......0.........a1bnb10.........0......b1...an......bn...0·········00···0bn⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣σ1σ2......σn+δ0−1r0r1...rn⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣c1−a1...cn−ancn+1............c2n+δ0⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦.(6.17)LetMbethematrixgivenaboveontheleft.Itsorderis2n+δ0.Thenumberofcolumnscontainingtermsai(resp.bi)isequalton+δ0−1(resp.n+1).Thenumberofzerosbelowthelastan(resp.abovetheﬁrstb1)isequalto1(resp.δ0).150LinearSystemsThematrixMisoftheform⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣10...0...0∗.................................100∗......∗Σ(a,b)∗0.........0bn⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦where∗eachtimestandsforanon-speciﬁedsubmatrix.SinceΣ(a,b)isinvertibleandbn(cid:5)=0,thismatrixisinvertible.Thisconﬁrmsthatthesystem(6.17)admitsauniquesolution.6.3.5.ChoiceofthepolesIntroductionTheintegralactionofthecontrollerensuresalargegainofL(s)atlowfrequencies.Byimposingδ0>1,weensureasmallgainofL(s)andofK(s)=R(s)S(s)athighfrequencies.Thestabilityoftheclosed-loopsystemisguaranteed(intheabsenceofmodelingerror)aslongastherootsofAcl(∂)arechoseninthelefthalf-plane.Anumberofspeciﬁcationspresentedinsection4.2arethereforesatisﬁed.Butsomeamongthesearenotyetconsidered,inparticular:(i)Howtoobtainasufﬁcientmodulusmargin?(ii)Howtoobtainasufﬁcientdelaymargin?(iii)Howtoobtainasufﬁcientrapidity?Tomeettheserequirements,theclosed-looppolesmustbechoseninanappropriateway.Forthisanalysis,weconsidertheclosed-loopintheequivalentformshowninFigure6.3.-sAI1sBsSsRIyFigure6.3.Closed-loop(equivalentdiagram)RSTController151sAI1BsKIu*Iuy_Figure6.4.PartialstatefeedbackPartialstatefeedbackAsaﬁrststep,assumethatthepartialstateξoftheminimalsystemwithtransferfunctionB(s)AI(s)isavailabletoprovidethefeedbackneeded(seesection2.3.5).Thissystem(theinputofwhichisuI=∂u)isrepresentedbytherightform(cid:20)B(∂)ξ=yAI(∂)ξ=uIwhereAI(∂)isthepolynomialofdegreen+1deﬁnedby(6.15).ThecontrolvariableuIoftheabovesystemischosentobeoftheformuI=u∗I−K(∂)ξwhereu∗IisasignalprovidedbythecommandandK(∂)isapolynomialsuchthatthecharacteristicpolynomialoftheclosed-loopisamonicpolynomialAcofthesamedegreeasAI,whichisn+1(seeFigure6.4).ThepolynomialAcisthusoftheformAc(∂)=∂n+1+γ1∂n+···+γn+1.Theclosed-loopisgovernedbythedifferentialequationAI(∂)ξ=u∗I−K(∂)ξ,fromwhichwegetAc(∂)ξ=u∗I,Ac(∂)=AI(∂)+K(∂).(ItisessentialtonotethatthetransferfunctionB(s)isnotpartoftheloop.)Asaresult,thepolynomialK(∂)isdeterminedbyK(∂)=Ac(∂)−AI(∂)(6.18)=(γ1−a1)∂n+···+(γn−an)∂+γn+1.152LinearSystemsTheopen-looptransferfunctioncorrespondingtoFigure6.4isgivenbyLe(s)=K(s)AI(s).Therefore,thecorrespondingsensitivityfunctionisgivenbySe(s)=11+Le(s)=AI(s)Ac(s).(6.19)Letp1,...,pn+1betherootsofAI(s)andπ1,...,πn+1betherootsofAc(s).Therootsπk(1≤k≤n+1)areofcourseassumedtohavenegativerealparts,sothatSe(s)∈(cid:1)H∞.Itisnothardtoprovethefollowinglemma:LEMMA110.–Asufﬁcientconditionfortheinequality)))iω−pkiω−πk)))≤1tobesatisﬁedforanyrootpkandatanyfrequencyωis:Imπk=ImpkandReπk≤−|Repk|.Lemma110providesasimplewayofchoosingtherootsofAc(s)asafunctionofthoseofAI(s)inordertoget(cid:23)Se(cid:23)∞=1,andthusamodulusmarginequalto1,whenthepartialstateisusedinthefeedbackloop.Indeed,wehave|Se(iω)|=’1≤k≤n+1))))iω−pkiω−πk)))).Thefollowingrulethusfollows,foranyintegerk,1≤k≤n+1:RULE111.–ChooseImπk=ImpkandReπk≤−|Repk|(withReπk<0).Thecriterionthatpresidesovertheaboveruleisuniquelythemodulusmargin.Otherconsiderationsofcourseneedtobetakenintoaccount,inparticulartherapidityandthedelaymargin,aswellas,possibly,thedampingcoefﬁcientofeachpole.Ontheotherhand,thisruleiscloselyrelatedtothe“linearquadraticcontrol”(see[20],PartI,andTheorem247ofsection8.1.4).SupplementarypolesCaseofaminimumphasesystemInreality,thepartialstateisingeneralunavailableforthecontrol(exceptintheparticularcasewhere0(cid:5)=B(∂)∈R).ThatiswhyitisnecessarytocomebacktotheBézoutequation(6.16).WechooseapolynomialAcl(∂)oftheformAcl=AcBF(6.20)whereAc(∂)isamonicpolynomialofdegreen+1,therootsofwhicharechosenaccordingtoRule111,andF(∂)isapolynomialofdegreem=δ(cid:15)BA(cid:16)+δ0−1,withrootsinthelefthalf-plane,andsuchthattheproductB(∂)F(∂)isamonicRSTController153polynomial.Thatway,Acl(∂)isindeedamonicpolynomialofdegree2n+δ0,alltherootsofwhichareinthelefthalf-planesince,fromhypothesis,therootsofB(∂)satisfythislastcondition.TheBézoutequation(6.16)canthusbewrittenasAISI=B(AcF−R).SinceAIandBarecoprime,thereexistsapolynomialQsuchthatSI=BQ.ThispolynomialQisnecessarilyofdegreeδ(cid:15)BA(cid:16)+δ0−1=d◦(F);wegetR=AcF−AIQ.(6.21)Theopen-looptransferfunctionisthereforeL=BAIRSI=BAIAcF−AIQBQ=FQAcAI−1fromwhichwededucethesensitivityfunction:So=11+L=QFAIAc.Equation(6.21)isaBézoutequationwithunknown(R,Q)forgivenAc,AI,andF.Previously,wehaveseenthatthisequationadmitsauniquesolutionsuchthatd◦(R)≤nandd◦(Q)=δ(cid:15)BA(cid:16)+δ0−1=m.Thissolution(R,Q)dependslinearlyonFandisdenotedasΨ(F).ThelinearmappingΨiscontinuous(inthesensespeciﬁedinTheorem112).Letnow(Fk)beasequenceofpolynomialshavingthesamepropertiesasthepolynomialFaboveandsuchthatask→+∞,allrootsofFktendto−∞whileremainingontherealaxis.Thereexistsasequenceofnon-zerorealnumbers(λk)suchthatλkFk→1(thesequenceconvergesinthesensespeciﬁedinTheorem112).Foranyintegerk,(Rk,Qk)=Ψ(Fk).Accordingto(6.21),wehaveλkRk+AIλkQk=AcλkFk.(6.22)SinceK+AI=Ac,wededucethatλkRk→KandλkQk→1.Therefore,QkFk→1andthesensitivityfunctionSo,k=QkFkAIAcconvergestothesensitivityfunctionSegivenby(6.19).Thefollowingtheoremdetailswhathasjustbeendiscussed:154LinearSystemsTHEOREM112.–Letthecharacteristicpolynomialoftheclosed-loopbedeﬁnedby(6.20),wheretherootsofAcarechosenaccordingtoRule111,andassumethatFisreplacedbyFk,where(Fk)isasequenceofpolynomialsasspeciﬁedabove.Then,(cid:15)(cid:23)So,k−Se(cid:23)∞(cid:16)→0.PROOF.*1)LetX(resp.,Y)bethesubspaceoftheR-vectorR[∂]consistingofallpolynomialswithdegree≤m(resp.≤n).ConsiderthelinearmappingΨ:X→X×Ydeﬁnedabove.ThespacesX,Yareﬁnite-dimensional,thereforeΨiscontinuous(seesection12.1.3).LetDbeaninﬁnitecompactsetincludedintheclosedrighthalf-plane.Thensups∈D|f(s)|=(cid:23)f(cid:23)(f∈X,resp.f∈Y)isanormonX(resp.Y),and(cid:23)(f,g)(cid:23)=sup((cid:23)f(cid:23),(cid:23)g(cid:23))(f∈X,g∈Y)isanormonX×Y.Let−1τ1,k,...,−1τm,kbetherootsofFk,whereτi,k>0(τi,k∈R).WehaveλkFk(s)=’1≤j≤m(1+τj,ks)(6.23)andlimk→+∞τj,k=0.Asaresult,(λkFk)→1uniformlyonD,i.e.((cid:23)λkFk−1(cid:23))→0.WehaveΨ(1)=(K,1),andthus((cid:23)λkRk−K(cid:23))→0and((cid:23)λkQk−1(cid:23))→0becauseofthecontinuityofΨ.Thismeansthat(λkRk)→Kand(λkQk)→1uniformlyonD.WehaveSo,k−Se=(cid:9)QkFk−1(cid:10)Se,andthussups∈D|So,k(s)−Se(s)|≤sups∈D))))Qk(s)Fk(s)−1))))(cid:23)Se(cid:23)∞,andthisquantitytendsto0ask→+∞.2)Wehavefrom(6.22)λkRk(s)Ac(s)+AI(s)Ac(s)λkQk(s)=λkFk(s).Fork→+∞,therootsofλkRkconvergetothoseofKaccordingto1)andd◦(λkRk)<d◦(Ac);therefore,for|s|→+∞(sremainingintheclosedrighthalf-plane),λkRk(s)Ac(s)→0uniformlywithrespecttok,thusλkQk(s)−λkFk(s)→0uniformlywithrespecttokbecauseAI(s)Ac(s)→1.Nowlets=iω,ω→+∞;wehave|1+τj,kiω|≥1foranyj∈{1,...,m}andanynaturalintegerk,therefore|λkFk(iω)|≥1accordingto(6.23);asaresult,)))Qk(iω)Fk(iω)−1)))→0uniformlywithrespecttok.Foranyε>0,itfollowsthatthereexistsafrequencyΩ>0,onlydependingonε,suchthat|So,k(iω)−Se(iω)|≤ε,foranyintegerk,aslongasω≥Ω.Ontheotherhand,accordingto1),thereexistsanintegerk0suchthat|So,k(iω)−Se(iω)|≤εforanyk≥k0andanyω∈[0,Ω](withD=[0,Ω]);thisintegerk0onlydependsonε.Foranyk≥k0,(cid:23)So,k−Se(cid:23)≤ε(seesection13.6.2),andthisprovesthetheorem.*RSTController155REMARK113.–(i)Thistheoremshowsthatonecanobtainamodulusmarginascloseto1asonewouldlikebychoosingapolynomialforFwhichisofdegreem=δ(cid:15)BA(cid:16)+δ0−1andtherootsofwhicharenegativerealwithsufﬁcientlylargeabsolutevalue.Accordingtorelations(4.9),(4.10),foramodulusmarginof1,wehaveaguaranteedgainmargin(−6dB,+∞)andaguaranteedphasemargin(−60◦,60◦).(ii)Thistheoremiscloselyrelatedtothe“LTRmethod”developedin[38].Nevertheless,inthecitedreference,onlythesimpleconvergenceof(So,k)toSeisobtained,whichdoesnotallowonetoconcludeanythingaboutthebehaviorofthemodulusmargin.Seesection9.1.4formoredetails.REMARK114.–LetSI,n=BQn.ThetransferfunctionofthecontrollerobtainedaboveisRn(s)sSI,n(s)=λnRn(s)sλnSI,n(s)→K(s)sB(s).Thetransferfunctionobtainedbytakingthelimitisthusimproper(exceptifd◦(B)=n−1).Thusacompromiseneedstobefoundbetweenthemodulusmargin(whichwillbeallthelargerastherootsofFare“faster”,i.e.willhavealargerabsolutevalue)andthesensitivityofthecontroltothemeasurementnoise.Caseofanon-minimumphasesystemTheprocedurejustdescribedisobviouslynotapplicabletothecaseofanon-minimumphasesystemsincetherootsofB(s)arethenunstable.(i)IfB(s)hasatleastonerootzwithpositiverealpart,wehaveseeninsection4.2.8thatwecouldreplacethezerozbythestablezero−z.WewillthusproceedthiswayforeachzerozsuchthatRez>0.(ii)IfB(s)hasatleastonerootontheimaginaryaxis(orsoclosetotheimaginaryaxisthatitcanbeconsideredaslocatedonit),wecanproceedasindicatedinRemark91(section4.2.8)byreplacingthiszerozby−z−α,whereα>0issuchthatcondition(4.22)holds;thisprocedurecanbecarriedoutforeachnon-zerorootofB(s)locatedontheimaginaryaxis.WethusconstructfromB(s)apolynomialB∗(s),allrootsofwhichbelongtothelefthalf-plane.Asalreadymentionedinsection4.2.8,themultiplicativeerrormadewhenreplacingB(s)byB∗(s)issmallifallunstablezerosofB(s)are“fast”withrespecttothemaximumunitygainfrequencyoftheclosed-loopsystem.Thisconsiderationmayleadtomaketheclosed-loopsystemslow,thuswithapoorperformance,asindicatedinthissamesection.Lastly,thechoicemadeforthepolynomialAcl(∂)isfollowing:Acl=AcB∗F.(6.24)Ofcourse,theBézoutequationtobesolvedisstill(6.16).156LinearSystemsChoiceofthepolynomialT(∂)ThepolynomialT(∂)canbechoseninsuchawaysothatsomeundesirabledynamicscanbecancelledinthetransferfunctionrelatingthereferencesignalrtotheoutputy.Thistransferfunctionis,accordingto(6.7),BTAcl.ThetwoonlyconstraintsthatT(∂)needstoobeyisthedegreecondition(6.6),whichisd◦(T)≤n+δ0,andequality(6.13).Itisdifﬁculttomakemoreprecisegeneralrecommendations,asshowninthefollowingexamples.REMARK115.–Withd◦(T)=n+δ0weobtainδ(BT/Acl)=d◦(B)+n+δ0−(2n+δ0)=δ(B/A).ThusbychoosingTadivisorofAcl,thecontrolledsystembehaves(intheabsenceofanydisturbanceandmodelingerror)likeasystemofthesameorderassystemP.6.3.6.ExamplesPIDdesignedbypoleplacementConsidertheminimalsystemPwithtransferfunctionP(s)=21−0.1s(1+0.5s)(1+s)(seesections5.3.2,5.4.1and5.4.2).Thissystemisdeﬁnedbytheleftform(∂+1)(∂+2)y=−410(∂−10)u.(6.25)Thissystemisnon-minimumphase,butitszerocanbeconsidered“fast”.LetusapplytheabovetheoryusingAc(∂)=(∂+2)3andAcl(∂)=Ac(∂)(∂+10)(whenceδ0=0).WeobtainR(∂)=(∂+2)(∂+1.26)101.26(6.26)S(∂)=∂(∂+16.18).(6.27)WecanputthetransferfunctionR(s)S(s)intheclassicform(5.17)ofthetransferfunctionofaPIDcontrollerwith:k=1.53;Ti=1.23s;Td=0.26s;N=4.22.Withthetimeunitinseconds,theBlackplotoftheopen-looptransferfunctionL(s)=B(s)A(s)R(s)S(s)isshowninFigure6.5.BychoosingT(∂)=R(∂),thecontrollerhas1-DOF,thatisitisaPIDinthemosttraditionalform.WecanseethebehaviorofthefeedbacksysteminFigure6.6withregardtothefollowingevents:(i)unitstepcommandattimet=0;(ii)unitstepdisturbanceofamplitude0.3addedtoyattimet=5s.*ThemeasurementnoiseisaGaussianwhitenoisewithstandarddeviation0.1(thecomputationstepis0.1s).1*Thetimeresponsesofthecontrolled1.Itisadiscrete-timewhitenoise,thecomputationstepisconsideredasbeingthesamplingperiod(seesection11.1).RSTController157Figure6.5.Blackplot(open-loopwithPID)systemwiththePIDdesignedbypoleplacement(-)andofthatwiththePIDdesignedusingthegeometricmethodofsections5.4.1and5.4.2(--)aresimulatedover10softime.Thetwocontrolledsystemshavepracticallyidenticalbehavior.Inbothcases,thenoiseﬁlteringispoor,thisisoneofthemajorinconveniencesofthePID(duetothederivativeaction,evenifthederivativeisﬁltered!).Figure6.6.TimedomainresponseswiththetwoPIDs158LinearSystemsAddingblockingzerosatinﬁnityConsideringthesamesystemasbefore,i.e.deﬁnedbytheleftform(6.25),takeAc(∂)=(∂+2)3againandconsiderthefollowingtwocases:(i)Acl(∂)=Ac(∂)(∂+10)2(fromwhichδ0=1);(ii)Acl(∂)=Ac(∂)(∂+10)3(fromwhichδ0=2).Inbothcases,wechooseT=R.Incase(i),weobtainR(∂)=(∂+2)(∂+1.23)1001.22(6.28)S(∂)=∂(∂+α)(∂+¯α)(6.29)withα=11.5+7.83i.Incase(ii),weobtainR(∂)=(∂+2)(∂+1.20)10001.20(6.30)S(∂)=∂(∂+β)(cid:15)∂+¯β(cid:16)(∂+18.46)(6.31)withβ=7.27+8.35i.CallK2theRSTcontroller,thepolynomialsofwhicharedeﬁnedby(6.26)and(6.27),K3theone,thepolynomialsofwhicharedeﬁnedby(6.28)and(6.29),andK4theone,thepolynomialsofwhicharedeﬁnedby(6.30)and(6.31)(K1denotesthePIDdeterminedinsections5.4.1and5.4.2).WithK2,thephaselagmarginis65.3◦andthedelaymarginis0.5s(aswecanseeinFigure6.5).WithK3(resp.K4),thephaselagmarginis62.5◦(resp.60.4◦)andthedelaymarginis0.6s(resp.0.67s).Addingfastsupplementarypolestotheclosed-loopsystemthushasatendencytoslightlyreducethephaselagmarginandincreasethedelaymargin(andthereforedeceleratingtheclosed-loopsystem).Thesevariations,hardlysigniﬁcant,areduetothefactthatthesupplementarypolesareat−10,whicharestillquitefarfrominﬁnity...ThecomparisonoftheBodeplotsoftheopen-looptransferfunctionsisshowninFigure6.7forthecontrollersK2(-),K3(--)andK4(-.).ForthetimeresponsesinFigure6.8theeventssimulatedarethesameasthepreviousones(seeFigure6.6,wheretheconventionsforthelinesarethesameasabove).WeseethattheBodeplotsarealmostidenticaluptotheunitygainfrequency(whichisoftheorderof2rad/s)andbecomeverydifferentatfrequencieshigherthan10rad/s(correspondingtotheabsolutevalueofthe“fastpoles”added).Thegreatertheroll-offδ0,thebetteristhemeasurementnoiseﬁltered(thisisparticularlyclearonthecontrolsignal).Otherthanthis(eventhoughthatisimportant,evencrucial),thethreetimeresponsesareverysimilar.RSTController159Figure6.7.BodeplotsofthethreecontrollersFigure6.8.Timedomainresponseswiththethreecontrollers160LinearSystemsAdifﬁcultcaseLetasystemnowbedeﬁnedbytheleftform(cid:15)∂2+1(cid:16)y=(∂−5)u.Thissystemispurelyoscillatoryandnon-minimumphase.Thedifﬁculty,inthepresentcase,isthatifwedampthepoles±itoomuch,thephasemarginwilldegrade.Aftersomeoftrialanderror,thefollowingchoiceturnsouttobecorrect:Ac(∂)=(∂+1)(∂+0.5+i)(∂+0.5−i)Acl(∂)=Ac(∂)(∂+5)(∂+10),wherethepole−10isaddedtogetδ0=1.ThepolynomialT(∂)ischoseninsuchawaysoastocancelbothpoorlydampedcomplexconjugatepolesoftheclosed-loopandtherapidpole.OneobtainsR(∂)=−12.5|γ|2(∂+γ)(∂+¯γ)S(∂)=∂(∂+λ)(cid:15)∂+¯λ(cid:16)T(∂)=µ(∂+0.5+i)(∂+0.5−i)(∂+10)withγ=0.15+0.69i,λ=8.50+5.84i,andwhereµissuchthatT(0)=R(0)=−12.5.TheBodeplotoftheopen-looptransferfunctionL(s)isshowninFigure6.9.Wenotethatthephaselagmarginisapproximately44◦,whichisreasonable.Thesameconclusionisforthegainmarginwhichisintherange(−∞,10dB).ThetimeresponsesinFigure6.10showthesystembehaviorfacedwiththefollowingevents:(i)unitstepcommandatt=0;(ii)stepdisturbanceofamplitude0.3addingtoyattimet=10s.Wecanseetheexcellentqualityofthestepresponse,withoutovershootandhavinga“negativestart”(seesection3.6,Exercise72).Theresponsetothedisturbancehasverydifferentdynamicsbecause,contrarytothereferencesignal,thisdisturbanceexcitestheoscillatorydynamicsoftheclosed-loop.Ofcourse,theseoscillatorydynamicscanonlybecancelledbyT(s)intheabsenceofmodelingerror.Thisexampleillustratestheadvantageofa3-DOFcontrollerovera1-DOFcontroller,whoseresponsetoastepcommandwouldbeverypoorinthepresentcaseRSTController161Figure6.9.Bodeplot(caseofthepureoscillatorysystem)Figure6.10.Timedomainresponse(systemoriginallyoscillatory)162LinearSystems6.4.*GeneralcaseSupposenowthatthedisturbancedandthereferencesignalraregovernedbylineardifferentialequationswithconstantcoefﬁcientsoftheformD1(∂)d=0,D2(∂)r=0.The“usualcase”previouslyconsideredwasaparticularcaseofwhatisnowdiscussed,withD1(∂)=D2(∂)=∂.Here,thereferencesignalcanbe,forexample,aramp(inwhichcase,D2(∂)=∂2)andthedisturbancecanbesinusoidal(byputtingD1(∂)=∂2+ω20).Thedisturbancecanalsobethesuperpositionofarampandasinusoid(D1(∂)=∂2(cid:15)∂2+ω20(cid:16)),etc.Themeasurementnoiseisagainassumedtohaveitsspectruminhighfrequenciesandsystem(6.11)isassumedtobecontrollable.6.4.1.DisturbancerejectionAccordingto(6.8),thedisturbancedisrejectedifandonlyifS∈(D1)(6.32)where(D1)denotestheidealinR[∂]generatedbyD1(seesection13.1.1).Thissigniﬁesthattheleftmemberoftherelation(6.32)isamultipleofthepolynomialD1.Thisconditiongeneralizes(6.12).6.4.2.ReferencetrackingInexpression(6.8),thetermdependentonrbecomeszeroifandonlyifB(T−R)−AS∈(D2).(6.33)Ifwewishtoobtainagoodrobustnessofperformance,condition(6.33)needstobesatisﬁedevenwhenthepolynomialsA(∂)andB(∂)areuncertain.Asaresult,(6.33)leadstothedoubleconditionS∈(D2),(6.34)T−R∈(D2).(6.35)Condition(6.35)generalizes(6.13).RSTController1636.4.3.InternalmodelprincipleConditions(6.32)and(6.35)arebothsatisﬁedifandonlyifS∈(D1)∩(D2)=(D)whereD=lcm(D1,D2)(seesection13.1.3).ThismeansthereexistsapolynomialSIsuchthatS=SID.(6.36)Condition(6.36)isthe“InternalModelPrinciple”[119].2Wemakethefollowinghypothesis:ASSUMPTION116.–Dhasallitsrootsontheimaginaryaxis.ThereasonforAssumption116isasfollows:(i)IfDhasrootsinthelefthalf-plane,onecanwritethispolynomialintheformD=DsDi,whereDsisapolynomialwhichhasallitsrootsinthelefthalf-planeandwhereDiisapolynomialprimewithDs.Thuseverysignalw(disturbanceorreferencesignal)satisfyingthedifferentialequationD(∂)w=0canbedecomposedasw=ws+wi,whereDs(∂)ws=0andDi(∂)wi=0(seesection2.3.8,Theorem449).Sincews(t)→0ast→+∞,thereisnoneedtoaccountforthissignalwhichiszeroinsteadystate.Thiscaseisthustobeexcluded.(ii)IfDhasrootsintherighthalf-plane,thereexistsasignalw(disturbanceorreferencesignal)satisfyingthedifferentialequationD(∂)w=0andwhichdivergesexponentially.Acontrolsignalthuscanonlycancelouttheerroreasymptoticallyifititselfalsodivergesexponentially.Thisiswhythiscaseistobeexcludedaswell.Itisalsoimportanttonotethefollowing:foraboundedcontrolsignaltobeabletoasymptoticallycancelouttheerrorewhilethesystemisexcitedbyasignalw(disturbanceorreferencesignal),thissignalitselfmustbeboundedtoo.ThissignalischaracterizedbythefactthatitisasolutiontothedifferentialequationD(∂)w=0;itisthereforenecessarythattherootsofD(s)besimpleandlocatedontheimaginaryaxis(section12.5.2,Theorem449).Nevertheless,insomecontrolproblems,therequirementscallforthetrackingofareferencerampsignalforaﬁnitedurationoftime.Thisiswhy,contrarytosomeauthors,wekeepthepossibilitythatD(s)mayhavemultiplerootsontheimaginaryaxisopen(thisdoesnothoweverchangeanythingtothetheory).2.Inthequotedreference,theInternalModelPrincipleisstatedintheframeworkofstate-spacesystems.Seesection8.3.164LinearSystems6.4.4.FilteringofmeasurementnoiseThepresenceofmeasurementnoisemakesitnecessarytoimposecondition(6.32);theargumentdevelopedinsection6.3.3remainsunchanged.6.4.5.ProblemresolutionStabilityconditionLetp=d◦(D)andp2=d◦(D2).WriteAI(∂)=A(∂)D(∂),andletAI(∂)=∂n+p+α1∂n+p−1+···+αn+p.(6.37)From(6.10)and(6.36),weareledtoresolvetheBézoutequation(6.16),withunknownsSIandR,andalsotoapplythetheoryinsection13.1.5,witha(s)=AI(s),b(s)=B(s),x(s)=SI(s),y(s)=R(s),andc(s)=Acl(s).ThefollowingisageneralizationofProposition109.PROPOSITION117.–ThereexistpolynomialsSI(∂)andR(∂)suchthatthepolynomialAcl(∂)hasallitsrootsinthelefthalf-planeifandonlyifthepolynomialsD(∂)andB(∂)arecoprime.PROOF.LetAf=gcd(AI,B).TheBézoutequation(6.16)admitsasolution(SI,R)ifandonlyifAclisoftheformAcl(∂)=Af(∂)Al(∂)(fromTheorem494)whereAl(∂)isanarbitrarypolynomial.Now,gcd(A,B)=1;thusAf=gcd(D,B),andaccordingtoAssumption116,anecessaryandsufﬁcientconditionforAftohaveallitsrootsinthelefthalf-planeisAf=1.DegreesofthepolynomialsLetgcd(D,B)=1fromnowon.Throughthesamerationaleasinsection6.3.4,wearriveatthefollowingconclusions:d◦(R)≤n+p−1,d◦(S)=n+p+δ0−1,d◦(SI)=n+δ0−1,d◦(Acl)=2n+p+δ0−1.RSTController165Wehaveξ=d◦(SI)=n+δ0−1,β=n−1andδ0≥0,thusξ≥β,andthesimpliﬁcationindicatedattheendofsection13.1.5canbemade.ThepolynomialsSIandAclarethereforechosentobemonic.NowletSI(∂)=∂n+δ0−1+x1∂n+δ0−2+···+xn+δ0−1,R(∂)=r0∂n+p−1+r1∂n+p−2+···+rn+p−1,Acl(∂)=∂2n+p+δ0−1+c1∂2n+p+δ0−2+···+c2n+p+δ0−1.SylvestersystemWiththeabove-mentionedsimpliﬁcation,theSylvestersystem(13.13)canbewrittenas⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣10···0············0α1..................α2...1......0.........α1...0b10...αn+p...α2...1...b1......0.........α1bn......0......αn+p...α20bn...b1......0.........0......0······0αn+p0···0bn⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣x1.........xn+δ0−1r0......rn+p−1⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣c1−α1............cn+p−αn+pcn+p+1...c2n+p+δ0−1⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦166LinearSystemsTheabove-givenmatrix(left)isoforder2n+p+δ0−1;itconsistsofn+δ0−1columnscontainingcoefﬁcientsαiandn+pcolumnscontainingcoefﬁcientsbi.6.4.6.ChoiceofpolesChoiceofAcl(∂)Theapproachinsection6.3.5appliesinbroadoutlineforthecalculationofAcl(∂).Thispolynomialtakesontheform(6.24),whereAc(∂)=(1≤k≤n+p(∂−πk)hasitsrootsπkchosenaccordingtoRule111asafunctionoftherootspkofAI(∂),whereB∗(∂)isconstructedasindicatedinsection6.3.5,andwhereF(∂)isapolynomialofdegreeδ(cid:15)BA(cid:16)+δ0−1,andthepolesofwhichare“fast”.Followingtherationaleinsection6.3.5,weobtainthefollowing:THEOREM118.–Ifsystem(6.11)isminimumphase,thestatementofTheorem112remainsvalid.Ontheotherhand,inthecasewhereasystemisinnon-minimumphase,theremarksinsection6.3.5remainvalidaswell.ChoiceofT(∂)TheconstraintsimposedonthepolynomialTare(6.35)and(6.6).Condition(6.35)meansthatthereexistsapolynomialQ(∂)∈R[∂]suchthatT−R=−QD2.(6.38)Asinsection6.3.5,onewouldliketochoosepolynomialT(∂)insuchawaythatitwillcancelcertainundesirabledynamicsinthetransferfunctionBTAclrelatingthereferencertotheoutputy.SupposeAs(∂)isthefactorofAcl(∂)thatwewouldliketocancel.ThenThastobeoftheformT=TIAs(6.39)whereTI∈R[∂].Accordingto(6.38)and(6.39),thepolynomialsTIandQhavetosatisfytheBézoutequationAsTI+D2Q=R.(6.40)Thisequationadmitsmultiplesolutions,sincegcd(As,D2)=1(fromAssumption116).Thecasep2=0istrivial,soletusassumethatp2≥1.Amongthesolutionsto(6.40),auniqueoneexistssuchthatd◦(TI)≤p2−1(section13.1.5,TheoremRSTController167494).WecanbesurethatthereexistsapolynomialTsatisfying(6.38),(6.39)andtheconstraint(6.6)onlyifd◦(As)+p2−1≤n+p+δ0−1,i.e.d◦(As)≤n+p−p2+δ0.(6.41)REMARK119.–Withd◦(As)=n+p−p2+δ0,wehaved◦(T)=n+p+δ0−1.Asaresult,δ(cid:21)BTAcl(cid:22)=d◦(B)+d◦(T)−(2n+p+δ0−1)=d◦(B)−n+(n+p+δ0−1)−(n+p+δ0−1)=δ(cid:21)BA(cid:22).ThisgeneralizesRemark115.NotethatTcanbechosentobeadivisorofAclonlyifTIisaunit,thusofdegreezero;thishappenswhenp2=1.6.4.7.Examples1.Constantreference,sinusoidaldisturbanceConsideragaintheminimalsystemPdeﬁnedbytheleftform(6.25)andsupposeweaddatitsoutputasinusoidaldisturbancedy,withfrequency1rad/s.Theobjectivehereistotrackaconstantreferencesignal.Therelativedegreeδ0isimposedtobe1.Theoretically,D1(∂)=∂2+1.Inawaytobroadenthe“resonancepeak”ofthetransferfunction1D(s),itispreferabletouseaverysmallbutnon-zerodampingcoefﬁcientς.Withς=0.5%,weobtainD1(∂)=∂2+0.01∂+1=(∂+η)(∂+¯η)withη(cid:9)0.005+i.Ontheotherhand,D2(∂)=∂,thusD(∂)=∂(cid:15)∂2+0.01∂+1(cid:16).ThetheoryisappliedwithAs(∂)=(∂+1+i)(∂+1−i)(∂+10)2,Acl(∂)=As(∂)(∂+2)(∂+1)2.168LinearSystemsCondition(6.41)issatisﬁedandweobtainR(∂)=(∂+1)(∂+2)(∂+α)(∂+¯α)80|α|2S(∂)=D(∂)(∂+β)(cid:15)∂+¯β(cid:16)T(∂)=As(∂)R(0)As(0)withα=0.338+0.639iandβ=11.50+8.30i.TheBodeplotoftheopen-looptransferfunctionisshowninFigure6.11.Wenotethelargegaininlowfrequencies(inordertotrackthereferencewithoutstaticerror)andintheneighborhoodof1rad/s(fortherejectionofsinusoidaldisturbance);theroll-offaccentuatesfrom10rad/s(thisfrequencyistheabsolutevalueoftherootofthepolynomialF(∂)=∂+10,usedforobtainingδ0=1).Thegainaugmentationmargin(about10dB)andthephaselagmargin(about45◦)arecorrect,alongwiththedelaymargin(0.3s).ThesimulationofthecontrolledsystemshowninFigure6.12correspondstothefollowingevents:(i)stepcommandatt=0;(ii)sinusoidaldisturbancedyoffrequency1rad/sandamplitude0.5addingtoyfromt=10s;*(iii)allalongthesimulation,aGaussianwhitenoisewithstandarddeviation0.03isaddedtothemeasurement(thecomputationstepisof0.1s).*Thestepresponseisexcellent;thedisturbanceisrejected,butwithmoreoscillatorydynamics(becausethedynamicsFigure6.11.BodeplotofL(s)(Example1)RSTController169Figure6.12.Timedomainresponse(Example1)correspondingtotherootsofAs(∂)areexcitedbythisdisturbance).Wenotethatfromt=10s,thecontrolbecomessinusoidal(ifweleaveasidetheeffectofthemeasurementnoise)counteractingthedisturbancedy.2.Rampreference,sinusoidaldisturbanceConsideragaintheminimalsystemPdeﬁnedbytheleftform(6.25)andsupposethatasinusoidaldisturbancedy,withfrequency1rad/s,isaddedtotheoutputofP.Differentfromwhatwaspresentedpreviously,theobjectivenowistotrackareferencesignalwhichisaramp.Therelativedegreeδ0isﬁxedtobe1.WeagainchooseD1(∂)=∂2+0.01∂+1,butD2(∂)=∂2.ThetheoryisappliedusingAs(∂)=(∂+0.4+i)(∂+0.4−i)(∂+10)2,Acl(∂)=As(∂)(∂+2)(∂+1)3.Condition(6.41)issatisﬁedandweobtainR(∂)=(∂+2)(∂+1)(∂+0.40)(∂+α)(∂+¯α)290.40×|α|2S(∂)=D(∂)(∂+β)(cid:15)∂+¯β(cid:16)T(∂)=µAs(∂)(∂+0.28)170LinearSystemsFigure6.13.BodeplotofL(s)(Example2)whereα=0.19+0.88i,β=11.40+8.05i,andwhereµissuchthatT(0)=R(0)=58(wealsohaveT(cid:2)(0)=R(cid:2)(0),where(.)(cid:2)denotesthederivativeofthepolynomialinparentheses).TheBodeplotoftheopen-looptransferfunctionisshowninFigure6.13.Theslopeis−40dB/decadeinthelowfrequenciesandthegainincreasesagainintheneighborhoodof1rad/s(fortherejectionofthesinusoidaldisturbance).TheFigure6.14.Timedomainresponse(Example2)RSTController171gainaugmentationmargin(about10dB)andthephaselagmargin(about41◦)aresufﬁcient,alongwiththedelaymargin(0.35s).ThesimulationofthecontrolledsystemshowninFigure6.14correspondstothefollowingevents:(i)referencerampsignalstartingatt=0untilitreachesthevalueof1,andthenmaintainingthissignalatthisvalue;(ii)sinusoidaldisturbancedywithfrequency1rad/sandamplitude0.5comesonatt=35s.ThesignalyandthereferencerareshownintheupperpartofFigure6.14.Notethattherampisfollowedwithouttrackingerror.Thedynamicsofthedisturbancerejectionareverydifferentfromthoseofthereferencetracking.Itwasnecessarytoonlyweaklydamptheclosed-loopinordertoobtaincorrectphaseandgainmargins(fortheopen-loopispurelyoscillatorywithadoublepoleattheoriginandisnon-minimumphase).6.5.ExercisesEXERCISE120.–Detailtheproofofequalities(6.8),(6.9)and(6.10).EXERCISE121.–Extendthetheorypresentedinsection6.3.4tothecasewhereB(∂)=b0∂n−1+b1∂n+···+bntosimplifytherationale,ﬁrstassumethatδ0>0whenb0(cid:5)=0andthenconsiderthecaseδ0=0andb0(cid:5)=0.EXERCISE122.–JustifythechoicemadeforpolynomialAcl(∂)inthefourexamplesgiveninsection6.3.6.EXERCISE123.–LetPbeaminimalsystemwithtransferfunctionG(s)=s+2s(s+1).1)DetermineanRSTcontrollerforthissystemthathasthefollowingproperties:(i)itrejectstheconstantdisturbancesduanddythatareaddedtotheinputandoutputofP,respectively;(ii)itensuresthetrackingofaconstantreferencesignalwithoutstaticerror;(iii)Acl(s)hasroots−1(tripleroot),−2,and−10;(iv)theonlypoleofthetransferfunctionbetweenreferencerandoutputyis−1(doublepole).2)HowissuchachoiceofAcljustiﬁed?3)WhatistherelativedegreeofthetransferfunctionRS?EXERCISE124.–LetPbeaminimalsystemwithtransferfunctionP(s)=s+2(s+1)2,forwhichwedesignanRSTcontrollerhavingProperties(i)and(ii)ofExercise123.Wechoose−1(triplepole)and−2tobethepolesoftheclosed-loop.(i)DetermineRandS,andthenToftheformλ(∂+1),whereλissuchthatthestaticerroriszero.(ii)ExplicitlydeterminethesensitivityfunctionSo(s),andthenthemodulusmargin.(iii)Calculatethetransferfunctionbetweenthereferencesignalrandtheoutputy,andthenexplicitlydeterminethestepresponse.Whatcanweconclude?172LinearSystemsFigure6.15.BodeplotofL(s)(Exercise126)EXERCISE125.–Thisexerciseisacontinuationofthepreviousone.Thistime,wechooseaclosed-loophaving,comparedtothatofExercise124,asupplementarypole−α.(i)Whatseemstobeareasonablevalueofα?(Defendyourviewpoint!).(ii)Chooseavalueofαthatseemspertinent,thendeterminetheRSTcontrollersuchthatthestepresponseisthesameasinExercise124.(iii)WhataretheadvantagesandinconveniencesofthetwoRSTcontrollers?EXERCISE126.–Thisexerciseisacontinuationofthepreviousone.Choosing,fromExercise125,α=5,weobtaintheopen-looptransferfunctionL(s),theBodeplotofwhichisshowninFigure6.15.(i)Isthisresultcoherent?(Explain!)(ii)SupposenowthatPisasimpliﬁedmodelofasystemoffourthorderwhosetransferfunctionis˜P(s)=P(s)E(s)withE(s)=ω20s2+2ςω0s+ω20whereς=5.10−3andω0≥30rad/s.ShowtheshapeoftheBodeplotofE(s)andinparticularcalculatethemaximumof|E(iω)|andatwhichfrequencythemaximumisattained.(iii)SupposingwecontrolthecompletesystemusingtheRSTcontrollerdeterminedinExercise125(withα=5),istheclosed-loopsystemstable?WhatwillhappenifweusethecontrollerdeterminedinExercise124?(Defendyourargument.)RSTController173EXERCISE127.–Consideracontrollableandobservablesecond-ordersystemwithtransferfunctionG(s)=1/(cid:15)s2+s−1(cid:16).(i)DesignanRSTcontrollerforthissystem,placingallthepolesat−1,suchthatthetransferofthecontrolledsystembetweenreferenceandoutputisoftheorderof2,andsuchthatδ0=0.(ii)Samequestionwithδ0=1.(iii)Intheabovetwocases,isthechoiceofthepolespertinent?EXERCISE128.–Extendthetheorypresentedinsection6.4.5tothecasewhereB(∂)=b0∂n−1+b1∂n+···+bn(seeExercise121)Chapter7SystemsTheory(II)Thetheoryoflineartime-invariantsystemsturnedouttobeessentiallyalgebraic,whichistheapproachthischapterwillbefollowing.Givenitsgeneralnatureandsigniﬁcance,suchanapproachwillnotbepossibleunlessweusethe“languageofmodules”aspresentedinsection13.4.Fromthepointofviewofapplications,itissufﬁcient,inmostcases,toconsider“state-spacesystems”(section2.3.6).Fundamentally,however,thisframeworkistoonarrow.Takeanexample:oneofthemostimportantnotionsofsystemstheoryiscontrollability.Wehavealreadycomeacrossthisnotioninsection6.2.2(seeDeﬁnition108)concerningSISOsystemsrepresentedbyleftforms.However,theredoesnotexisttwotypesofcontrollability,onefortheseleftformsandanotheroneforstate-spacesystems.Itisthereforenecessarytodeﬁnecontrollabilityforaclassofsystemsthatencompassesthesetwotypesofrepresentations.TherearealsosystemsthataredescribedbyaRosenbrockrepresentation,whichiscompletelygeneralasshowninsection2.3.5.Therefore,itappearsthatitissufﬁcienttoproperlydeﬁnethecontrollabilityofaRosenbrockrepresentation.Butisitaparticularrepresentationofthesystemwhichiscontrollableorisitthesystemitself?TheworksofWillemsandFliess([117],[42]),datingbacktothebeginningofthe1990s,haveclearlydemonstratedthatthisisapropertyofthesystem,andnotofoneofitsrepresentations.Controllabilityisthereforeaconcreteandobjectiveproperty.Henceforth,thisistheviewpointthatdeservestobeexpounded.Paradoxically,toachievethis,anoftenabstractlanguageisnecessary.175Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.176LinearSystems7.1.Structureofalinearsystem7.1.1.*ThenotionofalinearsystemLetusbeginbyrecallingwhathasbeenestablishedintheremarksofChapter2.Inwhatfollows,theterm“system”signiﬁes“lineartime-invariantsystem”,unlessotherwisestated.(i)AsystemΣcanbeidentiﬁedwithaﬁnitelypresentedR-module1M,whereR=R[∂](Remark8,section2.2.2).ThismoduleMisdeﬁnedbyanequationsuchthat(2.6)E(∂)w=0.Thevariablesw1,...,wkgenerateM,andwewriteM=[w]R,wherew=[w1...wk]T.ThematrixE(∂)isamatrixofdeﬁnitionofM(orofthesystemΣ).WecanassumethatE(∂)isleft-regular(i.e.fullrowrank)becauseRisaprincipalidealdomain(seesections13.1.4and13.4.2),andthenE(∂)∈Rr×k,wherer=rkE(∂).ThesystemΣ(identiﬁedwiththemoduleM)becomesacontrolsystemoncetheinputvariablesu1,...,umandtheoutputvariablesy1,...,yparechosen.Aﬁnitesequenceofvariablesu=[u1...um]TisapossibleinputforΣif(i)uisindependent,i.e.[u]RisafreeR-moduleofrankm,and(ii)themoduleM/[u]Ristorsion(Remark12,section2.3.1).TheonlyaprioriconstraintontheoutputvariablesisthattheybelongtoM(Remark15,section2.3.5).OnecanalwaysrepresentasysteminaRosenbrockformliketheonedeﬁnedbyrelation(2.1.1)ofsection2.3.5(Remark15,section2.3.5).ThepolesofthecontrolsystemΣaretheSmithzerosofthetorsionmoduleM/[u]R(Remark19,section2.3.7).7.1.2.State-spacerepresentationWeowetoFliess[42]thefollowingresult:THEOREM129.–Everycontrolsystemadmitsastate-spacerepresentation(oftheform(2.20),section2.3.6).PROOF.*1)SincethemoduleT=M/[u]Ristorsion,itisaﬁnite-dimensionalR-vectorspace(accordingtoTheorem565ofsection13.4.3).Let¯η=(¯ηi)1≤i≤nbeabasisofthisvectorspace.Since∂¯ηiisanR-linearcombinationofthe¯ηjs,1≤j≤n,1.Or,whatcomestothesamething(becauseRisNoetherian),aﬁnitelygeneratedR-module.Wecannonethelessconsideralinearsystemdeﬁnedoveranon-Noetherianring(seesection13.2.3,Remark500(ii));suchasystemcanbedeﬁnedas(orbeidentiﬁedwith)aﬁnitelypresentedmodule.SystemsTheory(II)177thereexistsamatrixA∈Rn×nsuchthat∂¯η=A¯η.Therealsoexistnelementsηi∈Msuchthat¯ηiisthecanonicalimageofηiinT(1≤i≤n).Asaresult,thereexistmatricesBj∈Rn×m(0≤j≤s,sﬁnite)suchthatBs(cid:5)=0and∂η=Aη+(cid:11)0≤j≤sBj∂ju.(7.1)Ifs≥1,thenletη∗=η−Bs∂s−1u.Thisyields∂η∗=Aη∗+*(cid:11)0≤j≤s−2Bj∂j+B(cid:2)s−1+uwhereB(cid:2)s−1=ABs+Bs−1.Iteratingthisprocedure,weobtaintheform∂x=Ax+Bu.(7.2)2)ItfollowsfromthisexpressionthatthemoduleTisdeﬁnedbytheequation∂¯x=A¯xwhere¯x=(¯xi)1≤i≤nand¯xiisthecanonicalimageofxiinT(1≤i≤n).Therefore,T=[¯x]R,andasthequantities¯xiareR-linearlyindependent,¯xisabasisofthevectorR-spaceT.Let¯yibethecanonicalimageofyi∈MinT.ThereexistsamatrixW(∂)∈Rp×msuchthaty=Cx+W(∂)u,(7.3)andexpression(2.20)ofsection2.3.6isobtained.*REMARK130.–Asmentionedinsection2.5.3,weareonlyinterestedinpropercontrolsystemsinpractice.FromTheorem48,apropersystemΣadmitsastate-spacerepresentationoftheform(cid:20)∂x=Ax+Buy=Cx+Du(7.4)whereA∈Rn×n,B∈Rn×m,C∈Rp×n,andD∈Rp×m;inaddition,D=0ifandonlyif,Σisstrictlyproper.Suchastate-spacerepresentationisdenotedby{A,B,C,D}inwhatfollows,andas{A,B,C}ifD=0.Astothepossibilityofobtainingsucharepresentationsystematically,seeRemark49(section2.5.3).DEFINITION131.–ThematricesA,B,CandDabovearecalled,respectively,thestatematrix,theinputmatrix,theoutputmatrixandthedirecttermmatrix(or,moresuccinctly,thedirectterm).Theﬁrstoftheequationsofequation(7.4)isthestateequation,thesecondistheoutputequation.178LinearSystemsyMAfFigure7.1.CarriageREMARK132.–SupposewechangethebasisinRnaccordingtox=Pη,wherethematrixP∈Rn×nisinvertible.Inthenewbasis,therepresentationis(cid:20)∂η=P−1APη+P−1Bu,y=CPη+Du.(7.5)EXAMPLE133.–ConsideracarriageofmassMrollingfrictionlessonahorizontalplaneandsubjectedtoaforcef(seeFigure7.1).Assumingthatthewheelshavenegligiblemassandmomentofinertia,wehaveaccordingtoNewton’slaw(equation(1.12),section1.2.1)f=M˙vwherev=˙yisthevelocityofthecarriage(yisthepositionwithrespecttoaﬁxedpoint).Thecontrolsystemwithinputu=fandoutputyisthusdescribedbythestate-spacerepresentation˙x=(cid:27)0010(cid:28)x+(cid:27)1M0(cid:28)u,y=(cid:25)01(cid:26)x,wherex(cid:1)(cid:25)vy(cid:26)T.Inthiscase,allthestatecomponentshaveaphysicalsigniﬁcance.Thisisnotalwaysso.7.1.3.ControllabilityAsystemiscontrollableifandonlyif,noneofthevariablesofthissystemsatisﬁesanon-trivialhomogenousdifferentialequation;inotherwords,ifandonlyif,allitsvariablesarefree(seesections13.4.1and13.4.3).Indeed,supposethereexistsanon-invertiblepolynomiala(∂)andavariablev∈Msuchthata(∂)v=0.TheSystemsTheory(II)179evolutionofavariablev∈E(R)satisfyingthesamedifferentialequationonlydependsoninitialconditions,andhencenopossibleactioncancauseanyinﬂexionontheevolutionofthisvariable.Conversely,theevolutionofafreevariable(notdeterminedbyinitialconditions)canbegovernedbyanappropriateaction.*Totranslatewhatwehavejustsaidintomathematicalwords,webeginbythefollowingremark:REMARK134.–LetMbethemoduleassociatedwithasystemΣ.AccordingtoCorollary555(section13.4.2),themoduleMisfreeifandonlyif,itistorsion-free.Wearenowledtothefollowingdeﬁnition,duetoFliess[42]:DEFINITION135.–AsystemΣiscontrollableiftheassociatedmoduleMisfree.*REMARK136.–Thereexistsa“behavioral”deﬁnitionofcontrollability,duetoWillems[117](seealso[96],section5.2).Thestudyoftheequivalencebetweenthecontrollability“àlaWillems”andthatofDeﬁnition135wascarriedoutbyFliess[43].Accordingtothesetwodeﬁnitions,thecontrollabilityofasystemisaconceptneitherrelatedtothetypeofrepresentationchosenforthesystemnorrelatedtoaparticularchoiceofthecontrolvariables.THEOREM137.–*AcontrolsystemΣiscontrollableifandonlyif,itcanberepresentedbya“rightform”(seesection2.3.5).*PROOF.*AcontrolsystemΣisrepresentablebytheequalities(2.19)ofsection2.3.5ifandonlyif,theassociatedmoduleisfree(withbasisξ).*THEOREM138.–LetΣbeasystemdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W}(Deﬁnition14,section2.3.5);Σiscontrollableifandonlyif,thematricesDandNareleft-coprime.PROOF.ThisisobviousaccordingtoTheorem505(section13.2.6)andRemark134.COROLLARY139.–“Popov–Belevitch–Hautus(PBH)testforcontrollability”.AsystemΣdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W}iscontrollableifandonlyif,rkC(cid:25)D(s)N(s)(cid:26)=rforeverys∈C(wherer(cid:1)rkRD(∂)).Inparticular,astate-spacesystem{A,B,C,D}iscontrollableifandonlyif,rkC(cid:25)sIn−AB(cid:26)=nforeverys∈C.PROOF.Thematrices{D,N}areleft-coprimeifandonlyiftheSmithformof(cid:25)DN(cid:26)is(cid:25)Ir0(cid:26)(accordingtoTheorem505ofsection13.2.6),i.e.whenthestatedconditionholds.180LinearSystemsREMARK140.–ThenecessaryandsufﬁcientconditionexpressedbyTheorem138generalizesDeﬁnition108ofsection6.2.2,validonlyinthecaseofanSISOsystemdeﬁnedbyaleftform.THEOREM141.–“Kalmancriterionforcontrollability”[65].Astate-spacesystem{A,B,C,D}iscontrollableifandonlyif,rkΓ=n,wherenisthedimensionofthestatevector(section2.3.6,Remark16)andwhereΓisthe“controllabilitymatrix”,deﬁnedbyΓ=(cid:25)BAB...An−1B(cid:26).(7.6)PROOF.*1)Aswehaveindicatedinsection2.3.6,astate-spacerepresentation{A,B,C,∗}isaRosenbrockrepresentation{D,N,Q,∗}ofaparticulartype,whereD(∂)=∂In−A,N(∂)=BandQ(∂)=C.AccordingtoTheorem138,thesystemdeﬁnedbythisrepresentationiscontrollableifandonlyif,thematrices∂In−AandBareleft-coprime,thatistosayif(cid:25)∂In−AB(cid:26)isright-invertibleaccordingtoDeﬁnition506(section13.2.6).ThisamountstosayingthatifvT=(cid:25)v1...vn(cid:26)isarowofelementsofarightR-module,theequalityvT(cid:25)∂In−AB(cid:26)=0impliesvT=0.Theﬁrstoftheseequalitiesisequivalentto(a)∂vT=vTAand(b)vTB=0.Multiplying(b)by∂ontheright,weobtainvT∂B=0,andhencevTAB=0accordingto(a).Thislastequality,multipliedontherightby∂,impliesthatvT∂AB=0,andhencevTA2B=0accordingto(a),etc.Asaresult,theequalityvT(cid:25)∂In−AB(cid:26)=0impliesvTΓ=0.IfrkΓ=n,thisimpliesvT=0.Therefore,theconditionrkΓ=nissufﬁcientforthesystemtobecontrollable.2)Letusshowbycontradictionthatthisisalsoanecessarycondition.LetrkΓ=ρ<n.LetP=(cid:25)P1P2(cid:26)∈Rn×n,wherethesubmatrixP1consistsofρlinearlyindependentcolumnsofΓandwhereP2isasubmatrixchosensuchthatPwillbeinvertible.Suchamatrixexistsaccordingtothe“theoremoftheincompletebasis”(Corollary517,section13.3.1).Indeed,thecolumnsofP1areidentiﬁedwithlinearlyindependentvectorsxi(ρ+1≤i≤n)inthecanonicalbasisofRn.Wecandeterminethevectorsxi(ρ+1≤i≤n)insuchawaythat(xi)1≤i≤nisabasisofRn.Thevectorsxi(ρ+1≤i≤n)areidentiﬁedwithcolumnvectorsinthecanonicalbasisofRnandformthematrixP2whichisbeingsoughtafter.LetuandbbethehomomorphismsrepresentedbythematricesAandB,respectively,whenthebaseschoseninRnandRmarethecanonicalbases.ThesubspaceofRnspannedbythevectorsxi(1≤i≤ρ)isE1=(cid:11)0≤i≤n−1uiimb(whereu0=In).AccordingtotheCayley–Hamiltontheorem(Theorem537,section13.3.4),unisanR-linearcombinationoftheendomorphismsui,0≤i≤n−1,and,asaresult,E1isu-invariant.Asshowninsection13.3.2(seeequation(13.24)),thematrix˜Arepresentinguinthebasis(xi)1≤i≤n,i.e.˜A=P−1AP,isthereforeoftheform˜A=(cid:27)Ac∗0A¯c(cid:28)SystemsTheory(II)181wherethesquarematrices˜Acand˜A¯careoforderρandn−ρ,respectively.Ontheotherhand,imb⊂E1,andthusthematrix˜BrepresentingbinthecanonicalbasisofRmandthebasis(xi)1≤i≤nofRn,i.e.˜B=P−1B(seeequation(7.5),section7.1.2),isoftheform˜B=(cid:27)Bc0(cid:28)whereBc∈Rρ×m.Puttingx=Pη,whereη=(cid:27)xcx¯c(cid:28),weobtain(cid:20)∂xc=Acxc+∗x¯c+Bcu∂x¯c=A¯cx¯c(7.7)where∗isanunspeciﬁedmatrix.Consequently,thesubmodule[η¯c]RofMgeneratedbythecomponentsofx¯cistorsionandnotreducedto0.ThemoduleMisthereforenotfreeandtheassociatedsystemisthereforenon-controllable.*REMARK142.–(i)SincethecontrollabilitymatrixΓdeﬁnedbyequation(7.6)dependsonlyonAandB,fromnowonwewillcallitthe“controllabilitymatrixof(A,B)”anddenoteitasΓ(A,B).Wewillexpressthatitisofranknbysayingthat“(A,B)iscontrollable”.(ii)AnelementarycalculationshowsthatforanymatrixP∈GLn(R),2Γ(cid:15)P−1AP,P−1B(cid:16)=P−1Γ(A,B).(7.8)Asaresult,thecontrollabilityof(A,B)onlyinvolvesthehomomorphismsuandbdeﬁnedbythesematricesinthechosenbases[119].(iii)Originally,controllabilityhasbeendeﬁnedforstate-spacesystemsbyKalman[65]inthefollowingmanner:“Astate-spacesystem{A,B,C,D}iscontrollableifforanyinitialcondition(t0,x0)andanypointx∗inthestatespace,thereexistsaninstantt1>t0andacontroludeﬁnedon[t0,t1]forwhichthestatexpassesbetweentheinstantt0andtheinstantt1fromthevaluex0tothevaluex∗”.Kalmanshowedinthecitedreferencethatanecessaryandsufﬁcientconditionforthesystem{A,B,C,D}tobecontrollable,inthesenseasspeciﬁedjustnow,istheonegiveninTheorem141(inthecaseofdiscrete-timesystems,seeDeﬁnition315andTheorem317(section10.4.2)).REMARK143.–ItiseasytoshowusingTheorem141thatthecarriageofExample133isacontrollablesystem.Itisequallyeasytoshowthatfromanyinitialinstant2.GLn(R)isthegenerallineargroupofthesquarematricesofordernoverR,i.e.themultiplicativegroupconsistingofallinvertiblematricesofordernwithrealentries:seesection13.1.4.182LinearSystemst0andanyinitialstatex0=(cid:25)v0y0(cid:26)T(x0=x(t0)),onecanbringthecarriagetoanarbitrarilychosenstatex∗=(cid:25)v∗y∗(cid:26)Tatanytimet1>t0(x(t)=x∗)bymodulatingtheforcefontheinterval[t0,t1]inanappropriatemanner,whichisKalman’sdeﬁnitionofcontrollability(Remark142(iii)).*UsingthenotationintheproofofTheorem141,weobtainthefollowingresult:PROPOSITION144.–ThetorsionsubmoduleofMisT(M)=[x¯c]R.PROOF.1)Weknowthat[x¯c]R⊂T(M).2)Toprovetheconverse,considerthequotientmoduleM/[x¯c]R=[¯xc,¯u]R,wherethecomponentsof¯xcandof¯uarethecanonicalimagesofthoseofxcandofu,respectively.Weobtain∂¯xc=Ac¯xc+Bc¯u.(7.9)WehaverkΓ(cid:9)˜A,˜B(cid:10)=ρandΓ(cid:9)˜A,˜B(cid:10)=(cid:27)BcAcBc...An−1cBc00...0(cid:28),andhenceρ=rk(cid:25)BcAcBc...An−1cBc(cid:26)=rkΓ(Ac,Bc);thelastequalityisaconsequenceoftheCayley–Hamiltontheorem(seeabovetheproofofTheorem141).Therefore,themoduleM/[x¯c]Risfree,andthusT(M)⊂[x¯c]R*DEFINITION145.–Wecallthecontrollablequotientsystemthesystemwithequation(7.9)(*associatedwiththequotientmoduleM/T(M)*)3.Theaboveprovesthat(Ac,Bc)iscontrollable.Furthermore,onecanrepresentthedecomposition(7.7),called“Kalmancontrollabilitydecomposition”,bythediagraminFigure7.2:7.1.4.ObservabilityIntuitively,acontrolsystemisobservableif,whenbothitsinputandoutputareidenticallyzero,allitsvariablesarenecessarilyzero(inotherterms,everyevolutionofthesystemvariablescanbedetectedfromtheinputandoutput).3.*Sinceasystemisassociatedwithaﬁnitelypresentedmodule,aquotientsystemisassociatedwithaquotientofthismodule[22].*SystemsTheory(II)183yControllable  Non controllableu+Figure7.2.Kalmancontrollabilitydecomposition*Toexpresswhathasbeenjustsaidinmathematicalterms,thelanguageofmodulesis,onceagain,thebestsuitedone:thecontrolsystemconsideredisobservableifandonlyif,M[y,u]R=0,(7.10)andwearethusledtothefollowingdeﬁnition[42]:DEFINITION146.–AcontrolsystemΣ,withinputuandoutputy,isobservable,iftheassociatedmoduleMsatisﬁestheequalityM=[y,u]R.*THEOREM147.–AcontrolsystemΣisobservableifandonlyif,itcanberepresentedbya“leftform”(seesection2.3.5).PROOF.*AcontrolsystemΣisrepresentablebytheequality(2.17)ofsection2.3.5ifandonlyif,theassociatedmoduleisM=[y,u]R.*THEOREM148.–LetΣbeacontrolsystemdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W};Σisobservableifandonlyif,thematricesDandQareright-coprime.PROOF.*ThesystemΣisobservableifandonlyif,theequality(7.10)issatisﬁed.LetξbethepartialstateofΣand_ξbethecolumnmatrix;theentriesarethecanonicalimagesofthecomponentsofξinM/[y,u]R.Weget(cid:27)D(∂)Q(∂)(cid:28)_ξ=0.(7.11)184LinearSystemsΣisobservableifandonlyif,thisequalityimplies_ξ=0,whichisthecaseifandonlyif,thematrix(cid:27)D(∂)Q(∂)(cid:28)isleft-invertible.Thismeansthatthematrices{D,Q}arerightcoprime(seesection13.2.6).*FollowingasimilarlineofreasoningasintheproofofCorollary139andofTheorem141,weobtainthefollowingresults(withthesamenotation):COROLLARY149.–“Popov–Belevitch–Hautus(PBH)testforobservability”.AsystemΣdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W}isobservableifandonlyif,rkC(cid:25)DT(s)QT(s)(cid:26)=rforeverys∈C.Inparticular,ifΣisastate-spacesystem{A,B,C,D},Σiscontrollableifandonlyif,rkC(cid:25)sIn−ATCT(cid:26)=nforeverys∈C.THEOREM150.–“Kalmancriterionforobservability”[65].Astate-spacesystem{A,B,C,D}isobservableifandonlyifrkΩ=n,wherenisthedimensionofthestatevectorandwhereΩisthe“observabilitymatrix”deﬁnedbyΩ=(cid:23)CTATCT...(cid:15)AT(cid:16)n−1CT(cid:24)T.(7.12)REMARK151.–SincetheobservabilitymatrixΩonlydependsonAandC,itcanbedenotedbyΩ(A,C),andwecanexpressthatitisofranknbysayingthat“(C,A)isobservable”.(OnecanalsorefermoreintrinsicallytothehomomorphismsdeﬁnedbythematricesCandAinthechosenbases,inthespiritofRemark142ofsection7.1.3.)REMARK152.–Itiseasytoshow,usingTheorem150,thatthecarriageofExample133(withthespeciﬁedinputandoutput)isobservable.Wecaninterpretthispropertyinthefollowingmanner:supposethatthesystemevolvesoveratimeinterval[t0,t],t>t0,andwecollectmeasurementsoftheinputandtheoutputoverthisinterval.Fromthesedata,itispossibletoreconstructtheinitialstatex0=x(t0).(Iftheoutputisvelocityvinsteadofpositiony,suchareconstructionisimpossible,sincetheinputandoutputremainunchangedifoneaddsanarbitraryconstanttothepositiony;thecontrolsystemisthereforenon-observable.)SuchanapproachofobservabilityisduetoKalman[65](incaseofdiscrete-timestate-spacesystems,seeDeﬁnition327andTheorem328(section10.4.3)).TheinterpretationofobservabilityduetoWillemsisverysimilarbutnotrelatedtothestate-spacerepresentation([96],section5.3).ThefollowingisdeducedfromTheorem150:COROLLARY153.–Controllability↔observabilityduality.(C,A)isobservableifandonlyif,(cid:15)AT,CT(cid:16)iscontrollable.SystemsTheory(II)185PROOF.ItisclearthatΩT(A,C)=Γ(cid:15)AT,CT(cid:16),andhencerkΩ(A,C)=rkΓ(cid:15)AT,CT(cid:16)accordingtoProposition534(section13.3.4).Theabovedualityhasimportantconsequences;inparticular,thefollowing:letΣbeastate-spacesystem{A,B,C,D}ofordernandwhichisnon-observable.Letω<nbetherankofitsobservabilitymatrixΩ.LetP=(cid:25)P1P2(cid:26)∈Rn×n,whereP1isformedbyωlinearlyindependentcolumnsofΩTandP2isasub-matrixchoseninsuchawaythatPisinvertible(seePart2oftheproofofTheorem141).ThematricesˇAT=P−1ATPandˇCT=P−1CTareoftheformˇAT=(cid:27)ATo∗0AT¯o(cid:28),ˇCT=(cid:27)CTo0(cid:28)where(cid:15)ˇATo,ˇCTo(cid:16)iscontrollable.Asaresult,ˇA=PTAP−TandˇC=CP−T(whereP−Tmeans(cid:15)P−1(cid:16)T)satisfyˇA=(cid:27)Ao0∗A¯o(cid:28),ˇC=(cid:25)Co0(cid:26)where(Co,Ao)isobservable.Inthenewbases,thestateequationstaketheform⎧⎪⎪⎨⎪⎪⎩∂(cid:27)xox¯o(cid:28)=(cid:27)Ao0∗A¯o(cid:28)(cid:27)xox¯o(cid:28)+(cid:27)∗∗(cid:28)uy=(cid:25)Co0(cid:26)(cid:27)xox¯o(cid:28)+[∗]u.(7.13)*Wededucethefollowingresult:PROPOSITION154.–The“non-observablequotientsystem”isassociatedwiththequotientmoduleM/[y,u]R(seeFootnote3ofsection7.1.3)deﬁnedbytheequation∂_¯x¯o=A¯o_¯x¯o(7.14)wherethecomponentsof_¯xarethecanonicalimagesofthecomponentsofx¯oinM/[y,u]R.PROOF.Wehave(cid:27)∂Iω−AoCo(cid:28)_¯xo=0andthus_¯xo=0becausethematrix(cid:27)∂Iω−AoCo(cid:28)isleft-invertible(fromthefactthat(Co,Ao)isobservableandaccordingtoTheorem148).Thus,M/[y,u]R=(cid:25)_¯x¯o(cid:26)R,andthislastmoduleisdeﬁnedbyequation(7.14).*Wecanrepresentthedecomposition(7.13)bythediagraminFigure7.3:186LinearSystems       Observable         Non observable u      yFigure7.3.Kalmanobservabilitydecompostion7.1.5.CanonicalstructureofasystemConsideracontrolsystemΣinthestate-spaceform{A,B,C},4whichcanbenon-controllableand/ornon-observable.Bydecomposingthissystemaccordingtocontrollability,oneobtainstherepresentation(7.7),where(Ac,Bc)iscontrollableandwhereA¯cistheemptymatrixifΣiscontrollable.Theoutputycanbeexpressedasy=(cid:25)CcC¯c(cid:26)(cid:27)xcx¯c(cid:28).Nowletusconsiderthecontrollablequotientsystem(7.9)andits“outputequation”˜y=Cc˜xcwherethecomponentsof˜yarethecanonicalimagesofthoseofyinthequotientM/[x¯c]R.Wecandecomposethissystemaccordingtoobservability(decompositionincludingemptymatricesifthissystemisobservable).ThequotientsystemM/[xc,u]Rcanbedecomposedinthesameway.Weﬁnallyobtainthefollowingresult:THEOREM155.–“Canonicalstructureofastate-spacesystem”[65].(i)ThereexistsachangeofbasismatrixP∈Rn×nsuchthatthematrices˜A=P−1AP,4.ThedirecttermmatrixDdoesnotplayanyroleinthenexttheoremandcanbeassumedtobezerowithoutlossofgenerality.SystemsTheory(II)187˜B=P−1B,and˜C=CPtaketheform⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩˜A=⎡⎢⎢⎣Ac¯o∗∗∗0Aco0∗00A¯c¯o∗000A¯co⎤⎥⎥⎦,˜B=⎡⎢⎢⎣Bc¯oBco00⎤⎥⎥⎦˜C=(cid:25)0Cco0C¯co(cid:26)(7.15)where(cid:21)(cid:27)Ac¯o∗0Aco(cid:28),(cid:27)Bc¯oBco(cid:28)(cid:22)iscontrollableand(cid:21)(cid:25)CcoC¯co(cid:26),(cid:27)Aco∗0A¯co(cid:28)(cid:22)isobservable.(ii)Thestate-spacesystem{Aco,Bco,Cco}isbothcontrollableandobservable.PROOF.(i)isobtainedbyapplyingtheaboveindicatedmethod(formoredetails,see[65],([63],section3.4.3)or([96],section5.4)).(ii)Letnc¯o(resp.,nco)betheorderofthematrixAc¯o(resp.,Aco).AccordingtothePopov–Belevitch–Hautustest(Corollary139,section7.1.3),wegetrkC(cid:27)sInc¯o−Ac¯o∗Bc¯o0sInco−AcoBco(cid:28)=nc¯o+ncoforanys∈C.ThisimpliesrkC(cid:25)sInco−AcoBco(cid:26)=ncoforanys∈C,andthus(Aco,Bco)iscontrollable.Theobservabilityof(Cco,Aco)canbeshowninasimilarmanner.ThedecompositionexpressedintheabovetheoremcanberepresentedbythediagraminFigure7.4.REMARK156.–Ingeneral,itisnottruethat(Ac¯o,Bc¯o)willbecontrollablenor(C¯co,A¯co)willitbeobservable(seeExercise213,section7.6).PROPOSITION157.–ThetransfermatrixofthesystemΣisG(s)=C(sI−A)−1B=Cco(sI−Aco)−1Bco.(7.16)188LinearSystemsControllable,   observable Controllable, Non observable Non controllable, observableNon controllable, Non observable +uyFigure7.4.KalmangeneraldecompositionPROOF.Theﬁrstequalityisanimmediateconsequenceofequality(2.48)(section2.5.3)sinceW(s)=0.Thesecondequalityisaconsequenceofthestructureofthematricesinequation(7.15).THEOREM158.–AcontrolsystemΣisminimal(seesection2.4.6)if,andonlyifitisbothcontrollableandobservable.PROOF.*1)Accordingtoequation(7.16)andequality(2.37)ofsection2.4.6,thetransmissionorderofΣcannotexceedtheorderofthematrixAco.Thus,Σisnotminimalifitisnon-observableornon-controllable.2)Conversely,supposeΣisobservable.ItisrepresentablebyaleftformD(∂)y=N(∂)uaccordingtoTheorem147(section7.1.4).IfΣisalsocontrollable,thenthematrices{D,N}areleft-coprimeaccordingtoTheorem138(section7.1.3).Therefore,accordingtoRemark31(section2.4.5),thetransmissionpolesofΣaretheSmithzerosofD(s)andtheycoincidewiththepolesofΣaccordingtoRemark19ofsection2.3.7.Asaresult,thecontrolsystemΣisminimal.*SystemsTheory(II)1897.2.ZerosofasystemWehaveseeninsection2.4.7thatwecandeﬁneﬁnitetransmissionpolesandzerosandalsopolesandzerosatinﬁnity.Thisisalsotrueforallothertypesofpolesandzeros.Thereadercanﬁndacompleteexpositionofthedifferenttypesofpolesandzerosatinﬁnityin[21]and[22].Inwhatfollows,wewillbeinterestedonlyinﬁnitepolesandzeros.7.2.1.InvariantzerosandtransmissionzerosIntuitively,theinvariantzeros(i.z.)ofacontrolsystemΣ,withinputuandoutputy,characterizethedynamicsofthissystemwhenitsoutputismaintainedat0;thetransmissionzeroshavebeendeﬁnedinsections2.4.4and2.4.5fromthetransfermatrix(seeDeﬁnition28).*Nowletusexpressthedeﬁnitionsinthelanguageofmodules[19].ConsidertheﬁnitelypresentedR-moduleMassociatedwithΣanditsdecomposition(13.42)(section13.4.2),i.e.M=T(M)⊕Φ(7.17)whereΦisafreesubmodule.Inwhatfollows,thenotationandterminologyarethoseusedinsections13.4.1and13.4.2.AccordingtoProposition561,onecanchooseΦ=Φ[y,u]R,whereΦ[y,u]Rissuchthat[y,u]R=T([y,u]R)⊕(cid:15)[y,u]R∩Φ[y,u]R(cid:16).Itisthischoicethatwewillusebelow.DEFINITION159.–(i)ThemoduleofinvariantzerosisT(M/[y]R).(ii)ThemoduleoftransmissionzerosisT(Φ∩[y,u]R)/T(Φ∩[y]R).(iii)Theinvariantzeros(resp.,thetransmissionzeros)aretheSmithzerosoftheﬁrst(resp.,ofthesecond)module.*LetsystemΣbedescribedbyaRosenbrockrepresentation{D,N,Q,W}(section2.3.5).Let_¯ξ=(cid:9)_ξi(cid:10)1≤i≤rand_¯u=(cid:15)_¯ui(cid:16)1≤i≤m,where_ξiand_¯uiarethecanonicalimagesofξiandui,respectively,inM/[y]R(ξ=(ξi)1≤i≤risthepartialstateandu=(ui)1≤i≤mistheinput).Oneobtains(cid:27)D(∂)−N(∂)Q(∂)W(∂)(cid:28)#_ξ_¯u$=0.(7.18)190LinearSystemsDEFINITION160.–ThematrixR(∂)=(cid:27)D(∂)−N(∂)Q(∂)W(∂)(cid:28)(7.19)iscalledtheRosenbrockmatrix(orsystemmatrix)ofthecontrolsystemΣ.Fromtheabovetwodeﬁnitions,equation(7.18),andsection13.2.5,wegetthefollowingresult:THEOREM161.–TheinvariantzerosofΣaretheSmithzerosofitsRosenbrockmatrix.REMARK162.–SupposeΣisastate-spacesystem{A,B,C,D}(takingcarenottoconfusethematrixDofthisstate-spacerepresentationwiththematrixD(∂)oftheRosenbrockrepresentation).Then,theRosenbrockmatrixofthesystemisR(s)=(cid:27)sIn−A−BCD(cid:28).(7.20)PROPOSITION163.–(i)Letρ(.)betherankofthematrixinparenthesesovertheﬁeldofrationalfunctionsF=R(s).TherankoftheRosenbrockmatrix(7.19)overFsatisﬁestheequalityρ(R)=ρ(D)+ρ(G)(7.21)whereGisthetransfermatrixofΣ.(ii)Inparticular,ifRisgivenby(7.20)andifGissemi-regular(section13.1.4),weobtainρ(R)=n+min{p,m}.(7.22)PROOF.Noticethat(withr=ρ(D)):(cid:27)Ir0−QD−1Ip(cid:28)R(∂)=(cid:27)D−N0G(cid:28)accordingtoequation(2.27)(section2.4.2),fromwhichweobtaintheequality(7.21)becausethematrixontheleftisinvertible.7.2.2.Input-decouplingzerosInput-decouplingzerosarealsocalled“non-controllablepoles”.Theyaredeﬁnedindependentlyofthechoiceoftheinputofthesystem.*LetusﬁrstprovideanabstractdeﬁnitionbyconsideringtheR-moduleMassociatedwithsystemΣ[19]:SystemsTheory(II)191DEFINITION164.–Themoduleofinput-decouplingzeros(i.d.z.)isT(M).Thei.d.z.saretheSmithzerosofthismodule.*TheresultbelowisanimmediateconsequenceofDeﬁnitions135(section7.1.3)and164:THEOREM165.–Asystemiscontrollableifandonlyif,itdoesnothavei.d.z.s.SupposeΣisacontrolsystemdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W}.Wethenhavethefollowing:PROPOSITION166.–Thei.d.z.saretheSmithzerosofthematrix(cid:25)DN(cid:26).PROOF.*ThisisobvioussinceM=[ξ,u]R,where(cid:25)D(∂)N(∂)(cid:26)(cid:27)−ξu(cid:28)=0.*SupposenowthatΣisastate-spacesystem{A,B,C,D},andconsideritscontrollabilitydecomposition(7.7)(section7.1.3).PROPOSITION167.–Thei.d.z.saretheeigenvaluesofthematrixA¯c.PROOF.*Thisisanimmediateconsequenceofthesecondequalityof(7.7)andofProposition144(section7.1.3).*7.2.3.Output-decouplingzeros*Letusbeginbyanabstractdeﬁnition[19],consideringtheR-moduleMassociatedwiththecontrolsystemΣwithinputuandoutputy.DEFINITION168.–Themoduleofoutput-decouplingzeros(o.d.z.)isM/[y,u]R.Theo.d.z.saretheSmithzerosofthismodule.*Output-decouplingzerosarealsocallednon-observablepoles.Thefollowingtheoremcanbederivedimmediatelyfromthedeﬁnitions:THEOREM169.–Acontrolsystemisobservableifandonlyif,ithasnoo.d.z.SupposeΣisdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W}.Onehasthefollowing:192LinearSystemsPROPOSITION170.–Theo.d.z.saretheSmithzerosofthematrix(cid:27)DQ(cid:28).PROOF.*ItsufﬁcestorememberthatM/[y,u]Risdeﬁnedbyequation(7.11)(section7.1.4).*Last,supposeΣisastate-spacesystem{A,B,C,D}andletusconsideritsobservabilitydecomposition(7.13)(section7.1.4).PROPOSITION171.–Theo.d.z.saretheeigenvaluesofthematrixA¯o.PROOF.*ThisisobviousaccordingtoProposition154.*7.2.4.Input–ouputdecouplingzeros*Letusbeginbyanabstractdeﬁnition[19]:DEFINITION172.–Themoduleofinput–outputdecouplingzeros(i.o.d.z.)isT(M)T([y,u]R).Thei.o.d.z.saretheSmithzerosofthismodule.*LetΣ={A,B,C,D}beastate-spacesystemandconsideritscanonicalstructuregivenbyTheorem155(section7.1.5).Weobtainthefollowingresult:PROPOSITION173.–Thei.o.d.z.saretheeigenvaluesofA¯c¯o,and{i.o.d.z.}⊂{i.d.z.}∩{o.d.z.}.PROOF.*ThemoduleT(M)/T([y,u]R)isdescribedbytheequation∂˘x¯c¯o=A¯c¯o˘x¯c¯o,wherethecomponentsof˘x¯c¯oarethecanonicalimagesofthecomponentsofx¯c¯o(whichbelongtoT(M))inT(M)/T([y,u]R)*7.2.5.Hiddenmodes*Letusbeginbygivinganabstractbut“intrinsic”deﬁnitionofhiddenmodes([19],Deﬁnition16):DEFINITION174.–Themoduleofthehiddenmodes(h.m.)isM/(Φ∩[y,u]R).ThehiddenmodesaretheSmithzerosofthismodule.*SystemsTheory(II)193Thehiddenmodesaredirectlyderivedfromthei.d.z.s,theo.d.z.s,andthei.o.d.z.s.Wehaveindeedthefollowingresult,whereε(.)denotesthesetofelementarydivisors(takingintoaccountmultiplicities)ofthemoduleorofthematrixinparentheses(Lemma559,section13.4.2).THEOREM175.–Thefollowingequalityholds:ε(h.m.)=ε(i.d.z.)˙∪ε(o.d.z.)\ε(i.o.d.z.)where˙∪isthe“disjointunion”(section13.4.2,Lemma559)andA\BisthecomplementofBinA(whenB⊂A).PROOF.*WehaveaccordingtoTheorem538(section13.4.1)MΦ∩[y,u]R=T(M)⊕ΦΦ∩[y,u]R∼=T(M)⊕ΦΦ∩[y,u]R,M[y,u]R=T(M)⊕Φ(T(M)∩[y,u]R)⊕(Φ∩[y,u]R)∼=T(M)T([y,u]R)⊕ΦΦ∩[y,u]R.(7.23)AccordingtoLemma559(ii)(section13.4.2),weobtainfromtheﬁrstequalityε(h.m.)=ε(i.d.z.)˙∪ε(Φ/Φ∩[y,u]R)andfromthesecondequality,ε(o.d.z.)=ε(i.o.d.z.)˙∪ε(Φ/Φ∩[y,u]R)fromwhichwegetthedesiredresult.*Weimmediatelydeducefromtheabovethefollowingclassicresult:COROLLARY176.–Thefollowingequalityholds:{h.m.}={i.d.z.}˙∪{o.d.z.}\{i.o.d.z.},where{.}denotesthesetofelementsinbrackets(multiplicitiestakenintoaccount).LetΣ={A,B,C,D}beastate-spacesystemandconsideritscanonicalstructuregivenbyTheorem155(section7.1.5).ThefollowingresultisadirectconsequenceofTheorem175:PROPOSITION177.–ThehiddenmodesaretheeigenvaluesofthematrixAc¯o⊕A¯c¯o⊕A¯co(countingmultiplicities).55.Ac¯o⊕A¯c¯o⊕A¯coisa“diagonalsum”ofmatrices(section13.1.4).194LinearSystems7.2.6.RelationshipsbetweenpolesandzerosDenotethesystempolesbys.p.,thetransmissionpolesbyt.p.,andthetransmissionzerosbyt.z..ThefollowingdeﬁnitionisduetoRosenbrock[101]:DEFINITION178.–Thesystemzeros(s.z.)aredeﬁnedbytheequality{s.z.}={t.z.}˙∪{h.m.}.Thefollowingtheoremdescribesthevariousrelationsamongthedifferentkindsofpolesandzeros;mostofthoseareowedtoRosenbrock[100],[101];theﬁrstinclusionofequation(7.25)wasestablishedin[19].THEOREM179.–(i){s.p.}={t.p.}˙∪{h.m.},(7.24){t.z.}˙∪{i.o.d.z.}⊂{i.z.}⊂{s.z.}.(7.25)(ii)Ifthetransfermatrixisleft-regular,{t.z.}˙∪{i.d.z.}⊂{i.z.}.(iii)Ifthetransfermatrixisright-regular,{t.z.}˙∪{o.d.z.}⊂{i.z.}.(iv)Ifthetransfermatrixissquareandregular,{s.z.}={i.z.}.PROOF.*Wearegoingtoprove(i)(fortheotherpoints,seeExercise214,or[19]).Equality(7.24)isderivedfromTheorem155(since,accordingtoTheorem129ofsection7.1.2,theproblemcanalwayscomedowntothecasewherethesystemisgivenbyastate–staterepresentation).For(7.25),weobservethatM[y]R∼=T(M)T([y]R)⊕ΦΦ∩[y]R,ΦΦ∩[y]R⊃Φ∩[y,u]RΦ∩[y]R,andaccordingtoLemma559(i)(section13.4.2),Z(cid:21)T(M)T([y]R)(cid:22)⊃Z(cid:21)T(M)T([y,u]R)(cid:22)fromwhichwededucetheﬁrstinclusion.Accordingtoequation(7.23),oneobtainsM/[y,u]R∼=T1,whereT1⊃T(M)T([y,u]R)⊕T2,T2=T(cid:21)ΦΦ∩[y,u]R(cid:22),SystemsTheory(II)195andasaresult,{o.d.z.}⊃Z(T2)˙∪{i.o.d.z.}.(7.26)Ontheotherhand,accordingtoTheorem538(iii)(section13.4.1)andLemma559(i)(section13.4.2),T2∼=T(cid:21)ΦΦ∩[y]R(cid:22)/T(cid:21)Φ∩[y,u]RΦ∩[y]R(cid:22),Z(T2)=Z(cid:21)ΦΦ∩[y]R(cid:22)\{t.z.}.Last,Z(cid:21)ΦΦ∩[y]R(cid:22)={z.i}\Z(cid:21)T(M)T([y]R)(cid:22),Z(T(M)/T([y]R))⊂{i.d.z.}fromwhichwegetZ(T2)˙∪{t.z.}˙∪{i.d.z.}⊃{z.i}.(7.27)Here,thesecondinclusionof(7.25)isaconsequenceof(7.26),(7.27)andofCorollary176.*7.3.Stability,stabilizabilityanddetectabilityThenotionofstability,essentialtocontroltheory,sofarhasbeendeﬁnedonlyforminimalsystems(Deﬁnition61,section3.1.1).Inthegeneralcase,oneusesthefollowingdeﬁnition:DEFINITION180.–AcontrolsystemΣ(assumedtobelineartime-invariant)isstableifallitspolesarelocatedinthelefthalf-plane.REMARK181.–Accordingtosection2.3.8,acontrolsystemisstableifandonlyif,allvariablesofitsfreebehaviortendto0ast→+∞.(Ina“behavioralapproach”[96],thispropertyistakenasdeﬁnitionofstabilityofacontrolsystem;withthisdeﬁnition,thefollowingisatheorem:asystemisstableifandonlyif,allitspolesbelongtothelefthalf-plane.6)SupposeΣisastate-spacesystem{A,B,C,D}.ThenthepolesofΣaretheeigenvaluesofA(Theorem18,section2.3.7).Wewillthenusethefollowingdeﬁnition:6.Thisremarkappearstobemadebasedonverysubtledistinctions.Theapproachaccordingtowhichalinearsystemischaracterizedbyaﬁnitelypresentedmoduleandthatinwhichsuchasystemischaracterizedbya“behavior”arenotidentical.TheequivalencebetweenthesetwoapproacheswasdeeplystudiedbyOberst[94](formorerecentresults,see[23]and[22]).196LinearSystemsDEFINITION182.–AmatrixA∈Rn×niscalledastabilitymatrixifallitseigenvaluesbelongtothelefthalf-plane.WecancompleteDeﬁnition180bythefollowing:DEFINITION183.–AcontrolsystemΣ(assumedtobelineartime-invariant)ismarginallystableifallitspoleslieintheclosedlefthalf-plane,thosebelongingtotheimaginaryaxis(ifany)havingalltheirstructuralindicesequalto1.REMARK184.–AccordingtoTheorem23(section3.1.1),acontrolsystemismarginallystableifandonlyif,allvariablesofitsfreebehaviorarebounded.(Ina“behavioralapproach”,thispropertyisusedasthedeﬁnitionofamarginallystablecontrolsystem).Withthisdeﬁnition,thefollowingisatheorem:acontrolsystemismarginallystableifandonlyif,allitspolesbelongtotheclosedlefthalf-plane,thosethatbelongtotheimaginaryaxis(ifany)havingalltheirstructuralindicesequalto1.)Thenotionsthatfollowwillshowalltheirsigniﬁcancewhenwegettothesubjectofcontrolbystatefeedbackandthetheoryofobservers,inChapters8and9,respectively.DEFINITION185.–Acontrolsystemisstabilizable(resp.,detectable)ifnoneofitsi.d.z.s(resp.,itso.d.z.s)belongstotheclosedrighthalf-plane¯C+.WededuceimmediatelyfromPropositions166(section7.2.2)and170(section7.2.4)thefollowingresult:PROPOSITION186.–“Popov–Belevitch–Hautustestforstabilizabilityanddetectability”.LetΣbeasystemdeﬁnedbyaRosenbrockrepresentation{D,N,Q,W};thissystemisstabilizable(resp.,detectable)ifandonlyif,rkC(cid:25)D(s)N(s)(cid:26)=r(resp.,rkC(cid:25)DT(s)QT(s)(cid:26)=r)foranys∈¯C+(wherer(cid:1)rkRD(∂)).Inparticular,astate-spacesystem{A,B,C,D}isstabilizable(resp.,detectable)ifandonlyif,rkC(cid:25)sIn−AB(cid:26)=n(resp.,rkC(cid:25)sIn−ATCT(cid:26)=n)foralls∈¯C+.ThefollowingisanimmediateconsequenceoftheabovepropositionandisrelatedtoCorollary153(section7.1.4).COROLLARY187.–Stabilizability↔detectabilityduality.(C,A)isdetectableifandonlyif,(cid:15)AT,CT(cid:16)isstabilizable.SystemsTheory(II)1977.4.Realization7.4.1.Introduction“Realization”meansputtingacontrolsystemintoastate-spaceform.Thistermisalittleambiguous:Theorem129(section7.1.2)showshowtoobtainarealizationofageneralcontrolsystem.Veryoften,astate-spacesystemcomesnaturallyfromphysicalequations(seetheexercises).Inthissection,wearegoingtoexaminehowtoobtainarealizationofaleftformaswellasthatofarightform.Then,itbecomeseasytodeterminea“minimalrealization”7fromatransfermatrixbecausesuchamatrixadmitsaleft-coprimefactorization(correspondingtoacontrollableleftform)andaright-coprimefactorization(correspondingtoanobservablerightform):seeRemark31(section2.4.5).Beforedoingso,noticethefollowing:let{A,B,C,D}beastate-spacerepresentationofapropercontrolsystem.ForanyinvertiblematrixP,(cid:31)P−1AP,P−1B,CP,D isalsoastate-spacerepresentationofthesamecontrolsystem(Remark7.5,section7.1.2).ThisbasistransformationmatrixPcanbechosensuchthatP−1APis,forexample,arationalcanonicalformofA(section13.4.3),andthereforethereexistsomeformsofrealizationthataremoreremarkablethanothers.Inaddition,iftheyhavethepropertyofuniqueness,theyarecalledcanonicalforms.Thelatterhavetheparticularityofhavingthesimplestpossiblestructure.Ontheotherhand,whenthesystemisofahighorder,thesecanonicalformsaretobeavoidedbecausetheirstatematrixisingeneralill-conditioned(seesection13.5.7).7.4.2.SISOsystemsAllsystemsconsideredinthisparagraphareSISO.CaseofanobservablesystemConsideracontrolsystemwhichisobservable,andwhichcanthusbedescribedbytheleftform(2.17)(section2.3.5)accordingtoTheorem147(section7.1.4).Assumingthatthissystemisproper,weobtainD(∂)y=N(∂)u,(7.28)D(∂)=∂n+a1∂n−1+...+an,(7.29)N(∂)=b0∂n+b1∂n−1+...+bn.(7.30)PerformingtheEuclideandivisionofN(∂)byD(∂)yieldsN(∂)=b0D(∂)+N(cid:2)(∂)7.Thatisarealizationintheformofaminimalstate-statesystem,inthesenseofDeﬁnition33(section2.4.6).198LinearSystems1bnbna1aunxnx2x2x1x1xyFigure7.5.Diagramofanobservablecanonicalformwhered◦(N(cid:2))<d◦(D).Letξ=y−b0u;thenD(∂)ξ=N(cid:2)(∂)u(7.31)y=ξ+b0u.Itnowsufﬁcestodeterminearealizationofastrictlyproperleftform(7.31).Inordertosimplifythecalculations,weassumeinwhatfollows,withoutlossofgenerality,thatthesystemconsideredisstrictlyproper.Onecanproceedasinsection12.5.1:theleftform(7.28),(7.29),(7.30)(withb0=0)isidenticaltothelineardifferentialequationwithconstantcoefﬁcients(12.97).Deﬁningthestatesx1,...,xnbytherelations(12.98),(12.99),oneobtainsthesystem(12.100),(12.101),i.e.˙x=⎡⎢⎢⎢⎢⎢⎢⎢⎣−a110···0−a20............0......0.........01−an00···0⎤⎥⎥⎥⎥⎥⎥⎥⎦x+⎡⎢⎢⎢⎢⎢⎢⎢⎣b1.........bn⎤⎥⎥⎥⎥⎥⎥⎥⎦u,(7.32)y=(cid:25)10······0(cid:26)x.(7.33)ThesestateequationscanberepresentedbythediagraminFigure7.5,thestatesbeingtheoutputsoftheintegrators.SystemsTheory(II)199Notethatthestate-spaceform(7.32),(7.33)isonlyanotherwayofwritingtheleftform(7.28).Asthisisobservable(Theorem147,section7.1.4),soisthestate-spacesystem(7.32),(7.33)(ascanbeshownusingtheKalmancriterion(Theorem150,7.1.4).Anotherremarkablepropertyofthestate-spaceform(7.32),(7.33)isitssimplicity:thisrealization{Ao,Bo,Co}issuchthatAoisacompanionmatrixofthepolynomialD(∂),BohascoefﬁcientssameasthoseofthepolynomialN(∂),andthematrixCoexpressestherelationy=x1.Itisa“canonicalform”,inthesensespeciﬁedinsection7.4.1.DEFINITION188.–Therealization(7.32),(7.33)iscalledtheobservablecanonicalformassociatedwiththeleftform(7.28).AccordingtotheremarksprecedingDeﬁnition188andTheorem138(section7.1.3),wehavethefollowing:PROPOSITION189.–Theobservablecanonicalform(7.32),(7.33)isalwaysobservable;itiscontrollableifandonlyif,thepolynomials{D,N}arecoprime.CaseofacontrollablesystemConsideracontrolsystemwhichiscontrollable,andthuscanbedescribedbytherightform(2.19)(section2.3.5)accordingtoTheorem137(section7.1.3),andsupposethissystemisstrictlyproper.Wethushavetheequations(cid:20)y=N(∂)ξ,u=D(∂)ξ,(7.34)D(∂)=∂n+a1∂n−1+...+an,(7.35)N(∂)=b1∂n−1+...+bn.(7.36)Wecanwritetheﬁrstlineof(7.34)explicitlyas:∂nξ=−(cid:15)a1∂n−1+...+an(cid:16)ξ+u.Letx=(cid:25)∂n−1ξ...ξ(cid:26)T;then,itfollowsthat˙x=⎡⎢⎢⎢⎢⎢⎢⎣−a1−a2······−an10···0001..................0...00010⎤⎥⎥⎥⎥⎥⎥⎦x+⎡⎢⎢⎢⎢⎢⎢⎣10......0⎤⎥⎥⎥⎥⎥⎥⎦u,(7.37)y=(cid:25)b1b2······bn(cid:26)x.(7.38)200LinearSystems1bna1au1na1nn1x2xnx1nbnbyFigure7.6.DiagramofacontrollablecanonicalformTheseequations,whicharethoseofarealization{Ac,Bc,Cc},canberepresentedbythediagraminFigure7.6below;therealization{Ac,Bc,Cc}isveryspecial,liketheobservablecanonicalformdescribedabove:AcisacompanionmatrixofthepolynomialD(∂),thecoefﬁcientsofCcarethoseofthepolynomialN(∂),andBchasastructurethatcannotbefurthersimpliﬁed.Sinceeveryrightformiscontrollableandequations(7.37)and(7.38)representonlyarewriting(inadifferentformalism)ofarightform,thestate-spacesystem{Ac,Bc,Cc}isnecessarilycontrollable.DEFINITION190.–Therealization{Ac,Bc,Cc}iscalledthecontrollablecanonicalformassociatedwiththerightform(7.34).ThefollowingpropositionisobtainedbyasimilarreasoningthatleadstoProposition189.PROPOSITION191.–Thecontrollablecanonicalform{Ac,Bc,Cc}isalwayscontrollable;itisobservable,if,andonlyif,thepolynomials{D,N}arecoprime.Wecanverifythecontrollabilityof(Ac,Bc)usingtheKalmancriterion(Theorem141,section7.1.3).ThecontrollabilitymatrixΓ(Ac,Bc)(seeRemark142)isformedbyiterationinthefollowingmanner:itsﬁrstcolumnisBcandits(i+1)thcolumn(1≤i≤n−1)isequaltoitsithcolumnleft-multipliedbyAc.REMARK192.–Oneshouldalwaysfollowtheaboveproceduretocalculatethecontrollabilitymatrix.Thisavoidsneedlesslycalculatingthepowersofthestatematrix,whichisverycumbersome.SystemsTheory(II)201Fromtheabovemethod,weobtainacontrollabilitymatrixoftheformΓc=⎡⎢⎢⎢⎢⎣1∗...∗01...............∗0...01⎤⎥⎥⎥⎥⎦whichisobviouslyofrankn.Moreprecisely,arathersimplecalculationshowsthatΓcA+=In,whereA+istheuppertriangularToeplitzmatrixA+=⎡⎢⎢⎢⎢⎣1a1···an−10............a10···01⎤⎥⎥⎥⎥⎦.Asaresult,Γc=A−1+.(7.39)OtherrealizationsofacontrollablesystemTherealizationsoftherightform(7.34)arealloftheform{A,B,C}=(cid:31)PAcP−1,PBc,CcP−1 ,accordingtoRemark132(section7.1.3),byusingachangeofbasismatrixP−1.AccordingtoRemark142(ii),wehaveΓ(A,B)=PΓc,andtherefore,accordingtoequation(7.39),P=Γ(A,B)A+.(7.40)Itfollowsfromtheabovethatthereexistsauniquerealization{Acc,Bcc,Ccc}ofequation(7.34)suchthatΓ(Acc,Bcc)=In.Indeed,{Acc,Bcc,Ccc}=(cid:31)A+AcA−1+,A+Bc,CcA−1+ .(7.41)LetAcc=⎡⎢⎢⎢⎢⎢⎢⎣00···0−an10···0001..................0−a20001−a1⎤⎥⎥⎥⎥⎥⎥⎦,Bcc=⎡⎢⎢⎢⎢⎢⎢⎣10......0⎤⎥⎥⎥⎥⎥⎥⎦,(7.42)Ccc=(cid:25)b1b2······bn(cid:26)A−1+.(7.43)OnecaneasilyverifythatA+Ac=AccA+,andthusrelation(7.41)issatisﬁed.202LinearSystemsDEFINITION193.–Therealization{Acc,Bcc,Ccc}iscalledthecanonicalformofcontrollability.Gatheringtheresultsobtained,wehavethefollowingtheorem:THEOREM194.–(i)Let{A,B,C}beanyrealization(withstatex)oftherightform(7.34).Thestatexcofthecontrollablecanonicalform{Ac,Bc,Cc}isdeterminedbytherelationx=Pxc,wherethechangeofbasismatrixPsatisﬁesequation(7.40).(ii)Thecanonicalformofcontrollability{Acc,Bcc,Ccc}istheuniquerealizationoftherightform(7.34),thecontrollabilitymatrixofwhichisIn.Itrelatestothecontrollablecanonicalformthroughtherelation(7.41)andisgivenbyequations(7.42)and(7.43);AccisacompanionmatrixofthepolynomialD(∂)(section13.4.3).DualitybetweencanonicalformsWehavethefollowing“dualityrelations”betweentheobservableandcontrollablecanonicalforms(theserelationsarelinkedtoCorollary153,section7.1.4):Ac=ATo,Bc=CTo,Cc=BTo.(7.44)Wewouldliketoemphasizethefactthattheobservability↔controllabilityduality,andthustheobservablecanonicalform↔controllablecanonicalformduality,isstrictlyformal,inthefollowingsense:letaphysicalsystembedescribedbyanobservablecanonicalform(thiscanbe,forexample,theRLCcircuitinFigure1.1,section1.1.1,describedbytheleftform(2.12)ofsection2.3.3,becausesuchadescriptionisequivalenttoanobservablecanonicalform);the“dualized”systemaccordingtotheformulas(7.44)doesnot,ingeneral,correspondtoanyphysicalreality.7.4.3.*MIMOsystemsWewillnowdealwiththesubjectofMIMOsystems,wherethecanonicalformsarenumerousandmorecomplicatedthanintheSISOcase[64].RealizationofacontrollablesystemInthefollowing,onlythecaseofacontrollablesystemisconsideredbecausetherealizationofanobservablesystemcanbederivedbyduality(Corollary153,section7.1.4).Wecanassumethesystemisdescribedbytherightform(2.19)(section2.3.5):(cid:20)u=D(∂)ξ,y=Q(∂)ξ,(7.45)whereD(∂)∈Rr×risamatrixofrankr.ThereexistmatricesU(∂)andV(∂),invertibleoverR,suchthat∆=U−1DVisadiagonalmatrixdiag{β1,...βr}SystemsTheory(II)203accordingtoTheorem497(section13.2.3),where0(cid:5)=βi∈Risamonicpolynomialforeveryindexi.Thematrix∆canbetheSmithformofD,butasshownbytheproofoftheaforementionedtheorem,obtainingthediagonalform,withoutdivisibilityconditionontheelementsβi,requireslesscalculation.Let=V−1(∂)ξ,v=U−1(∂)u,and˜Q=QV.Relations(7.45)canbeputintheform(cid:20)v=∆(∂),y=˜Q(∂).(7.46)Here,asseenabove,isacolumnvectorwithrentriesi(1≤i≤r).Supposethatinthelist(βi)1≤i≤r,theﬁrstjelements,andonlythose,areequalto1.Forj+1≤i≤r,wewritethepolynomialβiintheformβi(∂)=∂ni+βi,1∂ni−1+...+βi,ni.Ontheotherhand,puttingXi=⎡⎢⎢⎢⎣∂ni−1...∂1⎤⎥⎥⎥⎦j+i,1≤i≤r−j,weobtain,accordingtotheﬁrstrowofequation(7.46),∂Xi=C(βi)Xi+1nivj+i,1≤i≤r−j,whereC(βi)isthecompanionmatrixofthepolynomialβihavingthestructureofthestatematrixofacanonicalcontrollableform(seeequation(7.37),section7.4.2)andwhere1niisacolumnmatrixwithnirows,whoseonlynon-zeroentryistheﬁrstonewhichisequalto1.SettingX=⎡⎢⎣X1...Xr−j⎤⎥⎦,˜v=⎡⎢⎣vj+1...vr⎤⎥⎦,oneobtainstheequation∂X=AX+diag{1ni}1≤i≤r−j˜vwithA=diag{C(βi)}1≤i≤r−j.204LinearSystemsWritingv=U−1(∂)u,weobtainanexpressionoftheform(7.1)(section7.1.2)withX=η.ThereonlyremainstoimplementtheprocedurealreadyusedintheproofofTheorem129(section7.1.2)inordertogetthestateequation(7.2)(section7.1.2).Finally,theoutputy=˜Q(∂)iswrittenintheformofequation(7.3)(section7.1.2),takingintoaccounttheequalitiesi=vi,1≤i≤j.EXAMPLE195.–ConsiderthetransfermatrixG(s)=#s(s+1)2−s2(s+1)2(s−1)1(s+1)2s2+s+1(s+1)2(s−1)$.ProceedingasinRemark31(ii)(section2.4.5),weobtaintheright-coprimefactorization(Q(s),D(s))ofG(s)withQ(s)=(cid:27)s011(cid:28),D(s)=(cid:27)(s+1)2s0s−1(cid:28).TheSmithformofD(s)isΣ=U−1DV=diag(cid:7)1,(s+1)2(s−1)(cid:8)withU−1(s)=(cid:27)1−11−ss(cid:28),V=(cid:27)0−11(s+1)2(cid:28),whichwecanobtainbyusingthemethodof“markingoutelementaryoperations”(seesection13.2.3).ThestepsofobtainingaminimalrealizationofG(s)arenowasfollows:(i)Writetheequality(cid:27)v1v2(cid:28)=U−1(∂)(cid:27)u1u2(cid:28)=(cid:27)u1−u2u1−∂(u1−u2)(cid:28).(7.47)(ii)Accordingtotheﬁrstlineofequation(7.46),onegetsv1=1and(∂+1)2(∂−1)2=v2.ThislastequalityleadsustoputX=(cid:25)∂22∂22(cid:26)T,andweget∂X=AX+13v2withA=⎡⎣−111100010⎤⎦.(7.48)Accordingtoequation(7.47),∂X=AX+B0u+B1∂u,whereB0=⎡⎣100000⎤⎦,B1=⎡⎣−110000⎤⎦.SystemsTheory(II)205(iii)FollowingthemethodusedintheproofofTheorem129,letusputx=X−B1u.Weget∂x=Ax+BuwithB=AB1+B0,i.e.B=⎡⎣2−1−1100⎤⎦.(7.49)(iv)Attheend,y=˜Q(∂)with˜Q(∂)=Q(∂)V=(cid:27)∂011(cid:28)(cid:27)0−11(∂+1)2(cid:28)=(cid:27)0−∂1∂2+2∂(cid:28).Therefore,y1=−x2andy2=1+∂22+2∂2=u1−u2+(x1−u1+u2)+2x2,fromwhichwehavey=CxwithC=(cid:27)0−10120(cid:28).(7.50)ControllabilityindicesThankstotheaboveprocedure,weobtainarealizationwhosestatematrixAhasquiteaparticularform(andisactuallyinarationalcanonicalform,likeinExample195),buttheBmatrixdoesnothaveaprivilegedstructure(seeequation(7.49)).Theformobtainedisthereforenotcanonical.Wenowaregoingtoexaminehowwecangofromanyrealizationtoa“canonicalformofcontrollability”.Let{A,B,C}beastate-spacesystemofordernandbi(1≤i≤m)betheithcolumnofB∈Rn×m.TraversethecontrollabilitymatrixΓ(A,B)fromlefttorightandeliminate,asonegoesalong,thecolumnsthatarelinearlydependentontheprecedingones.Byre-arrangingtheremainingcolumns,weobtainamatrixoftheform(cid:25)b1...Ak1−1b1b2...Ak2−1b2...bm...Akm−1bm(cid:26)usingtheconventionthatAjbiistheemptycolumnifj<0.DEFINITION196.–Thenaturalintegerski,1≤i≤m,arethecontrollabilityindicesofthestate-spacesystem{A,B,C}.REMARK197.–Thereexistsazerocontrollabilityindexkiif,andonlyif,Γ(A,B)doesnotcontainanytermthatisdependentonbi.Asaresult,ifthematrixBisright-regular(i.e.rkB=m),allthekisarepositive.DEFINITION198.–[44]Thestate-spacesystem{A,B,C},whereA∈Rn×n,B∈Rm×n,andC∈Rp×n,issaidtobewell-formedifrkB=mandrkC=p.88.Inthecitedreference,onlythematrixBisconsideredforthisdeﬁnition.206LinearSystemsInthefollowing,thestate-spacesystemisassumedtobewell-formed.REMARK199.–Theabovehypothesisdoesnotgenerateanylossofgeneralityinreality.Indeed,supposethatrkB<mandrkC=p,andtoclarifyideasletm=3andrkB=2.OneofthecolumnsofB,b3forexample,isthusanR-linearcombinationoftheothercolumns,andsothereexistrealnumbersλ1andλ2suchthatb3=λ1b1+λ2b2.Consequently,Bu=b1(u1+λ1u3)+b2(u2+λ2u3).Substitutingu(cid:2)1=u1+λ1u3andu(cid:2)2=u2+λ2u3,oneisledtothecaseofawell-formedstate-spacesystemwithtwoinputsu(cid:2)1andu(cid:2)2.AsimilarreasoningcanjustifythatthematrixCcanalwaysbeassumedtobeofrankp.See,in[44],complementaryinterpretationsofthehypothesisthatrkB=m.REMARK200.–Assumingthatastate-spacesystemiswell-formed,thereexistsapermutationσof{1,...,m}suchthatµ1(cid:1)kσ(1)≥µ2(cid:1)kσ(2)≥...≥µm(cid:1)kσ(m)≥1;σcorrespondstoaright-multiplicationofBbyapermutationmatrixQcc∈GLm(R).Theintegers{µ1,...,µm}areagainthecontrollabilityindices,butarrangedina“canonicalorder”withwhichthematrixPcc=(cid:25)b(cid:2)1...Aµ1−1b(cid:2)1...b(cid:2)m...Aµm−1b(cid:2)m(cid:26)(7.51)isassociated,whereb(cid:2)i=bσ(i).Inwhatfollows,wewillcalltheﬁnitesequence(µi)1≤i≤mthelistofcontrollabilityindices.Thislistisinvariantunderchangeofbasisinthestatespaceandpermutationofsysteminputs.Theproofofthetheorembelowisdeducedinanobviousmannerfromtheconstructionofthelistofcontrollabilityindices(µi)1≤i≤minRemark200andfromTheorem141(section7.1.3):THEOREM201.–(i)Thelargestcontrollabilityindexµ1isthesmallestintegerµsuchthatρ(µ)(cid:1)rk(cid:25)BAB...Aµ−1B(cid:26)isstationaryforµ≥µ1.(ii)Wehaveρ(µ1)=(cid:11)1≤i≤mµiandthesystemiscontrollableifandonlyif,ρ(µ1)=n.Thereadercanﬁnda“geometricalinterpretation”ofthecontrollabilityindicesin([119],section5.7).CanonicalformofcontrollabilityDEFINITION202.–Thecanonicalformofcontrollability(withinputu(cid:2)=Q−1ccu)ofthewell-formedcontrollablestate-spacesystem{A,B,C}is{Acc,Bcc,Ccc}whereAcc=P−1ccAPcc,Bcc=P−1ccBQcc,Ccc=CPcc.(7.52)SystemsTheory(II)207Thisformisthefollowingwhenm=3and{µ1,µ2,µ3}={4,3,2}([64],section6.4):Acc=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣0∗∗∗1∗∗∗1∗∗∗1∗∗∗∗0∗∗∗1∗∗∗1∗∗∗∗0∗∗∗1∗⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦,Bcc=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣100010010⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦,andthematrixCccdoesnothaveapriorianyparticularform.Theunmarkedentriescontainazeroandthestarsdesignatepossiblynon-zeroelements.ItiseasytoshowthatΓ(Acc,Bcc)=In;thisformisthusageneralizationtotheMIMOcaseofthecanonicalformofcontrollability(7.42)(section7.4.2).EXAMPLE203.–ConsideragainExample195;wehavePcc=(cid:25)b1Ab1b2(cid:26),thusthecontrollabilityindicesare{µ1,µ2}={2,1}.Explicitly,Pcc=⎡⎣2−3−1−1210−10⎤⎦andbyapplying(7.52)wededucethefollowing:Acc=⎡⎣0−101−2−1001⎤⎦,Bcc=⎡⎣100001⎤⎦,Ccc=(cid:27)1−2−1011(cid:28).ControllablecanonicalformInwhatfollows,thecontrollablecanonicalformbecomesmoreusefulthanthecanonicalformofcontrollability,butitisalittlemoredifﬁculttoobtainintheMIMOcase(contrarytotheSISOcase).ThefollowingconstructionisduetoPopov[97](seealso[26],Chapter7).Consideragainawell-formedstate-spacesystem{A,B,C}.208LinearSystemsConsidertheinvertiblematrixPccgivenby(7.51).LetM=P−1ccandwewrite(assumingclarityofideasthatm=3)M=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣e1,1...e1,µ1e2,1...e2,µ2e3,1...e3,µ3⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦.LetPcbethechangeofbasismatrixdeﬁnedbyP−1c=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣e1,µ1Aµ1−1...e1,µ1e2,µ2Aµ2−1...e2,µ2e3,µ3Aµ3−1...e3,µ3⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦.(7.53)Let(cid:31)P−1cAPc,P−1cBQcc,CPc ={Ac,B(cid:2)c,Cc}(whereQccisthepermutationmatrixdeﬁnedinRemark200).ThematricesAcandB(cid:2)chavethefollowingstructures(form=3and{µ1,µ2,µ3}={4,3,2}):Ac=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣∗∗∗∗∗∗∗∗∗11100∗∗∗∗∗∗∗∗∗110∗∗∗∗∗∗∗∗∗1⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦,B(cid:2)c=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣1b1b200000000001b3000000001000⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦,(7.54)wheretheunmarkedentriesarezeroandthematrixCcdoesnothaveapriorianyparticularform.SystemsTheory(II)209NowletˇB=⎡⎣1b1b201b3001⎤⎦,υ=˘Bu(cid:2)=˘BQccu,(7.55)whereQccisthepermutationmatrixdeﬁnedinRemark200andu(cid:2)isasinDeﬁnition202.Weobtain(cid:7)P−1cAPc,P−1cBQcc˘B−1,CPc(cid:8)={Ac,Bc,Cc},whereAcisgivenbyequation(7.54)andBchasthesamestructureasB(cid:2)cbutwithalltheentriesbi(1≤i≤3)equaltozeroandwhereCcdoesnothaveapriorianyparticularstructure.DEFINITION204.–{Ac,Bc,Cc}isthecontrollablecanonicalform(withinputυ=˘BQ−1ccu)ofthewell-formedstate-spacesystem{A,B,C}.EXAMPLE205.–LetuscontinuewithExample195.Thechangeofbasismatrixgivenbyequation(7.53)isPc=⎡⎣211−1000−10⎤⎦(7.56)andweobtainwithQcc=I3Ac=⎡⎣−2−1−1100001⎤⎦,B(cid:2)c=⎡⎣1−10001⎤⎦.(7.57)Cc=(cid:27)100011(cid:28).(7.58)Asaresult,˘B=(cid:27)1−101(cid:28),Bc=⎡⎣100001⎤⎦.(7.59)7.5.FlatnessThenotionofaﬂatsystemwasconceivedbyFliessetal.[48]intheframeworkofnonlinearsystems;itsolvestheproblemofmotionplanning,whichisthedeterminationofanopen-loopcontrolthat,whenappliedtoasystemintheabsenceofanydisturbanceandmodelingerror,hastheeffectofhavingthissystemfollowanappropriatetrajectory.210LinearSystems7.5.1.*FlatnessofnonlinearsystemsLetΣbeanonlinearsystem,deﬁnedbyequation(2.4),section2.2.2,forexample,whereeachcomponentofFisavector-valuedrationalfunctionwithcoefﬁcientsinadifferentialﬁeldK.DEFINITION206.–Avariableσ=(σ1,...,σm)iscalledaﬂatoutputofΣif:(i)thecomponentsσiofσcanbeexpressedrationallyoverKasafunctionofthevariableswjofΣ(1≤j≤k)andaﬁnitenumberoftheirderivatives;(ii)conversely,allthevariableswjofΣcanbeexpressedrationallyoverKasafunctionofthecomponentsσiofσandaﬁnitenumberoftheirderivatives;(iii)σisanindependentvariable(section2.3.1).Aﬂatsystemisasystemthathasaﬂatoutput.7.5.2.FlatnessoflinearsystemsLetΣbealinearsystem,associatedwithaﬁnitelypresentedR-moduleM,whereR=K[∂](withK=Rif,inaddition,Σistime-invariant).Then,wecanreplacetheadverb“rationally”everywhereinDeﬁnition206by“linearly”;thetheorembelowfollowsfromRemark134(section7.1.3):THEOREM207.–AﬂatoutputofalinearsystemΣisabasisofitsassociatedmoduleM.Alinearsystemisﬂatifandonlyif,itiscontrollable.SystematicdeterminationofaﬂatoutputLetΣbethelinearcontrollablesystemdeﬁnedbyequation(2.6)(section2.2.5),whereE(∂)∈Rr×kisleft-regular(i.e.ofrankr).SincethemoduleMisfree,theSmithformofE(∂)is(cid:25)Ir0m×r(cid:26)(seesection13.4.2),wherer=k−mistherankofthemoduleM.Asaresult,thereexistmatricesU(∂)andV(∂),invertibleoverR,suchthatU−1(∂)E(∂)V(∂)=(cid:25)Ir0m×r(cid:26).LetV−1(∂)w=(cid:27)ςσ(cid:28),whereςandσhave,respectively,randmcomponents.Then,equation(2.6)isequivalenttoς=0,andσisabasisofM;therefore,σisaﬂatoutputofΣ.“Natural”ﬂatoutputsAcontrollablesystemoftenhasaﬂatoutputwhosephysicalsigniﬁcanceisclear.Consider,forexample,thelinearizedinvertedpendulum(2.7)(section2.2.7).Theabscissay1=y+lθofthemassmisaﬂatoutput.Indeed,fromthesecondequalitySystemsTheory(II)211ofequation(2.7),wegetθ=¨y1/g,andthereforey=y1−¨y1l/g.Fromtheﬁrstequalityof(2.7)weobtainf=¨y1(M+m)−y(4)1Ml/g.(7.60)Thevariabley1isabasisofthemoduleMsince(i)itisR-linearlyindependent(whichistrivialinthepresentcasebecauseithasonlyonecomponentthatisnotatorsionelement),(ii)alltheelementsofMareR-linearcombinationsofy1.Fromaphysicalpointofview,y1isthequantitythatprovidesthemostinformationaboutthesystem(ajugglerwhowouldliketobalancetheinvertedpendulumthroughsmallmovementsofthecarriagewouldhavehis/hereyesﬁxedonmassmthroughouthis/hernumber).Notethatthenonlinearinvertedpendulumisnotﬂat.ApplicationtomotionplanningSupposenowwewouldliketomovetheinvertedpendulumfromoneequilibriumpointtoanotherbetweentheinstantst0andt1>t0,whileychangesfromvaluey(t0)=0toy(t1)>0;supposealsothatwewouldliketorealizethismovementbyimposingthattheabscissay1bestrictlyincreasing(andthuswithoutanyoscillationofthemassm).Theequilibriumconditions,expressedasafunctionofthevariabley1,canbewrittenfori∈{0,1}as:y1(ti)=y(ti),y(β)1(ti)=0(1≤β≤4).ThesecanbesatisﬁedifwechooseapolynomialP(t)ofdegree9andappropriatecoefﬁcientsforthetrajectoryt(cid:3)→y1(t)(followingHermite’sinterpolationmethod:seeExercise223,section7.6).Theopen-loopcontroltobeappliedtothesystemisthenobtainedbyequation(7.60).(Inthepresentcase,thesystembeingunstable,itisalsonecessarytostabilizeitbyfeedbackaroundthe“nominaltrajectory”asdeﬁnedhere.)Thetrajectoryoftheﬂatoutputwitht0=0,t1=1,y(0)=0,andy(1)=1isrepresentedinFigure7.7.7.6.ExercisesEXERCISE208.–ConsidertheDCmotordeﬁnedbyequation(2.14)(section2.3.3).(i)Putthissysteminstate-spaceformusinginputu=V,statex=(cid:25)θωi(cid:26)T,andoutputofy=θ.(ii)Showthatthissystemiscontrollableandobservable.EXERCISE209.–(i)Fromtheequationsofthelinearizedinvertedpendulum((2.7),section2.2.7),determineastate-spacerealizationofthatsystembychoosingstatex=(cid:25)˙ylθl˙θy(cid:26)Tandinputu=f/M.Intheremainingpartofthisexercise,weputσ=%glandε=mMandweassumethat0<ε<1.(ii)Determinethepolesofthissystem;isthissystemstable?(iii)Showthatthissystemiscontrollable.212LinearSystems00.20.40.60.8100.20.40.60.81Time (s)Flat outputFigure7.7.Trajectoryoftheﬂatoutput(iv)SupposingthattheoutputisanR-linearcombinationofx1,x2,andx3,isthesystemobservable?Isitdetectable?(v)Whatiftheoutputisx4?(vi)Ifx4istakenasoutput,determinethetransmissionzerosofthesystem.Whathappenswhenε(cid:16)1?EXERCISE210.–Considerthetraindeﬁnedbyequations(1.19)(section1.11).(i)Putthissysteminastate-spaceformwithx=(cid:25)˙z1˙z2z1z2(cid:26)T,λ=km1,ρ=m1m2,andcontrolu=fm1.(ii)Usingthisstate-spacerepresentation,determinethepolesofthesystem.Istherecoherencewiththeexpression(2.13)(section2.3.3)?(iii)Isthesystemcontrollable?(iv)Ifonechoosesx2asoutput,isthesystemobservable?Howwouldyouinterpretthis?(v)Determinethehiddenmodeswhenx2istheoutput.(vi)Whathappensifwechoosex4astheoutput?(vii)Withthelastchoice,doesthecontrolsystemhavetransmissionzeros9?EXERCISE211.–ConsidertheRLCcircuitdescribedbytherightform(2.18)(section2.3.5).(i)Putthissystemincontrollablecanonicalform.(ii)Calculateitsobservabilitymatrix.Whathappensifthecapacitorhasacapacitancethattendsto+∞?Interpretation?EXERCISE212.–ConsiderthelinearizedinverteddoublependulumwithequationsdeterminedinExercise56(Section2.7).(i)Showthatthissystemadmitsastate-spacerepresentationwithstatex=(cid:25)θ1θ2˙θ1˙θ2(cid:26)Tandinputu=−fM.(ii)Whatarethenecessaryandsufﬁcientconditionsonthelengthsl1andl2forthesystemtobecontrollable?(iii)Choosingx1asoutput,willthesystembeobservable?9.Asmentionedinthebeginningofsection7.2,weareonlyconcernedwithﬁnitetransmissionzeros.SystemsTheory(II)213EXERCISE213.–Let{A,B,C}beastate-spacesystemwithA=(cid:27)0010(cid:28),B=(cid:27)10(cid:28),C=(cid:25)10(cid:26).NoticingthatthissystemalreadyhasthecanonicalstructureinTheorem155(section7.1.5),showthat(Ac¯o,Bc¯o)isnotcontrollable.EXERCISE214.–*WecallLaplacefunctor[45]thefunctorK⊗R−,whereKistheﬁeldoffractionsofR(seesection13.6.5).LetybeacolumnvectorwhoseentriesyibelongtoanR-moduleM;weseethatˆyiistheimageofyiunderthecanonicalhomomorphism(i.e.ˆyi=11yi)andthatˆyisthecolumnvectorconstitutedoftheˆyis.(a)ConsideralinearcontrolsystemassociatedwithaﬁnitelypresentedR-moduleM,withinputuandoutputyhavingmandpcomponents,respectively,withtransfermatrixG.Showthatˆy=Gˆu.(b)IfrkKG=p,usingresultsfromthelastpartofsection13.6.5,showthat[y]RisafreemoduleanddeducePart(ii)ofTheorem179(byadaptationoftheproofofPart(i)).(c)IfrkKG=m,showthatthemoduleM/[y]Ristorsionand,byasimilarapproachashereabove,provePart(iii)ofTheorem179.(d)Finally,provePart(iv)ofthistheorem.EXERCISE215.–*LetRbeanintegraldomainandlet(M,u,y)beacontrolsystemwhoseringofoperatorsisR.(i)UsingtheLaplacefunctor(seeExercise214),deﬁnethetransfermatrixofthissystem(using(13.66)).(ii)AssumingthatRisacommutativeelementarydivisorring(seesection13.2.3)deﬁnetheSmith–MacMillanformofatransfermatrix,thusgeneralizingDeﬁnition29.EXERCISE216.–(i)Considerthestate-spacesystem˙x1=u1,˙x2=x2+u2,y=x1.Calculateitso.d.z.sanditsi.z.s.(ii)Considerthestate-spacesystem˙x1=u,˙x2=x2,y1=x1,y2=x2.Calculateitsi.d.z.sanditsi.z.s.(iii)IstherecoherencewithTheorem179?EXERCISE217.–LettherebethetransfermatrixG(s)=(cid:27)1s+11s+21s+31s+4(cid:28).(i)Showthat(Q(s),D(s))isaright-coprimefactorizationofG(s)withQ(s)=(cid:27)s+3s+4s+1s+2(cid:28),D(s)=(cid:27)s2+4s+300s2+6s+8(cid:28).(ii)DeduceaminimalrealizationofG(s)incontrollablecanonicalform.Isitunique?Ifnot,why?214LinearSystemsEXERCISE218.–(i)Analogoustocontrollabilityindices,deﬁnetheobservabilityindicesofanMIMOstatesystem{A,B,C}.(ii)Assumingthatthissystemiswell-formed,describeitscanonicalformofobservability{Aoo,Boo,Coo}andtheobservablecanonicalform{Ao,Bo,Co}.(iii)Howdoesonegofrom{A,B,C}to{Aoo,Boo,Coo}andthento{Ao,Bo,Co}?EXERCISE219.–LettherebethetransfermatrixG(s)=#s(s+1)2(s+2)2−s(s+2)2s(s+2)2−s(s+2)2$.(i)Showthat(D(s),N(s))isaleft-coprimefactorizationofG(s)withD(s)=(cid:27)0(s+2)2−(s+1)2(s+2)s+2(cid:28),N(s)=(cid:27)s−s0s2(cid:28).(ii)DeduceaminimalrealizationofG(s)inobservablecanonicalform(seeExercise218).Isitunique?EXERCISE220.–LetΣ={A,B,C}bethestate-spacesystemwithA=⎡⎣−1001−301−41⎤⎦,B=⎡⎣010⎤⎦,C=(cid:27)100−110(cid:28).(i)StudythecontrollabilityandtheobservabilityofΣ.(ii)Determinethepolesofthissystem.(iii)Calculate(ifany)itsi.d.z.s,itso.d.z.s,itsi.o.d.z.s,anditshiddenmodes.Deduceitstransmissionpoles.(iv)IsΣstabilizable?detectable?(v)Calculateitsinvariantzeros.EXERCISE221.–SamequestionsasinExercise220whenA=⎡⎣−100110000⎤⎦,B=⎡⎣001⎤⎦,C=(cid:25)−101(cid:26).(beforeansweringQuestion(iii),calculatethetransferfunctionof{A,B,C}).EXERCISE222.–(i)Showthatastate-spacesystemΣ={A,B,C,D}iscontrollableifandonlyif,thereisnolefteigenvectorofAthatwillannihilateB,i.e.arowvectorvT(cid:5)=0suchthatvTA=λAandvTB=0.(ii)Stateacriterionofthesametype,forobservability.SystemsTheory(II)215EXERCISE223.–Lettherebetwodistinctrealnumbersy0andy1andtwoinstantst0andt1=t0+∆,∆>0.ShowthatthereexistsauniquepolynomialP(t)ofdegree2n+1thatsatisﬁesthefollowingconditions:P(ti)=yi,P(β)(ti)=0,1≤β≤n,i∈{0,1}.Findthesystemoflinearequationsthatwilldeterminethecoefﬁcientsofthispolynomial.(“Hermite’sinterpolation”.)EXERCISE224.–(i)Showthatz2is“naturalﬂatoutput”ofthetraindeﬁnedbyequations(1.19)(section1.11).(ii)Wewishtotransferthistrainfromoneequilibriumpositiontoanotherbetweeninstantst0andt1>t0,whilez2movesfromvaluez2(t0)=z20toz2(t1)=z21(cid:5)=z20.Writedowntheequilibriumconditionsasafunctionoftheﬂatoutputz2.Chapter8StateFeedbackThestate-spaceformalismisveryusefulinprovidingbothasimpleandcompletesystemrepresentation.Thistypeofrepresentationisindeedsimplerthana“Rosenbrockrepresentation”:seesection2.3.6.Ontheotherhand,withinthisformalism,acompletedescriptionofthesystemispossible(ifthelatter’s“structureatinﬁnity”[22]isleftaside).Inaddition,hiddenmodesarenotoverlookedunliketherepresentationbyatransfermatrix(Proposition157,section7.1.5).Butthestate-spaceformalismisespeciallyinterestinginthatitisparticularlywelladaptedtosolvingcontrolproblems.Thisisthesubjectofthisandthefollowingchapters.First,wewillstudythecontrolbyan“elementary”statefeedback.Thisessentialpartshedsnewlightonthenotionsofcontrollabilityandstabilizability.Butthisisonlyapreliminarystep.Wewillthenexplainhowstatefeedbackcanbeusedinpracticetosolvecontrolproblems.8.1.Elementarystatefeedback8.1.1.GeneralprincipleLettherebeastate-spacesystem˙x=Ax+Bu,x(t)∈Rn,u(t)∈Rm,(8.1)y=Cx,y(t)∈Rp.(8.2)Inordertocontrolthissystembystatefeedback,wewillassumeintherestofthischapterthatallthestatecomponentsaremeasured.Thishypothesisisratherstrict217Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.218LinearSystems(andwewillseeinthenextchapterhowtodowithoutit),butthereareinpracticequiteanumberofcaseswherethisissatisﬁed.Letusconsiderthesimplestexamplethatwehaveencounteredsofar:thatofthecarriage(Example133,section7.1.2).Thestateofthissystemconsistsofitspositionandvelocity;inordertocontrolthissystemusingstatefeedback,wewillassumethatitisequippedwithapositionsensor(whichisnecessaryanywayifwewanttocontrolthisposition)andaspeedsensor.Wemay,however,dispensewithaspeedsensorbyestimatingthespeedvusingthepositiony.Wehavev=˙y,andhence,inpassingintotheLaplacedomain,ˆv(s)=sˆy(s)ify(0−)=0.Thederivativeoperatorhastransferfunctions,whichisimproper,butonecanreplaceitwithaﬁlteredderivativeoperatorwithtransferfunctions1+τs,τ>0.The“estimatedspeed”ve=L−1(cid:9)s1+τsˆy(s)(cid:10)willbeasclosetotherealspeedvasthetimeconstantτissmall.AsecondexampleistheDCmotorstudiedinsection1.3,whichcanbeputinstate-spaceformwithx=(cid:25)θωi(cid:26)T(seeExercise208,section7.6).Ifweputinasensorforanangularpositionθandasensorforcoilcurrenti,onecanconsiderthatthestateismeasuredbecausetheangularspeedωisderivedfromθ,withinagoodapproximation,thankstotheproceduredescribedabove.Astatefeedbackforsystem(8.1)isoftheformu=v−Kx(8.3)whereK∈Rm×nisthegainmatrix(ormoresuccinctly,thegain)ofthestatefeedbackandvisanexternalsignal,calculatedfromthereferencesignal.ThediagramofthefeedbacksystemisshowninFigure8.1.Notethatthestatefeedback(intheelementaryversionpresentedinthissection)doesnotdepend–atleastnotdirectly–ontheoutputy.Theequationofthefeedback-+xCyuBxAx               KvuyxFigure8.1.ControlbystatefeedbackStateFeedback219systemisobtainedbyreplacingthecontroluinequation(8.1)byitsexpression(8.3),andoneobtains˙x=(A−BK)x+Bv.(8.4)Thisexpressionisoftheformofequation(8.1)withAreplacedbyA−BKandureplacedbyv.8.1.2.PoleplacementbystatefeedbackLEMMA225.–Thei.d.z.sofasystemareinvariantunderstatefeedback.PROOF.Changingthebasisinthestate-spaceifnecessary,wecanassumethatsystem(8.1)canbedecomposedaccordingtocontrollability(seesection7.1.3,equation(7.7)andFigure7.2).Inotherterms,wecansupposethatmatricesAandBareoftheformA=(cid:27)AcA120A¯c(cid:28),B=(cid:27)Bc0(cid:28)where(Ac,Bc)iscontrollableandthesubmatrixA¯cisemptyifandonlyif,(A,B)iscontrollable.LetK=(cid:25)KcK¯c(cid:26)bethegainmatrixofthestatefeedback(decomposedincoherencewiththestructureofthematricesAandBabove).OneobtainsA−BK=(cid:27)Ac−BcKcA12−BcK¯c0A¯c(cid:28).(8.5)Thei.d.z.saretheeigenvaluesofA¯c(section7.2.2,Proposition167),andhencetheyareinvariantunderstatefeedback.Thepolesofalineartime-invariantsystemwithrealcoefﬁcientsalwayshavethefollowingsymmetryproperty:ifp∈Cisapoleofthesystem,thentheconjugate¯pofpisalsoapoleofthesystem.Thisleadsustoadoptthefollowingdeﬁnition,inaccordancewith([119],section0.8):DEFINITION226.–AsubsetPofCissaidtobesymmetric(abouttherealaxis)if:foreveryp∈P,wehave¯p∈P.LEMMA227.–ConsiderthesystemΣdeﬁnedbythestateequation(8.1)withm=1.LetP⊂Cbeasymmetricsetofnelements.IfΣiscontrollable,thenthereexistsauniquestatefeedbacksuchthatthepolesofthefeedbacksystemaretheelementsofP.220LinearSystemsPROOF.SinceΣiscontrollable,thematrixPdeﬁnedby(7.40)(section7.4.2)isinvertible,and(Ac,Bc)=(cid:15)P−1AP,P−1B(cid:16)isinacontrollablecanonicalform;inotherwords,thematricesAcandBcare,respectively,thestatematrixandcontrolmatrixofsystem(7.37)(section7.4.2).Letxcbethestateofthiscontrollablecanonicalform.Wehavex=Pxc,andhencethecontrol(8.3)iswrittenasu=v−KPxc.LetKc=KP=(cid:25)kc1kc2...kcn(cid:26).Thefeedbacksystem,inthenewbasis,isexpressedas˙xc=(Ac−BcKc)xc+BcuwithAc−BcKc=⎡⎢⎢⎢⎢⎢⎢⎣−a1−kc1−a2−kc2······−an−kcn10···0001..................0...00010⎤⎥⎥⎥⎥⎥⎥⎦.ThematrixAc−BcKcisacompanionofthepolynomialf(s)=sn+f1sn−1+...+fn,(8.6)fi=ai+kci,1≤i≤n;(8.7)f(s)isthusthecharacteristicpolynomialofAc−BcKc(section13.4.3,Proposition562(i)),andthereforeofA−BK.Letf(s)=’p∈P(s−p)andwewritef(s)intheformofequation(8.6).Accordingtoequation(8.6)andtheexpression(7.40)(section7.4.2),Pisthesetofpolesofthefeedbacksystemif,andonlyif,K=(cid:25)f1−a1f2−a2...fn−an(cid:26)[Γ(A,B)A+]−1.(8.8)REMARK228.–Expression(8.8)ofthegainmatrixofthestatefeedbackiscalledtheBass–Guraformula.Itis,ingeneral,quitecumbersometouseinpractice,butithastheinterestingpointofshowingKcanbeexpressedlinearlyasafunctionofthecoefﬁcientsfi−ai,1≤i≤n.LEMMA229.–ConsiderthesystemΣdeﬁnedbythestateequation(8.1)withm>1.LetP⊂Cbeasymmetricsetofnelements.IfΣiscontrollable,thenthereexistsanon-uniquestatefeedbackcontrolsuchthatpolesofthefeedbacksystemaretheelementsofP.StateFeedback221PROOF.SinceΣiscontrollable,wecanputthesystemincontrollablecanonicalformbychangeofbasisinthestate-spaceandinthecontrolspace,i.e.inRnandRm,respectively(seesection7.4.3).Toclarifyideas,supposethiscanonicalformis(7.54);denotebyxcitsstateandbyυitscontrol(seeDeﬁnition204,section7.4.3).Letthestatefeedbackcontrolbeequation(8.3),whichcanbeputintheformυ=ν−Kcxcbychangeofvariable(7.55)(section7.4.3).(1)Oneﬁrstmethodconsistsofchoosingrealnumbersαi(1≤i≤4),βi(1≤i≤3),andγi(1≤i≤2)andthendetermineKcinsuchawaythatAc−BcKc=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣−α1−α2−α3−α400000111000000−β1−β2−β3001100000000−γ1−γ21⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦(thisdeterminationisnotdifﬁcultduetotheformofBc).Therefore,{Ac−BcKc,Bc}hasthesamecontrollabilityindicesas{A,B}anddet(sI9−Ac+BcKc)=α(s)β(s)γ(s),α(s)=s2+α1s+α2,β(s)=s3+β1s2+β2s+β3,γ(s)=s4+γ1s3+...+γ4.Polynomialsα(s),β(s),andγ(s)canbearbitrarilychosen,andtheirroots,whicharethepolesofthefeedbacksystem,canbearbitrarilychosentoo.(2)Thesamepolescanbeobtainedwithdifferentmethods,givingdifferentgainmatrices,andwearegoingtoshowonecaseherebelow:itconsistsofchoosingtherealnumbersαi(1≤i≤9)anddeterminingKcinsuchawaythatAc−BcKc=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣−α1−α2−α3−α4−α5−α6−α7−α8−α9111000001000001100000001001⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦;222LinearSystemsthedeterminationofKcisnotdifﬁcult,forthesamereasonasgivenbefore.Thistime,thematrixAc−BcKciscyclicsinceitisacompanionofthepolynomialα(s)=s9+(cid:11)1≤i≤9αis9−i.Thepolesofthefeedbacksystemaretherootsofthepolynomialα(s)andthuscanarbitrarilybechosen.Thefollowingtheoremisoneofthemostimportantinthetheoryofstate-spacesystems:THEOREM230.–ConsiderthesystemΣdeﬁnedbyequation(8.1).(i)Thefollowingtwoconditions(a)and(b)areequivalent:(a)foranysymmetricsetP⊂Cofnelements,thereexistsastatefeedback(8.3)forwhichthepolesoftheclosed-loopsystemaretheelementsofP;(b)thesystemΣiscontrollable.(ii)Thereexistsastatefeedbackforwhichtheclosed-loopsystemisstableif,andonlyif,Σisstabilizable.PROOF.1)(a)⇒(b):Letusprovethisimplicationbycontradiction.Ifsystem(8.1)isnotcontrollable,thesetofitsi.d.z.sisnon-empty(Theorem165,section7.2.2).Thesei.d.z.sarepolesofthesystemandareinvariantbyfeedbackaccordingtoLemma8.1,andthusCondition(a)doesnothold.2)(b)⇒(a)accordingtoLemmas227and229.3):Assume,withoutlossofgenerality,thatthesystemΣisdecomposedaccordingtocontrollability.Sincethefeedbacksystemisgivenbyequation(8.5),thesetofitspolesisSp(Ac−BcKc)˙∪Sp(A¯c)(whereSpand˙∪denotethespectrumandthedisjointunion,respectively:seesections13.3.3and7.2.5).ThesystemΣisstabilizableifandonlyifallitsi.d.z.s(whicharetheeigenvaluesofA¯casshownintheproofofLemma225)belongtothelefthalf-plane(Deﬁnition185,section7.3).Ontheotherhand,(Ac,Bc)iscontrollableaccordingtoProposition144(section7.1.3),andhencetheeigenvaluesofAc−BcKccanbearbitrarilyassigned(providedthattheyformasymmetricsubsetofCwhosecardinalisn)bychoiceofKcaccordingto(i).REMARK231.–Brunovskicanonicalform.WeusetheﬁrstmethodintheproofofLemma229andwechoosethecoefﬁcientsαi,βi,andγitobezero.Thefeedbacksystemthusisreducedtothreechainsofintegrators,whichare:˙x1=υ1,˙xi+1=xi,1≤i≤3˙x5=υ2,˙xi+1=xi,5≤i≤6˙x8=υ3,˙x9=x8.ThisstaterepresentationiscalledtheBrunovskicanonicalformofthewell-formedsystemconsidered.Weencounterthis,inparticular,inthecontextofnonlinearsystem,whenweusethetechniqueof“linearizationbyfeedbackanddiffeomorphism”[62];arobustversionofthistechniquewasdevelopedin[49].ForfurtherdetailsontheBrunovskicanonicalform,see[44].StateFeedback2238.1.3.ChoiceofthepoleplacementintheSISOcaseLetΣbeacontrollableSISOstate-spacesystemofordern.AccordingtoLemma227,ifonechoosesasymmetricsetP⊂Cofnelements,thereexistsauniquestatefeedbackcontrolforwhichthepolesoftheclosed-loopsystemaretheelementsofP.Thechoiceofthepoleplacementisthusreducedtothechoiceofthepolesoftheclosed-loopsystem.Bychangeofbasisinthestate-space–ifnecessary–theproblemcomesdowntothecasewhereΣisincontrollablecanonicalform.Thestateofthiscanonicalformisxc=(cid:25)∂n−1ξ...ξ(cid:26)Twhereξisthepartialstate(seesection7.4.2),andhencethestatefeedbackcontrolu=v−Kcxc=v−(cid:25)kc1...kcn(cid:26)xccanbewrittenintheformu=v−K(∂)ξ,(8.9)K(∂)=(cid:12)1≤i≤nkci∂n−i.Expression(8.9)isthatofa“partialstatefeedbackcontrol”(seesection6.3.5).ToobtainamodulusmarginMmiequalto1,itisthussufﬁcienttochoosethepolesπkofthefeedbacksystemasafunctionofthenpolespk(1≤k≤n)ofΣaccordingtoRule111(section6.3.5).EXAMPLE232.–Theexamplepresentedhere,eventhoughitisacademic,allowsustohighlightseveralimportantpoints.LetΣ={A,B}beastate-spacesystemwithA=⎡⎣−120100110⎤⎦,B=⎡⎣100⎤⎦.ThecontrollabilitymatrixisΓ(A,B)=⎡⎣1−1301−1010⎤⎦;itsdeterminantis1,andhenceΣiscontrollable.ThepolesofΣare{−2,0,1}.Rule111(section6.3.5)isthusrespectedifwechoosethepolesoftheclosed-loopsystemtobe{−2,−1,−1}.ThecharacteristicpolynomialofthefeedbacksystemisthenPc(s)=(s+2)(s+1)2=s3+4s2+5s+2.Nowletthestatefeedbackbeequation(8.3)(section8.1.1)withK=(cid:25)k1k2k3(cid:26).Accordingto(8.4),thestatematrixofthefeedbacksystemisA−BK=⎡⎣−1−k12−k2−k3100110⎤⎦224LinearSystemsanditscharacteristicpolynomialisf(s)=s3+s2(k1+1)+s(k2+k3−2)+k3.ByidentifyingPc(s)andf(s)termbyterm,weobtainK=(cid:25)352(cid:26).ThemethodusedheretocalculateKrequiressigniﬁcantlyfewercomputations(whentheyare“handcalculated”)thanthe“Bass-Guraformula”(seeRemark228).ThesensitivityfunctionSiisgivenbytherelationSi=(I+Li)−1withLi=K(sIn−A)−1B.Sincethefeedbacksystemisstable,wehaveSi∈(cid:1)H∞.TheBodeplotofSiisshowninFigure8.2.1Since|Si(iω)|≤1andlimω→+∞|Si(iω)|=1,wehave(cid:23)Si(cid:23)∞=1,andhenceMmi=1accordingtotheexpression(4.23)ofsection4.2.9.AccordingtoTheorem93(section4.2.9),thisinputmodulusmarginguaranteesaninputgainmarginof(−6dB,+∞)andaninputphasemarginof(−60◦,60◦)(Deﬁnition92).WecanverifythispointontheBodeplotofLi,showninFigure8.3.Theactualinputgainmarginandactualinputphasemarginare(−9.5dB,+∞)and(−64◦,64◦),respectively.Theyarethus,inthisparticularcase,quiteclosetothegainmarginandphasemarginguaranteedbythemodulusmargin(whichisrelatedtothefactthatΣisunstableandthustheNyquistplotofLi(s)encirclesthecriticalpoint−1intheanti-clockwisesense:seeFigure8.4).8.1.4.*ChoiceofthepoleplacementintheMIMOcaseLetΣbeastate-spacesystemofordern,well-formed,andwithmcontrolvariables.ThedifﬁcultiesAsshownbyLemma229,thechoiceofthepolesofthefeedbacksystemdoesnotuniquelydeterminethestatefeedbackifm>1.EXAMPLE233.–ConsiderthestatesystemΣ={A,B,C}deﬁnedinExample195(section7.4.3)and,moreprecisely,bytheequalities(7.48),(7.49),and(7.50).AccordingtoExample205(section7.4.3),byputtingx=Pcxandυ=˘Bu,wherePcand˘Baregivenby(7.56)and(7.59),respectively,weobtainthecontrollablecanonicalform{Ac,Bc,Cc},withstatexcandcontrolυ,givenby(7.57),(7.58),and(7.59).ThepolesofΣare{−1,−1,1}.Therefore,Rule111ofsection6.3.5isbeingcompliedwithifwechoosethepolesofthefeedbacksystemtobe{−3,−3,−5}.(1)WewillfollowthispoleplacementaccordingtoMethod(1)oftheproofofLemma229.WeobtainAc−BcKc=⎡⎣−6−9010000−5⎤⎦,Kc=(cid:27)48−1006(cid:28).1.Thecurvesrelatedtosection8.1areplacedattheendofthissection.StateFeedback225Thegainmatrixofthestatefeedback(8.3)isK=˘B−1KcP−1c=(cid:27)56−36126(cid:28).ThesingularvaluesofthesensitivityfunctionSiareplottedinFigure8.5asafunctionofthefrequencyω.Wenotethat(cid:23)Si(cid:23)∞(cid:9)0.008dB.Thisquantityislargerthan1(byjustalittle),andhencethepropertythatholdsintheSISOcase(i.e.(cid:23)Si(cid:23)∞=1)islost.(2)WewillnowusethesamepoleplacementaccordingtoMethod(2)oftheproofofLemma229.Weget(s+3)2(s+5)=s3+11s2+39s+45.WeobtainAc−BcKc=⎡⎣−11−39−45100010⎤⎦,Kc=(cid:27)938440−11(cid:28).Thegainmatrixofthestatefeedback(8.3)isK=˘B−1KcP−1c=(cid:27)45818122(cid:28).ThesingularvaluesofthesensitivityfunctionSiareplottedinFigure8.6asafunctionofω.Thistime,(cid:23)Si(cid:23)∞(cid:9)11.9dB,or(cid:23)Si(cid:23)∞(cid:9)4.TheinputmodulusmarginMmiisonly0.25,andTheorem93(section4.2.9)givesaguaranteedgainmarginof(−1.9dB,2.5dB)andaguaranteedphasemarginof(−14.4◦,14.4◦).Theseareverypoorvalues.REMARK234.–(i)Theaboveexampleshowsthatforidenticalpolesoftheclosed-loopsystem,thestatefeedbackcontrolcanhaverobustnesspropertiesverydependentonthemethodusedfordesigningthepoleplacement.(ii)WecanconjecturethatMethod(1)providesabettermodulusmarginthanMethod(2).Thereader,however,shouldnotbelievethatMethod(1)willalwaysprovideamodulusmargincloseto1aslongasRule111ofsection6.3.5isbeingabidedby,withrespecttothechoiceoftheclosed-looppoles.Forexample,forthechoice{−1,−1,−1},whichcomplieswiththisrule,weobtainK=(cid:27)121242(cid:28),Mmi(cid:9)0.62.(α)methodWewillprovideinwhatfollowsasolutiontothedifﬁcultyshownabove.Wewillcallthissolutionthe“(α)method”.226LinearSystemsLetP∈Rn×nbeasymmetricrealmatrixandAα=A+αIn,α∈R.Considerthestatefeedback(8.3)whereK=BTP.(8.10)Let{λ1,...,λn}betheeigenvaluesof˜Aα(cid:1)Aα−BK(repeatingeacheigenvalueasmanytimesasitsmultiplicity).Assumethat˜Aαisdiagonalizable,andlet{ξ1,...,ξn}beabasisofassociatedeigenvectors.Letηi=Pξi(1≤i≤n),whichisequivalenttoη=Pξ,and,sinceξisinvertible,toP=ηξ−1(8.11)whereη=(cid:25)η1...ηn(cid:26),ξ=(cid:25)ξ1...ξn(cid:26);(8.12)andthenletνi(cid:1)(cid:27)ηiξi(cid:28),1≤i≤n.(8.13)REMARK235.–Thehypothesisthat˜Aαisdiagonalizableisonlymadetosimplifythediscussion.Thereadercanverifythattherationalewhichfollowsisalongthemainlinesandisstillvalidifthishypothesisisremovedandwedenoteabasisofgeneralizedeigenvaluesof˜Aαby{ξ1,...,ξn}(seeRemark531,section13.3.4).*Fromanumericalpointofview,itispreferabletousetheSchurformthantheJordanform([2],AnnexE).*LEMMA236.–(i)MatrixPisasolutionoftheequationPAα+ATαP−PBBTP=0,(8.14)(calledanalgebraicRiccatiequation)ifandonlyif,foranyi∈{1,...,n},thefollowingequalityholds:(cid:27)Aα−BBT0−ATα(cid:28)νi=λiνi.(8.15)Thematrixappearingontheleftofthisequality(denotedbyHinwhatfollows)iscalledtheHamiltonianmatrix,andequation(8.15)expressesthefactthatνiisaneigenvectorofHassociatedwiththeeigenvalueλi.(ii)Letσbeapermutationof{1,...,n},ησ=(cid:25)ησ(1)...ησ(n)(cid:26),ξσ=(cid:25)ξσ(1)...ξσ(n)(cid:26),andPσ=ησξ−1σ;andwehaveP=Pσ.PROOF.(i)Foranyi∈{1,...,n},wehaveλiξi=(cid:15)Aα−BBTP(cid:16)ξi=Aαξi−BBTηi.(1)IfPisasolutionofthealgebraicequation(8.14),thenforanyStateFeedback227i∈{1,...,n}wehaveλiηi=P(cid:15)Aα−BBTP(cid:16)ξi=−ATαPξi=−ATαηi,andhenceequation(8.15)issatisﬁed.(2)Conversely,ifforalli∈{1,...,n},theequality(8.15)issatisﬁed,wehaveAαξi−BBTPξi=λiξiand−ATαηi=λiηiwithηi=Pξi,fromwhichweget(cid:15)PAα+ATαP−PBBTP(cid:16)ξi=0.Asaresult,Pisasolutionof(8.14).(ii)Thepermutationσcorrespondstoaright-multiplicationofηandξbyapermutationmatrixΠ,i.e.ησ=ηΠandξσ=ξΠ.Therefore,Pσ=(ηΠ)(ξΠ)−1=P.Thefollowingresultisclassicandisproved,forexample,in([64],A.41)and([119],section12.4).LEMMA237.–LetZ∈Rn×nbeasymmetricnon-negativedeﬁnitematrix(i.e.Z≥0)2andletF∈Rn×nbeastabilitymatrix(Deﬁnition182,section7.3).Then,theLyapunovequationFTP+PF=−ZhasauniquesolutionP∈Rn×n,andP≥0.If,inaddition,(cid:9)√Z,F(cid:10)isobservable3,thenP>0.THEOREM238.–(i)IfλisaneigenvalueofH,sois−λ.(ii)Let{νi,1≤i≤n}beasetoflinearlyindependenteigenvectorsofH,letηiandξi(1≤i≤n)bethevectorsdeﬁnedbyequation(8.13),andletηandξbethematricesdeﬁnedbyequation(8.12);ifξisinvertible,Pdeﬁnedby(8.11)isasolutionofthealgebraicRiccatiequation(8.14).(iii)Ofthefollowingconditions,((a)&(b))⇔(c):(a)(Aα,B)isstabilizable;(b)Hhasnoimaginaryeigenvalues;(c)amongthematricesPdeﬁnedbyequation(8.11),thereexistsamatrixˇPforwhichAα−BK(withKgivenbyequation(8.10))isastabilitymatrix.(iv)WhenCondition(c)holds,thematrixˇPisuniqueandissymmetricrealnon-negativedeﬁnite;itisthematrixPobtainedwhentheλis(1≤i≤n)aretheeigenvaluesˇλiofHbelongingtothelefthalf-plane.(v)Let{π1,...,πn}bethepolesofΣ.Thepolesoftheclosed-loopsystemwiththestatefeedbackcontrol(8.3)(whereK=−BTˇP)are(cid:31)ˇλ1,...,ˇλn suchthatˇλi=(cid:20)πiifRe(πi)<−α,−πi−2αifRe(πi)>−α.(8.16)PROOF.(i)IsobvioussincetheeigenvaluesofHarethoseofAαplusthoseof−Aα.(ii)IsareformulationofLemma236.(iii)and(iv)Accordingto(i),ifHhas2.ForasquarematrixZwithrealentries,thesymbolZ≥0(resp.,Z>0)signiﬁesthatZissymmetricnon-negativedeﬁnite(resp.,symmetricpositivedeﬁnite):seeDeﬁnition575(section13.5.6).ThesameholdswhenZhascomplexentries,changingsymmetrictoHermitian.3.√ZistheHermitian(realsymmetricinthepresentcase)squarerootofZ(seesection13.5.6).ButanysquarerootofZcanbeused.228LinearSystemsnoimaginaryeigenvalues,thismatrixhasneigenvaluesbelongingtothelefthalf-planeandneigenvaluesbelongingtotherighthalf-plane.If,inaddition,(Aα,B)isstabilizable,thereexistsauniquematrixP=ˇPoftheform(8.11)forwhichAα−BKisastabilitymatrix:see([69],Theorem1)wheretheconverseisalsoproved.Accordingtoequation(8.14),wehaveˇP(Aα−BK)+(Aα−BK)TˇP=−ZwithZ=ˇPBBTˇP≥0.Asaresult,accordingtoLemma237,ˇP≥0.(v)TheeigenvaluesofHareπi+αand−πi−α,andhencetheeigenvaluesofAα−BKareπi+αifRe(πi)<−αand−πi−αifRe(πi)>−α.ItremainsnowtosubtractαinordertoobtaintheeigenvaluesofA−BK.EXAMPLE239.–ConsiderthesamesystemasinExample233.Bytakingα=2,thepolesofthefeedbacksystemplacedaccordingtotheabovemethodare{−3,−3,−5},whichareexactlythepoleschosenintheexampleconsidered.Wecanalsochooseα=1;although,inthiscase,theHamiltonianmatrixHhaseigenvaluesattheorigin,thestatefeedbackwithgainmatrix(8.10)andPgivenbyequation(8.11)arewell-deﬁned,andthepolesarethenplacedat{−1,−1,−3}.Thesearevaluesthatsatisfy(8.16).Theinterestinallpreviousdevelopmentcanbefoundinthetheorembelow.THEOREM240.–LettherebethestatefeedbackinTheorem238(iv).Ifα≥0,theinputmodulusmarginisMmi=1.PROOF.LetL(s)=K(sIn−A)B,Lα(s)=L(s−α)=K(sIn−Aα)B,andΦα(s)=(sIn−Aα)−1.Usethefollowingnotation:(.)∼(s)=(.)T(−s)wheretheterminparenthesesisanytransfermatrix.Andﬁnally,letP=ˇP.Bymultiplyingequation(8.14)by−1,thensubtractingsPto−AαPintheobtainedequation,thenaddingontotheterm−ATαPthesamequantity,andlastmultiplyingthenewlyobtainedequationontheleftbyBTΦ∼α(s)andbyΦα(s)Bontheright,weobtain:(Im+Lα)∼(Im+Lα)=Im;(8.17)asaresult,supRe(s)≥0¯σ(cid:9)(Im+Lα(s))−1(cid:10)≤1StateFeedback229sincethepolesofthetransfermatrix(Im+Lα(s))−1are(cid:31)ˇλ1,...,ˇλn ,whichbelongtothelefthalf-plane.Wehave,ontheotherhand,sinceSi=(Im+L)−1,(cid:23)Si(cid:23)∞=supRe(s)≥0¯σ(cid:9)(Im+L(s))−1(cid:10)=supRe(s)≥−α¯σ(cid:9)(Im+Lα(s))−1(cid:10),andhenceifα≥0,(cid:23)Si(cid:23)∞≤supRe(s)≥0¯σ(cid:9)(Im+Lα(s))−1(cid:10)≤1.Sincelim|s|→+∞Si(s)=Im,wehave(cid:23)Si(cid:23)∞=1,andthereforeMmi=1.DEFINITION241.–The(α)methodconsistsofdeterminingthegainmatrixKofthestatefeedbackaccordingtoequation(8.10)withP=ˇP,forarealnumberα≥0suchthat(i)(Aα,B)isstabilizable,(ii)Aα(or,inanequivalentmanner,H)hasnoimaginaryeigenvaluesifα=0,(iii)ξisinvertible(thislastconditionisalwayssatisﬁedifHhasnoimaginaryeigenvalues).EXAMPLE242.–ContinuingfromExample239,weobtainˇP=⎡⎣9.916.13.928.511.213.8⎤⎦,K=(cid:27)3.73.6−3.36.212.57.2(cid:28),withˇP=ˇPT.ThesingularvaluesofthesensitivityfunctionSiareplottedinFigure8.7asafunctionoftheangularfrequencyω.ThisﬁgureillustrateswellthefactthatMmi=1.REMARK243.–(i)The(α)methodiscloselyrelatedtothe“linearquadraticoptimalcontrol”(seeRemark245(ii)below).Thisisnevertheless,intheformulationproposedhere,amethodofpoleplacement.(ii)InthecaseofanSISOsystem,Theorem240doesnotcontradictequality(4.17)ofsection4.2.8becausetherelativedegreeoftheopen-looptransferfunctionL(s)isequalto1.Ontheotherhand,accordingtoequality(4.18)oftheabove-mentionedparagraph,allzerosofL(s)belongtotheclosedlefthalf-plane.ThisremarkremainsvalidinthecaseofanMIMOsystem(seesection4.2.9).Extensionofthe(α)method:theLQRmethodThe“(α)method”isaparticularcaseofthe“LQRmethod”,4thealgebraiccharacteristicsofwhichwewillnowdescribe,withoutinsistingonthe“optimal4.LQRstandsfor“LinearQuadraticRegulator”;seeRemark245below.ThisregulatorcorrespondstotheLQcontrol(alreadymentionedinthepreface).230LinearSystemscontrol”aspect(inaccordancewithwhatissaidinthepreface).Supposethat(Aα,B)isstabilizableandlettherebeastatefeedbackwithgainmatrixKgivenbyK=R−1BTP(8.18)whereR∈Rm×m,R>0andwherePisarealsymmetricmatrix;theexpression(8.18)isageneralizationofequation(8.10).ConsideralsothealgebraicRiccatiequationPAα+ATαP−PBR−1BTP+Q=0(8.19)(Q∈Rn×n,Q≥0),whichisageneralizationofequation(8.14).Andﬁnally,considertheHamiltonianmatrixH=(cid:27)Aα−BR−1BT−Q−ATα(cid:28).(8.20)LetEbeasquarerootofQ(section13.5.6),i.e.amatrixsuchthatQ=ETE.THEOREM244.–(i)Parts(i)-(iv)ofthestatementofTheorem238remainvalid(theνis,1≤i≤n,arethegeneralizedeigenvaluesofHifthismatrixisnotdiagonalizable:seeRemarks235(section8.1.4)and531(section13.3.4))whentheexpressions(8.10)and(8.14)arereplaced,respectively,byequations(8.18)and(8.19)andHisdeﬁnedbyequation(8.20).(ii)SupposefromnowonthatCondition(a)ofTheorem238holds.InorderthatCondition(b)ofthissametheorembesatisﬁed(forCondition(c)tohold),itsufﬁcesthatthefollowingcondition(d)besatisﬁed:(d)(E,Aα)isdetectable.(iii)Inthiscase,thereexistsauniquesolutiontothealgebraicRiccatiequation(8.19)forwhichAα−BKisastabilitymatrixanditistheabovematrixˇP;ˇPisalsotheuniquenon-negativedeﬁnitesolutiontoequation(8.19).(iv)Ifinaddition(E,Aα)isobservable,thenˇP>0.PROOF.(i)isaneasygeneralizationofthecorrespondingpartsofthediscussionofTheorem238(seeExercise268).For(ii),see([119],section12.3)and([72],section3.4.3).(iii)isaconsequenceofLemma237.REMARK245.–(i)Condition(d)isnotnecessaryfortheexistenceofˇP,andthatiswhythe(α)methodappliestounstablesystems(seeExample242).Condition(d)isonlynecessaryfortheuniquenessinTheorem244(iv)([69],Theorem2).(ii)Conditions(a)and(d)arenecessaryandsufﬁcientforthecontrolu=−Kx(withKsatisfyingequation(8.18)andP=ˇP)tominimizethequadraticcriterionJα=(cid:2)+∞0e2αt(cid:15)xT(t)Qx(t)+uT(t)Ru(t)(cid:16)dtStateFeedback231([72],[2]).ThematricesQandRcanbeinterpretedasweightingmatrices,allowingweightingatvariouslevelsofcertainR-linearcombinationsofthestatevariablesandofthecontrolvariables(themoresuchalinearcombinationisweighted,thesmalleritsvariationswillbeovertime).Supposefromnowonthatα≥0andConditions(a)and(b)ofTheorem238hold.Lettherebethestatefeedback(8.18)withP=ˇP.UsingthesamenotationasintheproofofTheorem240,weobtain(byanidenticalapproach)thegeneralizationbelowofequality(8.17),ageneralizationwhichiscalledtheKalmanequality:[Im+Lα(s)]∼R[Im+Lα(s)]=R+BTΦ∼α(s)QΦα(s)B.(8.21)Lets=iω;wehaveBTΦ∼α(iω)QΦα(iω)B≥0,andasaresult¯σ(cid:9)√R(Im+Lα(iω))−1√R−1(cid:10)≤1,∀ω.WededucethefollowinggeneralizationofTheorem240(whichcorrespondstothecaseQ=0andR=Im):THEOREM246.–Withthestatefeedbackdeﬁnedaboveand,foranyα≥0,wehave(cid:29)(cid:29)(cid:29)√RSi√R−1(cid:29)(cid:29)(cid:29)∞=1.Inparticular,ifR=Im,ormoregenerally,ifRisascalarmatrix,5wehaveMmi=1.ThequestionthatremainstobeexaminedisthenatureofthepoleplacementcarriedoutusingtheLQRmethod.Inordertodoso,thematrixRisreplacedinwhatfollowsbyρR,whereρ>0isarealnumber.LetG(s)=EΦ(s)B,Φ(s)=(sIn−A)−1;whereG(s)isthetransfermatrixofthestate-spacesystem{A,B,E}.Also,lettherebethefollowinghypothesis(H):(H):G(s)∈R(s)m×m,rkR(s)G(s)=mandthestate-spacesystem{A,B,E}isminimal.THEOREM247.–(i)Let{π1,...,πn}bethepolesofΣ(countingmultiplicities).Asρ→+∞,thepolesˇλk(1≤k≤n)oftheclosed-loopsystemtendto(cid:20)πkifRe(πk)≤−α,−πk−2αifRe(πk)>−α.5.A“scalarmatrix”R∈Rm×misoftheformrIm,wherer∈R.Suchamatrixisobviously>0ifandonlyif,r>0.NotethatifRisascalarmatrix,wecomebacktothecaseR=ImbyreplacingPbyP/randQbyQ/rinequation(8.19).232LinearSystems(ii)SupposethatHypothesis(H)isinforce.Let{ν1,...,νq}betheMacMillanzerosofG(s)(countingmultiplicities).Asρ→0+,qpolesˇλk(1≤k≤q)oftheclosed-loopsystemtendto(cid:20)νkifRe(νk)≤−α,−νk−2αifRe(νk)>−α.Theremainingn−qpolesˇλk+q(1≤k≤n−q)areunboundedandwhenm=1,ˇλk+q∼sk,wheresk=ei(12+−1+2k2(n−q))π(cid:21)β2ρ(cid:22)12(n−q),β(cid:5)=0.(8.22)PROOF.Leta(s)=|sIn−A|andf(s)=|sIn−A+BK|(therootsofa(s)andoff(s)arethepolesoftheopen-loopsystemandoftheclosed-loopsystem,respectively).Weobtain,byconsideringthedeterminantofthetwomembersofequation(8.21)andbyputtingℵα(s)=ℵ(s−α)foranymatrixℵofrationalfunctionsf∼αfα=a∼αaαdet(cid:21)Im+1ρ√R−1G∼αGα√R−1(cid:22).(8.23)LetM=√R−1G∼αGα√R−1andr=rkR(s)G(s)≤m.WehavefromLemma519(section13.3.3)det(ρIm+M(s))=ρm+r(cid:12)k=1∆k(s)ρm−kwhere∆k(s)isthesumoftheprincipalminorsoforderkofM(s).Therefore,f∼α(s)fα(s)=a∼α(s)aα(s)*1+r(cid:12)k=1∆k(s)ρ−k+.(8.24)(i)ρ→+∞.Then,wegetf∼αfα→a∼αaα,f(s)beingapolynomial,allrootsofwhichbelongtotheclosedlefthalf-plane.WenowonlyneedtoapplythesamerationaleasintheproofofTheorem238(iii).(ii)ρ→0+.(a)Letς(s)betheuniquemonicpolynomial,therootsofwhicharethetransmissionzerosof{A,B,E},andletq=degς(s)<n.ConsideringtheSmith–MacMillanformofG(s)(section2.4.5),wegetG(s)=U−1(s)(s)Ψ−1(s)V(s),wherethepolynomialmatricesU(s)andV(s)areinvertibleoverR[s].SupposingHypothesis(H)isinforce,wehaver=mand(s)=diag(ε1(s),...,εm(s)),Ψ(s)=diag(ψ1(s),...,ψm(s)),ς(s)=det(s)=’mi=1εi(s),a(s)=detΨ(s)=’mi=1ψi(s),∆m(s)=detM=β2detRς∼αςαa∼αaα,StateFeedback233whereβ=detU−1(s)detV(s).Asaresult,fromequation(8.24),f∼α(s)fα(s)=1ρm(cid:27)β2detRς∼α(s)ςα(s)+......+a∼α(s)aα(s)*ρm+m−1(cid:12)k=1∆k(s)ρm−k+$.(8.25)(b)LetKbeacompactsubsetofthecomplexplane,whichdoesnotcontainanyMacMillanpoleofG∼αGα,andtheinteriorofwhichcontainsallrootsofς∼α(s)ςα(s).The∆k(s)areboundedonK,andhencetherootsoff∼α(s)fα(s)remaininginKconvergetotherootsofς∼α(s)ςα(s)asρ→0+.(c)n−qrootsoff(s)areunboundedasρ→0+,accordingtotheabove.Inthecasem=1,wecanassumewithoutlossofgeneralitythatR=1andtheexpression(8.25)becomesf∼α(s)fα(s)=1ρ(cid:15)β2ς∼α(s)ςα(s)+ρa∼α(s)aα(s)(cid:16).(8.26)Sincea(s)isamonicpolynomialofdegreen,wehavea∼α(s)aα(s)=(−1)ns2n+s2nω1(1/s)(8.27)whereω1(1/s)tendsto0andsodoes1/s.Thesamerationaleisvalidforς(s),andhenceς∼α(s)ςα(s)=(−1)qs2q+s2qω2(1/s)(8.28)whereω2(1/s)tendsto0andsodoes1/s.Accordingtoequations(8.26),(8.27),and(8.28),therootswearelookingforasymptoticallysatisfy(−1)ns2n+β2ρ(−1)qs2q=0.Therootsofthisequationwhichbelongtotheclosedlefthalf-planearethesksdeﬁnedbyequation(8.22).REMARK248.–(i)Theconﬁgurationoftherootssk,well-knowninthetheoryofﬁlters,iscalledtheButterworthconﬁgurationofordern−q:therootssk(1≤k≤n−q)areequallydistributedinthecomplexplaneonacirclecenteredattheorigin,andhaveargument(cid:9)12+−1+2k2(n−q)(cid:10)π.(ii)Form>1andunderHypothesis(H),thenumberofpolesofthefeedbacksystemhavingabsolutevaluetendingto+∞isstillequalton−q,i.e.tothedegreeofzeroatinﬁnityofG(s)sincethedefectofthetransfermatrixG(s)iszero(seeRemark40,section2.4.7).Thesen−qpoleshavegenerallyamorecomplexbehaviorthaninthecasem=1;theirasymptoticdirectionscanbedistributedaccordingtoacombinationofseveralButterworthconﬁgurationsofdifferentorders:see([72],section3.8,Example3.19).234LinearSystemsFigure8.2.BodeplotofthesensitivityfunctionFigure8.3.BodeplotofLi(s)StateFeedback235Figure8.4.NyquistplotofLi(s)Figure8.5.SingularvaluesofSi(s)–method1236LinearSystemsFigure8.6.SingularvaluesofSi(s)–method2Figure8.7.SingularvaluesofSiStateFeedback237REMARK249.–(i)SupposeHypothesis(H)isreplacedbythefollowinghypothesis(H(cid:2)),whichislessrestrictive:G(s)∈Rr×m,rkR(s)G(s)=r(r≤m),andthestate-spacesystem{A,B,E}isminimal.Then,accordingtoequation(8.24),therootsoff∼α(s)fα(s)thatremainboundedconverge(asρ→0+)totherootsofthepolynomiala∼α(s)aα(s)∆r(s).(ii)Lettherebethestate-spacesystem{A,B,E},withtransfermatrixG(s),andsupposethattheabovehypothesis(H)issatisﬁedaswellasthefollowingcondition:{A,B,E}doesnothavetransmissionzerosintheclosedrighthalf-plane(inotherwords,{A,B,E}isminimumphase:seeRemark68).LetalsoPρbetheunique≥0solutionofthealgebraicRiccatiequation(8.19)forα=0andRreplacedbyρR,ρ>0.Itisshownin([72],section3.8.3)thatPρ→0asρ→0+.8.2.Statefeedbackwithintegralaction8.2.1.InsufﬁciencyofstatefeedbackConsidertheelementaryexampleofa2nd-ordersystemhavingnozerosanddescribedbytheleftform(cid:15)∂2+a1∂+a2(cid:16)y=b2u(b2(cid:5)=0).Wecanputthissysteminstate-spaceformbysettingx=(cid:25)˙yy(cid:26)T.Astate-feedbackcontrolu=v−Kx,whereK=(cid:25)k1k2(cid:26),canbewrittenasu=v−k1˙y−k2y.Itisacontroloftheproportionalandderivativekind,inwhichanintegralactionismissingandthereforeazerostaticerrorcannotbeguaranteed.Whatfollowsaimsremedyingsuchaﬂaw.8.2.2.FeedbackcontrolinthepresenceofdisturbancesLettherebethesystem(cid:20)˙x=Ax+Bu+d1,y=Cx+d2,(8.29)wherex(t)∈Rn,u(t)∈Rm,y(t)∈Rp,d1∈Rn,andd2∈Rp,whered1andd2areconstantdisturbances(analgebraicmannerofexpressingthatthesearesignals,thewholespectrumofwhichliesinthelowfrequencies).Thesedisturbancesaresupposedtobeunmeasuredandunknown.238LinearSystemsOntheotherhand,theconstantreferencesignalr∈Rpisassumedtobeknown.Thestatexandtheoutputyaresupposedtobemeasuredateachinstant.Letebetheregulationerrordeﬁnedbye=y−r.(8.30)TheobjectiveofwhatfollowsistodesignacontrollawforwhichProperty(P)belowissatisﬁed:–limt→+∞e(t)=0,–limt→+∞x(t)=const.,–limt→+∞u(t)=const.,∀d1∈Rn,d2∈Rp,bothofthemunknown,∀r∈Rpknown,andwithanyinitialconditions.Thehypothesesimposedonthestate-spacesystem{A,B,C}arethefollowing:(cid:127)(H1)(A,B)iscontrollable;(cid:127)(H2)thetransfermatrixG(s)ofthesystem{A,B,C}issemiregularoverR(s)(seesection13.1.4).8.2.3.ResolutionofthestaticproblemThe“staticproblem”canbestatedinthefollowingmanner:Doesthereexist(foranyconstantdisturbancesd1andd2andanyconstantreferencesignalr)anequilibriumstatexeandanequilibriumcontrolueforwhichtheregulationerroriszero?Thistranslatesintotheequations(cid:20)0=Axe+Bue+d1r=Cxe+d2whichareequivalentto(cid:27)−A−BC0(cid:28)(cid:27)xeue(cid:28)=(cid:27)d1r−d2(cid:28).(8.31)Theright-handsideofthisequationisanyvectorinRn+p;asaresult,thestaticproblemadmitsasolutionifandonlyif,thematrixontheleftoftheaboveequalityisofrankn+p.Thisconditioncanbewrittenintheformrk(cid:27)sIn−A−BC0(cid:28)s=0=n+pStateFeedback239inawaythatrevealstheRosenbrockmatrixR(s)of{A,B,C}.FromHypothesis(H2)andProposition163(section7.2.1),therankρ(R)ofR(s)overR(s)isn+min(p,m).Finally,accordingtoTheorem161(section7.2.1),weobtainthefollowingresult:PROPOSITION250.–Thestaticproblemadmitsasolutionifandonlyif,thefollowingtwoconditionshold:(i)m≥p;(ii)s=0isnotaninvariantzeroof{A,B,C}.REMARK251.–TakingintoaccountHypothesis(H2),Condition(i)ofProposition250expressesthefactthatthereareatleastasmanylinearlyindependentcontrolsaslinearlyindependentregulatedoutputs.Thisisthusamatterofnumberofdegreesoffreedom.Condition(ii)expressesthefactthatonecannotforcetheoutputofaderivatorsystemtobeanarbitraryconstant.ItissimilartothenecessaryandsufﬁcientconditionsexpressedbyProposition109(section6.3.4).8.2.4.ResolutionofthedynamicproblemBydifferentiatingequations(8.29)and(8.30),andbyputtingχ=(cid:27)∂xe(cid:28),υ=∂u(8.32)weobtainthestate-spacesystem˙χ=Fχ+Gυ,(8.33)F=(cid:27)A0C0(cid:28),G=(cid:27)B0(cid:28).AccordingtoTheorem230(ii),thereexistsastatefeedbackυ=−Kχ(8.34)forwhichtheclosed-loopsystemisstableifandonlyif,(F,G)isstabilizable.LEMMA252.–Lettherebethecontrol(8.34).Property(P)insection8.2.2issatisﬁedifandonlyif,F−GKisastabilitymatrix.PROOF.Letχ0=χ(0).Wehaveforeveryt≥0χ(t)=e(F−GK)tχ0.Property(P)isthussatisﬁedifandonlyif,F−GKisastabilitymatrix.240LinearSystemsPROPOSITION253.–(F,G)isstabilizableifandonlyif,Conditions(i)and(ii)inProposition250bothhold.Inthatcase,(F,G)iscontrollable.PROOF.AccordingtoProposition186(section7.3),(F,G)isstabilizableifandonlyif,rk(cid:25)sIn+p−FG(cid:26)=n+p,∀s∈¯C+.Noticethat(cid:25)sIn+p−FG(cid:26)=(cid:27)sIn−A0BCsIp0(cid:28)∼(cid:27)sIn−A−B0C0sIp(cid:28).(i)Fors(cid:5)=0,therankofthematrixontherightisequaltop+rk(cid:25)sIn−AB(cid:26)=p+nsince(A,B)iscontrollable.(ii)Fors=0,therankofthissamematrixisequaltotherank,forthissamevalueofs,oftheRosenbrockmatrixof{A,B,C},arankwhichisthesubjectofProposition250.IfConditions(i)and(ii)ofthispropositionbothhold,wehaverk(cid:25)sIn+p−FG(cid:26)=n+p,∀s∈C,and(F,G)isthereforecontrollable.Therefore,wecanassumethatConditions(i)and(ii)ofProposition250aresatisﬁed.Theorem230showsthatonecanchoosethecontrol(8.34)insuchamannerastoarbitrarilyassigntheeigenvaluesofF−GKinthelefthalf-plane(obeyingthesymmetrypropertywithrespecttotherealaxisinthecaseofimaginaryeigenvalues).WeputK=(cid:25)KpKi(cid:26)whereKp∈Rm×nandKi∈Rm×p.Takingintoaccountequation(8.32),equation(8.34)canbewrittenas∂u=−Kp∂x−Kie,andbyintegratingthisexpression,weobtainu(t)=−Kpx(t)−Ki(cid:2)e(t)dt+const.(8.35)Thediagramofthiscontrollaw,calledstatefeedbackwithintegralaction,isshowninFigure8.8.REMARK254.–(i)Property(P)isstillsatisﬁedeveninthepresenceofmodelingerrorsand,moreprecisely,ifthematricesA,B,andCofthesystemarereplacedbyA+∆A,B+∆B,andC+∆C,respectively,where∆A,∆B,and∆CareerrorssuchthatF+∆F−(G+∆G)K(where∆Fand∆GaretheadditiveerrorsonFandG,respectively,resultingfromtheadditiveerrors∆A,∆B,and∆ConA,StateFeedback241r-+-    Control  system .KiKpuy+Figure8.8.StatefeedbackwithintegralactionB,andC)remainsastabilitymatrix.(ii)Supposesystem{A,B,C}iswell-formed.Ifm>p,thereareseveralsolutionstothestaticproblem(8.31).Asaresult,evenwithzerodisturbancesd1andd2andaﬁxedreferencer,theequilibriumstatexeandcontroluearenotcontinuousfunctionsofA,B,andC.Verysmallerrors∆A,∆B,and∆Ccaninduceaveryimportantchangetotheseequilibriumvaluesand,consequently,canleadtosuchachangeinthebehaviorofthefeedbacksystem.Thisistobeavoidedanditisthuspreferable,evenindispensable,inpractice,toimposethat{A,B,C}bewell-formedandm=p[92].EXAMPLE255.–Forthesecondordersystemofsection8.2.1,thecontrol(8.35)canbeputintheformu(t)=−Kp1˙y(t)−Kp2y(t)−Ki(cid:2)e(t)dt+const.andweobtainthetraditionalPIDcontroller.EXAMPLE256.–Lettherebethestate-spacesystemΣ={A,B,C}deﬁnedinExample195(section7.4.3)andagainconsideredinExamples233,239,and242ofsection8.1.4.Thissystemhasatransmissionzeroats=0(sincerkG(0)=1),andhencetheabovecontrolisnotapplicable.EXAMPLE257.–Considerthestate-spacesystemΣ={A,B,C}withA=⎡⎢⎢⎣−4−300100000−6−80010⎤⎥⎥⎦,B=⎡⎢⎢⎣10000100⎤⎥⎥⎦,C=(cid:27)13141112(cid:28)242LinearSystemsFigure8.9.StepresponsesofthefeedbacksystemwhichisaminimalrealizationincontrollablecanonicalformofthetransfermatrixofExercise217(Section7.6).Conditions(i)and(ii)ofProposition250arebothsatisﬁed.TheeigenvaluesofAare{−4,−3,−2,−1}.Applythe(α)methodofsection8.1.4tothesystem(8.33).Withα=3/2,weobtainKp=(cid:27)4360180−243−6(cid:28),Ki=(cid:27)18−36−1236(cid:28)andtheeigenvaluesofF−GKare{−4,−3,−3,−3,−2,−2}.Thestepresponsesoftheclosed-loopsystemandthecorrespondingcontrolsarerepresentedinFigures8.9and8.10–seebelow.Thecurvesontheleft(resp.,ontheright)arethevariationsofy1andy2(forFigure8.9)andofu1andu2(forFigure8.10)whenr1isaunitstepandr2=0(resp.,whenr1=0andr2isaunitstep).Weobservenotonlythatthestaticerroriszero,whichisinlinewiththetheory,butalsoanabsenceofovershootandagooddecouplingbetweenthetwooutputs(eventhoughΣisheavilycoupled).NowitremainstoverifythatwhenthegainmatrixKisdeterminedasinExample257,theinputmodulusmarginofΣisgood(and,ifpossible,equalto1).Theinputsensitivityfunction˜Siofthesystem(8.33)fedbackbythecontrol(8.34)issuchthat(cid:29)(cid:29)(cid:29)˜Si(cid:29)(cid:29)(cid:29)∞=1,accordingtoTheorem240,sinceα≥0.THEOREM258.–LetΣbefedbythecontrol(8.35).AssumethatthegainmatrixK=(cid:25)KpKi(cid:26)ischosenaccordingtothe(α)method(or,moregenerally,theLQRmethod)insection8.1.4appliedtosystem(8.33)withα≥0.Then,theinputsensitivityfunctionSiissuchthat(cid:23)Si(cid:23)∞=1.StateFeedback243Figure8.10.CorrespondingcontrolsPROOF.WehaveSi=(Im+Li)−1withLi(s)=(cid:15)Kp+1sKiC(cid:16)(sIn−A)−1B.Ontheotherhand,˜Si=(cid:9)Im+˜Li(cid:10)−1withLi(s)=(cid:25)KpKi(cid:26)(cid:27)sIn−A0−CsIp(cid:28)−1(cid:27)B0(cid:28).Accordingtoequation(13.9)(section13.1.4),wehave(cid:27)sIn−A0−CsIp(cid:28)−1=(cid:27)(sIn−A)−10(1/s)C(sIn−A)−1(1/s)Ip(cid:28),andhenceLi=˜Li.ThusSi=˜Si.EXAMPLE259.–(Example257continued).ThesingularvaluesofthesensitivityfunctionSiandthoseofLiareplottedinFigures8.11and8.12,respectively,asafunctionofangularfrequencyω.Wenotethat(cid:23)Si(cid:23)∞=1inaccordancewithwhatwasconﬁrmedinTheorem258,andthattheloopshapingofthesingularvaluesofLi(iω)issimilartothatinFigure4.15ofsection4.2.9.Thebalancingofthesingularvaluesintheneighborhoodof0dBiscorrect.8.3.*Internalmodelprinciple8.3.1.ProblemsettingWeconsideragainsystemΣdeﬁnedbyequation(8.29)andtheerroredeﬁnedbyequation(8.30),butinamoregeneralcontext.Wealsoconsiderthedisturbancesdi244LinearSystemsFigure8.11.SingularvaluesofSiFigure8.12.SingularvaluesofLiStateFeedback245(i=1,2)aswellasthereferencesignalrwhicharetorsionelementsovertheringR[∂](seesection13.4.1).ThesetofallannihilatingdifferentialpolynomialsofthesedisturbancesandofthisreferencesignalisanidealIofR[∂];theidealIisprincipalandgeneratedbyauniquemonicpolynomialdenotedbyD(∂).6Thesituationconsideredinsection8.2isaspecialcaseofthis,obtainedwithD(∂)=∂.Ontheotherhand,thispolynomialD(∂)correspondstowhatisconsideredinsection6.4.Itisassumedthatallitsrootslieontheimaginaryaxis(seesection6.4.3,Hypothesis116),andthattheserootsaresimple(thelatterconditionmakesitpossibletosimplifytheproblemsetting:seethelastparagraphofsection6.4.3).WehavethusbyhypothesisD(∂)di=0(i=1,2),D(∂)r=0.(8.36)Also,Hypotheses(H1)and(H2)ofsection8.2.2areinforce.Theobjectiveofwhatfollowsistodesignacontrollawforwhichthefollowingproperty(P’)issatisﬁed:–limt→+∞e(t)=0,–xisbounded,–uisbounded,foranydisturbancesdi(i=1,2)andanyreferencesignalrsatisfyingequation(8.36).8.3.2.SolutionLeft-multiplying(8.29)byD(∂),weobtain,puttingη=D(∂)x,ς=D(∂)e,andυ=D(∂)u,(cid:20)˙η=Aη+Bυ,ς=Cη.Wehavee=D(∂)−1Ipς.Let{A1,B1,C1}beaminimalrealizationofD(s)−1.Then,aminimalrealizationofD(s)−1Ipis{Aε,Bε,Cε}withAε=,1≤i≤pAi,Bε=,1≤i≤pBiCε=,1≤i≤pCi6.ThispolynomialD(∂)shouldnotbeconfusedwiththedirecttermmatrixDofthestate-spacesystem.246LinearSystemswhereAi=A1,Bi=B1,andCi=C1foranyi∈{1,...,p}andwhere⊕denotesthediagonalsum(seesection13.1.4).Thetrackingerroreistheoutputofsystem{Aε,Bε,Cε}withinputς.Denotingbyηεthestateofthatsystem,wehave(cid:20)˙ηε=Aεηε+Bες,e=Cεηε.Nowletχ=(cid:27)ηηε(cid:28).Then,equation(8.33)issatisﬁed,aswellastheoutputequatione=HχwithF=(cid:27)A0BεCAε(cid:28),G=(cid:27)B0(cid:28),H=(cid:25)0Cε(cid:26).Thefollowingresultcanbeeasilyproved:LEMMA260.–ThestatementofLemma252isstillvalidinthepresentcontext,replacing(P)by(P(cid:2)).Proposition253(section8.2.4)canbegeneralizedasfollows:PROPOSITION261.–Thepair(F,G)isstabilizableif,andonlyif,thefollowingtwoconditionshold:(i)m≥p;(ii){A,B,C}hasnoinvariantzerosthatarerootsofD(s).Then,(F,G)iscontrollable.PROOF.Letq=d◦(D).AccordingtoProposition186(section7.3),(F,G)isstabilizableif,andonlyif,foranys∈¯C+,rkC(cid:25)sIn+pq−FG(cid:26)=n+pq.(8.37)LetV(s)=(cid:25)sIn+pq−FG(cid:26).(1)IfsisnotaneigenvalueofAd(i.e.notarootofD(s)),weimmediatelyseethatCondition(8.37)holds,duetothefactthat(A,B)iscontrollable.(2)SupposenowthatsisaneigenvalueofAd.WehaveV(s)=V1(s)V2(s)withV1(s)=(cid:27)In000−BεsIpq−Aε(cid:28),V2(s)=⎡⎣sIn−A0BC000Ipq0⎤⎦.StateFeedback247Inaddition,rkCV1(s)=n+pqbecause(Aε,Bε)iscontrollable.Ontheotherhand,rkCV2(s)=pq+rkC(cid:27)sIn−A−BC0(cid:28).AccordingtoHypothesis(H2)andProposition163(section7.2.1),rkR(s)(cid:27)sIn−A−BC0(cid:28)=n+min{m,p},andhencerkCV2(s)≤pq+n+min{m,p},withequalityifandonlyif,sisnotaninvariantzeroof{A,B,C}.AccordingtotheSylvesterinequality(13.7)(section13.1.4),wehaverkCV(s)≥rkCV1(s)+rkCV2(s)−(n+p+pq).Therefore,thequantityontheright-handsideofthisinequalityisequalton+pqifandonlyif,Conditions(i)and(ii)statedaresatisﬁed.Inthiscase,wehaverkC(cid:25)sIn+pq−FG(cid:26)=n+pqforalls∈C.AssumingthatConditions(i)and(ii)ofProposition261hold,wecanthusstabilize(8.33)byafeedbackoftheform(8.34),i.e.υ=−(cid:25)KpKε(cid:26)(cid:27)ηηε(cid:28).(8.38)Thisexpressioncanbefurtherdevelopedinthefollowingmanner:D(∂)u=−KpD(∂)x−Kεηε.Letxε=D(∂)−1Imηε.Accordingtothepreviousdiscussion,weobtaintheexpressionofthe“statefeedbackwithinternalmodel”controller˙xε=Aεxε+Bεe,(8.39)u=−Kpx−Kεxε.(8.40)The“internalmodel”isthesystem(8.39):itisamodelofthedisturbancesandofthereferencesignal,duplicatedptimes,andhavingthetrackingerroreasinput.REMARK262.–(i)ThestatexdisonlydeﬁneduptoatermannihilatedbyD(∂)andthesameistrueforthecontrolu.(ii)Thecontrol(8.40)istheexactgeneralizationofequation(8.35)(wheretheonlytermjustasmentionedaboveisaconstantofintegration).(iii)ThediagramobtainedforthecontrollawisidenticaltothatinFigure8.8,withtheonlydifferencethattheintegratorneedstobereplacedbytheinternalmodel.(iv)Remark254remainsvalid.(v)ThestatementofTheorem258remainsvalidinthemoregeneralcontextthatisconsideredhere.248LinearSystems8.4.ExercisesEXERCISE263.–Showthattheinvariantzerosofastate-spacesystem{A,B,C,D}areinvariantunderstatefeedback.EXERCISE264.–Lettherebeastate-spacesystemΣ={A,B,C}withA=(cid:27)021−1(cid:28),B=(cid:27)1−2(cid:28),C=(cid:25)21(cid:26).(i)StudycontrollabilityandobservabilityofΣ.(ii)CalculatethetransferfunctionG(s)ofΣ,itspoles,anditsinvariantzeros.(iii)Withoutmakinganyadditionalcalculation,indicatewhetheritispossibletomaintainthesystemoutputtoaconstantreferencebywayofastatefeedbackwithintegralaction.(iv)Determineastatefeedbackwithintegralactionforwhichthepolesoftheclosed-loopsystemare{−1,−1,−2}.(v)TracetheshapeoftheNyquistplotoftheopen-looptransferfunctionLi(s).EXERCISE265.–AnswerthesamequestionsasthoseofExercise264whenΣisthelinearizedinvertedpendulumwhosestate-spacerepresentationhasbeendeterminedinExercise209(Section7.6),assumingthatthecontrolledvariableisthepositionyofthecarriage,andgiventhefollowing:M=10kg,m=1kg,l=0.981m.Forquestion(iv),choosethepolesoftheclosed-loopsystemtobe{−2,−3,−4,−5,−6}.EXERCISE266.–Considerthesystembelow,consistingoftwoidenticaltanks,theﬁrstonedrainingintothesecondoneinFigure8.13.Thesysteminputisthedischargeofwatergoingintothe1sttank,theoutputisthewaterlevelx2inthe2ndtank.x1x2uFigure8.13.SystemoftwotanksStateFeedback249(i)Justifythefactthatwehaveastate-spacesystem{A,B,C},whereAandBareoftheformA=(cid:27)−α20α2−α3(cid:28),B=(cid:27)α10(cid:28)anddeterminethematrixC.Assumefromnowonthatα1=α3=0.01andα2=0.02.(ii)Isthissystemcontrollable?observable?(iii)Whatarethepolesofthissystem?Isthesystemstable?(iv)Doesthissystemhavezeros(ifyes,whatarethey)?Whatisitsstaticgain?(v)Supposeallthecomponentsofthestatearemeasured,anddetermineastatefeedbackwithintegralactionforwhichallthepolesoftheclosed-loopareplacedat−0.05.Howcansuchachoicebejustiﬁed?EXERCISE267.–ConsiderthehotairballooninFigure8.14.Let:–θbethevariationoftemperatureintheballoonwithrespecttoareferencetemperature;–ubethevariationofthequantityofheatprovidedbytheballoon(whichisthecontrolvariable);–wbetherisingspeedofthewind(whichisadisturbance);–hbethevariationofthealtitudeoftheballoonwithrespecttoareferencealtitude;–vbetheverticalvelocityoftheballoon.Aroughmodelleadstothefollowingequations:⎧⎨⎩τ1˙θ=−θ+τ1uτ2˙v=−v+στ2θ+w˙h=vFigure8.14.Hotairballoon250LinearSystemswhereτ1andτ2aretimeconstantswithvaluesof10sand1s,respectively;σisacouplingfactorofvalue1,takingintoaccountthechosenunits.(i)Writethissysteminstate-spaceformwithinput(cid:27)uw(cid:28)andoutputh.(ii)Determinethepolesofthissystem.Isitstable?(iii)Weatﬁrstassumethatu=0.(a)Writethesystemthusobtainedinstate-spaceformwithinputwandoutputh.(b)Isthissystemobservable?(c)Interprettheresultsphysically.(iv)Wenowassumethatw=0.(a)Repeatthequestionsof(iii)byreplacingwbyu.(b)Determinethestatefeedbackthatassignsallclosed-looppolesat−1.EXERCISE268.–*(i)LetPbeasolutionofthealgebraicRiccatiequation(8.19),letT=(cid:27)I0PI(cid:28)andletF=A−BK.(a)CalculateT−1HT,whereHistheHamiltonianmatrix(8.20).(b)ShowthatH(cid:27)IP(cid:28)=(cid:27)IP(cid:28)F.(ii)Using(i),proveParts(i)-(iii)ofTheorem244.(Thereadercanﬁndaprecisediscussionofthesolutionofthisexercisein([64],section3.4,Exercises3.4-9and3.4-10.)*EXERCISE269.–Extendthetheoriesdevelopedinsections8.2and8.3tothecasewherethesystemtobecontrolledhasadirectterm,i.e.the2ndequationofequation(8.29)isy=Cx+Du+d2.Chapter9ObserversInthepreviouschapter,wehaveseenhowtousethesystemstatetocontrolthelatterwhenallstatecomponentsaremeasured,thusknownateachinstant.Inthischapter,weconsiderthesituationwherethestatex(t)isentirelyorpartlyunknownateachinstantt.9.1.Full-orderobservers9.1.1.GeneralprincipleConsiderthestate-spacesystem{A,B,C,D}:(cid:20)˙x=Ax+Buy=Cx+Du(9.1)wherex(t)∈Rn,u(t)∈Rm,andy(t)∈Rp.Thestatexisunknown,whiletheoutputyandtheinputuareassumedtobeknown.Wesuggesttodeterminefromthesedataavariablet(cid:3)→ˆx(t)suchthattheerror˜x(t)=x(t)−ˆx(t)(9.2)tendsto0whent→+∞.Thedeterminationofˆxisoftencalledthe“reconstructionofthesystemstate”andtheterms“stateobserver”and“statereconstructor”aresynonymous.Thequantity˜xdeﬁnedby(9.2)iscalledthereconstructionerrorortheobservationerror.251Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.252LinearSystemsTheformofafull-orderobserveris∂ˆx=(Aˆx+Bu)+˜K(y−Cˆx−Du)(9.3)=(cid:9)A−˜KC(cid:10)ˆx+˜Ky+(cid:9)B−˜KD(cid:10)u(9.4)where˜K∈Rn×pisthe“gainmatrixoftheobserver”(sometimescalled,moresuccinctly,the“observergain”).For˜K=0,(9.3)isasimplesimulationofthestate-spacesystem{A,B}.Thetermy−Cˆx−Duistheerrorweseewhenthesimulationispoor.Left-multipliedby˜K,thiserrorprovidesa“correctionterm”.Bysubtracting(9.3)fromtheﬁrstlineof(9.1)andtakingintoaccountoftheotherequations,weobtainthedifferentialequationoftheobservationerror˜x:∂˜x=(cid:9)A−˜KC(cid:10)˜x.(9.5)REMARK270.–Equation(9.5)isobtainedinthe“idealcase”wherethesystem,thestateofwhichweseektoreconstruct,isperfectlylineartime-invariant,withmatricesA,B,C,andDperfectlyknown.IfweonlyknowapproximationsˆA,ˆB,ˆC,andˆDofthesematrices,equation(9.3)becomes∂ˆx=(cid:9)ˆAˆx+ˆBu(cid:10)+˜K(cid:9)y−ˆCˆx−ˆDu(cid:10),whichcomplicatesalotthedifferentialequationoftheobservationerror.Wecanalreadyconcludethatwewillcertainlybefacedwiththeproblemofrobustnessoftheobserver.Thispointwillbedealtwithlater.DEFINITION271.–(i)Thestateobserver(9.3)issaidtobestableif˜x(t)→0ast→+∞,foranyinitialerror˜x(0).(ii)TheeigenvaluesofA−˜KCarecalledtheobserverpoles.THEOREM272.–Thestateobserver(9.3)isstableifandonlyif,allitspoleslieinthelefthalf-plane.PROOF.ThisisanimmediateconsequenceofRemark181(section7.3).THEOREM273.–Lettherebethestateobserver(9.3).(i)Thefollowingconditions(a)and(b)areequivalent:(a)foranysymmetricsetP⊂Cofnelements,thereexistsagainmatrix˜KforwhichtheobserverpolesaretheelementsofP;(b)thepair(C,A)isobservable.(ii)Thereexistsagainmatrix˜Kwithwhichtheobserverisstableifandonlyif,(C,A)isdetectable.Observers253PROOF.TheeigenvaluesofA−˜KCareidenticaltothoseof(cid:9)A−˜KC(cid:10)T=AT−CT˜KT(section13.3.4,Proposition534).ThetheoremisthusanimmediateconsequenceofCorollary153(section7.1.4),Corollary187(section7.3),andTheorem230(section8.1.2).REMARK274.–Statefeedback↔observerduality.AsaresultoftheproofofTheorem273,thedeterminationofthegainmatrixofanobserverandthatofastatefeedbackaretwo“dualproblems”.Moreprecisely,thegainmatrix˜Kofanobservercanbedeterminedbasedonaﬁctitiousstate-spacesystem(cid:31)AT,CT .Forthissystem,wedetermineaﬁctitiousstatefeedbackwithgainmatrix˜KT,byusingoneofthemethodsstudiedinChapter8.Then,weset˜K=(cid:9)˜KT(cid:10)T.REMARK275.–Expression(9.4)showsthatanobserverisafeedbacksystem:the“open-loopsystem”∂ˆx=Aˆx+eisfedbackaccordingtoe=−˜KCˆx+z,wherez=˜Ky+(cid:9)B−˜KD(cid:10)u.Thereaderisaskedtodrawadiagramofthisloop.9.1.2.Statefeedback/observersynthesisLettherebeastate-spacesystem{A,B,C,D}oftheform(9.1),where(A,B)isstabilizableand(C,A)isdetectable.1)Since(A,B)isstabilizable,wecandesign,ifthestatex(t)isknownateachinstantt,astabilizingstatefeedbackcontrolu=v−Kx.If(A,B)iscontrollable,wecanmoreoverchoosethegainmatrixKinawaythatarbitrarilyassignstheeigenvaluesofA−BKinthelefthalf-plane(withtheusualsymmetryconditionwithrespecttotherealaxis):seeTheorem230(section8.1.2).2)Assumenowthatonlytheoutputy(t)andthecontrolu(t)areknownateachinstantt.Thehypothesisofdetectabilityof(C,A)allowsustoafﬁrmthat,accordingtoTheorem273(section9.1.1),wecanreconstructthestateusingastablefull-orderobserveroftheform(9.3).If(C,A)isobservable,wecanmoreoverchoosethegainmatrix˜Kinamannerastoarbitrarilyassigntheobserverpolesinthelefthalf-plane(withthesymmetryconditionwithrespecttotherealaxisasrecalledabove).3)Considerthecontrolu=v−Kˆx(9.6)254LinearSystemswhereˆxistheestimatedstateprovidedbytheobserver.Weobtainthefollowingtheorem,sometimescalledthe“separationprinciple”.1THEOREM276.–Thepolesoftheclosed-loopsystemwithcontrol(9.6)aretheelementsofSp(A−BK)˙∪Sp(cid:9)A−˜KC(cid:10)(countingmultiplicities),whereSpdenotesthespectrum–seesection13.3.3–and˙∪denotesthedisjointunion–seesection13.4.2,Lemma559.PROOF.Accordingto(9.2)and(9.6),wehaveu=v−K(x−˜x).Wethereforehave,from(9.1),˙x=Ax+B(v−K(x−˜x))=(A−BK)x+BK˜x+Bv.Finally,accordingto(9.5),thestateofaclosed-loopsystemis(cid:27)x˜x(cid:28)andthissystemisgovernedby∂(cid:27)x˜x(cid:28)=(cid:27)A−BKBK0A−˜KC(cid:28)-./0Aa(cid:27)x˜x(cid:28)+(cid:27)B0(cid:28)-./0Bav,y=(cid:25)C0(cid:26)-./0Ca(cid:27)x˜x(cid:28).Wehavedet(∂I2n−Aa)=det(∂In−A+BK)det(cid:9)∂In−A+˜KC(cid:10)(seesection13.1.4),whichprovesthedesiredresult.REMARK277.–Itisclearaccordingto(9.5)thatthedynamicsoftheobserverarenotcontrollable(intheabsenceofanymodelingerrorandanydisturbance).1.*Someauthorsreservethisterminologyforthe“linearquadraticgaussiancontrol”,whichisshowntobea“linearquadraticcontrol”/“Kalmanﬁlter”synthesisinthecontextofoptimalcontrol.Theterm“certaintyequivalenceprinciple”isalsousedinthatcase.*Observers255WewillnowdeterminethetransfermatrixH(s)ofacontrollerdesignedbystatefeedback/observersynthesis.Itisatransferfunctiony→−uwhenv=0andwhenthecontrolsystemissuppressedfromtheloop(the−signisduetothefactthatbyconvention,thefeedbackisalwaysnegative;seeFigure4.1insection4.1.1).Accordingtoequations(9.6)and(9.4)∂ˆx=(cid:9)A−˜KC−(cid:9)B−˜KDK(cid:10)(cid:10)ˆx+˜Ky,andhencethetransfermatrixH(s)isgivenbyH(s)=K(cid:9)sIn−A+BK+˜KC−˜KDK(cid:10)−1˜K.(9.7)9.1.3.Statefeedback/observersynthesisandRSTcontrollerItisworthwhileseekingarelationshipbetweenthestatefeedback/observersynthesisandtheRSTcontrollerasstudiedinChapter6inthecaseofanSISOcontrolsystem,assumedtobestrictlyproperinordertosimplifythenotation.Toavoidconfusion,thecontrolsystemisdenotedby{F,G,H}inwhatfollows.Thissystemisthereforegovernedbytheequations(cid:20)˙x=Fx+Guy=Hx(9.8)whereastheobserverisgivenby∂ˆx=(Fˆx+Gu)+˜K(y−Hˆx)(9.9)andthecontrolsatisﬁesequation(9.6).ThetransferfunctionΘ(s)ofthesystem{F,G,H}isgivenbyΘ(s)=H(sIn−F)−1G(seeProposition157,section7.1.5);therefore,byequation(13.8)(section13.1.4),wehaveΘ(s)=B(s)A(s),(9.10)A(s)=det(sIn−F),B(s)=Hadj(∂In−F)Gwhereadj(.)isthe“classicaladjointmatrix”of(.).Suppose{F,G,H}isminimal.Inthiscase,itsorderanditstransmissionordercoincide(section2.4.6),andthustherationalfunction(9.10)isirreducible,i.e.thepolynomialsB(s)andA(s)arecoprime.256LinearSystemsOntheotherhand,letAc(∂)=det(∂In−F+GK),Ao(∂)=det(cid:9)∂In−F+˜KH(cid:10).Accordingto(9.9),wehave(cid:9)∂In−F+˜KH(cid:10)ˆx=Gu+˜Ky(9.11)andweknowthat(cid:9)∂In−F+˜KH(cid:10)−1=adj(cid:9)∂In−F+˜KH(cid:10)Ao(∂).(9.12)LetQ(∂)=Kadj(cid:9)∂In−F+˜KH(cid:10)G,R(∂)=Kadj(cid:9)∂In−F+˜KH(cid:10)˜K.Wegetfromequations(9.6),(9.11)and(9.12)S(∂)u=−R(∂)y+T(∂)vwithS(∂)=Ao(∂)+Q(∂)andT(∂)=Ao(∂).Astatefeedback/observersynthesisisthereforeidenticaltoaparticularRSTcontroller.Accordingtosection6.2.1,thecharacteristicpolynomialoftheclosed-loopsystemisAcl(∂)=A(∂)S(∂)+B(∂)R(∂)andbyTheorem276(section9.1.1),wehave(withthenewnotation)Acl(∂)=Ac(∂)Ao(∂).(9.13)Thislastexpressionistobecomparedwithequalities(6.20)and(6.24)ofsection6.3.5.ThetransferfunctionΘbf(s)oftheclosed-loopsystem(withinputvandoutputy)isgivenbyΘbf(s)=B(s)T(s)A(s)S(s)+B(s)R(s)=B(s)Ac(s).Thepolesoftheobserverarethushiddenmodesoftheclosed-loopsystem,whichisconsistentwithRemark277(section9.1.2).(Asacomplementtothisanalysis,seeExercise301.)Observers2579.1.4.LTRmethodIntroductionWehaveshowninsections8.1.3and8.1.4thatitispossibletodesignastatefeedbackcontrolforanSISOoranMIMOstate-spacesystemΣ,suchthatitwillstabilizetheclosed-loopsystemwithacertainrobustness,and,morespeciﬁcally,aninputmodulusmarginequalto1.Twoconditionsarerequiredforthis:thecontrollability(orbydefaultthestabilizability)ofΣ,andthepossibilitytoknowallthestatecomponentsateachinstant.Astateobserverhastheroleofrelaxingthislastconstraint.Butthereisthequestionofknowingunderwhatcondition(ifitexists)thepresenceofanobserverwillnotdestroytherobustnessoftheclosed-loop.ThisisaproblemthathasalreadybeentoucheduponintheframeworkofRSTcontrollers.Indeed,supposeΣisaminimalSISOstate-spacesystem.Astatefeedbackcontrolcanbewrittenintheformofa“partialstatefeedbackcontrol”(seesection8.1.3).Asaresult,accordingto(9.13),thechoice,insection6.3.5,of(6.20)asacharacteristicpolynomialoftheclosed-loop,correspondstothatofastateobserver,thepolesofwhicharethetransmissionzerosofΣ,plusfastpoles.Itisthischoicewhichallowsustoconserveinanapproximatemannerthemodulusmarginobtainedbystatefeedback(Theorem112,section6.3.5).AnecessaryandsufﬁcientconditionforthesynthesisofsuchanobservertobepossibleisthatΣshouldbeminimumphase.AccordingtoProposition90(section4.2.8),thislimitationisinthenatureofthingsandisnotrelatedtothemethodused.CaseofanSISOsystemForanSISOsystemΣ(assumedtobeminimal),itispossibletodesignbypoleplacementafull-orderobserverliketheoneabove.Thisobserverisindeedentirelydeterminedbyitscharacteristicpolynomial.LetAo(∂)=B∗(∂)F(∂)(9.14)bethischaracteristicpolynomial(withthenotationusedinequation(6.24)(section9.1.3).LetL(s)(resp.,Lsf(s))bethetransferfunctionoftheopenloopwhenthecontrolusedisthestatefeedback/observersynthesis(resp.,thestatefeedback).(i)IfΣhasnotransmissionzerosintheclosedrighthalf-plane,thenB∗(∂)=B(∂),andhencethehypothesesofTheorem112aresatisﬁed,and(cid:29)(cid:29)(cid:29)11+L−11+Lsf(cid:29)(cid:29)(cid:29)∞→0whentherootsofthepolynomialF(∂)tendto−∞ontherealaxis.(ii)IftheonlytransmissionzerosΣpossiblyhasintheclosedrighthalf-planehaveanabsolutevaluethatismuchlargerthanthemaximumcutofffrequencyωcoftheclosed-loopsystem,then,whentherootsofF(∂)havetheabovebehavior,L(iω)→Lsf(iω)withagoodapproximationatfrequenciesωforwhichB∗(iω)(cid:9)B(iω),i.e.suchthatω≤ωc.258LinearSystemsCaseofanMIMOsystemForasystemΣwithseveraloutputs,weencounterthesamedifﬁcultyasinsection8.1.4,i.e.afull-orderobserverisnotdeterminedbyitspoles(orbyitscharacteristicpolynomial).WearethusledtoconsideradualoftheLQRsolutionofsection8.1.4.Letusﬁndouttheexactnatureofthisduality.Inthetablebelow,thedatathatarenecessaryforthesynthesisofastatefeedbackareshownintheleftcolumn,thosethatarenecessaryforthesynthesisofanobserverareshownintherightcolumn(thematrixdenotedbyˇPinsection8.1.4isdenotedbyPinwhatfollows).AATBCTK˜KTQ˜QR˜RP˜PTheﬁrstthreerowsexpressthedualityalreadymentionedinRemark274(section9.1.1).Thenextthreerowsareinterpretedasfollows:considertheexpression(8.18),whereK,R,B,andParereplacedby˜KT,˜R,CT,and˜Prespectively.Wehave˜KT=˜R−1C˜P,fromwhichweget˜K=˜PCT˜R−1.(9.15)Let’sworkthesamewayasinexpression(8.19),withα=0andreplacingAbyAT.Weobtain˜PAT+A˜P−˜PCT˜R−1C˜P+˜Q=0.(9.16)REMARK278.–*(i)Expressions(9.3),(9.15)and(9.16)arethoseofthe“Kalmanﬁlter”,dualofthe“linearquadraticcontrol”[2]*.(ii)By“dualizing”Theorem244ofsection8.1.4(withα=0),weobtainthetheorembelow.LettherebetheHamiltonianmatrix˜H=(cid:27)AT−CT˜R−1C−˜Q−A(cid:28)andlet˜Ebeasquarerootof˜Q.Alsolet,(cid:20)˜νi(cid:1)(cid:27)˜ξi˜ηi(cid:28),1≤i≤n&beasetofgeneralizedlinearlyindependenteigenvectorsof˜H,where˜νiisassociatedwiththeeigenvalue˜λiof˜H.Last,let˜η=(cid:25)˜η1...˜ηn(cid:26),˜ξ=(cid:25)˜ξ1...˜ξn(cid:26)Observers259and,supposingthat˜ξisinvertible,let˜P=˜η˜ξ−1.(9.17)THEOREM279.–(i)Thematrix˜Pdeﬁnedby(9.17)isasolutionofthealgebraicRiccatiequation(9.16).(ii)Thefollowingconditions(a)and(b)areequivalent:(a)thereexistsamatrix˜Poftheform(9.17)suchthatA−˜KCisastabilitymatrix(thismatrix˜P,whichisthenuniqueandsatisﬁes˜P≥0,isobtainedbychoosingtheneigenvalues˜λiinthelefthalf-plane);(b)(C,A)isdetectableand˜Hhasnoimaginaryeigenvalues.(iii)Supposefromhereonwardthat(C,A)isdetectable.ForCondition(a)or(b)tobesatisﬁed,itissufﬁcientthatthefollowingconditionholds:(c)(cid:9)A,˜E(cid:10)isstabilizable.(iv)SupposeCondition(c)holds.Then,thereexistsauniquesolution˜PtothealgebraicRiccatiequation(9.16)forwhichA−˜KCisastabilitymatrix;˜Pisalsotheuniquenon-negativedeﬁnitesolutionto(9.16).(v)If,inaddition,(cid:9)A,˜E(cid:10)iscontrollable,then˜P>0.Theso-called“LTR”method2consistsofchoosingthematrix˜Qasafunctionofarealnumberq≥0(itisthereforepreferabletodenotethismatrixby˜Qq)accordingtotherelation˜Qq=˜Q0+q2BVBT(9.18)whereV∈Rm×m,V>0,andoflettingqtendto+∞.Wehaveﬁrsttheresultbelow,whichisadirectconsequenceof([119],section3.10,Theorem3.6):LEMMA280.–(i)Let˜E0beasquarerootof˜Q0.If(cid:9)A,˜E0(cid:10)isstabilizable(resp.,controllable),thensois(cid:21)A,(cid:30)˜Qq(cid:22)foranyq≥0.(ii)If(A,B)isstabilizable(resp.,controllable),thensois(cid:9)A,B√V(cid:10).Nowconsiderthefollowinghypothesis(HLTRu),3where˜E0isasquarerootof˜Q0andG(s)=C(sIn−A)−1B:(HLTRu):(a)Thestate-spacesystemΣ={A,B,C}isminimal;(b)A−BKisastabilitymatrix;(c)(cid:9)A,˜E0(cid:10)iscontrollable;(d)G(s)∈R(s)m×m;2.LTR:acronymof“LoopTransferRecovery”(seeRemark283below).3.Hypothesis(HLTRu)isstrongerthanHypothesis(HLTR)usuallyconsidered(seeRemark283below);itguaranteesuniform–insteadofsimple–convergenceonthecompactsubsetsof¯C+.260LinearSystems(e)rkR(s)G(s)=m;(f)G(s)hasnoMacMillanzerosintheclosedrighthalf-plane¯C+.AssumingthatConditions(a)and(c)ofHypothesis(HLTRu)hold,thealgebraicRiccatiequation(9.16)(where˜Q=˜Qq)admits,foranyq≥0,auniquenon-negativedeﬁnitesolution(thissolutionisdenotedby˜Pqinwhatfollows)and˜Pq>0(accordingtoTheorem279andLemma280).Let˜Kq=˜PqCT˜R−1bethecorrespondingobservergain.Thetransfermatrixoftheopen-loopattheinputofΣ,usuallydenotedbyLi(s),willbedenotedbyLq(s)inwhatfollowsjusttoclearlyindicateitsdependencewithrespecttotheparameterq;itisgivenbyLq(s)=Hq(s)G(s)whereHq(s)isthetransfermatrixH(s)satisfyingequation(9.7)(seesection4.1.2whereH(s)andG(s)aredenotedbyK(s)andP(s),respectively).Theinputsensitivityfunction(ormatrix)isthusgivenbySq(s)=(Im+Lq(s))−1.ThetransfermatrixLq(s)istobedistinguishedfromwhatwewouldobtainwithastatefeedbackcontrol,whichisLsf(s)=KΦ(s)BwhereΦ(s)=(sIn−A)−1,andtowhichcorrespondstheinputsensitivityfunction(ormatrix)Ssf(s)=(Im+Lsf(s))−1.Wehavethefollowingtheorem,whichdescribesthe“uniformLTReffect”:THEOREM281.–LetHypothesis(HLTRu)beinforce.Then,foranycompactsetK⊂¯C+,Sq(s)−Ssf(s)→0uniformlywithrespecttos∈Kasq→+∞.PROOF.1)Foranyq>0,thealgebraicRiccatiequation(9.16)canbewrittenintheform˜Pqq2AT+A˜Pqq2−˜Pqq2CT*˜Rq2+−1C˜Pqq2+˜Q0q2+(cid:9)√VBT(cid:10)T(cid:9)√VBT(cid:10)=0.(9.19)Condition(a)ofHypothesis(HLTRu)impliesthat(cid:15)AT,CT(cid:16)iscontrollableand(cid:9)√VBT,AT(cid:10)isobservable(accordingtoCorollary153ofsection7.1.4andLemmaObservers261280(ii)above).AccordingtoRemark249(ii)ofsection8.1.4(withρ=1q2andPρ=˜Pqq2),˜Pqq2→0asq→+∞.Therefore,asq→+∞,*˜Pqq2+CT*˜Rq2+−1C*˜Pqq2+→BVBT.Accordingto(9.15),˜Kqisthereforesuchthat1q2˜Kq˜R˜KTq→BVBTandrk˜Kq=mbecause˜Pq>0.FromCorollary586(section13.5.7),thereexistsforanyq>0anorthogonalmatrixUq∈Rm×mandamatrix1(1/q)∈Rn×msuchthat%˜R˜KTq=q(cid:9)Uq√VBT+%˜R1(1/q)T(cid:10)and1(1/q)→0asq→+∞.PuttingWq=√VUTq%˜R−1,itfollowsthat˜Kq=q(BWq+1(1/q)).(9.20)2)LetΨ(s)=(sIn−A+BK)−1.WehaveHq(s)=KΨ(s)(cid:9)Im+˜KqCΨ(s)(cid:10)−1˜KqandaccordingtoLemma520(section13.3.3)Hq(s)=KΨ(s)˜Kq(cid:9)Im+CΨ(s)˜Kq(cid:10)−1=KΨ(s)J(q,s)(9.21)whereJ(q,s)=˜Kqq*Imq+CΨ(s)˜Kqq+−1.(9.22)From(9.20),J(q,s)=(BWq+1(1/q))(cid:21)Imq+CΨ(s)(BWq+1(1/q))(cid:22)−1,262LinearSystemsandhence,withGc(s)=CΨ(s)B,J(q,s)=BG−1c(s)(cid:21)Im+(Gc(s)Wq)−1(cid:21)CΨ(s)1(1/q)+Imq(cid:22)(cid:22)+1(1/q)G−1c(s)..(cid:21)Im+(Gc(s)Wq)−1(cid:21)CΨ(s)1(1/q)+Imq(cid:22)(cid:22).(9.23)LetK⊂¯C+beacompactset.AccordingtoConditions(d),(e)and(f)ofHypothesis(HLTRu),Gc(s)isinvertibleinK(seeChapter8,Exercise263)andisboundedinthisset.FromCondition(b)ofHypothesis(HLTRu),thetransfermatrixΨ(s)isalsoboundedinK.Asaresult,accordingto(9.23),J(q,s)=BG−1c(s)(Im+2(1/q,s)),where2(1/q,s)→0uniformlywithrespecttos∈Kasq→+∞.Usingthisexpressionin(9.21),weobtain(byanidenticalrationale)Hq(s)=(Im+3(1/q,s))KΨ(s)BG−1c(s)where3(1/q,s)→0uniformlywithrespecttos∈Kasq→+∞.Ontheotherhand,Φ(s)B=Ψ(s)(cid:9)Im−BK(sIn−A+BK)−1(cid:10)−1,andhencefromLemma520(section13.3.3),Φ(s)B=Ψ(s)B(Im−KΨ(s)B)−1.Therefore,Lq(s)=(Im+3(1/q,s))KΨ(s)B(Im−KΨ(s)B)−1andhenceSq(s)=(Im−KΨ(s)B)(Im+3(1/q,s)KΨ(s)B)−1.Inaddition,Ssf(s)=(Im+KΦ(s)B)−1=(cid:9)Im+KΨ(s)B(Im−KΨ(s)B)−1(cid:10)−1=Im−KΨ(s)B.SincethetransfermatrixKΨ(s)BisboundedinK,Sq(s)→Ssf(s)uniformlywithrespecttos∈Kasq→+∞.Observers263REMARK282.–IthasnotbeenprovenintheabovetheoremthatSq(s)→Imasqand|s|bothtendto+∞(withs∈¯C+).Wethuscannotassertthat(cid:23)Sq−Ssf(cid:23)∞→0asq→+∞(theauthordoesnot,however,knowofanycounterexampletothispropertyofwhichwemayconjecture).REMARK283.–The“LTR”method,popularizedbyDoyle[38]fromatheoryduetoKwakernaakandSivan[71],canbedescribedasfollows(see[93]forarigorousproof):lettherebeHypothesis(HLTR)below:(a)Thestate-spacesystem{A,B,C}isstabilizableanddetectable;(b)A−BKisastabilitymatrix;(c)(cid:9)A,˜E0(cid:10)isstabilizable;(d)G(s)∈R(s)p×m;(e)rkR(s)G(s)=m;(f)G(s)hasnoMacMillanzerosintheclosedrighthalf-plane¯C+.Underthishypothesis,Lq(s)→Lsf(s)asq→+∞foranys∈Cwhichisnotapoleofsystem{A,B,C}.EXAMPLE284.–ConsidertheminimalsystemwithtransferfunctionG(s)=1s4anditscontrollablecanonicalrealization{A,B,C}(seesection7.4.2).(1)Letxbeameasuredstate.Thegainmatrixofthestatefeedbackcontrolforwhichthepolesoftheclosed-loopsystemareplacedat{−1,−1,−1,−1}is:K=(cid:25)4641(cid:26).Thischoiceofthepolesoftheclosed-loopsystemcomplieswithRule111(section6.3.5).(2)Nowsupposewehavethestateobserverspeciﬁedabovewith˜Q0=I4andV=1.TheBodeplotsoftheopen-looptransferfunctionsarerepresentedinFigure9.2inthefollowingorder(goingfromlowtohighinthehighfrequencies)4:withthestatefeedback/observersynthesisandq=0,q=102,q=104,q=106,andthenwiththecompletestatefeedback.ThecorrespondingBodeplotsofthesensitivityfunctionsareshowninFigure9.3withareverseorderinthelowfrequencies.Onecanseethat(cid:23)Sq−Ssf(cid:23)∞→0asq→+∞(seeRemark282).TheBodeplotsofthetransferfunctionsHq(s)ofthecontroller,fortheabove-speciﬁedvaluesofq,areshowninFigure9.4,inthesameorderasinFigure9.2.Letωq=argmaxω|Hq(iω)|.Asq→+∞,weseethat|Hq(iωq)|→+∞andωq→+∞.Thisphenomenonisoneofthethingsthatmakestheanalysisofthebehaviorof|Hq(iω)G(iω)|difﬁcultasbothqandωtendtoward+∞.Rememberthatacontrollerhavingalargegaininthehighfrequenciesrendersthecontrolverysensitivetomeasurementnoise(seesection4.2.6),whichistobeavoided.Itisthereforerecommendedtoincreaseparameterquntilasufﬁcientmodulusmarginisobtained,andthennottogobeyondthatvalue.4.Thecurvesrelatedtosections9.1and9.2areassembledattheendofsection9.2.264LinearSystems9.2.Statefeedback/observersynthesiswithintegralaction9.2.1.ProblemsettingInthissection,thecontrolmethodbystatefeedbackwithintegralactionstudiedinsection8.2iscombinedwithafull-orderobserver.ConsiderthefollowingsystemΣ:⎧⎨⎩∂x=Ax+Bu+d1y=Cx+d2z=Ey(9.24)wherex(t)∈Rnisthestate,u(t)∈Rmisthecontrol,y(t)∈Rkisthemeasuredvector,andz(t)∈Rpistheregulatedvariable;d1∈Rnandd2∈Rkareconstantdisturbances,unmeasuredandunknown(seesection8.2.2).ThematricesA,BandCareuncertaininpractice,butmatrixEisassumedtobeperfectlyknown.Thethirdlineof(9.24)can,forexample,signifythatzisconstitutedoftheﬁrstprowsofyandinthatcaseE=(cid:25)Ip0(cid:26).Letr∈Rpbethereferencesignal,assumedtobeknown,andlettheregulationerrorbee=z−r.OuraiminwhatfollowsistodesignacontrollawforwhichProperty(P)ofsection8.2.2issatisﬁed.Letuswritez=E(Cx+d2)=Hx+d3withH=EC,d3=Ed2.Theproblemconsideredherewouldreducetothatofsection8.2.2ifthestateweremeasured.Therefore,thesamehypothesesasforthislastproblemareinforce:(H1)(A,B)iscontrollable;(H2)thetransfermatrixG(s)ofSystem{A,B,H}issemiregularoverR(s).Asupplementarystep,inthepresentcase,consistsinreconstructingthestateusingthemeasuredvectory,whichleadsustoaddthehypothesisbelow:(H3)(C,A)isobservable.Observers2659.2.2.AlgebraicsolutionWedeﬁnethevariablesχandυasinequation(8.32)ofsection8.2.4.Wegetstateequation(8.33)withF=(cid:27)A0H0(cid:28),G=(cid:27)B0(cid:28).BasedonHypotheses(H1)and(H2)andProposition253,wehavethefollowing:PROPOSITION285.–(F,G)isstabilizableifandonlyif,thefollowingtwoconditionshold:(i)m≥p;(ii)s=0isnotaninvariantzeroofsystem{A,B,H}.Inthatcase,(F,G)iscontrollable.AssumingthatConditions(i)and(ii)ofProposition285hold,thereexistsagainmatrixK∈Rm×(n+p)forwhichF−GKisastabilitymatrix.Moreprecisely,bychoosingKinanappropriatemanner,theeigenvaluesofF−GKcanbeplacedinanarbitrarysymmetricsubsetwithn+pelementsofthelefthalf-plane(seesection8.1.2,Theorem230).Letη=∂xandconsidertheobserverbelow,withaimsatreconstructingη:∂ˆη=Aˆη+Bυ+˜K(∂y−Cˆη).(9.25)Indifferentiatingtheﬁrsttwoequationsof(9.24),weobtain(cid:20)∂η=Aη+Bυ,∂y=Cη;(9.26)asaresult,putting˜η=η−ˆη,wegetfromequations(9.25)and(9.26)∂˜η=(cid:9)A−˜KC(cid:10)˜η.(9.27)AccordingtoHypothesis(H3),thereexistsagainmatrix˜K∈Rn×kforwhichA−˜KCisastabilitymatrix.NowwritethegainmatrixKintheformK=(cid:25)KpKi(cid:26),Kp∈Rm×n,Ki∈Rm×p,andconsiderthecontrollawυ=−Kpˆη−Kie.(9.28)266LinearSystemsLetξ=⎡⎣ηe˜η⎤⎦.Weobtainfromequations(9.26),(9.11)and(9.28)∂ξ=⎡⎣A−BKp−BKiBKpH0000A−˜KC⎤⎦ξ(cid:1)Mξ.SincethematrixMisoftheformM=(cid:27)F−GK∗0A−˜KC(cid:28),wehaveSp(M)=Sp(F−GK)˙∪Sp(cid:9)A−˜KC(cid:10),(9.29)whichprovesthatMisastabilitymatrix.Letˆx(t)=(cid:2)ˆη(t)dt,˜x=x−ˆx.BythesamerationaleasintheproofofLemma252(section8.2.4),weobtainthefollowingresult:THEOREM286.–Usingthecontrollaw(9.28),wehave:limt→+∞e(t)=0,limt→+∞x(t)=const.,limt→+∞˜x(t)=const.limt→+∞u(t)=const.Theproblemwhichremainstobesolvedistheimplementationofthecontrollaw(9.28).SincethegainmatricesKp,Ki,and˜Kareconstant,5weobtainbyintegrating5.Thecasewherethegainsarescheduledisquitedifferent[80].Then,equations(9.28)and(9.25)mustbekeptandthecontrolumustbecalculatedbyintegratingυ,usinganintegratorplacedjustattheinputofthecontrolsystem.Observers267equations(9.28)and(9.25)u(t)=−Kpˆx(t)−Ki(cid:2)e(t)dt+c,(9.30)∂ˆx=Aˆx+Bu+˜K(y−Cˆx)+c(cid:2)(9.31)wherecandc(cid:2)areintegrationconstants.REMARK287.–(i)Takingc(cid:2)=0,equation(9.31)istheclassicexpressionofanobserverofstatex.(ii)Thecontrollaw(9.30)isnothingbutthe“controlbystatefeedbackandintegralaction”(8.35)ofsection8.2.4,wherexhasbeenreplacedbyˆx.Theorem286andequality(9.29)canbeconsideredasanextensionofthe“separationprinciple”(Theorem276,section9.1.2).Thediagramoftheclosed-loopsystemisshowninFigure9.1.Notethattheregulationerrore=z−risnotreconstructed(neitheristhecontrolledvariablez).9.2.3.ExtensionoftheLTRmethodSupposewechoosethegainmatrixKusingthe(α)methodortheLQRmethodofsection8.1.4.Then,accordingtoTheorem258(section8.2.4),weobtainusingthecontrollaw(8.35)(assumingthatthestateisknown)aclosed-loopsystemwhoseinputsensitivityfunctionSisatisﬁes(cid:23)Si(cid:23)∞=1.Likeinsection9.1.4,thequestiononhandnowistoknowhowtodesignthestateobserver(9.25)(or,inanequivalentmanner,thestateobserver(9.31))inawayasnottodegrade(toomuch)thisrobustnessproperty.WearegoingtoshowthattheLTRmethod,detailedinsection9.1.4,extendstothesituationnowconsidered.Theobservergainnowdependsonparameterq≥0andisdenotedby˜Kq.Letusﬁrstdeterminethetransfermatrix(cid:25)Hq,y(s)Hq,e(s)(cid:26)ofthecontrollerwithinput(cid:27)ye(cid:28)andoutputu,assumingthattheexternalsignals(i.e.thedisturbancesd1andd2andthereferencesignalr)arezero.Wehave(cid:9)∂In−A+˜KqC+BKp(cid:10)ˆη=˜Kq∂y−BKie.Asaresult,Hq,y(s)=Kp(cid:9)sIn−A+BKp+˜KqC(cid:10)−1˜Kq,Hq,e(s)=(cid:27)Im−Kp(cid:9)sIn−A+BKp+˜KqC(cid:10)−1B(cid:28)Kis.268LinearSystemsWecanalsoconsiderthatonlythemeasuredvectorygoesintothecontroller(takingintoaccounttherelationz=Ey);thiscontrollerthushasasatransfermatrixHq(s)=Hq,y(s)+Hq,e(s)E.SupposeHypothesis(HLTR)ofRemark282(section9.1.4)isinforceandletPbethelocusofthecontrollerpoles(i.e.Sp(cid:7)A−BKp−˜KqC(cid:8)˙∪{0})whenqvariesfrom0to+∞.THEOREM288.–Letq→+∞.(i)Foranys∈¯C+(cid:2)(cid:15)P∩¯C+(cid:16),sHq,e(s)→Ki.(ii)Foranys∈CwhichisnotaneigenvalueofA,Hq,y(s)C(sIn−A)−1B→Kp(sIn−A)−1B.PROOF.Forthesakeofsimplicity,assumethatHypothesis(HLTRu)isinforce(ifitisthereplacedHypothesis(HLTR),whichislessrestrictive,wemustmakeuseoftheapproachdevelopedin[93]).(i):Wehavefromequation(9.20)˜KqqW−1q∼B.LetΨ(s)=(sIn−A+BKp)−1and∆q(s)=(cid:9)sIn−A+BKp+˜KqC(cid:10)−1B.Foranys∈¯C+(cid:2)(cid:15)P∩¯C+(cid:16),sisnotapoleofΨ(s)and(cid:9)In+˜KqCΨ(s)(cid:10)−1isbounded.Therefore,wehavethefollowingequivalentsasq→+∞:∆q(s)=Ψ(s)(cid:9)In+˜KqCΨ(s)(cid:10)−1B∼Ψ(s)(cid:9)Im+˜KqCΨ(s)(cid:10)−1˜KqqW−1q∼Ψ(s)˜Kq(cid:9)Im+CΨ(s)˜Kq(cid:10)−1W−1qq.UsingthesamerationaleasintheproofofTheorem281,wethusobtain∆q(s)∼1qΨ(s)B(CΨ(s)B)−1W−1qwhereW−1q=%˜RUq√V−1.Thelastquantityisbounded,andhence∆q(s)→0asq→+∞,andsHq,e(s)→Ki.Theproofof(ii)canclearlybederivedfromthatofTheorem281.Observers269EXAMPLE289.–ConsideragainthesysteminExample257(section8.2.4).ThegainmatricesKpandKihavealreadybeencalculated,butwenowassumethatthestatexisnotmeasured:themeasuredvectorisy=Cx,andz=y.LetG(s)=CΦ(s)B,whereΦ(s)=(sI4−A)−1.Usingthestatefeedback/observersynthesiswithintegralaction,theopen-looptransfermatrixatinputofΣisLq(s)=Hq(s)G(s)whileusingthecontrollaw(8.35)itisequaltoLsf(s)=KpΦ(s)B+KisG(s).Thematrix˜Q0ischosentobetheidentity,aswellas˜R.ThetwosingularvaluesofLq(iω)areplottedasafunctionofωinFigure9.5forq=100(–-)6,q=104(..)7,andq=106(--).ThetwosingularvaluesareplottedinthesameFigure(–).ThetwosingularvaluesofSq(iω)=(I2+Lq(iω))−1andthoseofSsf(iω)=(I2+Lsf(iω))−1areplottedinFigure9.6withthesameconventions.Weobservethatasq→+∞,Sq(iω)→Ssf(iω)foranyω;inaddition,inthecaseconsidered,(cid:23)Sq−Ssf(cid:23)∞→0(seeRemark282insection9.1.4).Withq=102,themodulusmarginisalreadysufﬁcient(about−3dB:seesection4.2.9),thusthisvalueofqisretained.Itisnowrelevanttoverifythetime-domainqualitiesofthefeedbacksystem.Thefollowingeventsaresimulated:(i)astepcommandofamplitude1fortheﬁrstvariableandofamplitude−1forthesecond,atinstantt=1;(ii)astepdisturbanceofamplitude0.2ontheﬁrstoutputatt=5andofamplitude−0.3onthesecondoutputatt=7.Theﬁrstoutput(–)andthesecondone(--)asafunctionoftimeareshowninFigure9.9.ThecorrespondingcontrolsareshowninFigure9.10,withthesameconventions.Theresponsestostepcommandsareidenticaltothoseobtainedwithacontrolbystatefeedbackandintegralaction(seeRemark277,section9.1.4).Itisnotthesamefortheresponsestodisturbances,whichneverthelessaresatisfactorywiththedesignedcontrol.Ifwechoseamuchlargervalueofq(toincreasethemodulusmargin),itwouldresultinacontrollerhavinglargergains(thetwosingularvaluesofHq(iω)areplottedasafunctionofωinFigure9.7forq=100,q=104,andq=106withthealreadyadoptedconventions),fromwhich,asaresponsetodisturbances,wehaveontheonehandacontrolhavingtoolargeamplitudes,andontheotherhandastrongcouplingbetweenthetwooutputs.Anotherquestionthatstillremainstobeanswerediswhethertheoutputmodulusmarginissuitableforthevalueretainedforparameterq(i.e.q=100).Indeed,theoutputsensitivityfunctionis(I+GHq)−1;itisdifferentfromtheinputsensitivityfunction(I+Lq)−1=(I+HqG)−1considered6.Alternatelongandshortdashes.7.Dotted.270LinearSystems-     Observer EKpsKiControl system ruyz++-Figure9.1.Closed-loopsystemuptillnow.ThesingularvaluesofthesetwosensitivityfunctionsareshowninFigure9.8:thatattheinputofΣ(..)andthatatitsoutput(--).TheoutputmodulusmarginofΣ,about−8dB,isclearlynotasgoodasthatattheinputmodulusmargin,butforanMIMOsystemthisvalueisstillreasonable.Figure9.2.LTReffect(1)Observers271Figure9.3.LTReffect(2)Figure9.4.LTReffect(3)272LinearSystemsFigure9.5.SingularvaluesofLiFigure9.6.Singularvalues(inputsensitivityfunction)Observers273Figure9.7.Singularvalues(controller)Figure9.8.Inputandoutputsensitivityfunctions274LinearSystemsFigure9.9.Timeresponses(Example289)Figure9.10.Timeresponses(Example289)Observers2759.3.*GeneraltheoryofobserversThegeneraltheoryofobserversisessentiallyduetoLuenberger[87],[88].9.3.1.Reduced-orderobserverConsiderthestate-spacesystem{A,B,C}:(cid:20)˙x=Ax+Buy=Cx(9.32)wherex(t)∈Rn,u(t)∈Rm,andy(t)∈Rp.ThematrixCisassumedtobeleft-regular.REMARK290.–Whatfollowseasilyextendstothecasewheretheabovestate-spacesystemhasadirectterm,i.e.wherethesecondequationof(9.32)isy=Cx+Du.Theonlythingtodoistoreplaceyby¯y=y−Dueverywhere.Ifthesignalyisverynoisy,itisusefulforthecontrollertohaveasmallgaininhighfrequencies(seesection4.2.6).Thisiswhatwegetusingafull-orderobserver,sincethenthetransfermatrixH(s)givenbyequation(9.7)(withD=0)issuchthatH(iω)→0asω→+∞.Supposenowthatthesignalyislessnoisyandthatthecomponentsofyarepartofthecomponentsofx.Wecanalwayscomebacktothiscase.Indeed,letJ∈Rn×(n−p)beamatrixsuchthatT=(cid:27)JC(cid:28)isinvertible.PuttingX=Tx,wehaveobviouslyy=(cid:25)0n×(n−p)Ip(cid:26)X.Itisthusassumedinwhatfollowsthattheabovealgebraicoperationhasalreadybeenmade,andthereforethatthestatexisoftheformx=(cid:27)xry(cid:28)(9.33)wherexr(t)∈Rn−p.REMARK291.–Nevertheless,twocasesaretobedistinguished:thecasewherethestatexis“bynature”oftheformofequation(9.33)andthecasewherethisstructureisobtainedthroughtheabovealgebraicoperation.ThelatterdoesnotproduceanexactresultifthematrixCisuncertain;the“reduced-orderobserver”thatwillbediscussedcanthenleadtoanotveryrobustcontrollaw.276LinearSystemsThefollowingdecompositionofsystem(9.32)correspondstodecomposition(9.33)ofthestate:(cid:27)˙xr˙y(cid:28)=(cid:27)ArBrCrDr(cid:28)(cid:27)xry(cid:28)+(cid:27)GrHr(cid:28)u.(9.34)Letyr=˙y−Dry−Hru.(9.35)Wehave(cid:20)˙xr=Arxr+Bry+Gruyr=Crxr.(9.36)LEMMA292.–Thepair(Cr,Ar)isobservable(resp.,detectable)if,andonlyif,thepair(C,A)hasthesameproperty.PROOF.Wehave(cid:27)sIn−AC(cid:28)=⎡⎣sIn−p−Ar−Br−CrsIp−Dr0Ip⎤⎦∼⎡⎣sIn−p−Ar0Cr00Ip⎤⎦,fromwhichwededucethestatedresultaccordingtoProposition170andTheorem169(section7.2.3),aswellasDeﬁnition185(section7.3).Intherestofthisparagraph,(C,A)isassumedtobeobservable.(i)First,letusassumethatthesignalyrisknown(which,inreality,isnotthecasesinceitsdeﬁnition(9.35)involvesthederivativeofy:seesection2.5.3).Inthiscase,afull-orderobserverforthesystem(9.36)isoftheform(seeequation(9.3))∂ˆxr=Arˆxr+Bry+˜Kr(yr−Crˆxr)+Gru(9.37)where˜Kr∈R(n−p)×pissuchthatAr−˜KrCrwillbeastabilitymatrix.(ii)Whatislefttodonowistoreplaceˆxrbyavariablezthatisgovernedbyadifferentialequationfromwhichthevariableyriseliminatedsoastoavoidthedifferentiationofy.Therefore,letz=ˆxr−˜Kry.Weobtain˙z=(cid:9)Ar−˜KrCr(cid:10)z+(cid:9)Br−˜KrDr+Ar˜Kr−˜KrCr˜Kr(cid:10)y+(cid:9)Gr−˜KrHr(cid:10)u(9.38)Observers277andthereconstructedstateˆxfurnishedbythe“reduced-orderobserver”isˆx=(cid:27)ˆxry(cid:28)=(cid:27)z+˜Kryy(cid:28)=(cid:27)In−p0(cid:28)z+(cid:27)˜KrIp(cid:28)y.(9.39)Let˜x=x−˜xbetheobservationerror.PROPOSITION293.–Wehave˜x(t)→0ast→+∞.PROOF.Wehave˜x=(cid:27)˜xr0(cid:28)with˜xr=xr−ˆxr,andaccordingto(9.36)and(9.37),˜xr(t)→0ast→+∞.REMARK294.–Theobserver(9.38),(9.39)issaidtobe“ofreduced-order”becauseitisofordern−p,whilethe“full-orderobserver”(9.3)isofordern.Whenn=1,onecanshowthattheobserver(9.38),(9.39)is“minimal”,inthesensethattheredoesnotexistanobserveroforderlessthann−1,thepolesofwhichcanbearbitrarilychosen(see[119],section3.8).9.3.2.GeneralformalismWenowproposetoreconstructavectorµ=Mx(whereM∈Rq×nisaleft-regularmatrix).Thecontrolofsystem(9.32)issupposedtobeoftheformu=−LˆµandwewriteK=LM.Remark290remainsvalid.Themostgeneralformpossiblefortheobserveris(cid:20)˙z=Fz+Gy+Huˆµ=Ez+Jywherezisavectorwithrcomponents.278LinearSystemsLetT∈Rr×nbealeft-regularmatrixandξ=z−Tx.Aftersomeelementarycalculations,weobtainthefollowingdifferentialequationfortheclosed-loopsystem:(cid:27)˙x˙ξ(cid:28)=(cid:27)A−BK−BLE0F(cid:28)(cid:27)xξ(cid:28),(9.40)H=TB,(9.41)K=LET+JC,(9.42)GC=TA−FT.(9.43)Equality(9.41)posesnoconstraintonsystem(9.32);thefollowingisclear:PROPOSITION295.–Theclosed-loopsystemisstableifandonlyifA−BKandFarestabilitymatrices,foritspolesaretheelementsofSp(A−BK)˙∪Sp(F).Letusexaminenowunderwhatconditionthefollowingproperty(P)willbetrue:(P):ThesymmetricsetSp(A−BK)˙∪Sp(F)canbearbitrarilychoseninthelefthalf-plane,andequalities(9.42)and(9.43)aresatisﬁed.Thetwocasesconsideredbelowarethefull-orderobserverandthereduced-orderobserver.Caseofafull-orderobserverInthiscase,M=E=T=InandJ=0.WritingG=˜K,equation(9.43)canbewrittenasA−˜KC=F.Asaresult,Property(P)issatisﬁedifandonlyif,system{A,B,C}isminimal.Caseofareduced-orderobserverAssumingthatsystem(9.32)isputintheform(9.34)withC=(cid:25)0n×(n−p)Ip(cid:26),wehaveM=In,T=(cid:25)In−p−˜Kr(cid:26),F=Ar−˜KrCrandE=(cid:27)K0(cid:28),J=K(cid:27)˜KrIp(cid:28).Equalities(9.42)and(9.43)arethussatisﬁed.AccordingtoLemma292(section9.3.1),Property(P)issatisﬁedifandonlyif,{A,B,C}isminimal.REMARK296.–(i)AccordingtoProposition295,the“separationprinciple”(Theorem276,section9.1.2)isstillvalidwhenareduced-orderobserverisused.(ii)ConsidertheRSTcontrollerofsection6.4.5withp=δ0=0(usingthenotationofthecitedparagraph).ThecharacteristicpolynomialAcl(∂)isthenofdegreeObservers2792n−1.Theobtainedcontrollerisjustanotherstatefeedback/observersynthesis(seesection9.1.3)whentheobserverusedisofreduced-order(andis,infact,minimalaccordingtoRemark294ofsection9.3.1).(iii)The“LTRmethod”canbeextendedtothecasewheretheobserverusedisofreduced-order[28].9.4.ExercisesEXERCISE297.–Let{A,B,C}bedeﬁnedasinExercise264(section8.4).(i)Determineafull-orderobserverforthissystem,havingadoublepoleat−5.(ii)Howcanyoujustifythischoice?EXERCISE298.–WeconsiderthesystemoftwotanksasdeﬁnedinExercise266(section8.4).(i)Determineafull-orderobserver(assumingthatthemeasuredvariableisthedischargeofthewaterleavingthesecondtank)thathasadoublepoleat−0.5.(ii)Howcanyoujustifythischoice?EXERCISE299.–Lettherebethestate-spacesystemΣ={A,B,C}whereA=(cid:27)−1210(cid:28),B=(cid:27)10(cid:28),C=(cid:25)1β(cid:26).(i)DeterminethepolesofΣandstudyitsstability.(ii)CalculatethetransferfunctionofΣ,aswellasitstransmissionpolesandzeros,infunctionofβ.(iii)IsΣcontrollable,andforwhichvalue(s)ofβisitnon-observable?(iv)DeterminetheinvariantzerosofΣ.(v)Determineastatefeedbackcontrolu=−Kx+k0r(whereK=(cid:25)k1k2(cid:26)andwhereristhereferencesignal,assumedtobeconstant)havingthefollowingproperties:(a)itplacesthepolesat{−2,−1};(b)intheabsenceofdisturbancesactingontoΣ,theregulationerrore=y−riszeroatsteadystate(zero“staticerror”).(vi)Inwhatfollows,β=1.SupposeaconstantbutunknowndisturbancedisaddingtotheoutputofΣ,insuchawaythattheexpressionofybecomesy=(cid:25)11(cid:26)x+d.(a)WiththecontrolcalculatedatQuestion(v),isthestaticerrorstillzero?(b)IsitpossibletodesignastatefeedbackwithintegralactionforΣ?(c)Ifyes,determinesuchacontrolsothattheclosed-looppolesareplacedat{−2,−1,−1}.(d)Howcanyoujustifythischoice?(vii)Thestateisnon-measured,thuswedecidetodesignafull-orderobserverandcombineitwiththecontrollawobtainedinQuestion(vi).Wealsodecidetoplacetheobserverpolesat{−1,−10}.(a)Howcanyoujustifythischoice?(b)Calculatethegainmatrix˜Kofthisobserver.EXERCISE300.–Lettherebethestate-spacesystemΣ={A,B,C},whereA=(cid:27)1/2−1/2−3/2−1/2(cid:28),B=(cid:27)1−1(cid:28),C=(cid:25)10(cid:26).280LinearSystems(i)Studythecontrollability,observability,andstabilityofthissystem.(ii)Studyitsstabilizability.(iii)Showthat,usingastatefeedbackcontrolu=−Kx,itispossibletoobtainaclosed-loopsystemwhosepolesare{−1,λ},whereλisarbitrarilychosenontherealaxis.Foraﬁxedλ,isthereuniquenessofthesolution?Giveaparameterizationofallsolutionswhenλ=−1(thisvaluewillbemaintainedinwhatfollows).(iv)Weassumefromnowonthatwewillnotmeasurethestatex.Determinethefull-orderobserverwhosepolesare{−1,−10}.(v)Assumingthatonlythesecondcomponentofthestateistobereconstructed,determineaminimalobserverbyjudiciouslychoosingitspole.(vi)Forpoleplacement,isanobserver(evenaminimalone)necessary?EXERCISE301.–ConsideraminimalsystemΣwithtransferfunctionG(s)=1/(cid:15)s2+s−1(cid:16).(i)DetermineforΣtheRSTcontrollerwithintegralaction(section6.3.1)placingallclosed-looppolesats=−1andsuchthatthetransferfunctionbetweenreferencerandoutputyisoforder3,inthefollowingtwocases:(a)δ0=0;(b)δ0=1.(ii)Let{F,G,H,J}betheobservablecanonicalformofΣ.(a)Forthisstate-spacesystem,determinethecontrollawbystatefeedbackandintegralactionthatplacesallclosed-looppolesats=−1.(b)Determinetheminimalobserver(resp.,thefull-orderobserver)whichhasallitspolesats=−1.(c)Thetwostatefeedback/observersyntheseswithintegralactionobtainedintheresponsestoQuestions(ii)(a)and(ii)(b)canbewrittenintheformoftwoRSTcontrollers.Whatarethey?(ComparewiththoseobtainedinQuestion(i).)(iii)Whatisthepossibleﬂawintheabovecontrollers?Howcanyoucorrectit?EXERCISE302.–*Furtherdevelopthetheorydiscussedinsection8.3byconsideringthecasewherethestatexisnotmeasured.SupposethatΣisdeﬁnedby(9.24),whereyisthemeasuredvector,anddenotebyϕ(∂)thepolynomialwithminimaldegreewhichannihilatesthedisturbancesd1andd2aswellasthereferencer.ConsiderthecasewhereΣhasadirectterm,i.e.thesecondequationof(9.24)isy=Cx+Du+d2.*Chapter10Discrete-TimeControl10.1.IntroductionTheprinciplespresentedinChapters5,6,8and9forthedesignofcontrollawsaregeneral,thoughtheyleadto“continuous-time”(alsocalled“analog”)controls.Foralongtime,innumerousbranchesofindustry,implementationofcontrollawshasbeendonethroughcomputers.Theresultingcontrolsarecalled“discrete-time”or“digital”becausethesetofinstantsatwhichthesignalscanbedeliveredtocomputers,andatwhichthosecomputerscandeliverthecontrol,isdiscrete.TheseinstantsareoftheformkT,wherek∈ZandTisarealpositivenumber;theseinstantsarecalledthesamplinginstants,whileTisthesamplingperiod(fs=1/Tandωs=2πfsarethenthesamplingfrequencyandtheangularsamplingfrequency,respectively).Digitalsignalshaveanotherparticularity:theirvalueateachinstantiscodedinaﬁnitenumberofbits.Thiscodingoperationiscalledquantization.Entirebooksaredevotedtodiscrete-timecontrolandsystems,e.g.[4].10.2.Discrete-timesignals10.2.1.DiscretizationofasignalAcontinuous-timesignalwithvaluesinRnisafunctionoftherealvariablex:R→Rn:t(cid:3)→x(t).ThediscretizedsignalatsamplingperiodTisthesequencexdofelementsinRndeﬁnedbyxd(k)=x(kT),k∈Z(sequencesare281Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.282LinearSystemsdenoted,inthischapter,asfunctionsdeﬁnedinZ).1Inreality,asmentionedinsection10.1,thecomponentsofxdarequantized,buttoremainassimpleaspossiblewewillnotdealwiththeproblemofquantization–besides,itsimportancediminishesastheperformanceofcomputersincreases;see[4]onthissubject.Signalxdisadiscrete-timesignal.Itisassumedintherestofthissectionthatn=1,exceptwhenotherwisestated.Itiseasytoextendthetheorytothecasewherencanbeanypositiveintegerbydoingthesamerationaleforeachcomponent.10.2.2.z-transformThe(two-sided)z-transformofadiscrete-timesignalxdisthez-transformofthesequencexd(seesections12.3.5and12.4.4)andisdenotedbyXinwhatfollows.WehaveX(z)=+∞(cid:11)k=−∞xd(k)z−k(10.1)forz∈Cc,whereCcistheannulusofconvergenceofX.10.2.3.SampledsignalLetx:R→Rbeacontinuous-timesignalandletT>0.Thissignal,sampledatperiodT,isx∗=xT(10.2)whereTistheDiraccomb(seesection12.2.3).Denotingdistributionslikefunctions,wethushavex∗(t)=x(t)T(t)=x(t)+∞(cid:12)k=−∞δ(t−kT).IfxbelongstothespaceOMofindeﬁnitelydifferentiablefunctionswhosederivativesofallorders(includingorder0)areslowlyincreasing,weobtainfromexpression(12.20)ofsection12.2.3x∗(t)=+∞(cid:12)k=−∞x(t)δ(t−kT)=+∞(cid:12)k=−∞x(kT)δ(t−kT)=+∞(cid:12)k=−∞xd(k)δ(t−kT).(10.3)1.ThesignalxcanbeonlydeﬁnedinanintervalofR;inthatcase,xdisdeﬁnedinanintervalofZ.Discrete-TimeControl283REMARK303.–Relation(10.3)isexactformoregeneralfunctionsxthanthosebelongingtoOM.SincetheDiracdistributionisameasurewithsupportreducedto{0},itsufﬁcesthatthereexistafunctiony∈OMand,forallk∈Z,aneighborhoodNkofk,suchthatx|Nk=y|Nk.Inthatcase,xd∈s(cid:2),thusx∗∈S(cid:2)(seesection12.3.2).Inwhatfollows,wedenotebyDTthesetofallfunctionsx:R→Rthatsatisfytheabovecondition.ItisimmediatelyclearthatDTisanR-vectorspace,whichwewillcallthespaceof“T-discretizablesignals”.NotallfunctionsbelongingtoDTarecontinuous.Thereexistsalinearbijectionxd˜(cid:3)→x∗,andthatiswhythesetwoquantitiesareoftenidentiﬁed.Anyhow,wewilldistinguishinwhatfollowsthediscretizedsignalxd,whichisaconcreteentity,andthesampledsignalx∗,whichispurelyamathematicalobject,usefulformanycalculations.The(two-sided)Laplacetransformofx∗satisﬁesˆx∗(s)=+∞(cid:12)k=−∞xd(k)(cid:2)+∞−∞δ(t−kT)e−stdt=+∞(cid:12)k=−∞xd(k)e−skTandhenceaccordingto(10.1),ˆx∗(s)=X(cid:15)esT(cid:16),i.e.ˆx∗(s)=X(z),z=esT.(10.4)10.2.4.PoissonsummationformulaLetFbetheFouriertransformandx∈DT.Accordingtoequation(10.2)andthesecondExchangetheorem(seesection12.3.1),wehaveFx∗=12π(Fx)∗(FT)undertheconditionthattheFouriertransformFxbewithcompactsupport.Underthishypothesis,accordingtorelation(12.41)(section12.41),(Fx∗)(ω)=12π(cid:21)(Fx)∗2πTωs(cid:22)(ω)=1T+∞(cid:12)k=−∞(Fx)(ω−kωs).Ontheotherhand,fromequation(10.4),(Fx∗)(ω)=X(cid:15)eiωT(cid:16),andbysubstitutingiω=s,wehavetheequalityX(cid:15)esT(cid:16)=1T+∞(cid:11)k=−∞ˆx(s−ikωs)(10.5)(whereˆxstandsforthebilateralLaplacetransformofx),whichisanexpressionofthePoissonsummationformula.284LinearSystems10.2.5.SamplingtheoremLetx∈DTbea(continuous-time)signalsuchthatFxhasacompactsupportandletωmax=inf{ω≥0:supp(Fx)⊂[−ω,ω]}(wheresuppisthesupport).ThissignalxisdiscretizedattheperiodT=1/fs,andwewritexd(k)=x(kT)(k∈Z).DEFINITION304.–ThefrequencyfN=fs/2andtheangularfrequencyωN=2πfNarecalledtheNyquistfrequencyandtheNyquistangularfrequency,respectively.Wehavethefollowingresult,calledthe“samplingtheorem”orthe“Shannontheorem”.Shannon,indeed,pointedouttheimportanceofthisresultintheproblemofsampling.2THEOREM305.–Asufﬁcientconditionunderwhichwecanreconstructthesignalxfromthediscretizedsignalxdis:ωN>ωmax.PROOF.Inordertomakeitmorereadable,theproofiscarriedoutinawaythatalldistributionsencounteredaretreatedasfunctions.Wehaverelation(10.5),whichcanalsobewrittenasX(cid:15)eiωT(cid:16)=1T+∞(cid:11)k=−∞ˆx[i(ω−kωs)].(10.6)AssumingthatωN>ωmax,wehaveforallω∈[0,ωN],X(cid:15)eiωT(cid:16)=1Tˆx(iω).(10.7)Letthe“normalizedangularfrequency”beθ=ωT.(10.8)The“function”θ(cid:3)→X(cid:15)eiθ(cid:16)istheFouriertransformofthesequencexd∈s(cid:2)(seesection12.3.3).Therefore,knowingxd,weknowX(cid:15)eiωT(cid:16)forallω∈[0,ωN],and2.Accordingtosomeauthors,Cauchyalreadyknewthisresultin1841.Thisisquestionnableand,moreprobably,theﬁrsttodiscoverthisconditionwasWhittakerin1915.Discrete-TimeControl285thusthe“function”ω(cid:3)→ˆx(iω),accordingtoequation(10.7).ThisistheFouriertransformofx,andthereforex∈S(cid:2)isknown(seesection12.3.1).TheelementsofS(cid:2)aredistributions;*sincethedistributiondeﬁnedbyxisknown,thefunctionxisknownalmosteverywhere.*REMARK306.–(i)Apriori,samplingcancausealossofinformation.ThesamplingtheoremshowsthattheconditionωN>ωmax(calledthe“Shannoncondition”)issufﬁcientforalltheinformationcontainedinxtobealsocontainedinxd.(ii)Equality(10.7)istherelationthatexistsbetweenFxdandFx.Usingthenormalizedangularfrequency(10.8),wecanwriteX(cid:15)eiθ(cid:16)=1Tˆx(iω)andX(cid:15)eiθ(cid:16)=(Fxd)(θ),ˆx(iω)=(Fx)(ω)(seesections12.3.3and12.3.4).RememberthatFxdis2π-periodic.Since(Fxd)(−θ)=(Fxd)(θ),Fxdisdeterminedbyitsrestrictionto[0,π]andπisthevalueofθwhenthevalueofωisωN.LetusnowseeinamoreexplicitmannerhowxcanbereconstructedfromxdwhentheShannonconditionissatisﬁed.Letusdeﬁnethe“sinecardinal”function,denotedbysinc,assincϕ=(cid:20)sinϕϕifϕ(cid:5)=01ifϕ=0.TheshapeofthisfunctionisshowninFigure10.1.10.80.40.60.20–0.2–0.4–25–20–15–10–50510152025Figure10.1.Sinecardinalfunction286LinearSystemsPROPOSITION307.–SupposetheShannonconditionissatisﬁed(seeRemark306).Then,wehavetheShannoninterpolationformulax(t)=+∞(cid:11)k=−∞xd(k)sinc[ωN(t−kT)].(10.9)PROOF.TheFouriertransformofxisgivenby(10.7).Byinversetransform(section12.3.1),weobtainx(t)=12π(cid:2)+∞−∞ˆx(iω)eiωtdω=T2π(cid:2)ωN−ωNX(cid:15)eiωT(cid:16)eiωtdω.Accordingto(10.1),wehavex(t)=2ωN+∞(cid:12)k=−∞xd(k)(cid:2)ωN−ωNeiω(t−kT)dωfromwhichwededuce(10.9).REMARK308.–LetusexaminewhatwillhappeniftheShannonconditionisnotsatisﬁed.(i)Supposexisasinusoidalsignal,sampledatperiodT,andwithangularfrequency3ωN/2.Itsspectrumconsistsoftworaysatfrequency−3ωN/2and3ωN/2(seerelation(12.42)ofsection12.3.1).Accordingtoequation(10.6),thedistributionω(cid:3)→X(cid:15)eiωT(cid:16)(denotedlikeafunction,forconvenience)is2ωN-periodic.Therayatangularfrequency−3ωN/2ofthespectrumofxthusgenerates,bythesummationin(10.6),arayatangularfrequencyωN/2.Asaresult,thediscretizedsignalxdisidenticaltowhatwewouldobtainbydiscretization(atthesameperiodT)ofasinusoidalsignalwithangularfrequencyωN/2.Throughtheinterpolationformula(10.9),itisthislastsignalthatwegenerate,insteadofx.(ThisphenomenonwasobservedbyNyquist,andthisisthereasonwhyfN=fs/2iscalledtheNyquistfrequency.)(ii)Takeasecondexamplebyconsideringthecontinuous-timesignalxwhosespectrumisshowninFigure10.2.ThespectrumofthediscretizedsignalxdisshowninFigure10.3whentheShannonconditionissatisﬁed,andinFigure10.4whenitisnot.Sampling,inthislastcase,hasdestroyedtheinformationwhichwascontainedinx,byaphenomenonwecallspectrumaliasing.REMARK309.–Theinterpolationformula(10.9)isnon-causal,becauseinordertocalculatex(t)accordingtothisexpression,onemustknowallthexd(k),includingthoseforwhichkT>t(Figure10.5showsatypicalexampleofreconstructionofsignalxfromthediscretizedsignalxd).Insomeapplications,wherethesignalisprocessedoff-line,thisdoesnotpresentanydifﬁculty,butthecontrolengineer,whoalwayshastoworkinreal-time,doesnothavetheappropriatecrystalball.Itisthereforenecessarytomakeacausalapproximationofformula(10.9);suchanapproximationisonlyvalidifωN≥λωmax,whereλ>1.Afactorλ=5or10iscommonlyused.Discrete-TimeControl287maxmaxixˆFigure10.2.Spectrumofthecontinuous-timesignalNNTieXFigure10.3.Spectrumofthediscretizedsignal(Shannonconditionsatisﬁed)NNTieXFigure10.4.Spectrumofthediscretizedsignal(spectrumaliasing)288LinearSystemsFigure10.5.Shannoninterpolation10.2.6.HoldAholdprovidingasolutiontotheproblemwasbroughtupinRemark309(section10.2.5),i.e.thenon-causalnatureoftheinterpolationformula(10.9).Onewaytoapproximatelyreconstructasignalxwhichhasbeendiscretizedistoholditsvalueovereachsamplingperiod.Thisholdoperationisobviouslycausalandconsistsofanextrapolation.Aholdofordern(n≥0)makesitpossibletodetermineanestimateofx(t),t∈[kT,(k+1)T),fromthevaluesxd(k),...,xd(k−n).Zero-orderholdThezero-orderhold(Z.O.H.)isthemostcommonlyusedbecauseitrequirestheleastcalculations.Letxdbeadiscretizedsignal(xd(k)=x(kT)).The“sampled-and-heldsignal”(withZ.O.H.)isdeﬁnedbyxh0(t)=xd(k),t∈[kT,(k+1)T).Thefunctionxh0isastaircasefunction(suchafunctionisdiscontinuousingeneral).Supposexisdifferentiable;thenaccordingtothemeanvalueformula,|x(t)−xh0(t)|≤Tsupt|˙x(t)|andhencetheinterpolationerrorissmallifxvariessufﬁcientlyslowly.First-orderholdThesampled-and-heldsignalwithaﬁrst-orderholdisdeﬁnedbyxh1(t)=xd(k)+t−kTT(xd(k)−xd(k−1)),t∈[kT,(k+1)T).Notethatxh1isacontinuousfunction.Discrete-TimeControl289Txx*H(s) hxZ.O.H Figure10.6.Sample-and-holdTransferfunctionofzero-orderholdIneverythingthatfollows,welimitourselvestothecaseofazero-orderhold.Thesampled-and-heldsignalxh0isdenotedbyxh.ItsLaplacetransformisgivenbyˆxh(s)=(cid:2)+∞−∞xh(t)e−stdt=+∞(cid:12)k=−∞x(kT)(cid:2)(k+1)TkTe−stdt.Theintegralontheright-handsideisequaltoe−skTH(s),whereH(s)=1−e−sTs.(10.10)Wethusobtainˆxh(s)=+∞(cid:11)k=−∞x(kT)e−skTH(s),andwealsohaveˆxh(s)=ˆx∗(s)H(s).(10.11)ThetransferfunctionH(s)isthusthatofthezero-orderholdandthesignalxhcanberepresentedasinFigure10.6;itissaidtobeobtainedfromxbymeansofasample-and-hold.10.3.Discrete-timesystems10.3.1.GeneraldescriptionLetΣbeacontinuous-timesystemwithtransfermatrixG(s);Σisassumedtobelineartime-invariantthroughoutthischapter.BydiscretizingtheoutputyofΣatsamplingperiodT,weobtainthediscrete-timesignalyd.Thissignalcanthenbeprocessedbyacalculatorinordertogenerateadiscrete-timecontrolud.Thiscontrolsignalcanbeconverted,usingaZ.O.H.,intoacontinuous-timesignaluh(notethatuh:t(cid:3)→uh(t)isnotacontinuousfunction).Thefeedbackby“discrete-timecontrol”isachievedbyusingthissignaluhasinputtoΣ.290LinearSystemstytuhkudkydDAC+ZOHG(s) ADCFigure10.7.DiscretizedsystemItisthennecessarytoconvertydintoanormalizedsignal,whosecomponentsvarybetween−10Vand+10V,forexample;thecombinationofthediscretizationandthisnormalizationiscalledtheanalog-to-digitalconversion(ADC).Ontheotherhand,thesignaludmustbeheld,andthenampliﬁed.Adigital-to-analog(DAC)conversionisthusnecessary.WethusarriveatthediagramofthediscretizedsystemΣd,withinputudandoutputyd,asrepresentedinFigure10.7.ThesystemΣdisalineartime-invariantdiscrete-timesystem.Itadmitsastate-spacerepresentation(theproofofTheorem129ofsection7.1.2extendstothecaseofdiscrete-timesystemswithoutdifﬁculty–see[15]or[22]formoredetails)and,asaresult,atransfermatrixF(z).Asaﬁrststep,wearegoingtoshowhowtodetermineF(z)fromG(s),andthenwewillshowhowtodetermineastate-spacerepresentationofΣdfromthatofΣ.REMARK310.–ThediscretizedoutputydisonlyrepresentativeoftheoutputyiftheShannonconditionissatisﬁed(seeTheorem305).Asaresult,itisessentialtoincorporatealow-passﬁlterwithlowercutofffrequencyωNintoΣ,attheoutputofthissystem.Thisﬁlteriscalledan“anti-aliasingﬁlter”,sinceitspurposeistoavoidspectrumaliasing(seesection10.2.5,Remark308).10.3.2.SampledsystemThenotionofthesampledsystem(aswewillrefertointhistext)ispurelyabstract,aswellasthatofasampledsignal.ButitisusefultocalculateF(z)asdiscussedabove.SupposeΣ0isacontinuous-timesystem,withtransfermatrixˆf(s),receivingasampled-signalu∗(t)(withperiodT)atitsinput.Theoutputy(t)ofthissystemissampledatperiodTanditresultsinasampledoutputy∗(t)(seeFigure10.8).Discrete-TimeControl291Tuu*F(s)Tyy*Figure10.8.SampledsystemLetf(t)=L−1(cid:7)ˆf(s)(cid:8)betheimpulseresponseofΣ0(seesection2.5.2).Assumingthattheinitialconditionsarezero,theoutputyisgivenbyy=f∗u∗=f∗(Tu)andthesampledoutputy∗thussatisﬁesy∗=Tf∗(Tu)=f∗∗u∗,(thesecalculationsarevalidifbothfandubelongtoDT∩S(cid:2)(Γ),whereΓisanon-emptyintervalofR:seesections12.3.4and10.2.3).AccordingtotheExchangetheorem,wethushaveˆy∗(s)=ˆf∗(s)ˆu∗(s)andasaconsequenceof(10.4),Y(z)=F(z)U(z)(10.12)whereY(z),U(z),andF(z)arethez-transformsofthesequences(yd(k)),(ud(k)),and(fd(k)),respectively.10.3.3.DiscretizedsystemConsiderthesysteminFigure10.8,withinputud=(ud(k))andoutputyd=(yd(k)).Thisisadiscrete-timesystem,butitcannotbeconsideredadiscretizedsystemyet(accordingtothedeﬁnitiongiveninsection10.3.1),becausetheinputofthecontinuous-timesystemΣ0doesnotreceiveasampled-and-heldsignal.WecandecomposethesystemΣd,resultingfromthediscretizationofΣatperiodT,accordingtothediagraminFigure10.9.Thediscrete-timesignalud=(ud(k)),representedbythesampledsignalu∗accordingto(10.3),isnowheldbeforeenteringΣ.ThesysteminFigure10.9isidenticaltotheoneinFigure10.8whenˆf(s)=G(s)H(s).Wededucethefollowingtheorem:292LinearSystemsu*TTy*H(s) G(s) Z.O.H sfˆFigure10.9.DiscretizedsystemTHEOREM311.–ThetransfermatrixGd(z)ofthediscretizedsystemΣdcanbeexpressedasafunctionofthetransfermatrixG(s)ofthecontinuous-timesystemΣbytherelationGd(z)=(cid:15)1−z−1(cid:16)Z(cid:23)L−1(cid:7)G(s)s(cid:8)(cid:24).(10.13)PROOF.Accordingto(10.12),Y(z)=Gd(z)U(z),whereGd(z)=Z[f(t)],3f(t)=L−1{G(s)H(s)}=L−1(cid:7)G(s)1−e−sTs(cid:8).Leth(t)=L−1(cid:7)G(s)s(cid:8).Then,f(t)=h(t)−h(t−kT),andhenceGd(z)=(cid:15)1−z−1(cid:16)H(z).SomeexamplesoftransferfunctionsofdiscretizedsystemsaregiveninTable(10.14).G(s)Gd(z)1sTz−11s2T2(z+1)2(z−1)2e−Tsz−1as+a1−e−aTz−e−aT(10.14)EXAMPLE312.–ConsiderthethirdrowofTable(10.14).SinceG(s)=1s2(doubleintegrator),Gd(z)=(cid:15)1−z−1(cid:16)Z(cid:25)L−1(cid:31)1s3 (cid:26).Accordingtorelation(12.83)ofsection12.4.4,h(t)=L−1(cid:20)1s3&=t221(t).3.Weslightlyabusethelanguagehere.Moreprecisely,oneshouldwriteGd(z)=Z[fd(k)]=Z[f(kT)].Discrete-TimeControl293Asaresult,hd(k)=h(kT)=T22k21(k),andaccordingtotable(12.64)ofsection12.3.5,Z(cid:25)L−1k21(k)(cid:26)=z(z+1)z−1.Finally,Gd(z)=T2(z+1)2(z−1)2.10.3.4.State-spacerepresentationofadiscrete-timesystemDiscretizationofastate-spacesystemLettherebeacontinuous-timesystem{A,B,C,D}:(cid:20)˙x=Ax+Buy=Cx+Du.Iftheinputuofthissystemisasampled-and-heldsignal(withZ.O.H.),wehaveu(t)=ud(k),t∈[kT,(k+1)T).TheintegrationofthestateequationbetweentheinstantskTand(k+1)Tprovides,accordingtorelation(12.112)ofsection12.5.2,xd(k+1)=eATxd(k)+(cid:2)(k+1)TkTeA[(k+1)T−t]Bu(t)dt=eATxd(k)+(cid:2)(k+1)TkTeA[(k+1)T−t]dtBud(k)wherexd(k)=x(kT).Puttingyd(k)=y(kT)andAd=eAT,Bd=(cid:2)T0eAtBdt(10.15)weobtain(changingtto(k+1)T−tintheintegral)(cid:20)xd(k+1)=Adxd(k)+Bdud(k)yd(k)=Cxd(k)+Dud(k).(10.16)State-spacerepresentationofadiscrete-timesystemAdiscrete-timesystemsuchasequation(10.16)isnotalwaysobtainedbydiscretizationofacontinuous-timesystem.Usingtheshift-forwardoperatorq(seesection12.3.5),equation(10.16)iswrittenas(cid:20)qxd=Adxd+Bdudyd=Cxd+Dud.(10.17)294LinearSystemsEquations(10.17)constituteastate-spacerepresentationofacausaldiscrete-timesystem.Fromapurelyformalpointofview,theseequationshavethesamestructureasequations(7.4)ofsection7.1.2:weonlyneedtoreplacethedifferentialoperator∂bytheshift-forwardoperatorq.Theterminologyintroducedinsection7.1.2(statematrix,controlmatrix,etc.)isthereforemaintained.Anotnecessarilycausaldiscrete-timesystemhasastate-spacerepresentationoftheform(cid:20)qxd=Adxd+Bdudyd=Cxd+Wd(q)ud(10.18)whereWd(q)isapolynomialmatrix.Thissystemiscausalifandonlyif,Wd(q)isaconstantmatrixD(possiblyzero),i.e.ifthefuturevaluesoftheinputhavenoinﬂuenceonthepresentoutput.Thecontrolengineeronlyhastodowithcausalsystems(seesection10.2.5,Remark309).System(10.18)issaidtobestrictlycausalifWd(q)=0.Thismeansthatthesysteminputhasnoimmediateinﬂuenceontheoutput.Thenotionsofcausalsystemandstrictlycausalsystem,relativetodiscrete-timesystems,correspondtothenotionsofpropersystemandstrictlypropersystem,relativetocontinuous-timesystems(seesection2.5.3).4Usingthenotionoftransfermatrix,weareledtothefollowing:DEFINITION313.–Adiscrete-timesystemΣdissaidtobecausal(resp.,strictlycausal,bicausal)ifitstransfermatrixG(z)isproper(resp.,strictlyproper,biproper).(Seesection13.6.1.)REMARK314.–Itisalsopossible,andtosomeextentpreferable,torepresentadiscrete-timesystemusingtheoperatorδ=q−1T(10.19)(whereTisthesamplingperiodifthesystemconsideredisadiscretizedsystemandwhereTisanyrealnumber>0–forexample,T=1–otherwise)becauseδis,like∂=ddt,a“differentialoperator”.Thisremarkonlyhasfullsigniﬁcanceintheframeworkoflineartime-varyingsystems:see[15]or[22](whereT=1).Usingthisoperator,adiscrete-timesystemadmitsastate-spacerepresentation(cid:20)δxd=˜Adxd+˜Bdudyd=Cxd+˜Wd(δ)ud4.Thisisthereasonwhysomeauthorscallcausal(resp.,strictlycausal)acontinuous-timesystemwhich,intheterminologyofthisbook,iscalledproper(resp.,strictlyproper).Weshouldavoidthisabuseoflanguageinouropinion.Forgeneralconsiderationsoncausality,see[41].Discrete-TimeControl295where˜Ad=Ad−InT,˜Bd=BdT.Suchasystemiscausal(resp.,strictlycausal)ifandonlyif,˜Wd(δ)=D(resp.,˜Wd(δ)=0).CalculationsLetusconsideradiscretizedsystemandseehowonecan,inpractice,calculatethematricesAdandBddeﬁnedbyequation(10.15).ThematrixAdisanexponentialmatrixandthuscanbecalculatedbyoneofthemethodsdiscussedinsection12.5.2.ThesamemethodsmakeitpossibletocalculateΨ=(cid:2)T0eAτdτ=InT+AT22+A2T33!+...andwethenhaveAd=In+AΨ,Bd=ΨB.IntheparticularcasewhereAisinvertible,Ψ=A−1(Ad−In)andwethushaveBd=A−1(Ad−In)B.Inthegeneralcase,letΦ(t)=eAtandΓ(t)=Ψ(t)B.Wehaveddt(cid:21)Φ(t)Γ(t)0Im(cid:22)=(cid:21)Φ(t)Γ(t)0Im(cid:22)(cid:21)AB00(cid:22),andhence(cid:21)AdBd0Im(cid:22)=exp(cid:20)(cid:21)AB00(cid:22)T&.(10.20)Equality(10.20)hastheadvantageofexpressingverysyntheticallytherelationthatexistsbetweenthestateandcontrolmatricesofthediscretizedsystemandthoseofthecontinuous-timesystem,butitdoesnotgenerallyconstitutethemosteconomicwaytomakecalculations.10.3.5.CalculationofthestateofadiscretizedsystemConsidertheﬁrstequationofequation(10.16).Lettherebeaninitialconditionxd(0)=x0.296LinearSystemsWehavexd(1)=Adx0+Bdud(0),xd(2)=Adxd(1)+Bdud(1)=A2dx0+(cid:25)BdAdBd(cid:26)(cid:27)ud(1)ud(0)(cid:28)andbyinduction,weeasilyestablishthatxd(k)=Akdx0+(cid:25)BdAdBd...Ak−1dBd(cid:26)⎡⎢⎢⎢⎣ud(k−1)...ud(1)ud(0)⎤⎥⎥⎥⎦.(10.21)10.4.Structuralpropertiesofdiscrete-timesystems10.4.1.PolesandzerosThedeﬁnitionsofthevariouskindsofpolesandzerosofdiscrete-timesystemsareidenticaltothoseofcontinuous-timesystems.5Letusrecallsomeoftheessentialpointsregardingdiscrete-timesystemsinstate-spaceforms:–ThepolesofthesystemΣddescribedby(10.18)aretheeigenvaluesofAd,andtheorderofΣdisequaltothenumberofitspoles(seesection2.3.7).ThesepolesarealsotheSmithzerosofthematrixzIn−Ad,andthisobservationallowsonetodeﬁnetheirstructuralindices,theirorders,andtheirdegrees(seesection13.2.5).–TheinvariantzerosofΣdaretheSmithzerosofthe“Rosenbrockmatrix”(cid:27)zIn−Ad−BdCWd(z)(cid:28).–Thetransmissionpoles(resp.,zeros)ofΣdaretheMacMillanpoles(resp.,zeros)ofthetransfermatrixGd(z)=C(zIn−Ad)−1Bd+Wd(z)(seesections2.4.2,2.4.4and2.4.5).–Thenon-controllablemodes(alsocalledtheinput-decouplingzeros,i.d.z.s)ofΣdaretheSmithzerosof(cid:25)zIn−Ad−Bd(cid:26)5.Aunitarydeﬁnitionofpolesandzerosofcontinuous-timeanddiscrete-timesystems(possiblytime-varying)hasbeengivenin[15]and[22]usingmoduletheory.Discrete-TimeControl297anditsnon-observablepoles(alsocalleditsoutput-decouplingzeros,o.d.z.s)aretheSmithzerosof(cid:27)zIn−AdC(cid:28)(seesections7.2.2and7.2.3).–Thehiddenmodescanbedeterminedby{hiddenmodes}={systempoles}(cid:2){transmissionpoles}(seesection7.2.6,Theorem179(i))andaccordingtoCorollary176ofsection7.2.5wecandeterminetheinput–outputdecouplingzeros(i.o.d.z.)by{i.o.d.z.}={i.d.z.}˙∪{o.d.z.}(cid:2){hiddenmodes}.–TheblockingzerosofΣd(ifany)arethecomplexnumberszsuchthatGd(z)=0(seesection2.4.4,Deﬁnition27)whilethezerosofΣdremaindeﬁnedaccordingtoDeﬁnition178(section7.2.6).Inwhatfollows,thediscrete-timesystemΣdisassumedtobecausal,deﬁned(exceptwhenotherwisestated)byastate-spacerepresentationsuchasthatofequation(10.17),andisdenotedby{Ad,Bd,C,D}(or{Ad,Bd,C}ifD=0).10.4.2.ControllabilityControllabilityofadiscretetimestate-spacesystemDEFINITION315.–Adiscretetimesystem{Ad,Bd,C,D}iscontrollable(resp.,0-controllable)ifthereexistsacontrolsequencethatallowsonetotransferitsstatexdfromanyinitialvaluexd(0)toanyﬁnalvaluex∗d(resp.,totheorigin)inﬁnitetime.REMARK316.–Numerousauthorscallreachability(resp.,controllability)thenotioncalledcontrollability(resp.,0-controllability)above:see[64]forexample.Weusehereagaintheterminologyadoptedin[22]inordertobetterrevealtheunitybetweencontinuous-timeanddiscrete-time.THEOREM317.–(i)ThesystemΣd={Ad,Bd,C,D}iscontrollableif,andonlyif,rkΓ=n,wherenistheorderofΣdandwhereΓdisthecontrollabilitymatrixΓd=(cid:25)BdAdBd...An−1dBd(cid:26)(10.22)(“Kalmancriterionforcontrollability”).(ii)Σdis0-controllableif,andonlyif,imAnd⊂imΓd.66.Withaslightabuseoflanguage:thesesymbolsdenotetheimagesofthelinearmappingsrepresentedbythematricesΓdandAndinthecanonicalbases.298LinearSystemsPROOF.(i)Accordingto(10.21),Σdiscontrollableifandonlyif,thereexistsanintegerNsuchthatrkΓdN=n,whereΓdN=(cid:25)BdAdBd...AN−1dBd(cid:26).Now,accordingtotheCayley–Hamiltontheorem(section13.3.4,Theorem537),rkΓdN=rkΓdnforanyN≥n,sinceAndisalinearcombinationwithrealcoefﬁcientsofIn,Ad,...,An−1d.(ii)IfrkAnd⊂rkΓd,foranyxd(0)∈Rn,thereexistsaﬁnitesequence(u(k))0≤k≤nsuchthatAndxd(0)+Γd⎡⎢⎣u(n−1)...u(0)⎤⎥⎦=0,andhenceΣdis0-controllable.TheconversealsoholdsaccordingtotheCayley–Hamiltontheorem.PROPOSITION318.–Thefollowingtwoconditionsareequivalent:(a)imAnd⊂imΓd;(b)foranyrowvT=(cid:25)v1...vn(cid:26),ifvTAidBd=0,0≤i≤n−1,thenvTAnd=0.PROOF.Condition(a)meansthatforanyx∈imAnd,x∈imΓ.Now,wehavevTAidBd=0,0≤i≤n−1,ifandonlyif,foranyx∈imΓ,vTx=0.Also,wehavevTAnd=0ifandonlyif,foranyx∈imAnd,vTx=0,fromwhichwearriveattheequivalenceasstated.*Intrinsicdeﬁnitionsofcontrollabilityand0-controllabilityDeﬁnition315is,ofcourse,onlyvalidforadiscrete-timesysteminstate-spaceform.Moregenerally,adiscrete-timesystemΣdcanbedeﬁnedasaﬁnitelypresentedR-moduleofM,whereR=R[q](seesection2.2.5,Remark8).Wearethusledtothefollowingdeﬁnition,inwhichtheinputofΣd,itsoutput,andthewayitisrepresented(state-spaceform,Rosenbrockrepresentation,etc.)donotplayanyrole.DEFINITION319.–ThesystemΣdiscontrollableifthemoduleMisfree(or,inanequivalentmanner,torsion-free,sinceRisaprincipalidealdomain).InthecasewhereΣdisastate-spacesystem,Deﬁnitions319and315areequivalent,accordingtoTheorem317.Indeed,alltheproofsofsection7.1.3canbetransposedtothecaseofdiscrete-timesystems.Thecanonicaldecompositionaccordingtocontrollability,andTheorem165ofsection7.2.2(i.e.Σdiscontrollableifandonlyif,ithasnoi.d.z.)remainvalid.REMARK320.–ThestatementofTheorem129(section7.1.2)remainsvalidmutatismutandis:alldiscrete-timecontrolsystemsadmitastate-spacerepresentation(oftheformofequation(10.18)).Discrete-TimeControl299LettherebethemultiplicativesetS={qn,n≥0}andletA=S−1Rbetheringconsistingofallelementsoftheformr/qn,r∈R,n≥07;inaddition,let˘MbetheA-moduleA⊗RMconsistingofallelementsoftheformm/qn,m∈M,n≥0(seesection13.6.5).Considerthefollowingdeﬁnitionof0-controllability,whichisintrinsiclikeDeﬁnition319ofcontrollability:DEFINITION321.–ThesystemΣdis0-controllableiftheA-module˘Misfree.REMARK322.–TheringAisaprincipalidealdomainandsoisR,andhencethemodule˘Misfreeif,andonlyif,itistorsion-free(seeCorollary555ofsection13.4.2).PROPOSITION323.–Foradiscrete-timestate-spacesystemΣd={Ad,Bd,C,D},Deﬁnitions315and321of0-controllabilityareequivalent.PROOF.TheA-module˘Misfreeif,andonlyif,thematrix(cid:25)In−q−1Adq−1Bd(cid:26)(whichisapresentationmatrixof˘M)isright-invertible(seetheproofofTheorem141insection7.1.3).Thisconditionmeansthatif˘vT=(cid:25)˘v1...˘vn(cid:26)isarowofelementsofarightA-module,theequality˘vT(cid:25)In−q−1Adq−1Bd(cid:26)=0implies˘vT=0.Theﬁrstoftheseequalitiesisequivalentto(a)˘vT=˘vTq−1Adand(b)˘vTq−1Bd=0.Right-multiplying(a)byq−1,weobtain˘vTq−1=˘vTq−2Ad,andhence˘vTq−2AdBd=0accordingto(b).Thislastequality,inturn,implies˘vTq−3A2dBd=0,etc.Foranyi∈{0,...,n−1},wecanright-multiplytheequality˘vTq−i−1AidBd=0byqi+1and(sinceqisaninvertibleelementofA)thisequalityisequivalentto˘vTAidBd=0.Theequality˘vT(cid:25)In−q−1Adq−1Bd(cid:26)=0isthusequivalentto˘vTAidBd=0,0≤i≤n−1.Asaresult,ifimAnd⊂imΓ,wehave˘vTAnd=0accordingtoProposition318,andhencefrom(a),wehave˘vT=0,and˘Misfree.Conversely,if˘Misfree,theequalities˘vTAidBd=0,0≤i≤n−1,imply˘vT=0,andhenceimAnd⊂imΓ.FromDeﬁnitions319and321,the“Popov–Belevitch–Hautustestforcontrollability(resp.,0-controllability)”isstatedasfollows:PROPOSITION324.–Thediscrete-timestate-spacesystemΣd={Ad,Bd,C,D}iscontrollable(resp.,0-controllable)if,andonlyif,rkC(cid:25)zIn−AdBd(cid:26)=nforanycomplexnumberz(resp.,foranycomplexnumberz(cid:5)=0).ControllabilityanddiscretizationLetΣbeacontinuous-timecontrolsystem,theinputofwhichisanindependentvariablewithmcomponents(seesection2.3.1),discretizedatasamplingperiodofT.LetΣdbethediscretizedsystem.7.*TheringAistheringofLaurentpolynomialsinqandisdenotedbyR(cid:25)q,q−1(cid:26).*300LinearSystemsTHEOREM325.–ForΣdtobecontrollable,itisnecessarythatΣbecontrollable,anditissufﬁcientthatΣbecontrollableandhasnopolesλ1,λ2suchthatλ1−λ2=2πki/T,wherekisanynon-zerointegerandi=√−1.PROOF.(A)Preliminarycalculations.AccordingtoTheorem129(section7.1.2),wecanassumethatΣisastate-spacesystem{A,B,C,D}.Letε(s)=esT,ψ(s)=(cid:2)T0estdtwhicharetwoentirefunctions(seesection12.4.2).Accordingtoequation(10.15),wehaveAd=ε(A),Bd=ψ(A)B.Wegetψ(s)=(cid:15)esT−1(cid:16)/sfors(cid:5)=0andψ(s)=Tfors=0,andhenceψ(s)=0ifandonlyif,esT=1withs(cid:5)=0,i.e.s=2πki/Twherekisanon-zerointeger.Ontheotherhand,ε(s1)=ε(s2)ifandonlyif,s1−s2=2πki/T,wherekisaninteger.Thepair(A,B)isnon-controllableifandonlyif,thereexistsv∈Cn(cid:2){0}andλ∈Csuchthat(a)vTA=vTλ;(b)vTB=0(seesection7.6,Exercise222).Likewise,(Ad,Bd)isnon-controllableifandonlyif,thereexistsv∈Cn(cid:2){0}andλ∈Csuchthat(c)vTAd=vTeλT;(d)vTBd=0.AssumingthatCondition(a)holds,vTε(A)=vTε(λ)andvTψ(A)=vTψ(λ)(seesection12.4.2,Proposition439).Asaresult,vTAd=vTeλTandvTBd=vTψ(A)B=vTψ(λ)B=ψ(λ)vTB.Inaddition,assumingthatCondition(c)holds,vTeAT=vTeλT,i.e.vTe(A−αIn)T=vTe(λ−α)T,whereα>max{Reβ:β∈Sp(A)}.AccordingtoPropositions439and441(section12.4.2),thisisequivalenttovTA=vT(λ+2πki/T),wherekisaninteger.(B)Proofbycontradiction.Lettherebeconditions(i),(ii)and(iii)below:(i)Σdiscontrollable;(ii)Σiscontrollable;(iii)Σhasnopolesλ1,λ2suchthatλ1−λ2=2πki/T,k(cid:5)=0.1)Supposethat(ii)doesnothold,andletv(cid:5)=0,λ∈Cbesuchthat(a)and(b)hold.Then,vTAd=vTε(λ)andvTBd=vTBψ(λ)=0,andhencewehave(c)and(d)anditfollowsthat(i)doesnothold.2)Suppose(i)doesnothold.AlleigenvaluesofAdareoftheformeλT,whereλisaneigenvalueofA.Thus,letλbeaneigenvalueofAandv(cid:5)=0besuchthat(c)and(d)hold.AccordingDiscrete-TimeControl301to(c),vTA=vT(λ+2πki/T),i.e.λ+2πki/TisaneigenvalueofAandvTisanassociatedleft-eigenvector.Asaresult,either(iii)doesnotholdork=0.Supposek=0;accordingto(d),vTBd=vTBψ(λ)=0,andhencevTB=0orψ(λ)=0.Intheﬁrstcase,(ii)doesnothold;inthesecond,λ=2πli/T,l(cid:5)=0,and(iii)doesnothold.3)Suppose(iii)doesnotholdandm=1.TherethusexistvT1andvT2suchthatvTjA=λjvTj(j=1,2)withλ1−λ2=2πki/T,k(cid:5)=0.Therefore,vT1(cid:5)=vT2accordingto(13.29)(seesection13.3.3),andeλ1T=eλ2T(cid:1)µ,fromwhichvTjAd=µvTj(j=1,2).Asaresult,theeigenvalueµofAdhasgeometricmultiplicityatleast2andrk(cid:25)µIn−AdBd(cid:26)≤n−2+m<n,thus(i)doesnothold.Weobservethatifλ=πki/T(k∈Z(cid:2){0})isaneigenvalueofA,sois¯λ,andλ−¯λ=2πki/T.Wededucethefollowing:Letωmax>0andletEωmaxbethesetofallcontrollablecontinuous-timesystems,thepolesofwhichhaveanimaginarypart≤ωmax.LetDωmaxbethesetofsystemsobtainedbydiscretizationatsamplingfrequencyfsofallsystemsbelongingtoEωmax;letωs=2πfsandωN=ωs/2.Theresultbelow,whichisapplicabletosystems,isaconsequenceofTheorem325andisanalogoustothesamplingtheorem(section10.2.5,Theorem305),whichisapplicabletosignals:COROLLARY326.–AnecessaryandsufﬁcientconditionforallsuchsystemsbelongingtoDωmaxtobecontrollableisωN>ωmax.10.4.3.ObservabilityObservabilityofadiscrete-timestate-spacesystemThe“behavioral”deﬁnitionofobservabilityofadiscrete-timesystemisasfollows:DEFINITION327.–Adiscrete-timestate-spacesystemΣd={Ad,Bd,C,D}isobservable(resp.,0-observable)if,fromitsinputsandoutputsud(k)andyd(k),k∈{0,...,N−1},forasufﬁcientlylargeN,wecandeterminethestatexd(0)(resp.,xd(N)).THEOREM328.–Lettherebethe“observabilitymatrix”Ωd=(cid:23)CTATdCT...(cid:15)ATd(cid:16)n−1CT(cid:24)TwherenistheorderofΣd.(i)SystemΣdisobservableif,andonlyif,rkΩd=n(“Kalmancriterionforobservability”).(ii)Σdis0-observableif,andonlyif,kerΩd⊂kerAnd.88.Withthesameabuseoflanguageaspreviouslymentioned.302LinearSystemsPROOF.Accordingtoexpression(10.21)ofsection10.3.5,wehaveyd(k)=CAkdx0+(cid:25)BdAdBd...Ak−1dBd(cid:26)⎡⎢⎢⎢⎣ud(k−1)...ud(1)ud(0)⎤⎥⎥⎥⎦+Dud(0).Bywritingtheseequalitiesfromk=0tok=κ−1(κ≥1),wethusobtainanexpressionoftheform⎡⎢⎢⎢⎣yd(0)yd(1)...yd(κ−1)⎤⎥⎥⎥⎦=Ωdκx0+Tκ⎡⎢⎢⎢⎣ud(0)ud(1)...ud(κ−1)⎤⎥⎥⎥⎦(10.23)whereΩdκ=⎡⎢⎢⎢⎣CCAd...CAκ−1d⎤⎥⎥⎥⎦.AccordingtotheCayley–Hamiltontheorem,rkΩdN=rkΩdnforanyN≥n,andhencewecanrestricttothecaseκ=N=n.LetΩd=Ωdn.(1)Accordingtoequation(10.23),wecandeterminex0asafunctionofud(k)andyd(k),k∈{0,...,n−1},ifandonlyif,Ωdisleft-invertible,i.e.ofrankn.(2)Accordingto(10.21),xd(n)isdeterminedinauniquemannerasafunctionofud(k)andyd(k),k∈{0,...,n−1}ifandonlyif,Andx0isdeterminedinauniquemannerasafunctionofthesamequantities.IfkerΩdisnotincludedinkerAnd,thereexistx0andx(cid:2)0suchthatx0−x(cid:2)0∈kerΩdandx0−x(cid:2)0/∈kerAnd.WethushaveΩdx0=Ωdx(cid:2)0andAndx0(cid:5)=Andx(cid:2)0,andthereforeud(k)andyd(k),k∈{0,...,n−1},donotallowonetodetermineAndx0,andΣdisnot0-observable.Conversely,supposekerΩd⊂kerAnd.Letf:x(cid:3)→Andxandlet¯fbethelinearmappinginducedbyfonRn/kerΩd(seesection13.3.2,Remark518).Wehave¯f(¯x0)=Andx0,where¯x0=x0+kerΩd,andhenceΣdis0-observable.*Intrinsicdeﬁnitionsofobservabilityand0-observabilitySupposenowthatthediscrete-timecontrolsystemΣdischaracterizedbyaﬁnitelypresentedR-moduleM(withR=R[q]),andthatΣdhasinputudandoutputyd(seesection7.1.1).Usinganapproachsimilartothatfollowedinsection10.4.2(andpreservingthenotationintroducedinthissection),weareledtothefollowingdeﬁnition,whichgeneralizesDeﬁnition327:DEFINITION329.–SystemΣdisobservable(resp.,0-observable)ifM=[yd,ud]R(resp.,A⊗RM=A⊗R[yd,ud]R).Discrete-TimeControl303Popov–Belevitch–HautustestWededuceimmediatelyfromDeﬁnition329thefollowingcriterion(“Popov–Belevitch–Hautustest”):PROPOSITION330.–Thediscrete-timestate-spacesystemΣd={Ad,Bd,C,D}isobservable(resp.,0-observable)ifandonlyif,rkC(cid:25)zIn−ATdCT(cid:26)=nforanycomplexnumberz(resp.,foranycomplexnumberz(cid:5)=0).COROLLARY331.–Adiscrete-timesystemΣdisobservable(resp.,0-observable)ifandonlyif,ithasnoo.d.z.(resp.,ifallitso.d.z.s–ifany–arezero).ObservabilityanddiscretizationTheorem325canbetransposedwithoutdifﬁcultytothecaseoflossofobservabilityduetodiscretization.Thedetailsarelefttothereader.EXAMPLE332.–Lettherebeaminimalcontinuous-timesystemwithtransferfunctionπ2s2+π2+1s+1.A“natural”state-spacerepresentationofthissystemis{A,B,C}withA=⎡⎣−10000−π2010⎤⎦,B=⎡⎣110⎤⎦C=(cid:25)10π2(cid:26).Ifthisstate-spacesystemisdiscretizedatperiodT=2,weobtainthediscrete-timesystem{Ad,Bd,C}whereAd=⎡⎣e−200010001⎤⎦,Bd=⎡⎣1−e−200⎤⎦(asuitablemethodforcalculatingAdistheuseoftheinverseLaplacetransform–seesection12.5.2–andwecanalsocalculateBdusingthesecondequalityofequation(10.15).System{Ad,Bd,C}isneithercontrollablenorobservable(therankofitscontrollabilitymatrixis1andthatofitsobservabilitymatrixis2).Thestepresponseofthecontinuous-timesystem(–)andtheinterpolatedoneofthediscretizedsystem(--)arerepresentedinFigure10.10.304LinearSystemsFigure10.10.Stepresponses10.4.4.RosenbrockrepresentationTheRosenbrockrepresentation,and,inparticular,theleftandrightforms,detailedinsection2.3.5forcontinuous-timesystems,areidenticalinthecaseofdiscrete-timesystems,replacingthe∂operatorbytheqoperator(see[15]or[22]).Aleftformisalwaysobservablewhilearightformisalwayscontrollable.10.4.5.StabilityStabilityofadiscrete-timecontrolsystemΣdisdeﬁnedanalogouslytothatofacontinuous-timecontrolsystemΣ.Assumewithoutlossofgenerality(accordingtoRemark320ofsection10.4.2)thatΣdisastate-spacesystem{Ad,Bd,C,D}.ThefreebehaviorofΣdistherefore,accordingtoDeﬁnition20(section2.3.8),thevectorspacespannedbyitsstatexdwhenitsinputudiszero.Inthiscase,accordingto(10.21),xdisthesequence(xd(k))deﬁnedasafunctionoftheinitialstatex0byxd(k)=Akdx0.(10.24)Remarks181and184ofsection7.3leadustothefollowingdeﬁnition(froma“behavioral”pointofview):DEFINITION333.–Adiscrete-timelineartime-invariantsystemΣdisstable(resp.,marginallystable)ifallthevariablesofitsfreebehaviortendto0(resp.,arebounded)asktendsto+∞.Discrete-TimeControl305LEMMA334.–Adiscrete-timestate-spacesystemΣd={Ad,Bd,C,D}isstable(resp.,marginallystable)ifandonlyif,limk→+∞Akd=0(resp.,thesequence(cid:15)Akd(cid:16)isbounded).THEOREM335.–Thediscrete-timelineartime-invariantsystemΣdisstable(resp.,marginallystable)ifandonlyif,allitspoleslieintheopenunitdisk|z|<1(resp.,intheclosedunitdisk|z|≤1,thosethatbelongtothecircle|z|=1–ifany–havingalltheirstructuralindicesequalto1).PROOF.Assumewithoutlossofgenerality(accordingtoRemark320ofsection10.4.2)thatΣdisastate-spacesystem{Ad,Bd,C,D}.Changingthebasis,ifnecessary,thestudyofAkdcomesdowntothecasewhereAdisinJordanform,Ad=,λ,lJλ,l(diagonalsum):seesection13.3.4,Theorem530.WethushaveAkd=,λ,l(Jλ,l)k.Foranyk≥l−1,wehaveJλ,l=λI+J0,l,andsincethematricesλIandJ0,lcommute,(Jλ,l)k=k(cid:12)j=0(cid:21)kj(cid:22)λk−j(J0,l)j=l−1(cid:12)j=0(cid:21)kj(cid:22)λk−j(J0,l)j,wherethelastequalityisduetothefactthat(J0,l)l=0.Thus,weobtainthestatedresult.DEFINITION336.–ThestatematrixAdofadiscrete-timesystemisastabilitymatrixifallitseigenvaluesbelongtotheopenunitdisk|z|<1.SupposenowthatΣdhasbeenobtainedbythediscretizationofacontinuous-timesystemΣ.Wehavethefollowing:THEOREM337.–ThesystemΣdisstable(resp.,marginallystable)if,andonlyif,Σhasthesameproperty.PROOF.Suppose,withoutlossofgenerality(seeTheorem129,section7.1.2)thatΣisastate-spacesystem{A,B,C,D}.LetT>0bethesamplingperiod.SystemΣdisthusastate-spacesystem{Ad,Bd,C,D},whereAd=exp(AT).Changingthe306LinearSystemsbasis(ifnecessary),theproblemcomesdowntothecasewhereAisinJordanform,i.e.A=,λ,lJλ,l.Asaresult,Ad=,λ,lexp(Jλ,lT)=,λ,leλTeJ0,lTandeJ0,lTisgivenbyexpression(12.107)ofsection12.5.2(replacingtbyT),whichprovesthetheorem.DEFINITION338.–LetΣdbeaminimaldiscrete-timesystem,andsupposethatthissystemisbicausal(Deﬁnition313).ThesystemΣd(or,abusingthelanguage,itstransfermatrix)issaidtobebistableifitstransmissionpolesandzerosalllieintheopenunitdisk.10.5.Pseudocontinuoussystems10.5.1.BilineartransformThe“bilineartransform”isdeﬁnedbyw=λz−1z+1,λ>0(10.25)InterpretationThistransformcanbeinterpretedasanapproximationtointegrationbytrapezoidalrule.Indeed,considerthedifferentialequation∂y=u,(10.26)andletˆy(s)andˆu(s)bethebilateralLaplacetransformsofyandu,respectively.Theysatisfytherelationˆy(s)=1sˆu(s).(10.27)Ontheotherhand,byintegratingequation(10.26)betweentheinstantskTand(k+1)T,weobtainy[(k+1)T]−y(kT)=(cid:2)(k+1)TkTu(t)dt.(10.28)Discrete-TimeControl307tutTkTk1Figure10.11.TrapezoidalruleSupposethattherestrictionofutotheinterval[kT,(k+1)T)hasthegraphrepresentedbythecurveinFigure10.11.Theintegralﬁguringintheright-handsideof(10.28)istheareasubtendedbythisgraph.Anapproximationofthisareaisthatsubtendedbythesegmentjoiningthepoints(kT,u(kT))and((k+1)T,u[(k+1)T]),andhencewehavey[(k+1)T]−y(kT)(cid:9)Tu[(k+1)T]+u(kT)2,andtherefore(q−1)yd(cid:9)T2(q+1)ud.LetY(z)andU(z)bethebilateralz-transformsofydandud,respectively.Accordingtoexpression(12.67)ofsection12.3.5,weobtainY(z)(cid:9)T2z+1z−1U(z).(10.29)Thetrapezoidalruleleadsthereforetoapproximation(10.29)ofequation(10.27).Returningtothecomplexvariablewdeﬁnedby(10.25),weobtainw(cid:9)swithλ=2T.(10.30)PropertiesPROPOSITION339.–(i)Thebilineartransformisadiffeomorphism9fromtheinterioroftheunitdisk,|z|<1,ontothelefthalf-planeRew<0,fromtheexterioroftheunitdisk,|z|>1,ontotherighthalf-planeRew>0,exceptthepointλ,andfrom9.Thatmeansitisadifferentiablebijectionwhoseinversefunctionisalsodifferentiable.308LinearSystemstheunitcircle,|z|=1,exceptthepoint−1,ontotheimaginaryaxis.Theinversediffeomorphismisgivenbyz=1+w/λ1−w/λ.(10.31)(ii)Wehavez=eiθ(−π<θ<π)ifandonlyif,w=iωwithω=λtanθ2.PROOF.Letz=ρeiθ.Thenw=λρeiθ−1ρeiθ+1andweeasilyseethatRew=λ(cid:15)ρ2−1(cid:16)ρ2+2ρcosθ+1whichproves(i)accordingto(10.31).Forρ=1,w=λeiθ/2−e−iθ/2eiθ/2+e−iθ/2=iλtanθ2.REMARK340.–Forsmallvaluesofθ2(θbeingexpressedinradians),tanθ2(cid:9)θ2,andhencetherelation(10.8)ofsection10.2.5issatisﬁedwithagoodprecisionforλ=2T(withthisvalue,thebilineartransformiscalledthe“Tustintransform”).Ifwewantthisrelationtobeveriﬁedwithagoodprecisionintheneighborhoodofθ0(cid:5)=0,|θ0|beinglargeenoughfortheapproximationtanθ02(cid:9)θ02tobetoorough,wetakeλsuchthatλtanθ02=ω0=θ0T,andhenceλ=θ0Ttanθ02.(10.32)Withthisvalue,thebilineartransformiscalledthe“Tustintransformwithprewarping”.Ifwetakeθ0tendingto0inequation(10.32),wegetbacktotheclassicvalueλ=2Tinequation(10.30).10.5.2.PseudocontinuousrepresentationsLetΣdbeadiscrete-timesystemwithtransfermatrixGd(z)andletˇG(w)=Gd(cid:21)1+w/λ1−w/λ(cid:22).Discrete-TimeControl309ThetransfermatrixˇGis“analogous”tothatofacontinuous-timesystem,because,accordingto(10.30),thevariablewis“analogous”totheLaplacevariables.WecallˇG(w)the“pseudocontinuousform”ofthetransfermatrixGd(z).Itislikewisepossibletodeterminea“pseudocontinuousstate-spacerepresentation”ˇΣofadiscrete-timesystemΣd,byusingtheoperator∆=λq−1q+1,(10.33)thatis“analogous”tothedifferentialoperator∂.Notethatq=1+∆/λ1−∆/λ.(10.34)PROPOSITION341.–(i)If−1isnotapoleofΣd,apseudocontinuousrepresentationofthissystemisˇΣgivenby(cid:20)∆ηd=ˇAηd+ˇBudyd=ˇCηd+ˇDud(10.35)whereηd=q+1λTxd,∆ηd=δxd(withδ=q−1T),ˇA=λ(Ad−In)(Ad+In)−1,ˇB=2T(Ad+In)−1Bd,ˇC=TλC(Ad+In)−1,ˇD=(cid:23)D−C(Ad+In)−1Bd(cid:24).(ii)ThetransfermatrixofˇΣisˇG(w),whereˇG(w)=ˇC(cid:15)wIn−ˇA(cid:16)−1ˇB+ˇD.(10.36)PROOF.(i)Wehaveηd=1Tλ(Ad+In)xd+1TλBdud,andhencexdcanbeexpressedasafunctionofηdifandonlyif,−1isnotaneigenvalueofAd,andinthatcasexd=Tλ(Ad+In)−1ηd−(Ad+In)−1Bdud.310LinearSystemsItfollowsthat∆ηd=1T[(Ad−In)xd+Bdud]=ˇAηd+ˇBud.Weobtainyd=ˇCηd+ˇDudbyananalogousrationale.(ii)WehavewithzeroinitialconditionsZ(∆ηd)=wZ(ηd).Accordingto(10.35),Z(∆ηd)=ˇAZ(ηd)+ˇBU(z),andhence(cid:15)wIn−ˇA(cid:16)Z(ηd)=ˇBU(z)fromwhichwededuce(10.36).DEFINITION342.–Supposethat−1isnotapoleofΣd.Then,ˇΣdeﬁnedby(10.35)isapseudocontinuousstate-spacerepresentationofΣd.REMARK343.–(i)Theabovepseudocontinuousstate-spacesystemˇΣisproperbutnotstrictlyproper,evenifΣdisstrictlycausal.(ii)IfΣdisobtainedbydiscretizationofacontinuous-timestate-spacesystemΣ={A,B,C,D}withsamplingperiodT,thesetofpolesofΣdis(cid:31)esT,s∈P ,wherePisthesetofpolesofΣ,andhence−1isnotapoleofΣd.Now,takeλ=2/TandT→0+;thenAd=eAT=In+TA+o(T),Bd=(cid:2)T0eAtdtB=TB+o(T)(10.37)whereo(T)/T→0.Asaresult,ˇA→A,ˇB→B,ˇC→C,ˇD→D.10.5.3.*IntrinsicdeﬁnitionofapseudocontinuoussystemTheconsiderationsthatfollowcalluponnotionsofextensionandrestrictionoftheringofscalars,andoffunctor(seesection13.6.5).Fromthealgebraicpointofview,considerthediscrete-timesystemΣdasassociatedwithaﬁnitelypresentedR-moduleM(RdenotingtheprincipalidealdomainR[q]:seesection10.4.2).Accordingtoequation(10.33),inorderthat∆beabletoactontheR-moduleM,weneedtobeabletodividetheelementsofMbyq+1.Discrete-TimeControl311Thus,lettherebethemultiplicativesetQ={(q+1)n,n≥0}⊂RandletB=Q−1Rbetheprincipalidealdomainconsistingofallelementsoftheformr/(q+1)n,r∈R,n≥0(seesection13.6.5).Since∆∈B,theprincipalidealdomainC=R[∆]isasubringofB.Conversely,accordingto(10.34),1−∆/λ=2/(q+1).LettherebethemultiplicativesetT={(1−∆/λ)n,n≥0}⊂CandletD=T−1C.Accordingtoequation(10.34),q∈D,andhenceRisasubringofD.WecanthusgofromanR-moduletoaC-moduleandconverselybymeansoftwofunctors,denotedbyGandH,respectively,anddeﬁnedasfollows:–FunctorG:extensionoftheringofscalarsfromRtoB,thenrestrictionoftheringofscalarsfromBtoC(seesection13.6.5).–FunctorH:extensionoftheringofscalarsfromCtoD,thenrestrictionoftheringofscalarsfromDtoR.Thesetwofunctorsareexact,astheyarethecompositionsoftwoexactfunctors,accordingto([102],Corollary3.74andTheorem9.31).LetMbeanR-module.ThefunctionθM:M→B⊗RMdeﬁnedbym(cid:3)→1⊗m(where1istheunitelementofB)isR-linear,andaccordingtoequation(13.66),section13.6.5:kerθM={m∈M:(q+1)nm=0forsufﬁcientlylargen}.Likewise,letˇMbeaC-module.ThefunctionψˇM:ˇM→D⊗CˇMdeﬁnedbyˇm(cid:3)→1⊗ˇmisC-linear,andkerψˇM=(cid:31)ˇm∈ˇM:(1−∆/λ)nˇm=0forsufﬁcientlylargen .LEMMA344.–LetMbeaﬁnitelypresentedR-module.(i)IfMisfreeofrankn(resp.,torsion),thenGMisaﬁnitelypresentedC-modulewhichisfreeofrankn(resp.,torsion).(ii)LetNbeasubmoduleofM.ThenGNisasubmoduleofGMandGM/GN=G(M/N).PROOF.See([10],sectionsII.1andII.5)and([102],Theorem3.76).DEFINITION345.–LetΣdbeadiscrete-timesystem,i.e.aﬁnitelypresentedR-moduleM.ThepseudocontinuoussystemˇΣassociatedwithΣdistheﬁnitelypresentedC-moduleˇM=GM.Conversely,letˇΣbeapseudocontinuoussystem,i.e.aﬁnitelypresentedC-moduleˇM.Thediscrete-timesystemassociatedwithˇΣistheﬁnitelypresentedR-moduleM=HˇM.312LinearSystemsPROPOSITION346.–LetΣdbeadiscrete-timecontrolsystem,withinputud=[ud1...udm]Tandoutputyd=(cid:25)yd1...ydp(cid:26)T.Then,thepseudocontinuoussystemˇΣisacontrolsystemwithinputˇud=[ˇud1...ˇudm]Tandoutputˇyd=(cid:25)ˇyd1...ˇydp(cid:26)T,whereˇudi=θM(udi)andˇydj=θM(cid:15)ydj(cid:16)(1≤i≤m,1≤j≤p).IfΣdiscontrollable,thensotooisˇΣ.PROOF.Lemma344impliesthatProperty(ii)ofsection7.1.1holds.IfΣdiscontrollable,thissystemisafreeR-moduleM,andhenceˇΣistheC-moduleGMwhichisfreeaccordingtoLemma344.WewillillustrateDeﬁnition345throughthreeexamples,theﬁrstiselementaryandthenexttwoare“pathological”:EXAMPLE347.–LettherebethesystemΣd:qyd=ud,andletMbetheassociatedR-module.TheB-moduleB⊗RMisdeﬁnedforanyvalueofn≥0byq(q+1)nˇyd=1(q+1)nˇudwhereˇyd=θM(yd)andˇud=θM(ud).Bytakingn=1,weobtain(1+∆/λ)ˇyd=(1−∆/λ)ˇudwhichdeﬁnesˇM=GM.Inpractice,weobtainˇΣbyreplacingtheoperatorqbyitsexpression(10.34)asafunctionof∆.EXAMPLE348.–LettherebethesystemΣd:(q+1)yd=0.ThemoduleˇM=GMisreducedto0.EXAMPLE349.–LettherebethesystemΣd:(cid:15)q2−1(cid:16)yd=ud,whichadmitsastrictlycausalstate-spacerepresentationoforder2,thestatematrixofwhichhaseigenvalues−1and1(Lemma341isthereforenotapplicable).UsingthefunctorG,weobtain4(∆/λ)ˇyd=(1−∆/λ)2ˇud.ToputˇΣinstate-spaceform,wecansetˇxd=4ˇyd+(2−∆/λ)ˇudandweobtain(cid:20)∆ˇxd=ˇud,ˇyd=14ˇxd+14(∆/λ−2)ˇud,whichisanimproperﬁrst-orderstate-spacerepresentation.Discrete-TimeControl31310.5.4.StructuralpropertiesofpseudocontinuoussystemsConsiderapseudocontinuoussystemˇΣ.Itsstructuralproperties(stability,controllability,observability,etc.)aredeﬁnedinthesamemannerasthoseofacontinuous-timesystemandtheyarethusmadeexplicitbyreplacing(inaformalway)theoperator∆by∂.LetΣdbeadiscrete-timecausalcontrolsystemandletˇΣbetheassociatedpseudocontinuouscontrolsystem.Supposethat−1isnotapoleofΣd.Wethenhavethefollowing:THEOREM350.–ThepseudocontinuoussystemˇΣisstable(resp.,controllable,observable,etc.)ifandonlyif,Σdhasthesameproperty.PROOF.WecanassumewithoutlossofgeneralitythatΣdisdeﬁnedbyastate-spacerepresentation{Ad,Bd,C,D}accordingtoRemark320(section10.4.2).Therefore,ˇΣisthestate-spacesystem(cid:31)ˇA,ˇB,ˇC,ˇD givenbyProposition341.ThespectrumofˇAisincludedinthelefthalf-planeifandonlyif,thatofAdisincludedintheopenunitdiskaccordingtoProposition339(section10.5.1)andProposition439(section12.4.2).Ontheotherhand,weshowtheequivalencebetweenthecontrollabilityof(Ad,Bd)andthatof(cid:15)ˇA,ˇB(cid:16)byapplyingthePopov–Belevitch–Hautustest.Itisthesamefortheequivalencebetweentheobservabilityof(C,Ad)andthatof(cid:15)ˇC,ˇA(cid:16).10.6.Synthesisofdiscrete-timecontrol10.6.1.DirectapproachesThedesignmethodsofcontinuous-timecontrolsstudiedintheprecedingchapters(PIDandRSTcontrollers,statefeedbackcontrolwithintegralaction–ormoregenerally“internalmodel”,statefeedback/observersynthesis,etc.)canbereformulatedinthecontextofdiscretetime.Inthisway,weareledtosynthesesofdiscrete-timecontrolswhichwecanqualifyas“directapproaches”.Theseapproachesarediscussedinarathercompletemannerin[4];theywillnotbedevelopedhere.10.6.2.DiscretizationbyapproximationItisalsopossibletoderiveadigitalcontrollerfromananalogcontrollerbyapproximation.TheEulerapproximation,∂(cid:9)q−1T(10.38)isthesimplestone.Itcomesdowntowriting,ifxisadifferentiablecontinuous-timesignal,˙x(t)(cid:9)x(t+T)−x(t)T314LinearSystemsandthatt=kT.Thisapproximationisofcourseonlyvalidifxdoesnotvarytoorapidlybetweentwosamplinginstants,andhenceifthesamplingperiodTissufﬁcientlysmall.Consider,forexample,ananalogPIDcontroller,whosetransferfunctionisK(s)=k*1+1TIs+Tds1+TdNs+.Withzeroinitialconditions,theapproximation(10.38)isequivalenttos(cid:9)z−1T.WethusobtainthedigitalPIDcontrollerwithtransferfunctionKd(z)=k*1+TTI1z−1+TdTz−11+TdNT(z−1)+.10.6.3.PassagethroughapseudocontinuoussystemTheeffectivenessoftheapproachdetailedherebelowhasbeenpointedoutinamoregeneralcontext[99].GeneralprocedureLetΣdbeadiscrete-timecontrolsystem,nothavingapoleat−1andhavingtheappropriatestructuralproperties(controllability,observability,etc.)andletˇΣbetheassociatedpseudocontinuoussystem(whichhasthesamestructuralpropertiesaccordingtoTheorem350).Weapplyoneofthedesignmethodsofcontinuous-timecontroldiscussedinsection10.6.1toˇΣ(theoperator∂beingreplacedby∆).WethusobtainasuitablepseudocontinuouscontrollerˇΘ,forwhichthepseudocontinuousclosed-loopsystemisstable.NowletΘdbethediscrete-timecontrollerassociatedwithˇΘ(i.e.Θd=HˇΘ,withthenotationinsection10.5.3*).AccordingtoTheorem350,Σd,fedbackbyΘd,isstable.REMARK351.–ThepseudocontinuouscontrolsystemˇΣisproperbutnotstrictlyproper(seesection10.5.2,Remark343(i)).Asaresult,fortheprocedureweareproposingtobeapplicable,themethodsusedtodesigncontinuous-timecontrolshavetoapplytothistypeofsystem(seesection6.5,Exercises121and128;section8.4,Exercise269;section9.3.1,Remark290;section9.4,Exercise302).Discrete-TimeControl315ConsiderationofthecomputingtimeTheabovecontrollerΘdiscausalbutnotstrictlycausal(evenifˇΘisstrictlyproper):seeExercise358.Ifthecomputingtimeofthecontrolud(k)isnotnegligiblerelativetothesamplingperiod(whichdependsbothonthecontrollercomplexityandthecomputingrapidity),itisnecessary,whenimplementingthecontrollawinrealtime,toonly“send”thecontrolud(k)atinstant(k+1)T,thususingastrictlycausalcontroller.EXAMPLE352.–Considerthecontinuous-timesystemΣdeﬁnedbytheleftform(6.25)(section6.3.6).The(Z.O.H.)discretizedsystemΣdwithsamplingperiodT=0.1isdescribedbytheleftformAd(q)yd=Bd(q)ud,whereAd(q)=q2−1.72q+0.74Bd(q)=−0.016q+0.051.WewishtodesignadigitalRSTcontrollerwithequationSd(q)ud=Rd(q)(rd−yd)(10.39)havingcharacteristicssimilartothoseofthecontinuous-timeRSTcontrollerwhosepolynomialsaredeﬁnedbyequalities(6.28)and(6.29).(i)Caseofanon-strictlycausalcontroller.Asmentionedabove,theimplementationofsuchacontrollerispossibleifthecomputingtimeofthecontrolud(k)issmallcomparedwiththesamplingperiod(uptoabout20%ofthisperiod).Themorepowerfulcomputersare,themorefrequentthissituationbecomes.ThepseudocontinuoussystemˇΣassociatedwithΣd,forλ=2T,isdescribedbytheleftformˇA(∆)ˇy=ˇB(∆)ˇu,withˇA(∆)=∆2+2.99∆+1.99,ˇB(∆)=0.019∆2−0.587∆+3.98.NotethatthecoefﬁcientsofthesepolynomialsareclosetothoseofthepolynomialsA(∂)andB(∂).Wechoose,likeinsection6.3.6,ˇAcl(∆)=ˇAc(∆)(∆+10)2withˇAc(∆)=(∆+2)2.ThepolynomialsˇS(∆)andˇR(∆)whichrealizethedesiredpoleplacementwhilesatisfyingconditionˇS(0)=0(integrator)areˇS(∆)=∆3+21.40∆2+209.54∆,ˇR(∆)=83.02∆2+266.24∆+200.83,anddeﬁnethepseudocontinuouscontrollerˇΘ.ThisonehereisassociatedwiththedigitalcontrollerΘddeﬁnedbytheleftform(10.39),whereSd(q)=q3−1.367q2+0.542q−0.175,Rd(q)=1.867q3−1.315q2−1.828q+1.353.316LinearSystems(ii)Caseofastrictlycausalcontroller.Ifwewanttoobtainastrictlycausalcontroller,weﬁrstreplaceAd(q)by˜Ad(q)=qA(q),thusthesystemΣdbythesystem˜Σd,whichhasasupplementaryunitydelay.Thepseudocontinuoussystemassociatedwith˜Σdis(againwithλ=2T)describedbytheleftformˇA2(∆)ˇy=ˇB2(∆)ˇuwhereˇA2(∆)=∆3+22.99∆2+61.84∆+39.83,ˇB2(∆)=−0.019∆3+0.97∆2−15.72∆+79.67.ChoosenowˇAcl(∆)=ˇAc(∆)(∆+10)2(∆+2/T)2,whereeachroot∆=−2/Tcorrespondstoasupplementarypoleq=0introducedbythecomputingdelay.WeobtainthepolynomialsˇS(∆)=∆4+44.65∆3+539.05∆2+4858.88∆,ˇR(∆)=84.71∆3+1963.91∆2+5593.19∆+4016.66thatdeﬁneastrictlyproperpseudocontinuouscontroller˜Θ,whichisassociatedwithadiscrete-timecontroller˜Θd.Thelatterisdeﬁnedbyaleftformwhosepolynomialscanbedenotedby˜Sd(q)andRd(q).Thedigitalcontrollerwearelookingforisdeﬁnedbytheleftform(10.39)whereSd(q)=q˜Sd(q).Weﬁnallyobtain(aftersimpliﬁcationoftherootq=0,commontoSd(q)andRd(q))10Sd(q)=q4−1.398q3+0.637q2−0.145q−0.095,Rd(q)=1.903q3−1.344q2−1.863q+1.383.(iii)Inthetwocases,Sd(1)=0,whichmeansthatthecontrollerisanintegratorsystem(Sd(1)isthesumofthecoefﬁcientsofthepolynomialSd(q));inaddition,Rd(−1)=0;thisisduetothefactthat,sinceeachpseudocontinuouscontrollerisstrictlyproper,itszeroatinﬁnity(i.e.atw=∞)istransformedintoazeroatz=−1throughtheinversebilineartransform(10.31)(itisimportantthatthisconditionberespectedforthedigitalcontrollertohavezerogainattheNyquistfrequency,whichplaystheroleof“highfrequencies”fordiscrete-timesystems:seesection4.2.6).Itnowremainstoverifythegoodbehavioroftheclosed-loopsystem.Theeventsareasfollows:(i)unitstepcommandatinstantt=0;(ii)disturbancestepofamplitude0.3addingtoyatinstantt=5.TheoutputydandthecontroludarerepresentedasfunctionsoftimeinFigure10.12,withtheﬁrst(--)andthesecond(–)controller–seebelow.Thetworesponsesarealmostidentical;thesecondcontrollernonethelessgeneratesaslightdelaycomparedwiththeﬁrst(whichwaspredictable).TheseresponsesarealsoverysimilartothoseinFigures6.6and6.8ofsection6.3.6(thistime,however,thesimulationisperformedwithoutmeasurementnoise).10.Thereaderisrequestedtoshowthatduetothefactor∆+2/TinˇAcl(∆),thepolynomialsSd(q)andRd(q)musthavethisrootincommon(thedigitalRSTcontrollerthusis0-controllable,butnotcontrollable,beforetheindicatedsimpliﬁcationisperformed).Discrete-TimeControl317Figure10.12.Timeresponses(Example352)EXAMPLE353.–Considerthesamecontinuous-timesystemΣasinExample352,butinthesituationspeciﬁedinsection6.4.7,no.1.Wemustnotonlyensureacontrolwithoutanystaticerror,butalsorejectasinusoidaldisturbancewithangularfrequencyω0=1rad/s.Thenotationusedhereisidenticaltothatinthecitedparagraph(mutatismutandis).Weassumethatthecomputingtimeissmallcomparedwiththesamplingperiod,andthatitisthereforeuselesstodesignastrictlycausaldigitalcontroller(otherwise,themethodalreadydetailedinExample352(ii)canbeused).Theeasiestwayistousethebilineartransformwithprewarpingatthenormalizedangularfrequencyθ0=ω0T,withcoefﬁcientλgivenbytheexpression(10.32)(foranotherapproach,seeExercise361).Therefore,D1(∆)=∆2+2ςω0∆+ω20withς=0.005forexample.ThepolynomialsAs(∆)andAcl(∆)are,respectively,As(∆)=(∆+1+iω0)(∆+1−iω0)(∆+10)2,Acl(∆)=As(∆)(∆+2)(∆+1)2,andthecorrespondingpolynomialsˇR(∆),ˇS(∆),andˇT(∆)areˇR(∆)=99.58∆4+360.90∆3+437.50∆2+276.91∆+100.58,ˇS(∆)=∆5+21.08∆4+221.38∆3+23.27∆2+220.17∆,ˇT(∆)=0.50∆4+11.06∆3+71.41∆2+120.70∆+100.58.318LinearSystemsFigure10.13.Timeresponses(Example353)Notethatthispseudocontinuouscontrollerisstrictlyproper(seeExample352(iii))andthatˇR(0)=ˇT(0)(seesection6.4.2).ThepolynomialˇS(∆)canbeputintheformˇS(∆)=∆D1(∆)(∆+β)(cid:15)∆+¯β(cid:16)withβ=−10.53+10.45i,andˇT(∆)=As(∆)ˇR(0)As(0).Thispseudocontinuouscontroller˜Θisassociatedwithadiscrete-timecontrollerΘdusingthetransform(10.33)withthevalueofλasspeciﬁedabove.ThiscontrollerΘdisadigitalRSTcontrollerwhosepolynomialsareRd(q)=2.274q5−6.043q4+3.081q3+4.462q2−5.356q+1.581,Sd(q)=q5−3.334q4+4.208q3−2.598q2+0.9139q−0.1905,Td(q)=10−2(2.396q5−3.514q4−0.809q3+3.315q2−1.567q+0.217).WehaveSd(1)=0,Rd(−1)=0(seeExample352(iii)),andRd(1)=Td(1)sinceˇT(0)=ˇR(0)(thisistheconditionforthestaticerrortobezero).Thesimulationoftheclosed-loopsystemyieldstheresponsesinFigure10.13(withthesameconditionsasinsection6.4.7,n◦1).TheseresponsesarealmostidenticaltothoseinFigure6.12Discrete-TimeControl31910.7.ExercisesEXERCISE354.–Establishalltheresultsintable(10.14).EXERCISE355.–Lettherebethesinusoidx(t)=sin(πt).(a)Whatisitsfrequency?(b)Thissinusoidisbeingdiscretizedatfrequencyfe=1,andhencethesamplinginstantsaretherationalintegers.Whatistheobtaineddiscretizedsignalxd?(c)CanwereplacethestrictinequalitybyaninequalitywhichisnotstrictinthestatementofTheorem305?EXERCISE356.–Considerthecontinuous-timestate-spacesystemΣ={A,B,C}withA=(cid:27)−201−2(cid:28),B=(cid:27)10(cid:28),C=(cid:25)01(cid:26).(i)DeterminethepolesofΣ.(ii)ThesystemΣisdiscretizedwithsamplingperiodT=0.2;determinethediscretizedsystemΣd={Ad,Bd,Cd}.(iii)CalculatethetransferfunctionofΣdanditspoles.EXERCISE357.–ThealtitudeθofasatellitesatisﬁestheequationJd2θdt2=Γ(t)whereJisthemomentofinertiaandΓ(t)isthetorqueexertedatinstantt.Weputy=θandu=Γ/J.(i)Determinetheobservablecanonicalform{A,B,C}ofthissystemΣ.(ii)ThesystemΣisdiscretizedwithperiodT.Determinethestate-spacerealization{Ad,Bd,C}ofthediscretizedsystemΣdbyapplyingrelation(10.15)ofsection10.3.4.Isitanobservablecanonicalform?(iii)DeterminetheleftformD(q)yd=N(q)udwhichgovernsthesystemΣd.(iv)Wenowassumethatthetorqueexertedtothesatelliteisnolongeru(uptofactorJ)butu(t−τ),whereτisthetransmissiondelayoftheinformationfromEarth.Byputtingτ=3T,writetheleftformwhichgovernsΣd,takingthisdelayintoaccount.(v)WritetheobservablecanonicalformofΣdinthissituation.(vi)DeterminetheblockdiagramofΣd,analogoustothatinFigure7.5(section7.4.2)butwheretheintegratorsarereplacedbydelaysq−1.(vii)Generalizetheabovetothecasewhereτ=nT,n≥1.(viii)ConsideringanRSTcontrollercalculatedaccordingtothemethodspresentedinExamples352and353,isitwelladaptedforthecontrolofatime-delaysystemsuchasthisonehere?Ifyes,isitnotakindofpredictivecontrol?EXERCISE358.–LetˇΣbeapseudocontinuoussystemdeﬁnedbyastate-spacerepresentation(cid:31)ˇA,ˇB,ˇC,ˇD .Determinethecorrespondingdiscrete-timestate-space320LinearSystemssystemΣd={Ad,Bd,C,D}bymakingtheappropriatehypothesisontheeigenvaluesofˇA.Inthegeneralcase,isΣdstrictlycausal?EXERCISE359.–LetΣbeacontinuous-timestate-spacesystemofordern,withequation˙x=Ax+Bu,anddiscretizedatperiodT.WedenotethestateandcontrolmatricesofthediscretizedsystemΣdbyAandB,respectively.(i)ShowthatforT→0+,Ad→In,Bd→0andthatallthepolesofΣdtendto1.(ii)Wedenotetheoperator(q−1)/Tasδ.Determinethestateandcontrolmatrices˜Adand˜BdofΣdwhenitsstate-spaceequationisexpressedusingtheoperatorδ,accordingtoδxd=˜Adxd+˜Bdud.Byabuseoflanguage,wewillcallthisequationthe“deltatransform”ofthestateequationofΣd[4].(iii)Determinethelimitsof˜Adand˜BdasT→0+;deducethatΣdisbetterrepresentedusingthedeltaoperator(insteadoftheshift-forwardoperatorq)afterquantizationwhenthesamplingperiodisverysmall.(iv)Inordertoimplementthecontrollaw,doestheoperatorδposeanyproblem?(Comparewiththeoperator∆.)EXERCISE360.–LetΣbethecontinuous-timesystemdeﬁnedbytheleftform(∂+1)y=u.(i)ThissystemisdiscretizedatperiodT(cid:16)1.DeterminethetransferfunctionGd(z)ofthediscretizedsystemΣd,andthenthetransferfunctionˇG(w)oftheassociatedpseudocontinuoussystemˇΣ(withλ=2/T).(ii)DeterminelimT→0ˇG(w).Whatisremarkableaboutthislimit?(iii)WehypothesizethatthecomputingtimeisnegligiblecomparedwiththesamplingperiodT=0.2.DeterminethepseudocontinuousRSTcontrollerhavingthefollowingproperties:(a)itisanintegratorsystem;(b)ˇR/ˇShasrelativedegreeδ0=1;(c)allthepolesofthepseudocontinuousclosed-loopsystemareplacedat−10/3;(d)thetransferfunctionbetweenthereferencesignalandtheoutputisoforder1.(iv)Determinethecorrespondingdiscrete-timeRSTcontroller.CalculateSd(1),Rd(1),Td(1),andRd(−1).Interpretation?(vi)Examinetheproblemagaininthecasewherewecannotneglectthecomputingtimecomparedwiththesamplingperiod.EXERCISE361.–HowdoyoutreatExample353usingabilineartransformwithoutprewarping?EXERCISE362.–(i)Canadiscretizedsystemhavepolesinthesubset(−∞,0)oftherealline?(ii)Canithavepolesat0?EXERCISE363.–*Considerthediscrete-timesystemdeﬁnedbytheleftform(q+1)qyd=(q+1)ud.(i)Isthissystemstabilizable?(ii)Showthattheassociatedpseudocontinuoussystemiscontrollable.DoesthisresultcontradictTheorem350orProposition346?(iii)Canthissystembeobtainedbydiscretizationofacontinuous-timesystem?*Chapter11IdentiﬁcationA“visual”methodofidentiﬁcationhasalreadybeendiscussedinthisbook(seeExercise71,section3.6).Othermethodsthatarealittlelessrusticexist(Strejc’sandBroïda’s,forexample[77])whoseresults,however,arenotsigniﬁcantlybetter.Wepresenthereoneofthewidelyusedandefﬁcientidentiﬁcationapproaches,i.e.theparametricidentiﬁcation.TheideaistoﬁrstchooseaprioriamodelM(θ)ofthesystem(forexample,onthebasisofphysicalconsiderations),whereθistheparametervectortobeestimated.Theestimationofθisdonebyminimizingacostfunction(or“criterion”),forexamplethenorml2ofthe“predictionerror”(seesection12.2.1forthedeﬁnitionofthisnorm).Toclarifyideas,considerthediscrete–timesystem(cid:15)q2+a1q+a2(cid:16)yd=(b1q+b2)ud.Thisequationdeterminesthemodelstructure(whichisadiscrete–timeleftformofthesecondorder).Thecoefﬁcientstobeestimatedaretheai’sandbi’s(1≤i≤2).Puttingθ=(cid:25)a1a2b1b2(cid:26)T,theidentiﬁcationproblemnowcomesdowntoestimatingθ,byminimizinganappropriatecriterionJ(θ).11.1.RandomsignalsThenaturalframeworkusedtodiscussparametricidentiﬁcationmethodsisthatofrandomsignals(alsocalledstochasticprocesses).Thetheoryofrandomsignalsisbasedonthetheoryofprobabilities(seesection12.7).Wewillbeginwiththestudy321Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.322LinearSystemsofpseudo-randomsignals(inthesenseof[5]),whichsharemanypropertieswithergodicrandomsignals(seesection11.1.5),andwewilllimitourdiscussiontotheformer(generalstochasticprocessesarestudiedin,e.g.[8]and[37]).11.1.1.Momentsoforder1and2Letx={x(t)}t∈Zbeadiscrete-timesignalwithvaluesinK=RorC(i.e.x∈KZ).Themean(ormomentoforder1)ofthissignalisx(t)=limN→+∞12N+1N(cid:11)t=−Nx(t).(ifitexists,andwithanabuseoflanguagebecausex(t)doesnotdependont).REMARK364.–Themeanofasignalonlydeﬁnedfort≥0isx(t)=limN→+∞1NN−1(cid:12)t=0x(t).Themomentoforder2ofx(ifitexists),alsocalleditsmeanenergy,is|x(t)|2=limN→+∞12N+1N(cid:11)t=−N|x(t)|2.DEFINITION365.–Asignalxissaidtobecenteredifx(t)=0.11.1.2.Correlationandcross-correlationDEFINITION366.–Letx∈KZ.Itscorrelationsequence(or,abusingthelanguage,itscorrelationfunction)isrxx={rxx(τ)}τ∈Zsuchthatrxx(τ)=x∗(t)x(t+τ)=limN→+∞12N+1N(cid:11)t=−Nx∗(t)x(t+τ)ifitexists,1inwhichcasethesignalxissaidtobecorrelatable.Lety∈KZ.Thecross-correlationsequence(orfunction)ofxandyisthesequencerxy={rxy(τ)}τ∈Zsuchthatrxy(τ)=x∗(t)y(t+τ)=limN→+∞12N+1N(cid:11)t=−Nx∗(t)y(t+τ)1.Inthischapter,x∗denotestheconjugateofx.Identiﬁcation323ifitexists.Twosignalsx,y∈KZaresaidtobecross-correlatableiftheyarecorrelatableandrxyexists,anduncorrelatedifrxy=0.PROPOSITION367.–(i)ryxexistsifandonlyifrxyexistsandryx(τ)=r∗xy(−τ)(insuchawaythattherelation“beingcross-correlatable”issymmetric).(ii)Ifxandyarecross-correlatable,thentheyareofﬁnitemeanenergyand|rxy(τ)|≤%rxx(0)(cid:30)ryy(0).PROOF.(i)isobviousand(ii)isaconsequenceoftheSchwarzinequality.Wewriter(cid:2)x,y(τ)=rxy(τ)√rxx(0)√ryy(0)andaccordingtoProposition367wehave))r(cid:2)x,y(τ)))≤1.DEFINITION368.–Thesequencer(cid:2)x,xisthenormalizedcorrelationsequence(orfunction)ofxandr(cid:2)x,yisthenormalizedcross-correlationsequence(orfunction)ofxandofy.PROPOSITION369.–AsetAofpairwisecross-correlatablesignalsisaK-vectorspace.PROOF.Itsufﬁcestonoticethatifz=µx(µ∈K),rzz=|µ|2rxxandthatrx+y,x+y=rxx+rxy+ryx+ryy.DEFINITION370.–Letf={f(t)}t∈Zbeadiscrete-timesignal.Thissignalissaidtobeofpositivetype(writtenasf(cid:18)0)ifforanysequence(ck)ofcomplexnumbersandanysequence(τk)ofelementsofZ,wehave(cid:12)(k,l)∈I×Ickc∗lf(τk−τl)≥0foreveryﬁnitesetofindicesI.PROPOSITION371.–Letxbeacorrelatablesignal.Thenrxx(cid:18)0.324LinearSystemsPROOF.Let(ck)beasequenceofcomplexnumbersand(τk)beasequenceofelementsofZ.ForanyﬁnitesetofindicesI,wehave(cid:12)(k,l)∈I2ckc∗lN(cid:12)t=−Nx∗(t)x(t+τk−τl)=(cid:12)(k,l)∈I2ckc∗lN+τk(cid:12)t=−N+τkx∗(t−τk)x(t−τl)andN+τk(cid:12)t=−N+τk=N(cid:12)t=−N+N+τk(cid:12)t=N+1−−N+τk−1(cid:12)t=−N.Thetwosumsontheright-handside,dividedby2N+1,tendto0asN→+∞.Ontheotherhand,(cid:12)(k,l)∈I×Ickc∗l2N+1N(cid:12)t=−Nx∗(t−τk)x(t−τl)=12N+1N(cid:12)t=−N)))))(cid:12)k∈Ic∗kx(t−τk))))))2≥0.*ThefollowingresultisavariantoftheBochnertheorem[5],theproofofwhichcanbefoundin([37],ChapterX).THEOREM372.–Letxbeacorrelatablesignal.(i)rxxcanbewrittenintheformofaFourier–Stieltjesintegralrxx(τ)=12π(cid:2)π−πeiωτdΦxx(ω),whereΦxxisaboundednon-decreasingfunctioncalledthespectralfunctionofx.2(ii)rxx(τ)=σ(0)=Φ(0+)−Φ(0−)≥0.(iii)|rxx(τ)|2=14π2(cid:11)ωσ2(ω),whereσ(ω)=Φ(ω+)−Φ(ω−)≥0(σcanonlybenon-zeroinacountablesetofpoints).(iv)Asaresult,ifΦisacontinuousfunction,thenrxx(τ)=|rxx(τ)|2=0.*2.Inthischapter,thenormalizedangularfrequency(see(10.8),section10.2.5)isdenotedbyωandnotθ,toavoidconfusionwiththeparametervector.Identiﬁcation325PROPOSITION373.–Letxbeacorrelatablesignal.Then,rxx(t)=)))x(t))))2+ryy(t),wherey(t)=x(t)−x(t).PROOF.Writingm=x(t),wehaverxx(τ)=(m∗+y∗(t))(m+y(t+τ))=|m|2+ryy(τ)becausey(t)=0.Ontheotherhand,theBochnertheoremshowsthatryy(t)exists.11.1.3.Pseudo-randomsignalsDEFINITION374.–Apseudo-randomsignalisacorrelatablesignalwhosespectralfunctionΦxxisabsolutelycontinuous(seesection12.2.3).Thederivativeϕxxofthisspectralfunctioniscalledthespectraldensityofx.THEOREM375.–(i)Apseudo-randomsignalisacorrelatablesignalsuchthatrxx(τ)=12π(cid:2)π−πeiωτϕxx(ω)dω=(cid:15)F−1ϕxx(cid:16)(τ);itsspectraldensityϕxxissuchthatϕxx(ω)=(Frxx)(ω)≥0andϕxx∈L1[−π,π](whereL1[−π,π]denotesthespaceofintegrablefunctionson[−π,π]).(ii)Itscorrelationsequencerxxissuchthatrxx(τ)=|rxx(τ)|2=0.(iii)Apseudo-randomsignaliscentered.PROOF.(i)and(ii)areimmediatelyclearfromDeﬁnition374andtheBochnertheorem.(iii)isderivedfromProposition373.DEFINITION376.–Twopseudo-randomsignalsxandyaresaidtobeabsolutelycross-correlatableiftheyarecross-correlatableandifrxy=F−1ϕxywhereϕxy∈L1[−π,π]iscalledthecross-spectraldensityofxandofy.LetRxy(z)bethez-transformofrxy.PROPOSITION377.–Ifxandyareabsolutelycross-correlatable,thenyandxarealsoabsolutelycross-correlatable,andRyx(z)=Rxy(cid:9)z∗−1(cid:10)∗;inparticular,ϕyx(ω)=ϕ∗xy(ω).IfK=R,Ryx(z)=Rxy(cid:15)z−1(cid:16);inparticularϕ∗xy(ω)=ϕxy(−ω).326LinearSystemsPROOF.Supposexandyareabsolutelycross-correlatable.Thenϕyx(ω)=+∞(cid:12)τ=−∞ryx(τ)z−τ=+∞(cid:12)τ=−∞r∗xy(−τ)z−τ(accordingtoProposition367(i)),thusϕyx∈L1[−π,π]andϕyx(ω)=ϕ∗xy(ω).Theotherassertionsareclear.THEOREM378.–AsetMofpairwiseabsolutelycross-correlatablepseudo-randomsignalsisaK-vectorspace.PROOF.AccordingtotheproofofProposition369,ifz=µx(µ∈K),thenϕzz=|µ|2ϕxxandϕx+y,x+y=ϕxx+ϕyy+ϕxy+ϕyx.11.1.4.FilteringandfactorizationWecalladigitalﬁlteradiscrete-timelineartime-invariantsystemfunctioningfrominitialinstantt0→−∞withzeroinitialconditions.Fromthemathematicalpointofview,adigitalﬁlterischaracterizedbyaninput–outputrelationwhichisaconvolutionoperatoru(cid:3)→y=g∗u,i.e.y(t)=+∞(cid:12)τ=−∞g(t−τ)u(τ).Theimpulseresponseofthisﬁlter(i.e.itsresponsetoaunitimpulseδ0–seesection12.3.5)isthesequenceg=(g(t))t∈Z,anditstransferfunctionisG(z)=Z{g}.IfweassumethatthefunctionG(z)isrational,thisﬁlteriscausalandstableifandonlyiftherationalfunctionG(z)isproperandallitspoleslieintheopenunitdisc,whichisequivalenttosayingthatgispositivelysupportedandbelongstol1(seeTheorem446,section12.4.4).InterferenceformulaLettherebetwostablecausaldigitalﬁlterswithrationaltransfersfunctionsG1(z)andG2(z).Letx1(resp.,x2)betheinputtotheﬁrst(resp.,second)ﬁlterandy1(resp.,y2)beitsoutput(seeFigure11.1).THEOREM379.–Ifx1andx2areabsolutelycross-correlatable,thensoarey1andy2,andRy1y2(z)=G1(cid:15)z−1(cid:16)G2(z)Rx1x2(z)(11.1)whereRy1y2(z)andRx1x2(z)arethez-transformsofry1y2andrx1x2respectively.Relation(11.1)iscalledtheinterferenceformula.Identiﬁcation3271x1y2x2yzG2zG1Figure11.1.Pseudo-randomsignalﬁlteringPROOF.Letgi=Z−1{Gi}(i=1,2).AccordingtotheExchangetheorem(section12.3.5),yi(t)=+∞(cid:12)k=−∞gi(t−k)xi(k),asaresulty∗1(t)y2(t+τ)=+∞(cid:12)k=−∞+∞(cid:12)j=−∞g1(t−k)g2(t+τ−k+j)x∗1(k)x2(k+j)fromwhichwegetry1y2(τ)=+∞(cid:12)k=−∞+∞(cid:12)j=−∞g1(t−k)g2(t+τ−k+j)rx1x2(j).Ontheotherhand,Ry1y2(z)=+∞(cid:12)τ=−∞ry1y2(τ)z−τandwethusobtain(11.1)bywriting−τ=(t−k)−(t−k+τ−j)−j.Pseudo-whitenoiseApseudo-whitenoiseisacorrelatablesignalwsuchthatrww=λδ0.Wethushaverww(τ)=(cid:20)λifτ=00otherwise.(11.2)Sincerww(0)=|w(t)|2≥0,λisarealnon-negativenumber,calledthevarianceofthepseudo-whitenoisew;σ=√λisitsstandarddeviation.328LinearSystemsDEFINITION380.–Thepseudo-whitenoisewithcorrelationsequence(11.2)issaidtobenormalizedifitsvarianceisequalto1.Theproofofthefollowingtheoremisobviousanditsdetailsarelefttothereader:THEOREM381.–Apseudo-whitenoisewithvarianceλisapseudo-randomsignalwithconstantspectraldensityequaltoλ.Apseudo-randombinarysequence(PRBS)isapseudo-randomsignalwsuchthatw(tn)∈{−σ,σ},where(tn)isastrictlyincreasingsequenceofelementsofZ,choseninsuchawaythatrww(τ)(cid:9)0ifτ(cid:5)=0(formoredetails,see[110],Chapter5).Suchasignalisthereforeanapproximationofapseudo-whitenoise.SpectralfactorizationDEFINITION382.–Apseudo-randomsignalxissaidtoberationalifRxx(z)isarationalfunction.Itissaidtobepersistentlyexcitingifϕxx(ω)>0foranyω∈[−π,π],andtobepersistentlyexcitingoforderN(N∈{1,2,...}∪{+∞})ifthereexistNdistinctvaluesωj∈[0,π]forwhichϕxx(ωj)>0.THEOREM383.–(Spectralfactorizationtheorem).Letxbeapersistentlyexcitingrealrationalpseudo-randomsignal(i.e.K=R).Thereexistsapseudo-whitenoisewwithwell-determinedvariance,aswellasauniquebistableandbicausalﬁlter,theimpulseresponseandthetransferfunctionofwhicharedenotedbygandG(z)respectively,suchthatx=g∗wandg(0)=1.PROOF.AccordingtoProposition377,ifzk(resp.,pk)isazero(resp.,apole)ofRxx(z),then1/zk,z∗kand1/z∗k(resp.,1/pk,p∗kand1/p∗k)areagainzeros(resp.,poles)ofRxx(z).Ontheotherhand,Rxx(z)hasnopolesontheunitcirclebecauseϕxx∈L1[−π,π],andRxx(z)hasnozerosontheunitcirclebecauseϕxx(ω)>0forallω∈[−π,π].WecanthuswriteRxx(z)=λ(k∈K(z−zk)(z−z∗k)(z−1/zk)(z−1/z∗k)(j∈J(z−pj)(cid:15)z−p∗j(cid:16)(z−1/pj)(cid:9)z−1/p∗kj(cid:10),λ>0.Wecanassumewithoutlossofgeneralitythat|zk|<1and|pj|<1,k∈K,j∈J.ThuswehaveG(z)=(k∈K(z−zk)(z−z∗k)(j∈J(z−pj)(cid:15)z−p∗j(cid:16)z2n,Identiﬁcation329wheren=card(J)−card(K).Therefore,G(z)isbiproperandbistable.Wehaveg(0)=lim|z|→+∞G(z)=1accordingtotheInitialvaluetheorem(seesection12.3.5).ThistransferfunctionG(z)isuniquelydetermined.Thereexistsasignalwsuchthatx=g∗w;thissignalwisgivenbyw=Z−1(cid:20)X(z)G(z)&.Itisapseudo-randomsignalaccordingtoTheorem379,andsinceRxx(z)=G(cid:15)z−1(cid:16)G(z)λ(11.3)wehaveRww(z)=1G(z−1)G(z)Rxx(z)=λ,whichprovesthatwisapseudo-whitenoise.Relation(11.3)expressesthe“bicausalspectralfactorization”thathasbeendone.Pseudo-colorednoiseJustaswhitelightisasuperimpositionofallcolorsandthushasaspectrumthatcontainsallvisiblefrequencies,apseudo-whitenoisehasaconstantspectraldensity.Ifwhitelightgoesthroughacolorﬁlter(apieceofcoloredglassforexample),weobtaincoloredlightbehindthisﬁlter.Byanalogy,apseudo-colorednoiseistheoutputofadigitalﬁlterexcitedbyapseudo-whitenoise.Theorem383showsthateveryrationalpseudo-randomsignalxisapseudo-colorednoise.11.1.5.ErgodicrandomsignalsErgodicityofuptosecondorderLet(Ω,F,P)beaprobabilityspace.Adiscrete-timerandomsignalxisasequenceofrandomvariablesx(t):ω∈Ω→x(t,ω)∈(K,B)(witht∈ZandwhereBistheBorelianσ-algebraofK).ThissignalissaidtoberealifK=R330LinearSystemsandstationaryifitslawofprobabilityνx(t)isindependentoft.Itisergodicofﬁrstorderifallrandomvariablesx(t)areofﬁrstorderandifforallω∈Ω,3E[x(t)]=x(t,ω).Thesignalxisergodicuptosecondorderif,inaddition,allrandomvariablesx(t)areofsecondorderand(forallω∈Ω)E[x∗(t)x(t+τ)]=x∗(t,ω)x(t+τ,ω).(11.4)Inwhatfollows,“ergodic”means“ergodicuptosecondorder”.Wefurtherassumethat,foranyω∈Ω,x(.,ω)isapseudo-randomsignalinthewayspeciﬁedinsection11.1.3(thisimplies,inparticular,thatE[x(t)]=0,i.e.xiscentered).WhitenoiseandcolorednoiseAdiscrete-timewhitenoisewisanergodicrandomsignalwhoseallrealizationsw(.,ω)arepseudo-whitenoisesofthesamevarianceE(cid:23)|w(t)|2(cid:24)=λ≥0(seerelation(11.2),section11.1.4).4Weincludeasanadditionalhypothesisthattherandomvariablesw(t)andw(τ)areindependentwhenevert(cid:5)=τ.5Letxbearandomsignal,ergodicuptothesecondorder,suchthatRxx(z)=Z{rxx}isarationalfunction.Therealizationsofxarepseudo-colorednoises(seesection11.1.4)andxisthuscalledacolorednoise.TemporallawLetXbearealergodicrandomsignal.Itstemporallawisthesetofprobabilitylawsofallrandomvariables(X(t1),X(t2),...,X(tn))where{t1,...,tn}spansthesetofallstrictlyincreasingﬁnitesequencesofelementsofZ.Inparticular,arandomsignal(assumedtoberealergodic)issaidtobeGaussianifitstemporallawisGaussian,thatisallthevariablesdiscussedhereareGaussian.3.Moreprecisely,foralmosteveryωinthesenseoftheprobabilitymeasureP,i.e.“almostsurely”.Thatishowtheexpression“forallω∈Ω”shouldbeinterpreted,inwhatfollows.4.Someauthorscallapseudo-whitenoisewhatwecallhereadiscrete-timewhitenoise.5.Theserandomvariablesareofcoursenon-correlated.Twoindependentrandomvariablesarenon-correlated,buttheconversedoesnothold,exceptinparticularcases(theGaussiancase,forexample).Identiﬁcation33111.2.Open-loopidentiﬁcation11.2.1.NotationHereandinsubsequentsections,allsystemsarelineardiscrete-timeonesandarerepresentedbymeansofthedelayoperatorq−1inplaceoftheshift-forwardoperatorq(wethusworkovertheringAintroducedinsection10.4.2).LetG(cid:15)q−1(cid:16)bearationalfunctionwithindeterminateq−1.TheleftmultiplicationbyG(cid:15)q−1(cid:16)representstheconvolutionbytheimpulseresponsegoftheﬁlterwithtransferfunctionG(cid:15)z−1(cid:16).Inotherwords,ifG(cid:15)q−1(cid:16)=+∞(cid:12)τ=−∞g(τ)q−τ,wherethesequence(g(τ))τ∈Zispositivelysupportedforcausalityoftheﬁlter,theoutputy(t)isgivenbyy(t)=G(cid:15)q−1(cid:16)u(t)=+∞(cid:12)τ=−∞g(τ)u(t−τ).Notethatinthisformalism,theInitialvaluetheoremcanbewritteninthefollowingparticularlysimpleform:g(0)=G(0).REMARK384.–Inthissection,whereopen-loopsystemsareconsidered,weassumethatthesesystemsarestableinordertoavoidthedivergenceoftheoutputsignal{y(t)}.11.2.2.LeastsquaresmethodDeterministicapproachConsiderastablesystemwiththefollowingmodel:A(cid:15)q−1(cid:16)y(t)=q−rB(cid:15)q−1(cid:16)u(t)+e(t),(11.5)A(cid:15)q−1(cid:16)=1+nA(cid:12)k=1aiq−i,B(cid:15)q−1(cid:16)=nB(cid:12)k=1biq−i.332LinearSystemswhereuandyarerespectivelytheinputandtheoutputofthesystem,andeistheerrorduetotheuncertaintyonthecoefﬁcientsaiandbiwhicharetobeidentiﬁed,thusaprioriarenotpreciselyknown(possiblytotallyunknown).Integerr≥0isthepuredelay(addingtothedelayduetothediscretizationwithZ.O.H.).Letθ=(cid:25)a1...anAb1...bnB(cid:26)T,φT(t−1)=(cid:27)−y(t−1)...−y(t−nA)u(t−r−1)...u(t−r−nB)(cid:28).Therelation(11.5)isthuswrittenasy(t)=φT(t−1)θ+e(t).(11.6)DEFINITION385.–Thevectorφ(t−1)(thatcontainsthedatay(τ)andu(τ−r)uptoinstantt−1)iscalledtheregressionvector.TheleastsquaresmethodconsistsofminimizingthecriterionJ(θ,t)=1tt(cid:12)τ=1e(τ)2.(11.7)wheret>1.LetΦ(t−1)=⎡⎢⎣φT(0)...φT(t−1)⎤⎥⎦,(11.8)Y(t)=(cid:25)y(1)...y(t)(cid:26)T,(11.9)E(t)=(cid:25)e(1)...e(t)(cid:26)T.ThenY(t)=Φ(t−1)θ+E(t)andJ(θ,t)=1tET(t)E(t)=1t(Y(t)−Φ(t−1)θ)T(Y(t)−Φ(t−1)θ).ForJ(.,t)tobeminimumatpointˆθ(t),itisnecessarythattheEulercondition∂J∂θ(cid:9)ˆθ(t),t(cid:10)=0besatisﬁed(seesection12.6.4,Proposition453),with∂J∂θ(θ,t)=−2tΦT(t−1)(Y(t)−Φ(t−1)θ).Identiﬁcation333Asaresult,ˆθ(t)willbeasolutionoftheso-callednormalequationΦT(t−1)Φ(t−1)θ=ΦT(t−1)Y(t).Thisequationalwaysadmitsasolution[29],butitsuniquenessisnotguaranteedunlessΦT(t−1)Φ(t−1)isinvertible,thatisrkΦ(t−1)=nA+nB.(11.10)Supposethisconditionholds.WethenhaveHJ(θ,t)=2tΦT(t−1)Φ(t−1)>0,(whereHJistheHessianmatrixofJ:seesection12.6.2),thusJ(.,t)isstrictlyconvex(section12.6.4,Proposition454).AccordingtoTheorem455(section12.6.4),J(.,t)thusadmitsastrictglobalminimumatpointˆθ(t)suchthatˆθ(t)=(cid:15)ΦT(t−1)Φ(t−1)(cid:16)−1ΦT(t−1)Y(t)=Φ†(t−1)Y(t)(forthesecondequality,seesection13.5.7,Proposition583).Thissolutioncanbemademoreexplicitusing(11.8)and(11.9):ˆθ(t)=(cid:21)t(cid:11)τ=1φ(τ−1)φT(τ−1)(cid:22)−1t(cid:11)τ=1φ(τ−1)y(τ).(11.11)Weobtainthefollowingtheorem:THEOREM386.–Theleastsquaresproblemhasauniquesolutionifandonlyifcondition(11.10)holds(thatis,ifthedatacontainsufﬁcientinformation).Thissolutionisgivenby(11.11).RecursiveleastsquaresLetP(t)=*t(cid:12)τ=1φ(τ−1)φT(τ−1)+−1.Theinconvenientofsolution(11.11)isthatitisnecessarytocalculateP(t),whichistheinverseofamatrixofsize(nA+nB)×(nA+nB).WehavetherecurrenceformulaP−1(t)=P−1(t−1)+φ(t−1)φT(t−1).334LinearSystemsApplyingthe“Inversionlemma”(section13.1.4,Lemma493)withA=P−1(t−1),B=φ(t−1),C=1andD=φT(t−1),weget(cid:19)P(t)=P(t−1)−K(t−1)φT(t−1)P(t−1)K(t−1)=P(t−1)φ(t−1)1+φT(t−1)P(t−1)φ(t−1)(11.12)Ontheotherhand,accordingto(11.11),ˆθ(t)=P(t)t(cid:12)τ=1φ(τ−1)y(τ).(11.13)Using(11.12),weobtainˆθ(t)=ˆθ(t−1)+K(t−1)(cid:23)y(t)−φT(t−1)ˆθ(t−1)(cid:24).(11.14)Relations(11.12)and(11.14)deﬁnetherecursiveleastsquaresalgorithm,whichdoesnotrequireanymatrixinversion.Letusstudythisfromastochasticpointofview.FormulationbasedonpredictionerrorAllrandomsignalsareassumedtoberealergodic.Theinputandoutputofthesystemarenowconsideredtobesuchsignals,andvectorθisarandomvariablewithvaluesinRn(n=nA+nB).Considerthe“stochasticversion”ofmodel(11.5),knownasthe“ARXmodel”6A(cid:15)q−1,θ(cid:16)y(t)=q−rB(cid:15)q−1,θ(cid:16)u(t)+w(t),(11.15)wherey(t)=φT(t−1)θ+w(t).(11.16)LetFt−1betheσ-algebrageneratedbytherandomvariablesy(t−i),u(t−i),i≥1andθ(seesection12.7.2).(Regardingtheinput,onlythevaluesu(t−r−i),i≥1,areactuallyinvolved,butwedonottakethisintoaccountforthesakeofclarityinthefollowingdiscussion.)DEFINITION387.–Wecallone-stepoptimalpredictionofy(t)therandomvariablegivenbyˆy(t|t−1)=E[y(t)|Ft−1](11.17)6.ARXstandsforAutoRegressive(whichisthepartA(cid:15)q−1(cid:16)y(t)=w(t))andXfortheeXternalpartq−rB(cid:15)q−1(cid:16)u(t)(uisindeedanexternalsignal).Identiﬁcation335andpredictionerrortherandomvariableε(t)=y(t)−ˆy(t|t−1).(11.18)Letustakethefollowingtwohypotheses,theﬁrstofwhichmakesmoreexplicitRemark384(section11.2.1).(H0):Theco-domainoftherandomvariableθisasubsetDofRnsuchthatforanyθ0∈D,A(cid:15)z−1,θ0(cid:16)(cid:5)=0forany|z|≥1andthepolynomialsA(cid:15)q−1,θ0(cid:16)andB(cid:15)q−1,θ0(cid:16)areco-prime.(H1):wisawhitenoisewithvarianceE(cid:23)w(t)2(cid:24)=λandissuchthatforeveryinstantt,w(t)isindependentoftheσ-algebraFt−1.THEOREM388.–UnderHypotheses(H0)and(H1),theone-stepoptimalpredictionofy(t)isgivenby:ˆy(t|t−1)=φT(t−1)θ.PROOF.Letz(t)=φT(t−1)θandlety•(t)beapredictionofy(t),thatis(likez(t))anelementofL2(Ω,Ft−1,P).WehaveE(cid:23)|y(t)−y•(t)|2(cid:24)=E(cid:23)|z(t)−y•(t)+w(t)|2(cid:24).Therandomvariablesz(t)−y•(t)andw(t)areindependent,thuswehave,accordingtoProposition470(ii)(section12.7.2),E(cid:23)|y(t)−y•(t)|2(cid:24)=E(cid:23)|z(t)−y•(t)|2(cid:24)+λ≥λ.Theminimumoftheleft-handsideisattainedwheny•(t)=z(t),asaresultz(t)=E[y(t)|Ft−1]accordingtoDeﬁnition474(section12.7.3).REMARK389.–(i)Theaboveoptimalpredictionˆy(t|t−1)canbeexpressedlinearlyasafunctionofθ,thusitiscalledalinearregressioninstatistics.(ii)AccordingtoTheorem388,theleastsquarescriterion(11.7)isalsowrittenasJ(θ,t)=1tt(cid:11)τ=1(ε(τ))2.(11.19)Accordingtotheergodichypothesis(11.4),ast→+∞,J(θ,t)→E(cid:23)(ε(τ))2(cid:24).BiasoftheestimatorLetwetakeHypothesis(H2):336LinearSystems(H2):Thereexistsauniquevalue˘θ∈Dofθsuchthatthedatayandusatisfytherelationy(t)=φT(t−1)˘θ+w(t).(11.20)REMARK390.–(i)Hypothesis(H2)meansthattheidentiﬁedsystemactuallyhastheARXstructure(11.15)andthat˘θisthe“truevalue”ofparameterθ(seesection11.2.5formoredetails).(ii)Toberigorous,oneshoulddistinguishbetweenthenoise{w(t)}ofthemodel(whichisonlyﬁctitious)andthenoise{˘w(t)}oftheactualsystem(andtowritey(t)=φT(t−1)˘θ+˘w(t)inplaceof(11.20)).Butthiscomplicatesthederivationwithoutchangingtheconclusion(seeExercise428);forthesakeofsimplicity,wand˘warenotdistinguishedinwhatfollows.Letˆθ(t)=argminθJ(t,θ)(11.21)(assumingthatJ(t,.)admitsastrictglobalminimum,thatiscondition(11.10)holds).DEFINITION391.–Theestimatorthatprovidestheestimateˆθ(t)(or,abusingthelanguage,theestimatorˆθ(t))issaidtobenon-biasedifE(cid:23)ˆθ(t)(cid:24)=˘θ,andasymptoticallynon-biasediflimt→+∞E(cid:23)ˆθ(t)(cid:24)=˘θ.THEOREM392.–UnderHypotheses(H0)to(H2),theleastsquaresestimatorisnon-biased.PROOF.Accordingto(11.13)andHypothesis(H2),wehave,byputtingΓ(t)=tP(t)ˆθ(t)=Γ(t)1tt(cid:12)τ=1φ(τ−1)(cid:9)φT(τ−1)˘θ+w(τ)(cid:10)=˘θ+Γ(t)1tt(cid:12)τ=1φ(τ−1)w(τ).(11.22)Therandomvariablesφ(τ−1)andw(τ)areindependentaccordingtoHypothesis(H1)andw(τ)iscentered,thusaccordingtoProposition470(i)(section12.7.3)E[φ(τ−1)w(τ)]=E[φ(τ−1)]E[w(τ)]=0,thereforeE(cid:23)ˆθ(t)(cid:24)=˘θ.Identiﬁcation337ConsistencyoftheestimatorDEFINITION393.–TheestimatorinDeﬁnition391issaidtobeconsistentiflimt→+∞ˆθ(t)=˘θalmostsurely.(11.23)REMARK394.–Aconsistentestimatorisasymptoticallynon-biased.Letustakethetwofollowinghypotheses:(H3):Theinput{u(t)}isapersistentlyexcitingsignalofinﬁniteorder.(H4):Foranyinstantstandτ,thenoisew(t)isindependentoftheinputu(τ).REMARK395.–Hypothesis(H4)isrealisticinthecontextofopen-loopidentiﬁcationwhichisthesubjectofthissection.Iftheidentiﬁcationismadeinclosed-loop,thefeedbackintroducesacross-correlationbetweenu(t)andthenoisew(τ),τ≤t.THEOREM396.–UnderHypotheses(H0)to(H4),theleastsquaresestimatorisconsistent.PROOF.WehaveΓ(t)−1=1tP−1(t)=1tt(cid:12)τ=1φ(τ−1)φT(τ−1)(seesection11.1.1,Remark364).Asaresult,ifE(cid:23)φ(t−1)φT(t−1)(cid:24)isinvertible,wehaveast→+∞Γ(t)→(cid:20)E(cid:23)φ(t−1)φT(t−1)(cid:24)−1&.TheinvertibilityofE(cid:23)φ(t−1)φT(t−1)(cid:24)isensuredbyHypotheses(H3)and(H4)([110]Chapter5,Complement5.2);wewillcomebacktothispointinthemoregeneralcontextofsection11.2.5.Ontheotherhand,1tt(cid:12)τ=1φ(τ−1)w(τ)→E[φ(t−1)w(t)]=0(seeproofofTheorem392).Thetheoremisthusaconsequenceof(11.22).ResidueanalysisTHEOREM397.–UnderHypotheses(H0)to(H4),ifˆθ(t)=˘θ,thenthepredictionerror{ε(t)}isawhitenoisesuchthatforanyinstantstandτ,ε(t)isindependentoftheinputu(τ).338LinearSystemsPROOF.Itsufﬁcestonotethat,forθ=˘θ,ε(t)=w(t).EXAMPLE398.–Letustakethecontinuous-timeminimalsystemwithtransferfunctionG(s)=s−2s2+0.2s+1.(11.24)Discretizingthissystem(withZ.O.H.)atsamplingperiodTs=0.5s(toclarifyideas,wecanindeedassumethattheunitoftimechosenisthesecond),weobtainthediscrete-timesystemwithtransferfunctionGd(z)=0.2193z−0.6853z2−1.6718z+0.9048=0.2193z−1−0.6853z−21−1.6718z−1+0.9048z−2(cid:1)˘B(cid:15)z−1(cid:16)˘A(z−1).ThesysteminputisaPRBSwithamplitude1andthe“equationnoise”wisaGaussianwhitenoisewithstandarddeviation1.Theidentiﬁcationisdoneover1000points.(ThesamplingperiodTschosencanseemquitelarge–takingintoaccounttheundampedcharacteristicfrequencyω0=1rad/softhesystem–,butthisorderofmagnitudeisessentialtoobtainacorrectidentiﬁcation.Withrespecttothecontrol,Tscanbemuchsmaller,andwecanconceivetwodifferentsamplingperiods:alargeenoughonefortheidentiﬁcation,anothersmalleroneforthecontrol,sothatthelatterwillquicklyreacttoadisturbance.)Theinputandtheoutput,overtheﬁrst200points(thustheﬁrst100seconds),areshowninFigure11.2(–),7aswellasthesimulatedoutputbasedontheidentiﬁedmodelandintheabsenceofnoise(--);thismakesitpossibletogetaﬁrstappreciationofthequalityoftheidentiﬁcationandalsoofthenoiselevel.ResidueanalysisisshowninFigure11.3.8Accordingtosomestatisticcriteriathatwearenotgoingtodetailhere,normalizedcorrelationsequencer(cid:2)εεandnormalizedcross-correlationsequencer(cid:2)εucanbeconsideredtobezero(exceptr(cid:2)εε(0))iftheystayinsidetheconﬁdenceintervalsrepresentedbydarkerareas,whichisthecasehere.ThetransferfunctionˆG(s)ofthecontinuous-timeidentiﬁedsystemisobtainedbyinvertingformula(10.13)ofsection10.3.3,basedonthetransferfunctionofthediscrete-timeidentiﬁedsystem(inpractice,thisinversionisdonethroughastate-spacerealization,byinvertingrelation(10.20)ofsection10.3.4).InthiswayweobtainˆG(s)=1.163s−1.952s2+0.2161s+0.962whichisverycloseto(11.24).Thestepresponsesoftheactualsystem(–)andoftheidentiﬁedsystem(--)areshowninFigure11.4.Thecurvesarealmostmerge.EXAMPLE399.–ThisexampleisthesameasExample398,exceptinthewaythatthewhitenoisew(t)affectsthesystem:hereitisnolongeran“equationnoise”,asin7.Figures11.2to11.7areattheendofsection11.2.8.Where“lag”standsfortheargumentτofryu(τ).Identiﬁcation339relation(11.15),butameasurementnoise.Thismeansthatthesystemsatisﬁes(cid:20)y(t)=y0(t)+w(t),˘A(cid:15)q−1(cid:16)y0(t)=q−r˘B(cid:15)q−1(cid:16)u(t).(11.25)Thisistheonlychangecomparedwiththepreviouscase.Notethatthissituationismorerealistic.Theinputandoutput,fortheﬁrst200points,areshowninFigure11.5(–),aswellastheoutputsimulatedbasedontheidentiﬁedmodelandintheabsenceofnoise(--).Accordingtotheresidueanalysis,showninFigure11.6,theidentiﬁcationisaprioripoor.Thetransferfunctionofthecontinuous-timeidentiﬁedsystemisindeedˆG(s)=6.099s−9.491s2+4.354s+4.001andthusisquitedifferentfrom(11.24).Thestepresponsesoftheactualsystem(–)andoftheidentiﬁedsystem(--),showninFigure11.7,conﬁrmthepoorqualityoftheidentiﬁcation.BiasanalysisTHEOREM400.–Ifthenoisewisameasurementnoise,theleastsquaresestimatorisingeneralbiased.PROOF.LetusfollowagaintheapproachusedintheproofofTheorem392.Recallﬁrstthataccordingto(11.25)˘A(cid:15)q−1(cid:16)y(t)=˘B(cid:15)q−1(cid:16)u(t−r)+˘A(cid:15)q−1(cid:16)w(t).(11.26)Polynomial˘A(cid:15)q−1(cid:16)isoftheform˘A(cid:15)q−1(cid:16)=1+q−1˘A•(cid:15)q−1,θ(cid:16).Asaresult,if˘θisthetruevalueoftheparameter,wehavefrom(11.13),writingv(t)=A•(cid:15)q−1,θ(cid:16)w(t),E(cid:23)ˆθ(t)(cid:24)=˘θ+Γ(t)1tt(cid:12)τ=1E(cid:23)φT(τ−1)v(τ−1)(cid:24),thusE(cid:23)ˆθ(t)(cid:24)(cid:5)=˘θbecause(exceptforaspecialcase)thecomponentsofφ(τ−1)arecorrelatedwithv(τ−1).Theorem400–aswellasExample11.15–showsthattheleastsquaresmethod,basedonanARXmodel,doesnotmakeitpossibletocorrectlyresolveallidentiﬁcationproblems.Forthisreason,weshallstudymorecomplexmethodsinthefollowingsections.340LinearSystems11.2.3.ModelsandpredictionConsidertheidentiﬁcationproblemofasysteminthepresenceofmeasurementnoise(seeExample399).Assumingthatthismeasurementnoiseiswhite,theinputu(t),theoutputy(t)andthewhitenoisew(t)satisfytherelation(11.26).Thisexpressionhasastructurethatcanbeputintoseveraldifferentforms.ModelsARMAXmodel9ThismodelisA(cid:15)q−1,θ(cid:16)y(t)=q−rB(cid:15)q−1,θ(cid:16)u(t)+C(cid:15)q−1,θ(cid:16)w(t).(11.27)AddingtheconstraintA(cid:15)q−1,θ(cid:16)=C(cid:15)q−1,θ(cid:16),(11.28)equation(11.26)hasthisstructure.Ingeneral,wecanassumethatpolynomialC(cid:15)z−1,θ(cid:16)ofanARMAXmodelissuchthatC(cid:15)z−1,θ(cid:16)(cid:5)=0for|z|≥1,accordingtothespectralfactorizationtheorem(section11.1.4,Theorem383).OutputerrormodelTheOE(OutputError)modelisy(t)=q−rB(q−1,θ)F(q−1,θ)u(t)+w(t).(11.29)ThisisthestructurethatcorrespondstotheprobleminExample11.15(withA(cid:15)q−1,θ(cid:16)replacedbyF(cid:15)q−1,θ(cid:16)).BoxandJenkinsmodelWecanconsiderthemoregeneralcasewherethemeasurementnoisenisacolorednoise.10Accordingtothespectralfactorizationtheorem,ncanbeassumedtobegeneratedbythemodeln(t)=C(cid:15)q−1,θ(cid:16)D(q−1,θ)w(t),9.ARMAstandsforAutoRegresiveMovingAverageandXisfromeXternal.10.DonotconfusethenoisenwiththeintegerninHypothesis(H0).Identiﬁcation341wherethetransferfunctionH(cid:15)q−1,θ(cid:16)=C(cid:15)q−1,θ(cid:16)D(q−1,θ)isbicausalandbistableandsuchthatH(0,θ)=1.WethusobtaintheBoxandJenkinsmodel(BJ)y(t)=q−rB(q−1,θ)F(q−1,θ)u(t)+C(q−1,θ)D(q−1,θ)w(t).(11.30)PredictionerrormodelWegatherallmodelsobtainedaboveintothegeneralstructureA(cid:15)q−1(cid:16)y(t)=q−rB(q−1,θ)F(q−1,θ)u(t)+C(q−1,θ)D(q−1,θ)w(t)(11.31)calledthepredictionerrormodel(PEM).Wearenowgoingtoseewhy.One-stepoptimalpredictionGeneralsystem(11.31)(inwhichpolynomialsA(cid:15)q−1,θ(cid:16),B(cid:15)q−1,θ(cid:16),C(cid:15)q−1,θ(cid:16),D(cid:15)q−1,θ(cid:16)andF(cid:15)q−1,θ(cid:16)appearexplicitly;thecoefﬁcientsofthesepolynomialsarethecomponentsoftheparameter-vectorθtobeidentiﬁed)canbeputinthemoreconciseformy(t)=G(cid:15)q−1,θ(cid:16)u(t)+H(cid:15)q−1,θ(cid:16)w(t).(11.32)Thefollowinghypothesis,whichgeneralizesHypothesis(H0)(section11.2.3),isinforce;nisthenumberofcomponentsofθ.(H0’):TherandomvariableθtakesitsvaluesinasubsetDofRnsuchthatforanyθ0∈D,G(cid:15)q−1,θ0(cid:16)isthetransferfunctionofastableandstrictlycausalﬁlter,H(cid:15)q−1,θ0(cid:16)isthetransferfunctionofabistableandbicausalﬁlter,andH(0,θ0)=1(seesection11.1.4,Theorem383,andsection11.2.1);GandHarerationalfunctionswithrespecttotheindeterminateq−1andthecomponentsofθ0.REMARK401.–Moreconcisely,G(cid:15)q−1,θ(cid:16)andH(cid:15)q−1,θ(cid:16)canbedenotedinwhatfollowsasG(cid:15)q−1(cid:16)andH(cid:15)q−1(cid:16),respectively,whenthisisnotambiguous.LetFt−1betheσ-algebrageneratedbytherandomvariablesy(t−i),u(t−i),i≥1andθ.Theone-stepoptimalpredictionˆy(t|t−1)andthepredictionerrorε(t)aredeﬁnedasinDeﬁnition387(section11.2.2).342LinearSystemsTHEOREM402.–UnderHypothesis(H0’)andHypothesis(H1)ofsection11.2.2,theone-stepoptimalpredictionofy(t)isgivenbyˆy(t|t−1)=(cid:23)1−1H(q−1)(cid:24)y(t)+G(q−1)H(q−1)u(t).(11.33)PROOF.Letz(t)betheleft-handsideof(11.33)andy•(t)beapredictionofy(t),i.e.(likez(t))anelementofL2(Ω,Ft−1,P).Wehavey(t)−y•(t)=z(t)−y•(t)+w(t),thuswecanconcludeasintheproofofTheorem388.11.2.4.OutputErrormethodandARMAXmethodTheidentiﬁcationmethodnowconsistsofdeterminingˆθ(t)deﬁnedby(11.21),thusofminimizingcriterion(11.19)(seesection11.2.2,Remark389).ThisminimizationisusuallycarriedoutusingtheLevenberg–Marquardtalgorithm(seesection12.6.5),whichrequirestheknowledgeofthegradientofthecriterionwithrespecttotheparameterstobeidentiﬁed.Letθibetheithcomponentofθ;wehave∂J∂θi(t,θ)=2tt(cid:12)τ=1ε(τ)∂ε∂θi(τ).Whatneedstobedonenextistoevaluatethepartialderivatives∂ε∂θi.Toillustratethispoint,wewillcalculatethesepartialderivativesfortheOutputErrormodelandfortheARMAXmodel(seealsoExercise422).CaseofanOutputErrormodelWehaveG(cid:15)q−1(cid:16)=q−rB(cid:15)q−1(cid:16)F(q−1),H(cid:15)q−1(cid:16)=1.Asaresult,accordingto(11.33),ε(t)=y(t)−q−rB(cid:15)q−1(cid:16)F(q−1)u(t).Therefore,∂ε∂bi(t)=−q−r−iF(q−1)u(t),∂ε∂fi(t)=q−r−iB(cid:15)q−1(cid:16)F(q−1)2u(t).Identiﬁcation343CaseofanARMAXmodelWehaveG(cid:15)q−1(cid:16)=q−rB(cid:15)q−1(cid:16)A(q−1),H(cid:15)q−1(cid:16)=C(cid:15)q−1(cid:16)A(q−1),andtherefore,from(11.33),ε(t)=A(cid:15)q−1(cid:16)C(q−1)y(t)−q−rB(cid:15)q−1(cid:16)C(q−1)u(t).Wededucethat∂ε∂ai(t)=q−iC(q−1)y(t),∂ε∂bi(t)=−q−r−iC(q−1)u(t),∂ε∂ci(t)=−q−iC(q−1)ε(t).EXAMPLE403.–ThisexampleisidenticaltoExample399(section11.2.2),butthistimethesystemisidentiﬁedusingtheOutputErrormethod.Theinputandtheoutput,fortheﬁrst200points,areshowninFigure11.8(–),aswellasthesimulatedoutputbasedontheidentiﬁedmodelintheabsenceofanoise(--).Thelatterclearlybetter“follows”theactualoutputthaninFigure11.5.Theresidueanalysis,showninFigure11.9,isgood.Forveriﬁcation,thetransferfunctionoftheidentiﬁedcontinuous-timesystemisˆG(s)=0.9465s−1.991s2+0.1933s+0.9941andisthusverycloseto(11.24).Thestepresponsesoftheactualsystem(–)andoftheidentiﬁedsystem(--),showninFigure11.10,conﬁrmthegoodqualityoftheidentiﬁcation.The(veryimportant)problemofidentiﬁcationinthepresenceofawhitemeasurementnoiseisthuscorrectlyresolvedbytheOutputErrormethod.EXAMPLE404.–ThisexampleisidenticaltoExample403butthesystemisidentiﬁedusingtheARMAXmethod.Theinputandoutput,fortheﬁrst200points,areshowninFigure11.11(–),aswellasthesimulatedoutputbasedontheidentiﬁedmodelintheabsenceofanoise(--).Theresidueanalysis,showninFigure11.12,iscorrect.Thepolynomialsoftheidentiﬁeddiscretizedsystemarethefollowing:ˆA(cid:15)q−1(cid:16)=1−1.6750q−1+0.9052q−2,ˆB(cid:15)q−1(cid:16)=0.1907q−1−0.6495q−2,ˆC(cid:15)q−1(cid:16)=1−1.6886q−1+0.9237q−2.344LinearSystemsThefactthatˆC(cid:15)q−1(cid:16)isveryclosetoˆA(cid:15)q−1(cid:16)makesitpossibletoconcludethatthenoiseisdeﬁnitelyameasurementnoise(accordingtorelation(11.28)).Thestepresponsesoftheactualsystem(–)andoftheidentiﬁedsystem(--),showninFigure11.13,conﬁrmtheexcellentqualityoftheidentiﬁcation.TheproblemofidentiﬁcationinthepresenceofawhitemeasurementnoiseisthusalsoresolvedbytheARMAXmethod.EXAMPLE405.–ThedifferencebetweenthisexampleandExample403isthat,thistime,themeasurementnoiseisverymuchcolored.ItisrepresentedinFigure11.14overtheﬁrst100points.TheidentiﬁcationiscarriedoutusingtheOutputErrormethod.Theinputandtheoutput,overtheﬁrst200points,areshowninFigure11.15(–),aswellasthesimulatedoutputbasedontheidentiﬁedmodelintheabsenceaofnoise(--).Theresidueanalysis,showninFigure11.16,demonstratesthattheOutputErrormodeldoesnotcorrespondtothecasetreated.Indeed,thepredictionerrorwasnotwhitenedattheendoftheoptimization.Nevertheless,thestepresponsesoftheactualsystem(–)andtheidentiﬁedsystem(--)inFigure11.17,showthatthesystemwascorrectlyidentiﬁed.Analysisofthisphenomenonisthesubjectofthefollowingsection.11.2.5.ConsistencyoftheestimatorandresiduesConsistencyConsiderthegeneralmodel(11.32)andsupposethattheactualsystemisgovernedbytheequationy(t)=˘G(cid:15)q−1(cid:16)u(t)+˘H(cid:15)q−1(cid:16)w(t),(11.34)wheretheﬁlter˘G(cid:15)q−1(cid:16)isstableandstrictlycausal,andtheﬁlter˘H(cid:15)q−1(cid:16)isbicausal,bistableandsuchthat˘H(0)=1.Hypothesis(H2)(section11.2.2)isahypothesisofidentiﬁabilityaccordingtothefollowing:DEFINITION406.–Thesystemissaidtobeidentiﬁableifthereexistsauniquevalue˘θ∈DofθsuchthatG(cid:9)q−1,˘θ(cid:10)=˘G(cid:15)q−1(cid:16)andH(cid:9)q−1,˘θ(cid:10)=˘H(cid:15)q−1(cid:16).11Supposethatnowmodel(11.32)canbewrittenasy(t)=G(cid:15)q−1,θs(cid:16)u(t)+H(cid:15)q−1,θν(cid:16)w(t)(11.35)11.Thereareseveralnotionsofidentiﬁabilityintheliterature.Thenotionpresentedhereisavariantoftheso-calledstructuralidentiﬁability.Anotherconceptofidentiﬁabilityispresentedin[110].Identiﬁcation345sothattheparameterθtobedeterminedisseparatedintotwoindependentpartsθsandθν,theﬁrstpartcharacterizingonlythedeterministicpartofthesystemtobeidentiﬁedandthesecondpartcharacterizingonlythestochasticpart.Wehaveθ=(θs,θν).(11.36)Letˆθ(t)=(cid:9)ˆθs(t),ˆθν(t)(cid:10),whereˆθ(t)isdeﬁnedby(11.21)(seesection11.2.2).DEFINITION407.–Thedeterministicpartofthesystemissaidtobeidentiﬁableifthereexistsauniquevalue˘θsofθssuchthatG(cid:9)q−1,˘θs(cid:10)=˘G(cid:15)q−1(cid:16).THEOREM408.–LetHypothesis(H0’)(section11.2.3)beinforce,aswellasHypotheses(H1),(H3)and(H4)(section11.2.2).(i)Ifthedeterministicpartofthesystemisidentiﬁable,thentheestimatorofthispartisconsistent,i.e.limt→+∞ˆθs(t)=˘θsalmostsurely.(ii)Ifthewholesystemisidentiﬁableandifthevarianceλ=σ2ofthewhitenoisewisnon-zero,thentheestimatorofthesystemisconsistent,i.e.limt→+∞ˆθ(t)=˘θalmostsurely.PROOF.Theone-stepoptimalpredictioncanbewrittenasˆy(t|t−1)=(cid:27)1−1H(q−1,θν)(cid:28)y(t)+G(cid:15)q−1,θs(cid:16)H(q−1,θν)u(t)whereastheactualsystemisdeﬁnedby(11.34).Thepredictionerrorε(t)=y(t)−ˆy(t|t−1)thussatisﬁesε(t)=∆G(cid:15)q−1,θs(cid:16)H(q−1,θν)u(t)+˘H(cid:15)q−1(cid:16)H(q−1,θν)w(t),(11.37)where∆G(cid:15)q−1,θs(cid:16)=˘G(cid:15)q−1(cid:16)−G(cid:15)q−1,θs(cid:16).Ast→+∞,J(t,θ)→E(cid:23)ε(t)2(cid:24)(seesection11.2.2,Remark389)andaccordingtoHypothesis(H4),whichimpliesthattheright-handsideof(11.37)isthesumoftwoindependentrandomvariables,wehaveE(cid:23)ε(t)2(cid:24)=E⎡⎣*∆G(cid:15)q−1,θs(cid:16)H(q−1,θν)u(t)+2⎤⎦+E⎡⎣*˘H(cid:15)q−1(cid:16)H(q−1,θν)w(t)+2⎤⎦.346LinearSystemsLetQ1betheﬁrstquantityontheright-handsideoftheaboveequalityandQ2thebesecondquantity.WehaveE(cid:23)ε(t)2(cid:24)=rεε(0)=12π(cid:2)π−πϕεε(ω)dω.Therefore,accordingtotheInterferenceformula(seesection11.1.4,Theorem379),Q1=12π(cid:2)π−π)))))∆G(cid:15)e−iω,θs(cid:16)H(e−iω,θν))))))2ϕuu(ω)dω,Q2=12π(cid:2)π−π)))))˘H(cid:15)e−iω(cid:16)H(e−iω,θν))))))2ϕww(ω)dω,whereϕuu(ω)>0foraninﬁnitenumberofdistinctangularfrequenciesω∈[−π,π]accordingtoHypothesis(H3)andϕww(ω)=λ.(i)Supposethatthedeterministicpartisidentiﬁable.AccordingtoHypothesis(H3),Q1isminimum(andequalto0)ifandonlyif∆G(cid:15)e−iω,θs(cid:16)=0foraninﬁnitenumberofdistinctfrequenciesω∈[−π,π],thatisθs=˘θs;indeed,anon-zerorationalfunctioncanonlyhaveaﬁnitenumberofzeros.(ii)Assumethatthepreviousconditionissatisﬁedandλ>0.WethenhaveE(cid:23)ε(t)2(cid:24)=λ2π(cid:2)π−π)))))˘H(cid:15)e−iω(cid:16)H(e−iω,θν))))))2dω.Let˜H(cid:15)q−1,θν(cid:16)=˘H(cid:15)q−1(cid:16)H(q−1,θν).Thisisthetransferfunctionofabicausalbistableﬁltersuchthat˜H(0,θν)=1;itcanbewrittenas˜H(cid:15)q−1,θν(cid:16)=1++∞(cid:12)τ=1˜h(τ)q−τ.AccordingtotheParsevalequality(12.45)ofsection12.3.3,E(cid:23)ε(t)2(cid:24)=λ*1++∞(cid:12)τ=1˜h(τ)2+.Sinceλ>0,E(cid:23)ε(t)2(cid:24)isminimumifandonlyifthel2normof(cid:9)˜h(τ)(cid:10)isalsominimum.Now,byassumingthatthesystemisentirelyidentiﬁable,the˜h(τ),τ≥1,areallzeroifandonlyifH(cid:15)q−1,θν(cid:16)=˘H(cid:15)q−1(cid:16),thatistosayθ=˘θ(takingintoaccountthefactthatθs=˘θs).Identiﬁcation347REMARK409.–ThestatementofTheorem408(ii)remainsvalidifwedonothavetheseparation(11.36)ofθintotwopartsθsandθν(asthereadercancheckbyslightlymodifyingtheproofofthistheorem),andExample404isanillustrationofthisremark.ResidueanalysisThepredictionerrorhastheimportantpropertystatedinthetheorembelow(whichgeneralizesTheorem397).THEOREM410.–UnderthehypothesesofTheorem408,ifthesystemisidentiﬁableandiftheparameterθhasitstruevalue˘θ,thenthepredictionerror{ε(t)}isawhitenoisesuchthatforanyinstantstandτ,ε(t)isindependentoftheinputu(τ).PROOF.Wehaveε(t)=w(t),andsothetheoremisaconsequenceofHypothesis(H4).11.2.6.FilteringofdataItisrareforthe“deterministicpart”ofthesystem,asdeﬁnedinsection11.2.5,tobeidentiﬁableintheabsolute.Indeed,thissubsystem(whosemodelis,e.g.todesignacontrollaw)isinfactverycomplex(seesection4.2.1).Therefore,itmakessensetoidentifyonlythe“usefulpart”ofthissubsystem,inaboundedintervaloffrequencies(thatconsistsoffrequenciesatwhichthecontrolhasenergy).Let[ωmin,ωmax]besuchaninterval.Ifwerestrictthebehaviorofthedeterministicpartto[ωmin,ωmax],thentheabove-mentioned“usefulpart”becomesidentiﬁableifboththisintervalandthemodelstructurearecorrectlychosen.Inpractice,wethereforeﬁlterthedatabyabandpassﬁlterwithtransferfunctionHbp(cid:15)z−1(cid:16),assumedtobebicausalandbistableforreasonsdiscussedbelow.Inotherwords,thedataprovidedtothealgorithmare,insteadoftheinput/outputu(t)andy(t),theﬁlteredinput/outputuf(t)=Hbp(cid:15)q−1(cid:16)u(t),yf(t)=Hbp(cid:15)q−1(cid:16)y(t).SupposethetransferfunctionoftheentiredeterministicpartisG(cid:15)q−1(cid:16)=Gu(cid:15)q−1(cid:16)+Gn(cid:15)q−1(cid:16),whereGu(cid:15)q−1(cid:16)isthe“usefulpart”andGn(cid:15)q−1(cid:16)istheparttobeneglected.ThebandpassﬁlterischoseninawaythatHbp(cid:15)e−iω(cid:16)Gu(cid:15)e−iω(cid:16)(cid:9)Gu(cid:15)e−iω(cid:16)Hbp(cid:15)e−iω(cid:16)Gn(cid:15)e−iω(cid:16)(cid:9)0.348LinearSystemsInabsenceofnoise,theinputsandoutputssatisfytherelationy(t)=(cid:25)Gu(cid:15)q−1(cid:16)+Gn(cid:15)q−1(cid:16)(cid:26)u(t).MultiplyingthetwosidesofthisequalitybyHbp(cid:15)q−1(cid:16),weobtaintherelationsatisﬁedbytheﬁlteredinputsandoutputsyf(t)=(cid:25)Gu(cid:15)q−1(cid:16)+Gn(cid:15)q−1(cid:16)(cid:26)uf(t),whichyieldsyf(t)(cid:9)Gu(cid:15)q−1(cid:16)uf(t).Letusnowexaminehowthisisformalizedinthepresenceofanoise.Considerthegeneralmodel(11.32)ofsection11.2.3andletH(cid:15)q−1,θ(cid:16)=Hi(q−1,θ)Hbp(q−1),(11.38)whereHi(cid:15)q−1,θ(cid:16)isthatpartofthestochastictermwhichistobeidentiﬁed;inH(cid:15)q−1,θ(cid:16),thispartismultipliedby1/Hbp(cid:15)q−1(cid:16)whichisthetransferfunctionofabandstopﬁlter.AccordingtoTheorem402,thepredictionerrorisgivenbyε(t)=1Hi(q−1,θ)yf(t)−G(cid:15)q−1,θ(cid:16)Hi(q−1,θ)uf(t).Asaresult,theheuristicmethodthatconsistsofsupplyingtheﬁltereddatatothealgorithmcanbeinterpretedasaparticularchoiceofthenoisemodel(accordingtorelation(11.38)).Figure11.2.Simulateddataandoutput–Example398Identiﬁcation349Figure11.3.Residueanalysis–Example398Figure11.4.Stepresponses–Example398350LinearSystemsFigure11.5.Simulateddataandoutput–Example399Figure11.6.Residueanalysis–Example399Identiﬁcation351Figure11.7.Stepresponses–Example399Figure11.8.Simulateddataandoutput–Example403352LinearSystemsFigure11.9.Residueanalysis–Example403Figure11.10.Stepresponses–Example403Identiﬁcation353Figure11.11.Simulateddataandoutput–Example404Figure11.12.Residueanalysis–Example404354LinearSystemsFigure11.13.Stepresponses–Example404Figure11.14.Measurementnoise–Example405Identiﬁcation355Figure11.15.Simulateddataandoutput–Example405Figure11.16.Residueanalysis–Example405356LinearSystemsFigure11.17.Stepresponses–Example40511.3.Closed-loopidentiﬁcation11.3.1.DirectandindirectapproachConsiderasystemwithequation(11.34)wheretheﬁlter˘G(cid:15)q−1(cid:16)isstrictlycausal(butmaybeunstable)andtheﬁlter˘H(cid:15)q−1(cid:16)isbicausal,bistableandsuchthat˘H(0)=1.Thecasewherethevarianceλofthenoiseiszeroistrivial,thereforewewillassumeλ>0inwhatfollows.Inthepresentsection,wewilldiscusstheproblemofidentiﬁcationofthesystemwhenitisfedbackbyacausalregulator,accordingtotheequationu(t)=r(t)−K(cid:15)q−1(cid:16)y(t);(11.39)thefeedbacksystemisassumedtobestableandthereferencesignal{r(t)}satisﬁesHypothesis(H5)below:(H5):Foranyinstantstandτ,r(t)isindependentofthenoisew(τ).Hypothesis(H0’)ofsection11.2.3isreplacedbythehypothesis(H0”)hereafter(wherendenotesthenumberofcomponentsofθ).(H0”):TherandomvariableθtakesitsvaluesinasubsetDofRnsuchthatforanyθ0∈D,G(cid:15)q−1,θ0(cid:16)isthetransferfunctionastrictlycausalﬁlterstabilizedbythecontroller(11.39);H(cid:15)q−1,θ0(cid:16)isthetransferfunctionofabistableandbicausalﬁltersuchthatH(0,θ0)=1;GandHarerationalfunctionswithrespecttoq−1andtothecomponentsofθ0.Hypothesis(H1)ofsection11.2.2,whichisstillrealistic,isinforce.Identiﬁcation357Letusnowlookatwhatdifﬁcultyarisesintheidentiﬁcationprocessduetothefeedbackloop.Sincey(t)iscorrelatedwiththew(τ),τ≤t(duetoequation(11.32)),relation(11.39)introducesacross-correlationbetweenu(t)andthew(τ),τ≤t(seesection11.2.2,Remark395).Therefore,Hypothesis(H4)ofsection11.2.2isnotsatisﬁed,whichinvalidatestheproofofTheorem408(section11.2.5).Itisthereforenecessarytoreconsidertheproblemoftheconsistencyoftheestimator.DirectapproachThedirectapproachofclosed-loopidentiﬁcationconsistsinidentifyingthesystemusingtheinputandoutputsignals{u(t)}and{y(t)}whilethefeedbackloopisignored.Besides,thisisunavoidablewhenthecontrollerisunknown.Theanalysisofthedirectapproachiscarriedoutinsection11.3.2.IndirectapproachTheindirectapproach,whichisonlypossiblewhenthecontrollerisknown,consistsoftwosteps.1)Theﬁrststepconsistsinidentifyingthefeedbacksystem.Todothis,variousmethodsareofcoursepossible,inparticulartheonethatconsistsofminimizingthel2normofthepredictionerror.Forthefollowingdiscussion,wewillassumethatthisisthemethodbeingused;themodelofthefeedbacksystem,deducedfrom(11.32)and(11.39),canthenbewrittenasy(t)=Gc(cid:15)q−1,θ(cid:16)r(t)+Hc1(cid:15)q−1,θ(cid:16)w(t)(11.40)whereGc=G1+GK,Hc1=H1+GK.Letθ0∈D;wecancarryoutthebicausalspectralfactorizationofthesignalHc1(cid:15)q−1,θ0(cid:16)w(t)(seesection11.1.4,Theorem383)ifthissignalispersistentlyexciting,thatisifλ(cid:1)ϕww>0andHypothesis(H6)belowisinforce:(H6):Foranyθ0∈D,theﬁltersG(cid:15)q−1,θ0(cid:16)andK(cid:15)q−1(cid:16)havenopolesontheunitcircle.Underthishypothesis,model(11.40)canbeputintheformy(t)=Gc(cid:15)q−1,θ(cid:16)r(t)+Hc(cid:15)q−1,θ(cid:16)w(cid:2)(t)(11.41)where,accordingtoHypothesis(H0”),foranyθ0∈D,Gc(cid:15)q−1,θ0(cid:16)isthetransferfunctionofastableandstrictlycausalﬁlter,Hc(cid:15)q−1,θ0(cid:16)isthetransferfunctionofa358LinearSystemsbicausalbistableﬁltersuchthatHc(0,θ0)=1,andw(cid:2)isawhitenoise,withvariancesameasw;wandw(cid:2)arenotdistinguishedinthesequel.Inotherwords,themodel(11.41)satisﬁesHypothesis(H0’)(section11.2.3).AccordingtoHypothesis(H1)mentionedabove,wecandeterminetheoptimalone-steppredictionˆy(t|t−1)basedonmodel(11.41);thispredictionisgiven(accordingtoTheorem402,section11.2.3)byˆy(t|t−1)=(cid:27)1−1Hc(q−1)(cid:28)y(t)+Gc(cid:15)q−1(cid:16)Hc(q−1)r(t).(11.42)Hypothesis(H5)meansthatHypothesis(H4)isalsoinforceformodel(11.41)(mutatismutandis).Let˘Gc=˘G1+˘GK,˘Hc1=˘H1+˘GKand,assumingthat˘GandKdonothavepolesontheunitcircle,let˘Hc(cid:15)q−1(cid:16)beabistablebicausalﬁltersuchthat˘Hc(cid:15)q−1(cid:16)˘Hc(q)=˘Hc1(cid:15)q−1(cid:16)˘Hc1(q)and˘Hc(0)=1.WehaveGc=˘GcandHc=˘HcifandonlyifG=˘GandH=˘H;consequently:LEMMA411.–Thefeedbacksystemisidentiﬁablewithmodel(11.41)ifandonlyiftheopen-loopsystemisidentiﬁablewithmodel(11.32).Now,letusconsiderHypothesis(H3’)below:(H3’):Thesignal{r(t)}persistentlyexcitingofinﬁniteorder.REMARK412.–(i)Thesysteminputuisgivenbyu(t)=11+˘G(q−1)K(q−1)r(t)−K(cid:15)q−1(cid:16)˘H(cid:15)q−1(cid:16)1+˘G(q−1)K(q−1)w(t).(11.43)Letthesensitivityfunctionbe˘So(cid:15)z−1(cid:16)=11+˘G(z−1)K(z−1).WehaveaccordingtoHypothesis(H5)ϕuu=)))˘So)))2ϕrr+)))K˘H˘So)))2λ(11.44)Identiﬁcation359(wherethetransferfunctionsareevaluatedontheunitcircle).Therefore,ifHypothesis(H3’)isinforceorifK(cid:5)=0,{u(t)}isapersistentlyexcitingsignalofinﬁniteorder.(ii)Accordingto(11.43),thetransferfunctionbetweenwanduisG1=−K˘H/(cid:9)1+˘GK(cid:10).ApplyingtheInterferenceformula(11.1)(section11.1.4)withx1=x2=wandG2=1,wegetRuw(z)=G1(cid:15)z−1(cid:16)λ;thus,accordingtoProposition377(section11.1.3)ϕuwϕwu=)))K˘H˘So)))2λ2.(11.45)Letˆθ(t)betheestimatordeﬁnedby(11.21),whereJisdeﬁnedby(11.19)and(11.18),andˆy(t|t−1)isgivenby(11.42).TheresultbelowfollowsimmediatelyfromtheaboveandfromTheorem408:COROLLARY413.–SupposeHypotheses(H0”),(H1),(H3’),(H5)and(H6)areinforce.Iftheopen-loopsystem(11.34)isidentiﬁablewithmodel(11.32),thentheestimatorˆθ(t)ofthefeedbacksystem(designedbasedonmodel(11.41))isconsistent.REMARK414.–Supposemodel(11.32)canbeputintheform(11.35).ThenGcdependsonlyonθs(i.e.onthatpartoftheparameterθwhichonlycharacterizesthedeterministicpartoftheopen-loopsystem)andthereforecanbewrittenasGc(cid:15)q−1,θs(cid:16).Ontheotherhand,eventhoughHonlydependsonθν(i.e.thatpartoftheparameterθthatonlycharacterizesthestochasticpartoftheopen-loopsystem),Hcdependsonbothθνandθs,thusentirelyonparameterθ.Asaresult,ifwereplacethehypothesisofsystemidentiﬁabilityinthestatementofCorollary413bythehypothesisofidentiﬁabilityofthedeterministicpartoftheopen-loopsystem(withtheotherhypothesesremainingunchanged),wecannotguaranteetheconsistencyoftheestimatorofthispart(seetheproofofTheorem408).Butthehypothesisoftotalsystemidentiﬁability(includingthestochasticpart)issometimestoostrong,thuswewillrevisitthissubjectlater(seesection11.3.3).2)Thesecondstepconsistsofdetermining,usingtheestimateˆGc(cid:15)q−1(cid:16)oftheactualclosed-looptransferfunction˘Gc(cid:15)q−1(cid:16),anestimateˆG(cid:15)q−1(cid:16)oftheactualopen-looptransferfunction˘G(cid:15)q−1(cid:16).Wehavetheequality˘G=˘Gc1−˘GcK.Asaresult,ˆG=ˆGc1−ˆGcK(11.46)360LinearSystemsisanestimateof˘G(cid:15)q−1(cid:16),anditisthisonethatisusedintheclassicindirectapproach.IftheestimateˆGc(cid:15)q−1(cid:16)of˘Gc(cid:15)q−1(cid:16)wereperfect(thatis,ˆGc(cid:15)q−1(cid:16)=˘Gc(cid:15)q−1(cid:16)),(11.46)wouldcertainlybeaperfectestimateof˘G(cid:15)q−1(cid:16).However,inpractice,(11.46)mightwellbeapoorestimateof˘G(cid:15)q−1(cid:16)duetothefactthattheestimateˆGc(cid:15)q−1(cid:16)of˘Gc(cid:15)q−1(cid:16)isinevitablyspoiltbyerrors.Thus,ˆGc(cid:15)q−1(cid:16)mayhavetoohighanorder,generateinstabilities,notcorrespondtoanythingreal,etc.11.3.2.ConsistencyofestimatorinthedirectapproachIdentiﬁcationoftheglobalsystemInthedirectapproachinastrictsense,aswasalreadybeenmentioned,thecontrollerisnotsupposedtobeknown.UnderHypotheses(H0”)and(H1),theone-stepoptimalpredictionˆy(t|t−1)andthepredictionerroraregivenby(11.33)and(11.37),respectively.Thislastexpressioncanbewrittenintheformε(t)=1H(q−1,θ)z(t)+w(t),z(t)=∆G(cid:15)q−1,θ(cid:16)u(t)−∆H(cid:15)q−1,θ(cid:16)w(t),(11.47)where∆G(cid:15)q−1,θ(cid:16)=˘G(cid:15)q−1(cid:16)−G(cid:15)q−1,θ(cid:16),∆H(cid:15)q−1,θ(cid:16)=˘H(cid:15)q−1(cid:16)−G(cid:15)q−1,θ(cid:16).Letˆθ(t)betheestimatordeﬁnedby(11.21),whereJisdeﬁnedby(11.19)and(11.18).LEMMA415.–SupposeHypotheses(H0”)and(H1)areinforce;iftheintegralinexpression(11.48)belowadmitsaminimum,thenˆθ(t)→θ•ast→+∞,where,with∆G=∆G(cid:15)e−iω,θ(cid:16),∆H=∆H(cid:15)e−iω,θ(cid:16),(.)∗=conjugateof(.),θ•∈argminθ∈D12π(cid:2)π−π1|H(e−iω,θ)|2ϕzz(ω)dω,(11.48)ϕzz(ω)=(cid:25)∆G−∆H(cid:26)ϕςς(ω)(cid:27)∆G∗−∆H∗(cid:28),(11.49)ϕςς(ω)=(cid:27)ϕuu(ω)ϕuw(ω)ϕwu(ω)λ(cid:28).(11.50)PROOF.AccordingtoHypothesis(H1),therandomvariablesz(t)andw(t)areindependent,thusE(cid:23)ε(t)2(cid:24)=1|H|2E(cid:23)z(t)2(cid:24)+λ,fromwhichwederive(11.48)ifaminimumsuchasthatmentionedexists(seesection12.6.4);forthisitissufﬁcientIdentiﬁcation361thatsystem(11.34)isidentiﬁablebasedonthemodel(11.32)).Theexpressionofϕzz(ω)isdeducedfrom(11.47).Ifsystem(11.34)isidentiﬁablebasedonthemodel(11.32),Lemma415showsthatitsestimatorˆθ(t)givenby(11.21)isconsistentifϕςς(ω)>0foraninﬁnitenumberofvaluesofωin[−π,π].Letϕruu(cid:1))))˘So)))2ϕrr,ϕwuu(cid:1))))K˘H˘So)))2λ,(11.51)where,accordingto(11.44),ϕuu=ϕruu+ϕwuu;ϕruu(resp.,ϕwuu)isthecontributionofsignalr(resp.,ofnoisew)tothespectraldensityϕuuofu.From(11.45),ϕwuu=ϕuw(ω)ϕwu(ω)/λ.PROPOSITION416.–Ifλ>0,thefollowingconditionsareequivalent:(i)Hypothesis(H3’)issatisﬁed.(ii)ϕruu(ω)>0foraninﬁnitenumberofvaluesofωin[−π,π].(iii)ϕςς(ω)>0foraninﬁnitenumberofvaluesofωin[−π,π].PROOF.(i)isequivalentto(ii)accordingto(11.51);(ii)isequivalentto(iii)accordingtoProposition576(section13.5.6),(11.50),andtheequalityϕruu=ϕuu−ϕuw(ω)ϕwu(ω)/λ.TheresultbelowisthusclearandconsistentwithCorollary413(section11.3.1):THEOREM417.–UnderHypotheses(H0”),(H1),(H3’),(H5)andλ>0,theestimatorˆθ(t)isconsistentiftheopen-loopsystem(11.34)isidentiﬁablebasedonmodel(11.32).IdentiﬁcationofthedeterministicpartInpractice,wemostoftenseektoidentifythedeterministicpartofthesystem(whichisthesubjectofinterestofTheorem408(i)inthecontextofopen-loopidentiﬁcation).Thehypothesisoftheidentiﬁabilityoftheglobalsystem(i.e.includingthestochasticpart)isoftentoostrong(seesection11.3.1,Remark414).Considernowthesituationwhereonlythedeterministicpartofthesystemisidentiﬁable.Inthefollowingsection,thesignal{u(t)}isassumedtobepersistentlyexciting(seeRemark412(i),section11.3.1).Accordingto(11.49),(11.50)andProposition576(section13.5.6),writingϕrww(ω)(cid:1)λ−ϕwu(ω)ϕuw(ω)/ϕuu(ω),362LinearSystemsB(cid:15)e−iω(cid:16)(cid:1)∆H(cid:15)e−iω(cid:16)ϕuw(ω)/ϕuu(ω),(11.52)weget(cid:25)∆G−∆H(cid:26)ϕςς(ω)(cid:27)∆G∗−∆H∗(cid:28)=(cid:25)∆G+B−∆H(cid:26)(cid:27)ϕuu00ϕrww(cid:28)(cid:27)(∆G+B)∗−∆H∗(cid:28).Notethataccordingto(11.44),(11.45)and(11.51),ϕrww=λϕruuϕuu.(11.53)From(11.48),wegetθ•∈argminθ∈D12π(cid:2)π−πϕuu|H|2(cid:20)|∆G+B|2+|∆H|2ϕrwwϕuu&dω(11.54)(i)Ifthestochasticpartisnotidentiﬁable,wecannothave∆H=0,whichimpliesB(cid:5)=0accordingto(11.52).Itfollowsthatwewillnothave∆G→0,andthustheestimatorofthedeterministicpartisasymptoticallybiased.Afortiori,itisthusnotconsistentaccordingtoRemark394(section11.2.2).(ii)Nevertheless,notethataccordingto(11.52)and(11.53)|B|2=|∆H|2λϕuuϕwuuϕuu,|∆H|2ϕrwwϕuu=|∆H|2λϕuu(cid:21)1−ϕwuuϕuu(cid:22),thus,if|∆H|bounded,ifλ/ϕuu→0,andifϕwuu/ϕuu→0(inotherwords,ifthesignal-to-noiseratiobecomesinﬁnitelylarge),thentheintegrandof(11.54)tendstoϕuu|H|2|∆G|2.Thus,ifthedeterministicpartoftheopen-loopsystemisidentiﬁable,theintegralin(11.54)becomesminimumwhen∆G=0,andtheestimatorofthedeterministicpartbecomesconsistent(butthisisalmostatautology).Therefore,thedirectapproachleadstothesameconclusionastheindirectapproach(seeRemark414):exceptforthesituationwherethesignal-to-noiseratioissolargethatwecanconsiderthattheidentiﬁcationisrealizedintheabsenceofanoise,inordertoidentifythedeterministicpartoftheopen-loopsystem,itisnecessarytoidentifythissystemglobally,thusthissystemneedstobeentirelyidentiﬁable.Identiﬁcation36311.3.3.AthirdpathModiﬁeddirectapproachThepurposeofthisapproachistoresolvethedifﬁcultiesoutlinedintheprevioussection;eventhoughitisbasedonthedirectapproach,itutilizesexplicitlytheknowledgeofthecontroller.Themodeloftheopen-loopsystem(11.34)isassumedtobeoftheform(11.32)withG=G(cid:15)q−1,θs(cid:16)(ontheotherhand,Hisassumedtobeentirelydependentontheparameterθ,whichmakesthedifferencewiththemodel(11.35)).Inaddition,weassumethatθ=(θs,θβ),wheretherandomvariablesθsandθβareindependent,andthatthesetDdeﬁnedinHypothesis(H0”)isoftheformDs×Dβ.Accordingto(11.37),underHypotheses(H0”)and(H1),thepredictionerrorisgivenbyε(t)=1H(q−1,θ)(cid:25)∆G(cid:15)q−1,θs(cid:16)u(t)+v(t)(cid:26),wherev(t)=˘H(cid:15)q−1(cid:16)w(t)andu(t)satisﬁes(11.39).Usingthislastexpression,weobtainε(t)=˘So(cid:15)q−1(cid:16)H(q−1,θ)(cid:25)∆G(cid:15)q−1,θs(cid:16)r(t)+(cid:15)1+G(cid:15)q−1,θs(cid:16)K(cid:15)q−1(cid:16)(cid:16)v(t)(cid:26).Therefore,underHypothesis(H5),thespectraldensityϕεεof{ε(t)}satisﬁes(with∆Gθs=∆G(cid:15)e−iω,θs(cid:16),Hθ=H(cid:15)e−iω,θ(cid:16),etc.)ϕεε=1|Hθ|2|∆Gθs|2)))˘So)))2ϕruu+1|Hθ|2|1+GθsK|2)))˘So)))2ϕvv.(11.55)TheresultbelowcanbeproventhesamewayasTheorem383(section11.1.4):LEMMA418.–UnderHypothesis(H6),thereexistsauniquerationalfunctionR(cid:15)z−1,θs(cid:16)suchthatforanyθs∈Ds,theﬁlterR(cid:15)q−1,θs(cid:16)isbicausal,bistable,suchthatR(0,θs)=1,and|Rθs|2=|1+GθsK|2.12Thecriteriontobeminimizedbecomesast→+∞J(θ)=12π(cid:2)π−πϕεε(ω)dω.ChooseH(cid:15)q−1,θs,θβ(cid:16)oftheformH(cid:15)q−1,θs,θβ(cid:16)=R(cid:15)q−1,θs(cid:16)H(cid:15)q−1,θβ(cid:16),(11.56)12.Thevariableθ0sisdenotedbyθs,formoresimplicity.364LinearSystemswhereforeveryθβ∈Dβ,theﬁlterH(cid:15)q−1,θβ(cid:16)isbicausal,bistableandsuchthatH(0,θβ)=1.WethushaveJ(θ)=J1(θs,θβ)+J2(θβ),(11.57)J1(θs,θβ)=12π(cid:2)π−π1|Hθ|2|∆Gθs|2)))˘So)))2ϕruudω,J2(θβ)=12π(cid:2)π−π1))Hθβ))2)))˘So)))2ϕvvdω.THEOREM419.–SupposeHypotheses(H0”),(H1),(H3’),(H5)and(H6)areinforceandthedeterministicpartoftheopen-loopsystem(11.34)isidentiﬁable.Assumealsothatthemodelchosenfortheidentiﬁcationis(11.32)withHoftheform(11.56).Then,theestimatorˆθs(t)ofthedeterministicpartofthesystemisconsistent.PROOF.Accordingto(H0”)and(H1),theoptimalone-steppredictionˆy(t|t−1)isgivenby(11.33).Accordingto(H5),ϕεεisoftheform(11.55)andfrom(H3’),ϕruu(ω)>0foraninﬁnitenumberofvaluesofωin[−π,π](seeProposition416).Hypothesis(H6)allowsonetowrite(11.56),andsincethedeterministicpartofthesystemisidentiﬁable,J1(θs,θβ)isminimum(andequalto0)ifandonlyif∆G(cid:15)q−1,θs(cid:16)=0,i.e.θs=˘θs.(Ontheotherhand,ast→+∞,ˆθβ(t)→ˆθβ•,whereˆθβ•∈argminθβ∈DβJ2(θβ),ifJ2(θβ)admitsaminimum.)RelationwiththeindirectapproachTheone-steppredictor(11.33),fedbackbythecontroller(11.39),canbewritten(inclosed-loop)ˆy(t|t−1)=#1−1+G(cid:15)q−1,θs(cid:16)K(cid:15)q−1(cid:16)H(q−1,θ)$y(t)+G(cid:15)q−1,θs(cid:16)H(q−1,θ)r(t).(11.58)1)Supposethatforeveryθs∈Ds,G(cid:15)q−1,θs(cid:16)isstable,andK(cid:15)q−1(cid:16)aswell.ThenR(cid:15)q−1,θs(cid:16)=1+G(cid:15)q−1,θs(cid:16)K(cid:15)q−1(cid:16)and,accordingto(11.56),(11.58)canbewrittenasˆy(t|t−1)=(cid:27)1−1H(q−1,θβ)(cid:28)y(t)+Gc(cid:15)q−1,θs(cid:16)H(q−1,θβ)r(t),anexpressionthatbecomesidenticalto(11.42)if,inthislastequation,wereplaceHc(cid:15)q−1,θ(cid:16)byH(cid:15)q−1,θβ(cid:16).2)Conversely,ifwemakeuseoftheindirectapproachofsection11.3.1with(i)G=G(cid:15)q−1,θs(cid:16),andthusGc=Gc(cid:15)q−1,θs(cid:16),and(ii)Hc(cid:15)q−1,θ(cid:16)replacedbyIdentiﬁcation365H(cid:15)q−1,θβ(cid:16)(inotherwords,providedthatthedeterministicpartandthestochasticpartoftheclosed-loopsystemarecharacterizedbyindependentparameters),Theorem408(i)(section11.2.5)showsthatunderHypotheses(H0”),(H1),(H3’)and(H5)13,weobtainforthedeterministicpartoftheclosed-loopsystemaconsistentestimatorˆθs(t)(theproblemmentionedinRemark414isthusresolved).Ontheotherhand,thedifﬁcultyinherenttothesecondstepoftheindirectapproach,initsclassicformulation,isavoided.Indeed,ˆθs(t)isanestimatorofthedeterministicpartoftheopen-loopsystemaswellasofthedeterministicpartoftheclosed-loopsystem.EXAMPLE420.–LetustakeExample399(section11.2.2)again.Thistime,thesystemisfedbackbyaproportionalcontrollerwithgaink=0.4(accordingtotherelationu=k(r−y)).ThesystemisidentiﬁedinadirectapproachbytheARMAXmethod(withnA=nB=nC=2,likeinExample404,wherenPdenotesthenumberofunknownparametersofpolynomialP=A,BorC).ThereferencesignalisaPRBSofamplitude1,themeasurementnoisewisaGaussianwhitenoiseofstandarddeviation1andtheidentiﬁcationiscarriedoutover1000points.Theorem417isapplicable.Theinputandtheoutput,overtheﬁrst200points,arerepresentedinFigure11.18(–),aswellastheoutputsimulatedbasedontheidentiﬁedmodelintheabsenceofanoise(--).TheresidueanalysisisshowninFigure11.19.Weseethatthepredictionerror{ε(t)}iswhitenedcorrectly;ontheotherhand,ε(t)isnotcorrelatedwiththeinputu(τ),τ>t(butiscorrelatedwiththeu(τ),τ≤t,inaccordancewiththeobservationmadeatthebeginningofsection11.3.1).Forveriﬁcationpurposes,thetransferfunctionoftheidentiﬁedcontinuous-timesystemisˆG(s)=1.139s−1.974s2+0.1495s+0.9825andthusiscloseto(11.24).Thestepresponsesoftheactualsystem(–)andoftheidentiﬁedsystem(--),showninFigure11.20,conﬁrmthegoodqualityoftheidentiﬁcation.Nevertheless,thecomparisonwiththeresultsobtainedinExample404showsthattheclosed-loopidentiﬁcationis(duetothecross-correlationbetweentheinputandtheoutput)anunfavorablecircumstance.11.4.ExercisesEXERCISE421.–ConsidertheARXmodely(t)+ay(t−1)=bu(t−1)+w(t).13.Hypothesis(H6)thusbecomesuseless.366LinearSystemsFigure11.18.Simulateddataandoutput–Example420Figure11.19.Residueanalysis–Example420Identiﬁcation367Figure11.20.Stepresponses–Example420(i)Letθ=(cid:25)ab(cid:26).Expressˆθ(t)asafunctionofryy,ryuandruuwhent→+∞.(ii)Weobtainexperimentallyryy(0)=0.03,ryy(1)=−10−3,ruu(0)=0.05,ryu(0)=−0.02andryu(−1)=−0.036.Calculater(cid:2)yy(1),r(cid:2)yu(0)andr(cid:2)yu(−1).Aretheresultscoherent?(iii)Determinetheidentiﬁedcoefﬁcientsˆaandˆb.(iv)Istheidentiﬁedsystemstable?Whatisitsstaticgain?EXERCISE422.–Considerthe“PEMmodel”(11.31).Determinethepredictionerrorasafunctionofthedataanditsvariouspolynomials,andthenthepartialderivativesofthiserrorwithrespecttothecoefﬁcientsofthesepolynomials.EXERCISE423.–WeconsiderthesystemofExample398andwetrytoidentifythissystemusingtheOutputErrormethod.Assumingthatthedeterministicpartisidentiﬁable,istheestimatorofthispartconsistentwhenHypotheses(H1)and(H3)ofsection11.2.2areinforce?EXERCISE424.–WeconsiderthesystemofExample405andwetrytoidentifythissystemusingtheARMAXmethod.(i)Assumethatthedeterministicpartisidentiﬁable(thevectorθsofDeﬁnition407beingcomposedofthecoefﬁcientsofthepolynomialsAandBoftheARMAXmodel).ArethehypothesesofTheorem408(i)satisﬁed?*(ii)Isitstillpossibletoobtainacorrectestimationofthe“deterministicpart”?(Ifyes,indicatehow).*368LinearSystemsEXERCISE425.–ConsiderasystemhavingthestructureA(cid:15)q−1(cid:16)y(t)=q−rB(cid:15)q−1(cid:16)u(t)+C(cid:15)q−1(cid:16)D(q−1)w(t)(11.59)withtheusualconventions.(a)ShowthatA(cid:15)q−1(cid:16)y(t)=q−rB(cid:15)q−1(cid:16)u(t)+1D1(q−1)w(t),(11.60)whereD1(cid:15)q−1(cid:16)isapowerseriesinq−1.(b)Justifythefactthat(11.60)isacorrectapproximationof(11.59)whenD1(cid:15)q−1(cid:16)isapolynomialofsufﬁcientlyhighdegreesuchthat))D1(cid:15)z−1(cid:16)))>0for|z|≥1.(c)Multiplyingthetwosidesof(11.60)byD1(cid:15)q−1(cid:16),showthatwecanidentifywithagoodprecision˜A(cid:15)q−1(cid:16)(cid:1)A(cid:15)q−1(cid:16)D1(cid:15)q−1(cid:16)and˜B(cid:15)q−1(cid:16)(cid:1)B(cid:15)q−1(cid:16)D1(cid:15)q−1(cid:16)usingtheleastsquaresmethod(and,possibly,recursiveleastsquares).(Thisprocedureisoneofthevariantsofthegeneralizedleastsquaresmethodcalledtheindirectprocedure.)EXERCISE426.–Letustakesystem(11.32)whereG(cid:15)q−1,θ(cid:16)=Gc(cid:15)q−1(cid:16)Gi(cid:15)q−1,θ(cid:16)H(cid:15)q−1,θ(cid:16)=Hc(cid:15)q−1(cid:16)Hi(cid:15)q−1,θ(cid:16)andwhereGc(cid:15)z−1(cid:16)andHc(cid:15)z−1(cid:16)areknowntransferfunctions,Gi(cid:15)z−1,θ(cid:16)andHi(cid:15)z−1,θ(cid:16)aretobeidentiﬁed(usualhypothesesareinforce:Gc(cid:15)q−1(cid:16)andGi(cid:15)q−1,θ(cid:16)arecausalandstable,Hc(cid:15)q−1(cid:16)andHi(cid:15)q−1,θ(cid:16)arebicausalbistableandsuchthatHc(0)=Hi(0,θ)=1).Howcanweestimateθ?EXERCISE427.–(i)IsitpossibletotreatExample420correctlyusingtheOutputErrormethod?(ii)Accordingtothetheorydiscussedinsection11.3.3,isitpossibletotreatcorrectlyExample420withanARMAXmodelwhosestochasticparthaslesscoefﬁcients(nC=1forexample)?EXERCISE428.–Gooverthedevelopmentofthischapteragainandcarefullydistinguishbetweennoisesw(t)and˘w(t)ofthemodelandofthesystemrespectively,andthusjustifyRemark390(ii).Chapter12Appendix1:AnalysisWhatispresentedhereisabriefsummaryofafewelementsofanalysiswhichareveryusefulincontroltheory.Theneedforconcisenessisnotcompatiblewiththerigorrequiredinpuremathematics.Moreprecisepresentationsincludingproofscanbefoundinnumerousbooks([35],[103],[83],amongothers).ThetheoryofmeasureandintegrationisonlytoucheduponinRemark431below;thisshouldnotbeaninconvenienceforthereaderwhohasnotstudiedthissubject,whichisdevelopedingreatdetailin([35],vol.II),orin[103],usingadifferentapproach.*Followingaresomeofthesimpliﬁcationsmade:weareonlyconcernedwithHausdorfftopologicalspaceswithacountablebase,whosetopologyiscompletelydescribedbytheconvergenceofsequences1;twofunctionsthatareequalalmosteverywhereinLebesgue’ssenseareconsideredequal(inotherwords,afunctionis“identiﬁed”withitsLebesgueclass);adistributionisexpressedthesamewayasafunctionandthe“integralnotation”(12.14)usedsystematicallybelow.*12.1.Topology12.1.1.TopologicalspacesOpensetsAtopologicalspaceEisaset,embeddedwithatopologyconsistingofopensets.Theopensetssatisfythefollowingaxioms:∅andEareopen,anyunionofopensetsisopen,aswellasanyﬁniteintersectionofopensets.IfAisasubsetofE,the1.Inthecaseoftopologicalspaceswithuncountablebase–inparticular,inspacesofdistributions–onehasonlytoreplacesequencesbynets,orequivalently,byﬁlters.369Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.370LinearSystemstopologyofAsaidtobe“inducedbythatofE”ifitsopensetsaretheΩ∩AwheretheΩ’saretheopensetsofE.SomefundamentalconceptsAclosedsubsetofEisthecomplementofanopensubsetofE.IfAisanon-emptysubsetofE(possiblyreducedtoonepoint),aneighborhoodofAinEisasubsetofEcontaininganopensetcontainingA.TheclosureofasubsetAofEisthesmallestclosedsubsetcontainingA,thatistheintersectionofallclosedsubsetscontainingA.AtopologicalspaceEissaidtobecompactiffromanycoveringofEbyafamilyofopensets,onecanextractaﬁnitesubcovering;onecanshowthatacompactsubsetofEisnecessarilyclosedinE.ThetopologicalspaceEisconnectediftheonlysubsetsofEwhicharebothopenandclosedare∅andE;roughlyspeaking,thismeansthatEis“allinonepiece”.LetEbeanytopologicalspaceandx∈E;theunionofallconnectedsubsetsofEcontainingxisaconnectedsetC(x),calledtheconnectedcomponentofxinE.TheintersectionoftwodistinctcomponentsofEisobviouslyemptyandEistheunionofitsconnectedcomponents.ConvergenceandcontinuityWesaythatasequence(xn)inthetopologicalspaceEconvergestoy∈EifforanyneighborhoodVof{y}(alsocalledaneighborhoodofy),thereexistsanintegerNsuchthatxn∈Vwhenevern≥N.AsubsetAofEissaidtobedenseinEifeverypointofEisalimitofasequenceofpointsofA.LetEandFbetwotopologicalspacesandletf:E→Fbeafunction.ThisfunctionissaidtobecontinuousifforanyopensubsetΩFofF,theinverseimagef−1(ΩF)isopeninE.Inthiscase,foranypointy∈Eandforanysequence(xn)whichconvergestoyinE,thesequence(f(xn))convergestof(y)inF;andconversely,ifthisconditionholds(*withthesimpliﬁcationsmentionedabove*),fiscontinuous.Iff:E→FiscontinuousandEiscompact,thenf(E)⊂Fiscompact.MetricspacesMetricspacesareamongthemostimportanttopologicalspaces.AmetricspaceisasetEequippedwithafunctiond:E×E→R+,calledadistance,suchthat(i)d(x,y)=d(y,x)andd(x,x)=0,(ii)d(x,y)+d(y,z)≤d(x,z)(“triangleinequality”),(iii)ifd(x,y)=0,thenx=y.2(Ifdonlysatisﬁes(i)and(ii)andifits2.Quantiﬁersareunderstoodwhenthereisnoambiguity.Appendix1:Analysis371codomainisR+∪{+∞},thisfunctioniscalledapseudometric.)If(E,d)isametricspace,theopen(resp.,closed)ballwithcenterxandradiusr(x∈E,r≥0)isthesetofally∈Esuchthatd(x,y)<r(resp.,d(x,y)≤r).Ofcourse,anopenballwithzeroradiusistheemptyset.Letx∈EandVn,x={y∈E:d(x,y)≤1/n}.ThesetofallVn,x,n≥1,isafundamentalsystemofneighborhoodsofx,inotherwordsasetWxisaneighborhoodofxifandonlyifthereexistsn≥1suchthatVn,x⊂Wx.Therefore,anopensetofEisaunionofopenballs.CompletenessAsequence(xn)inametricspace(E,d)iscalledaCauchysequenceifd(xn,xm)tendsto0asnandmbothtendtoinﬁnity.AllconvergentsequencesareCauchy,buttheconverseisfalseingeneral.AmetricspaceinwhicheveryCauchysequenceconvergesissaidtobecomplete.12.1.2.TopologicalvectorspacesGeneraldeﬁnitionLetEbeavectorspacedeﬁnedovertheﬁeldK=RorC(RdenotestheﬁeldofrealnumbersandCtheﬁeldofcomplexnumbers).Wewillequipthisspacewithatopologywhichiscompatiblewithitsalgebraicstructure,i.e.suchthatthefollowingtwoconditionshold:–if(λn)isasequenceofnumbersconvergingtoλinK,andif(xn)isasequenceofelementsofEconvergingtoxinE,thenthesequence(λnxn)convergestoλxinE;–if(yn)isanothersequenceofelementsofEconvergingtoapointyinE,thenthesequence(xn+yn)convergestox+y.Notethataccordingtotheabovecompatibilityconditions,(xn)convergestoxifandonlyifxn−xconvergesto0.AK-vectorspaceequippedwithsuchatopologyiscalledatopologicalvectorspace.IfEandFaretwotopologicalvectorspaces,anisomorphismfromEontoFisabijectivelinearfunctionofE→F,whichiscontinuousaswellasitsinversefunction.NormedvectorspaceAseminormonEisafunction(cid:23).(cid:23):E→R+suchthatthefollowingtwoconditionshold:–(cid:23)λx(cid:23)=|λ|(cid:23)x(cid:23)(whereλisascalar,i.e.anelementofK);–(cid:23)x+y(cid:23)≤(cid:23)x(cid:23)+(cid:23)y(cid:23)(“triangleinequality”).372LinearSystemsTherefore,d(x,y)=(cid:23)x−y(cid:23)isapseudometric.Thefunction(cid:23).(cid:23)isanormifthefollowingsupplementaryconditionholds:–if(cid:23)x(cid:23)=0,thenx=0(thatisiftheabovepseudometricisadistance).Thetopologyofanormedvectorspacecanbecharacterizedasfollows:asequence(xn)ofelementsofEconvergesto0inEifandonlyifthesequence((cid:23)xn(cid:23))tendsto0inR.(However,thetopologyofatopologicalvectorspaceisnotalwaysdeﬁnedbyanormnorbyadistance.Inparticular,thisisthecaseofdistributionspaceswhichwillbestudiedlater.)AboundedsubsetofEisasetincludedinaball.ACauchysequenceinEisbounded.3Avectorxsuchthat(cid:23)x(cid:23)=1issaidtobeunitaryandthesetofunitaryvectorsformsthe“unitsphere”.LetEbeanormedvectorspace.AcompactsubsetofEisnecessarilyclosedandbounded(butifEisinﬁnite-dimensional,thereexistclosedandboundedsubsetsofEwhicharenotcompact).IfEiscomplete,itiscalledaBanachspace.CaseofRandCInparticular,anopenballofRisanopenintervaloftheform(a,b),−∞<a≤b<+∞.InthecomplexplaneC,theopenballwithcenterzandradiusr≥0isnothingbuttheopendiscwithcenterzandradiusr,whichisthesetofs∈Csuchthat|z−s|<r.DualityAlinearformfonEisalinearfunctionfromEintoK.Foranyx∈E,thescalarf(x)isoftendenotedby f,x!(“dualitybracket”).Thesetofalllinearforms(resp.,ofallcontinuouslinearforms)onEisaK-vectorspace,whichwecallthealgebraicdual(resp.,thetopologicaldual)ofEandwedenotebyE∗(resp.,E(cid:2)).IfEisﬁnite-dimensional,E∗andE(cid:2)coincide.IfEisanormedvectorspace,wecandeﬁneanormonE(cid:2)(seesection12.1.3).Thetopologydeﬁnedbythisnormiscalledthe“strongtopology”ofE(cid:2).WecandeﬁneonE(cid:2)anothertopology,calledtheweak*topology,inthefollowingmanner:let(x(cid:2)n)beasequenceofelementsofE(cid:2);wesaythatthissequenceweakly*convergesto0inE(cid:2)if,foranyy∈E,thesequence( x(cid:2)n,y!)tendsto0.HilbertspacesLetK=RorC.Apre-HilbertspaceEovertheﬁeldKisaK-vectorspaceequippedwithascalarproductdenotedas .,.!.Thisscalarproductisapositive3.ThisdoesnotholdforaCauchynet.Appendix1:Analysis373deﬁniteHermitianform,i.e.afunctionfromE×EintoKforwhichthefollowingconditionshold:– x+x(cid:2),y!= x,y!+ x(cid:2),y!and x,y+y(cid:2)!= x,y!+ x,y(cid:2)!;– x,λy!=λ x,y!;thus,thefunction x,.!:y(cid:3)→ x,y!islinear;4– x,y!= y,x!(HermitiansymmetryifK=C,symmetryifK=R);– x,x!∈R+and x,x!=0ifandonlyifx=0.Onecaneasilyshowthatthefunctionx(cid:3)→% x,x!(cid:1)(cid:23)x(cid:23)isanormonE,calledapre-Hilbertnorm.Apre-HilbertspaceisthusaparticulartypeofnormedK-vectorspace.WehavetheSchwarzinequality:| x,y!|≤(cid:23)x(cid:23)(cid:23)y(cid:23).(12.1)NotethatifK=C,thefunctionx→ x,y!isantilinear5,whereasitwouldbelinearif .,.!wereadualitybracket.Acompletepre-HilbertK-spaceiscalledaHilbertspace.Apre-HilbertnormonaHilbertspaceiscalledaHilbertnorm.Thefollowingisthe“orthogonalprojectiontheoreminHilbertspaces”:THEOREM429.–LetEbeapre-HilbertspaceandF(cid:5)={0}beacompletesubspaceofE.Foranyx∈E,thereexistsoneandonlyonepointofF,denotedbyˆx,suchthat(cid:23)x−ˆx(cid:23)=miny∈F(cid:23)x−y(cid:23).Thispointischaracterizedbytherelation y,x−ˆx!=0forally∈F,andisthustheorthogonalprojectionofxontoF.Thefunctionx(cid:3)→ˆxisK-linear(itisalsocontinuouswithnorm1:seesection12.1.3).Finite-dimensionalspacesAccordingtotheRiesztheorem,ifEisaﬁnite-dimensionalK-vectorspace,thereexistsauniquetopologyonEcompatiblewithitsstructureofK-vectorspace.Inaddition,ifFisatopologicalvectorspaceandiffisalinearfunctionfromEintoF,fisnecessarilycontinuous.IntheelementsofalgebrainChapter13,weareonlyconcernedwithﬁnitedimension,thereforethenotionofcontinuity(whichisnotalgebraic)isneverdiscussed;fromacertainpointofview,wecanconsiderthatitisunderstood.AK-vectorspaceofdimensionn<+∞isidentiﬁedwith4.Accordingtoanequivalentbutdifferentconvention,thefunction(cid:8).,y(cid:9):x(cid:10)→(cid:8)x,y(cid:9)isassumedtobelinear.5.Afunctionf:x(cid:10)→f(x)isantilineariff(x1+x2)=f(x1)+f(x2)andf(λx)=¯λf(x).374LinearSystemsKnonceabasisischosen(seesection13.3.1).Thetopologyofthisspacecanthusbedeﬁnedbyoneofthefollowingnorms(amongothers):(cid:23)x(cid:23)1=(cid:11)ni=1|xi|,(cid:23)x(cid:23)∞=max1≤i≤n|xi|(withx=(x1,...,xn)).Asubsetofaﬁnite-dimensionalK-vectorspaceiscompactifandonlyifitisclosedandbounded.Everyﬁnite-dimensionalK-vectorspaceiscompleteandischaracterizedbythefactthatitislocallycompact,thatistosaythereexistcompactneighborhoodsof0(theunitballifthespaceisnormed,forexample).EuclideanandHermitianspacesLetEbeaﬁnite-dimensionalpre-HilbertspaceoverK.IfK=R,EiscalledanEuclideanspace,andapre-HilbertnormonsuchaspaceissaidtobeEuclidean.IfK=C,EiscalledaHermitianspaceandapre-HilbertnormonsuchaspaceissaidtobeHermitian.Obviously,anEuclideanspaceoraHermitianspaceisaHilbertspace;conversely,aﬁnite-dimensionalHilbertspaceisaEuclideanspaceoraHermitianspace.AHilbertK-spaceofdimensionnisidentiﬁedwithKninanorthonormalbasis;thevectorsofthisspacealsoidentiﬁedwiththecolumnvectorswithnentriesinK;thenthe“standardscalarproduct”is x,y!=x∗y(seeaboveaswellassection13.5.1).Thepre-Hilbertnorm(cid:23)x(cid:23)2associatedwiththisscalarproductiscalledthe“standardEuclideannorm”ifK=R,andiscalledthe“standardHermitiannorm”ifK=C.12.1.3.ContinuouslinearoperatorsLetEandFbetwonormedK-vectorspacesandletubeaK-linearfunctionfromEintoF(uisalsocalledalinearoperatorfromEintoF).Wesaythatuiscontinuous(inthenormtopology)if(cid:23)u(cid:23)<+∞,where(cid:23)u(cid:23)(cid:1)supx(cid:12)=0(cid:10)u(x)(cid:10)(cid:10)x(cid:10)=sup(cid:10)x(cid:10)≤1(cid:23)u(x)(cid:23)=sup(cid:10)x(cid:10)=1(cid:23)u(x)(cid:23)(12.2)(thereadercanprovethetwoequalitiesontheright-handsideasanexercise).ThecontinuouslinearoperatorsfromEintoFformaK-vectorspacedenotedbyL(E,F)andthequantity(12.2)deﬁnesanormonthisspace.Thisnormissometimescalledthe“operatornorminducedbythenormsofEandF”(andthe“operatornorminducedbythenormofE”ifE=F).FortheexplicitcalculationofthisnorminthecasewhereEandFareﬁnite-dimensionalHilbertspaces,seesection13.5.7.Appendix1:Analysis375Ifu∈L(E,F)andv∈L(F,G),whereE,FandGarenormedK-vectorspaces,wehave(cid:23)vu(cid:23)≤(cid:23)v(cid:23)(cid:23)u(cid:23)andweexpressthispropertybysayingthatanoperatornormismultiplicative.OnecanshowthatL(E,F)iscomplete,thusaBanachspace,ifFisaBanachspace.Inparticular,E(cid:2)=L(E,K)isaBanachspaceequippedwiththenorm(12.2);thisnormdeﬁnesthe“strongtopology”ofE(cid:2).Ifasequence(x(cid:2)n)ofelementsofE(cid:2)convergestozerointhistopology,thissequenceissaidtostronglyconvergetozero.IfEisﬁnite-dimensional,alllinearoperatorofEintoFarecontinuous(thisremainstrueifFisanytopologicalvectorspace).12.2.Sequences,functionsanddistributions12.2.1.Sequenceslpspaces–Casep∈[1,+∞)WedenotebylptheK-vectorspaceconsistingofallsequences(xn)n∈ZofelementsofKsuchthat+∞(cid:11)n=−∞|xn|p<∞.Then(cid:23)x(cid:23)p(cid:1)(cid:21)+∞(cid:11)n=−∞|xn|p(cid:22)1/p(12.3)isanormonlpandthatspace,equippedwiththenorm(12.3),isaBanachspace.Inthecasep=2,wedeﬁneonthespacel2thescalarproduct x,y!2(cid:1)+∞(cid:12)n−∞¯xnyn(12.4)where¯xnistheconjugateofxn.Thespacel2isaHilbertspace.–Casep=+∞Thespacel∞isthatofallboundedsequences;thisspaceisequippedwiththenorm(cid:23)x(cid:23)∞(cid:1)supn|xn|.(12.5)ThisisaBanachspace.376LinearSystemsThefollowingresultcaneasilybeshown:THEOREM430.–If1≤q≤p≤+∞,thenlq⊂lp.SequenceswithpositivesupportThesupportofasequence(xn)isthesetofallintegersnforwhichxn(cid:5)=0.Thissequence(xn)issaidtobewithpositivesupport,orpositivelysupported,ifxn=0forn<0.ConvolutionoftwosequencesGeneralcaseLethandubetwosequencesofelementsofK.Theirconvolutionproductisthesequencey,denotedy=h∗uanddeﬁnedbyyn=+∞(cid:11)k=−∞hn−kuk=+∞(cid:11)k=−∞hkun−k(12.6)undertheconditionthattheseriesconvergesforallvaluesofn.Notethatthefunction(h,u)(cid:3)→h∗uisbilinear(likeeveryproduct)andsymmetric(h∗u=u∗h).ConvolutionandlpspacesAseasilyshown,ifh∈l1,thentheaboveconvolutionproductiswell-deﬁnedwheneveru∈lp,p∈[1,+∞],andinthiscaseh∗u∈lp.Inaddition,wehavetheYounginequality(cid:23)h∗u(cid:23)p≤(cid:23)h(cid:23)1(cid:23)u(cid:23)p.(12.7)ThelinearoperatorHdeﬁnedbyHu=h∗uiscalledtheconvolutionoperatorwithkernelh.TheYounginequalityshowsthatifh∈l1,thenHiscontinuousfromlpintolpandthat(cid:23)H(cid:23)≤(cid:23)h(cid:23)1.ConvolutionofsequenceswithpositivesupportIfhanduaretwopositivelysupportedsequencesofcomplexnumbers,theirconvolutionproductymustexistandisalsopositivelysupportedsinceyn=n(cid:12)k=0hn−kuk.Appendix1:Analysis37712.2.2.FunctionsLebesguespacesREMARK431.–LetSbeasubsetofRandxbeafunctionfromSintoKnorfromSinto[−∞,+∞].Thefollowingnotionsareusedbelow:(a)themeasurabilityofS(inLebesgue’ssense);(b)themeasurabilityofx(inLebesgue’ssense);theintegral(cid:1)Sx(t)dt(inLebesgue’ssense);theLebesgueclassofx.(i)IfSisanintervalofR,themeasurabilityofxisnotastrongassumption.Indeed,thereisnoexplicitexampleofafunctionwhichisnotLebesgue-measurable,althoughusingtheaxiomofchoiceonecanprovethatsuchfunctionsexist[103].(ii)ThesetSisLebesgue-measurableifandonlyifsoisitscharacteristicfunctionκS:R→RdeﬁnedbyκS(t)=1ift∈SandκS(t)=0otherwise.ThesetSissaidtobeof(Lebesgue)measurezeroifitisof“zerolength”.Thishappens,inparticular,ifSiscountable.Forexample,thesubset[0,1]∩Qof[0,1]isofmeasurezero(althoughQisdenseinR),thusitscomplement[0,1]∩(R\Q)isofmeasure1.(iii)LetS⊂RbeLebesgue-measurable.TwofunctionsxandyfromSintoKnorfromSinto[−∞,+∞]aresaidtobeequalalmosteverywhereifZ={t∈S:x(t)(cid:5)=y(t)}isof(Lebesgue)measurezero.TheLebesgueclassofxconsistsofallfunctionsywhichareequaltoxalmosteverywhere.(iv)LetSbeanintervalofRandletxbeafunctionfromSintoKnorfromSinto[−∞,+∞].IfthereexistsintheLebesgueclassofxafunctionysuchtheusualRiemannintegral(cid:1)Sy(t)dtexists,thentheLebesgueintegral(cid:1)Sx(t)dtexists(i.e.xisLebesgue-integrableonS)andisequalto(cid:1)Sy(t)dt.Ontheotherhand,letx:S→Kn;theLebesgueintegral(cid:1)Sx(t)dtexistsifandonlyifxismeasurableand(cid:1)S(cid:23)x(t)(cid:23)dt<+∞.TheLebesguespacesLp(p∈[1,+∞])arespacesoffunctionswhichhavepropertiesverysimilartothoseoflpspaces.–Casep∈[1,+∞)WedenotebyLpthespaceofallfunctionsx:R→KwhichareLebesgue-measurableandsuchthat(cid:1)+∞−∞|x(t)|pdt<∞.ProvidedthatxisnotdistinguishedfromitsLesbesgueclass,LpiswrittenLpandthefunctionx(cid:3)→(cid:23)x(cid:23)p,asdeﬁnedbelow,isanormonLp:(cid:23)x(cid:23)p=(cid:21)(cid:2)+∞−∞|x(t)|pdt(cid:22)1/p.(12.8)Inthecasep=2,wedeﬁneonspaceL2thescalarproduct x,y!2(cid:1)(cid:2)+∞−∞¯x(t)y(t)dt(12.9)378LinearSystemswhere¯x(t)istheconjugateofthecomplexnumberx(t).Wehave(cid:23)x(cid:23)2=√<x,x>2.ThefunctionsbelongingtoL2aresaidtobesquareintegrable.Insignaltheory,thequantity(cid:23)x(cid:23)22iscalledtheenergyofthesignalx.Asaresult,L2canbeinterpretedasthespaceofsignalswithboundedenergy.–Casep=+∞Afunctionx:R→KissaidtobeessentiallyboundedifitismeasurableandthereexistsaﬁniteconstantM>0suchthat|x(t)|≤Malmosteverywhere.ThegreatestlowerboundofalltheconstantsMsatisfyingtheaboveconditionisdenotedas(cid:23)x(cid:23)∞(cid:1)ess.supt∈R|x(t)|.(12.10)ThespaceL∞isthatofallessentiallyboundedfunctionsandthefunctionL∞(cid:20)x(cid:3)→(cid:23)x(cid:23)∞∈R+isaseminorm.Again,providedthatxisnotdistinguishedfromitsLesbesgueclass,L∞iswrittenL∞,andtheaboveseminormisthenanormonL∞.Fromthepointofviewofsignaltheory,L∞canbeinterpretedasthespaceofsignalswithboundedabsolutevalue.AccordingtotheFisher–Riesztheorem,allLpspaces(p∈[1,+∞])areBanachspaces,andL2isaHilbertspace.Theorem430doesnothaveananalogueinthecaseoffunctions.FunctionswithpositivesupportThesupportofafunctionistheclosureofthesetofpointsatwhichitisnon-zero.Incontroltheory,weareessentiallyinterestedinfunctionswithpositivesupport,thatisinfunctionsxsuchthatx(t)=0fort<0.Hereiswhy.Consideracontrolsystemanditsinputu,deﬁnedinR;itisthusafunctionfromRintoKm(K=RorC).Ifweareonlyconcernedwiththebehaviorofthesystemfromaninitialinstantt0,whichwecanassumetobezero(bytranslationoftheoriginoftime),thenwealsoareonlyconcernedwiththerestrictionofutoR+.Theknowledgeofthisisequivalenttothatoftheproductu+=u1,where1istheunitstep,deﬁnedasfollows:1(t)=(cid:20)0,t<01,t≥0.Thisfunctionu+iswithpositivelysupported.Appendix1:Analysis379ConvolutionoftwofunctionsGeneralcaseLethandubetwofunctionsfromRintoK.TheirconvolutionproductisthefunctionyfromRintoK,denotedasy=h∗uanddeﬁnedbyy(t)=(cid:2)+∞−∞h(t−τ)u(τ)dτ=(cid:2)+∞−∞h(τ)u(t−τ)dτ(12.11)undertheconditionthattheintegralconvergesforallvaluesoft.Thefunction(h,u)→h∗uisbilinearandsymmetric.ConvolutionandLebesguespacesOnecanshowthatifh∈L1,thentheaboveconvolutionproductiswelldeﬁnedwheneveru∈Lp,p∈[1,+∞]andinthiscaseh∗u∈Lp.Inaddition,wehavetheYounginequality(cid:23)h∗u(cid:23)p≤(cid:23)h(cid:23)1(cid:23)u(cid:23)p.(12.12)LetHbethelinearoperatordeﬁnedbyHu=h∗u,calledtheconvolutionoperatorwithkernelh.TheYounginequalityshowsthatifh∈L1,thenHiscontinuousfromLpintoLpandthat(cid:23)H(cid:23)≤(cid:23)h(cid:23)1.Tocalculate(cid:23)H(cid:23)inthecasep=2,seesection13.6.2,Theorem589.AlgebraK+WedenotebyKthesetofalllocallyintegrablefunctionsfromRintoK(i.e.ofthosefunctionswhichareintegrableonallcompactintervals)andbyK+thesetconsistingofallpositivelysupportedfunctionsbelongingtoK.Forexample,thefunctiont→eαt1(t)belongstoK+,andthefunctiont(cid:3)→eet1(t)aswell.ForanyhandubelongingtoK+,integral(12.11)iswrittenasy(t)=(cid:2)t0h(t−τ)u(τ)dτ,thusitconverges;inaddition,h∗u∈K+.ThesetK+isacommutativeK-algebra(seesection13.1.1);indeed,itisbothaK-vectorspaceandacommutativeringwithconvolutionasaproduct.Wethuscallitaconvolutionalgebra.AnotherexampleofconvolutionalgebraisL1.Allthesealgebrasarecommutativesincetheconvolutionproductiscommutative.ContinuityofaconvolutionproductIfhandubelongtoK+andif,inaddition,hisalocallyboundedfunction(thatis,hisboundedonanycompactinterval),onecanshowthattheirconvolutionproducty=h∗uisacontinuousfunction.380LinearSystems12.2.3.DistributionsIntroductiontothenotionofdistributionLetTbeavectorspaceoffunctionsφ,fromRintoC,whichareveryregularinthefollowingsense:–theyareindeﬁnitelydifferentiable;–eithertheyhaveacompactsupport,andinthiscaseTisdenotedasD;orandtheydecreaseveryrapidlytoward0atinﬁnity,morepreciselyφanditsderivativesofallordersdecreasemorerapidlyintheneighborhoodofinﬁnity(inabsolutevalue)thananyfunctionoftheform1|tk|(wherekisanypositiveinteger):inthiscaseTisdenotedbyS.SpaceSiscalledthe“spaceofrapidlydecayingfunctionsatinﬁnity”.WecallTaspaceoftestfunctions.NowletfbeafunctionfromRintoC.Letusformtheintegral Tf,φ!(cid:1)(cid:2)+∞−∞f(t)φ(t)dt.(12.13)ForT=D,thisintegralconvergeswheneverf∈K.ForT=S,itconvergesforanyfunctionfinKthatisnotincreasing(inabsolutevalue)fasterthananypolynomialintheneighborhoodofinﬁnity;wedenotethesetofthesefunctionsbyO,andwecallthisthespaceof“slowlyincreasingfunctionsatinﬁnity”.Forexample,allpolynomialsintbelongtoO.Therefore,weassociatewithafunctionfthelinearformTf:φ→ Tf,φ!∈CwhichbelongstothedualT(cid:2)ofT(f∈KorO,dependingonwhetherT=DorS).IftwofunctionsfandgaresuchthatTf=Tg,onecanshowthatf=galmosteverywhere,thusfandgareidentiﬁed(byabuseoflanguage).TheknowledgeoffisequivalentthentothatofTf,whichmakesitpossibletoidentifyfwithTf.Intheintegralof(12.13),fandφplayasymmetricroleifthesefunctionsbelongtoL2accordingto(12.9):thedualofL2isL2itself.ButTisaspacemuchsmallerthanL2,thereforeitsdualT(cid:2)ismuchlarger(indeed,thestrongertheconditionsuponφ,thelargerthesetoffunctionsfforwhichtheintegral(12.13)converges).Inparticular,D(cid:2)islargerthanK,andS(cid:2)islargerthanO.Therefore,wehaveembeddedthespacesoffunctionsKandOinthelargerspaces,D(cid:2)andS(cid:2),respectively.TosumupO⊂S(cid:2)⊂D(cid:2)O⊂K⊂D(cid:2).Appendix1:Analysis381SpacesofdistributionsThespaceD(cid:2)iscalledthespaceofdistributions.ThespaceS(cid:2)iscalledthespaceoftempereddistributions.AdistributionisthusalinearformT:φ(cid:3)→ T,φ!(T∈T(cid:2)).Thespacesofdistributionsareequippedwiththefollowingtopologicalstructure:asequence(Tn)ofT(cid:2)convergestoT∈T(cid:2)ifforanytestfunctionφ∈T, Tn,φ!convergesto T,φ!.6Withthisdeﬁnition,TcanbeprovedtobedenseinT(cid:2)andinLp,p∈[1,+∞).Takingintoaccountrelation(12.13),weﬁnditconvenienttodenotethedualitybracket<T,φ>byanintegral,i.e. T,φ!=(cid:2)+∞−∞T(t)φ(t)dt(12.14)wherethedistributionTthusappearsthesamewayasafunctiont(cid:3)→T(t).Butitisa“generalizedfunction”7whichonlyhasmeaningunderasummation,asin(12.14).Adistributionwhichisnotafunctionissaidtobe“singular”.SupportofadistributionWesaythatadistributionTiszeroinanopensubsetΩofRif T,φ!=0foranyfunctionφ∈T,thesupportofwhichisincludedinΩ.TheunionofallopensubsetsinwhichTiszeroisthelargestopensetinwhichTvanishes.ItscomplementS,whichisclosed,isbydeﬁnitionthesupportofTandisdenotedbysuppT.NowletΩbeanopenneighborhoodofS=suppTandφ1,φ2betwofunctionsofTthatareequalinΩ.Thenφ=φ1−φ2iszeroinΩ,thereforesuppφisincludedinthecomplementofΩwhichisitselfincludedinS.Asaresult, T,φ!=0,whichimpliesthat T,φ1!= T,φ2!.Thisshowsthat T,φ!onlydependsontherestrictionofφtoanyopenneighborhoodofS.Forexample,ifThasasupportincludedin[t1,t2](resp.,[t1,+∞)),wecanwrite T,φ!=(cid:2)t+2t−1T(t)φ(t)dt(resp., T,φ!=(cid:2)+∞t−1T(t)φ(t)dt)(12.15)6.*Thisisthedeﬁnitionweak*topology(seesection12.1.2).ButduetotheveryspeciﬁctopologicalpropertiesofT(T,andthusT(cid:3),areMontelspaces),weak*convergenceandstrongconvergenceofsequencescoincideinT(cid:3)[106].*7.SoarealsoSato’shyperfunctions[22].382LinearSystemswherebyconvention(cid:2)t+2t−1(cid:1)limε1→0+,ε2→0+(cid:2)t2+ε2t1−ε1.Thisgeneralizesinthecaseofdistributionsthenotionofsupportdeﬁnedforfunctions,exceptthatinthecaseofafunction,t−1andt+2canbereplacedbyt1andt2,respectively.Aseasilyseen,everycompactlysupporteddistributionistempered.WedenotebyT(cid:2)+thesubspaceofT(cid:2)consistingofpositivelysupporteddistributionsandforanysuchdistributionTwethushave T,φ!=(cid:1)+∞0−T(t)φ(t)dtforanyφ∈T.DifferentiationofdistributionsDeﬁnitionLetT∈T(cid:2);wecandeﬁneformallythederivativeofthisdistributionbyapplyingtheintegrationbypartsto(12.14):(cid:2)+∞−∞˙T(t)φ(t)dt=−(cid:2)+∞−∞T(t)˙φ(t)dtisawell-deﬁnedexpressionbecause˙φ∈T.Asaresult,<˙T,φ>(cid:1)−<T,˙φ>.(12.16)Wededucethatalldistributionsareindeﬁnitelydifferentiable.DerivativeofafunctioninthesenseofdistributionsLetfbealocallyintegrablefunctionfromRintoC(thatisf∈K).ThisfunctionisgenerallynotdifferentiableatallpointsofRintheusualsense.Forexample,thefunctionf(t)=t1(t)isdifferentiablein(−∞,0)(withazeroderivative)andin(0,+∞)(withaderivativeof1)butnotat0.Ontheotherhand,ifwedealwithfthesamewayaswithadistribution,fbecomesdifferentiable.Itsderivativeisthustaken“inthesenseofdistributions”.Thisderivativecanbeafunctionorasingulardistribution.Intheexamplepresentedhere,wehave˙f=1,thus˙fisafunction.AbsolutelycontinuousfunctionLetfbealocallyintegrablefunctionandlet˙fbeitsderivativeinthesenseofdistributions.If˙fisalocallyintegrablefunction,onecanshowthatf(t)−f(t0)=(cid:2)tt0˙f(τ)dτAppendix1:Analysis383(seeforexample[35],sectionXVII.5).Suchafunctionfissaidtobeabsolutelycontinuous.Itisimmediatethatanabsolutelycontinuousfunctioniscontinuous.Anexampleofabsolutelycontinuousfunctionisthefunctionf(t)=t1(t)consideredabove.Thisfunctionisnotdifferentiableintheusualsense.Theunitstep,theDiracdistributionanditsderivativesDerivativeoftheunitstepTheunitstepisnotdifferentiableintheusualsenseoffunctions,duetoitsdiscontinuityat0.Inaddition,thisfunctionisnotabsolutelycontinuoussinceitisnotcontinuous.Itsderivativeinthesenseofdistributionsisthusasingulardistributionwhichwearegoingtodetermine.Wehaveforanyφ∈T1˙1,φ2=−31,˙φ4=−(cid:2)+∞0˙φ(t)dt=φ(0)DeﬁnitionofδThederivativeoftheunitstepistheDiracdistributionδdeﬁnedby δ,φ!=φ(0).(12.17)Usingthe“integralnotation”,wehave(cid:2)+∞−∞δ(t)φ(t)dt=φ(0).(12.18)Obviously,thesupportofδis{0}andthisdistributionisthereforetempered.InterpretationofδAccordingto(12.18),wecaninterpretδasageneralizedfunctionbeingeverywherezero,exceptat0whereitis+∞andsuchthat(cid:2)+∞−∞δ(t)dt=lim→0+(cid:2)+−δ(t)dt=1.(12.19)Wecanjustify(12.19)inthefollowingmanner:let>0;wehaveaccordingto(12.19)and(12.15):φ(0)=(cid:1)+−δ(t)φ(t)dt.Sinceδisa“non-negative(generalized)function”,wehave(cid:1)+−δ(t)φ(t)dt=φ(η)(cid:1)+−δ(t)dtforsomeη∈[−,],accordingtothemeanvalueformula.Wethusobtainthesecondequalityof(12.19)bytaking→0+,andtheﬁrstbyusingthefactthatδ(t)=0fort(cid:5)=0.384LinearSystemsNotethatherewerepeatedlyabusethelanguage:speciﬁcally,afunctionwhichiseverywhereequaltozeroexceptat0hasazerointegral(Remark431).Thus(12.19)wouldbeimpossibleifδwereactuallyafunction,asthenotationandtherationaleimplyit;butthecalculationswhichhavejustbeenmaderighthereareexactandtheycanbegivenaprecisemathematicalsense.ConvergencetoδInordertogiveaprecisemeaningoftheabove,letusstatethefollowingresult:THEOREM432.–Let(fn)beasequenceofmeasurablefunctionsfromRtoR+suchthat(cid:1)+∞−∞fn(t)dt=1andforeveryneighborhoodVof0inR,(cid:1)R\Vfn(t)dtconvergesto0.Then(fn)convergestoδinD(cid:2).DerivativesofδAccordingto(12.16),wehave3˙δ,φ4=−˙φ(0)andbyiteration3δ(n),φ4=(−1)nφ(n)(0).ProductofdistributionsOnecannotingeneraldeﬁnetheproductoftwodistributionsTandU.OnecandeﬁnetheproductofadistributionTbyafunctionfaccordingtotheformula Tf,φ!= T,fφ!undertheconditionthatfφbelongstoTforanyfunctionφofT.IfT=D,thisholdswheneverfisanindeﬁnitelydifferentiablefunction;ifT=S,thisholdswheneverfisafunctionbelongingtothespaceOMofindeﬁnitelydifferentiablefunctionswhosederivativesofallorders(zerothorderincluded)8belongtoO.IfT∈S(cid:2)+,thisformulaismeaningful,accordingto(12.15),wheneverfisanindeﬁnitelydifferentiablefunctionwhosederivativesofallordersareslowlyincreasingast→+∞(onesuchfunctiondoesnotgenerallybelongtoOMbecausewearenotconcernedwithitsbehaviorast→−∞).Inparticular,letεαbethefunctiondeﬁnedbyεα(t)=e−αt,α>0.Itsatisﬁestheabove-mentionedproperty,thustheproductεαTexists.ThiswillbeusefullatertodeﬁnetheLaplacetransform.ForT=δ,wehaveδf=f(0)δ.(12.20)8.Thezerothorderderivativeoffisfitself,ofcourse.Appendix1:Analysis385ConvolutionofdistributionsTheconvolutionproductoftwodistributionsgeneralizestheconvolutionproductoftwofunctions.Forthisproducttobemeaningful,itisnecessarythatthesupportsofthesedistributionssatisfycertainproperties.Inparticular,ifhisacompactlysupporteddistribution,theproducth∗ucanbedeﬁnedandthemapu(cid:3)→h∗uiscontinuousconvolutionoperator(withkernelh)fromD(cid:2)intoD(cid:2).Wecancalculateh∗uwhenu∈D,andthenwhenu∈D(cid:2)byusingthedensityofDinD(cid:2).Usingthe“integralnotation”ofdistributions,wecanformallywritethat(whenh∗uiswell-deﬁned)(h∗u)(t)=(cid:1)+∞−∞h(t−τ)u(τ)dτasifbothhanduwerefunctions.Forexample,ifu∈D,(cid:1)+∞−∞δ(τ)u(t−τ)dτ=u(t)accordingto(12.18),thusδ∗u=u(12.21)andthisresultcannowbeextendedtothecaseu∈D(cid:2).Asaresult,theDiracdistributionisthe“unitelement”fortheconvolutionproduct.ConvolutionalgebrasofD(cid:2)+andS(cid:2)+IfbothhandubelongtoT(cid:2)+(T=DorS),thentheconvolutionproducth∗uiswell-deﬁnedandbelongstoT(cid:2)+.ThismakesD(cid:2)+andS(cid:2)+convolutionalgebras(thesealgebrasarecommutative,likeK+).Sinceδbelongstothesetwosets,D(cid:2)+andS(cid:2)+areunitaryalgebras(seesection13.1.1),contrarytoK+,forδ/∈K+.Usingthe“integralnotation”,weobtain,whenhandubelongtoT(cid:2)+:(h∗u)(t)=(cid:2)t+0−h(t−τ)u(τ)dτ.(12.22)DerivativeandconvolutionWehavealsoddt(h∗u)=dhdt∗u=h∗dudt.(12.23)Inparticular,takingh=δ˙u=˙δ∗uInotherwords,differentiatingadistributionisjustastakingitsconvolutionproductwith˙δ.386LinearSystemsTranslationofadistributionConsiderﬁrstafunctionf:t(cid:3)→f(t).Thefunctionf(τ)deﬁnedbyf(τ)(t)=f(t−τ)isatranslation(orshift)offoftimeτ.Forτ>0,thisshiftisadelay,orlag;forτ<0itisanadvance,oralead.Letusnowdeﬁnethe“Diracdistributionatτ”:itisthetempereddistributionδ(τ),withsupport{τ},suchthat1δ(τ),φ2=φ(τ),φ∈S.Theintegralexpressionofthisdeﬁnitionisφ(τ)=(cid:1)+∞−∞δ(τ)(t)φ(t)dt.Thus,φ(τ)=(cid:1)+∞−∞δ(t)φ(t+τ)dt=(cid:1)+∞−∞δ(t−τ)φ(t)dt(afterachangeofvariable),thus(abusingthelanguageaswealreadydid)δ(τ)(t)=δ(t−τ).(12.24)Letu∈D;weget(δ(τ)∗u)(t)=(cid:2)+∞−∞δ(τ)(ς)u(t−ς)dς=u(t−τ).Inotherwords,theshiftoperatoru(cid:3)→u(τ)isnothingbuttheconvolutionoperatoru(cid:3)→δ(τ)∗u.Wecannowextendthisdeﬁnitiontothecasewhereu∈D(cid:2)bydensityofD(cid:2)inD.Asaresult,foranydistributionT∈D(cid:2),theshifteddistributionT(τ)isdeﬁnedbyT(τ)=δ(τ)∗T.(12.25)DiraccombLetT>0bearealnumberwhichweinterpretasaperiod.TheDiraccombTisdeﬁnedbyT=+∞(cid:12)n=−∞δ(nT).Therefore,accordingto(12.24)T(t)=+∞(cid:11)n=−∞δ(t−nT).(12.26)OnecaneasilyshowthatthisseriesconvergesinS(cid:2),thusdeﬁningatempereddistribution.Appendix1:Analysis38712.3.Fourier,Laplaceandztransforms12.3.1.FouriertransformsofdistributionsFouriertransforminL1Letu∈L1;thuswecancalculateforevery“angularfrequency”ωFu(ω)=(cid:1)+∞−∞u(t)e−iωtdt.(12.27)ThefunctionFu(fromRintoC)iscalledtheFouriertransformofu,andFistheFouriertransform.ThistransformisC-linear.Wehave|(Fu)(ω)|≤(cid:1)+∞−∞))u(t)e−iωt))dt=(cid:1)+∞−∞|u(t)|dt,andthusFu∈L∞and(cid:23)Fu(cid:23)∞≤(cid:23)u(cid:23)1.REMARK433.–ThereexistsvariousdeﬁnitionsoftheFouriertransform.Forexample,wecandeﬁneitasafunctionoffrequencyν=ω/2πinsteadoftheangularfrequencyω;thisleadsustoreplace(12.27)byFu(ν)=(cid:2)+∞−∞u(t)e−i2πνtdt.(12.28)FouriertransforminSSinceS⊂L1,whatwehavediscussedsofarapplies.Butonecanalsoshowthefollowingremarkableproperties:–TheimageofSbyFisS,andmorespeciﬁcallyFisanisomorphismfromthespaceSontoitself(i.e.anautomorphismofS).–ForanyfunctionˇubelongingtoS(ˇu:ω(cid:3)→ˇu(ω)),wewrite(Fˇu)(t)=(cid:2)+∞−∞ˇu(ω)eiωtdω.Thenwehavethereciprocityformula,validforanyfunctionu∈S:12πFFu=u,inotherwords:F−1=12πF.(12.29)REMARK434.–If(12.28)isusedasthedeﬁnitionoftheFouriertransform,weobtainthesimplerrelationF−1=F.388LinearSystemsFouriertransforminS(cid:2)IfbothuandφbelongtoS,weimmediatelyget Fu,φ!= u,Fφ!.(12.30)Thisrelationisnowtakenasadeﬁnitioninthecasewhereu∈S(cid:2);thismakesFanautomorphismofS(cid:2).Usingthisdeﬁnition,itiseasilyshownthat(Fδ)(ω)=1;(Fδ(τ))(ω)=e−iωτ(12.31)anditfollowsthat(FT)(ω)=+∞(cid:11)n=−∞e−iωnT.(12.32)Thereciprocityformula(12.29)isvalidinS(cid:2).Byapplyingitto(12.31),weget(cid:2)+∞−∞eiω(t−τ)dω=2πδ(t−τ),(12.33)anexpressionthatbecomesclearerfromthepointofviewofphysicsifweexchangetherolesplayedbythetimeandtheangularfrequencyandbychangingtto−t:(cid:1)+∞−∞eit(ω0−ω)dt=2πδ(ω−ω0).(12.34)TheFouriertransformofthesinusoidalsignalt(cid:3)→eiω0tisthusthedistributionω(cid:3)→2πδ(ω−ω0)(denotedhereasafunction,withtheusualabuseoflanguage).ThesupportoftheFouriertransformofasignaliscalleditsspectrum.Thespectrumofthesinusoidalsignalconsideredaboveisthepoint{ω0}.Suchaspectrumiscalleda“rayspectrum”(withauniquerayatω0).FouriertransforminL2LetxandybetwofunctionsbelongingtoS.Wehave Fu,Fy!2=(cid:2)+∞−∞(cid:2)+∞−∞(cid:2)+∞−∞_u(t)y(τ)eiω(t−τ)dtdτandaccordingto(12.33)weobtainthePlancherel–Parsevalformula: Fu,Fy!2=2π u,y!2.ThisequalityallowsustoextendtheFouriertransformtoL2(forSisdenseinL2),andthePlancherel–Parsevalformulaisstillvalidinthatspace.ThismakesFanautomorphismofL2.REMARK435.–WithDeﬁnition(12.28)oftheFouriertransform,thePlancherel–Parsevalrelationbecomes Fu,Fy!2= u,y!2.Appendix1:Analysis389ExchangetheoremAccordingto(12.12),L1isaconvolutionalgebraandweknowthattheFouriertransformisdeﬁnedinL1.LethandubetwofunctionsofL1;thenF(h∗u)(ω)=(cid:2)+∞−∞(cid:2)+∞−∞(cid:2)+∞−∞h(τ)u(t−τ)e−iωτe−iω(t−τ)dtdτdωandthusF(h∗u)=FhFu.(12.35)ThisistheExchangetheorem,whichisoneofthefundamentalpropertiesoftheFouriertransform(transformationoftheconvolutionproductintoanordinaryproduct).Weseethatthistheoremalsoappliestothefollowingcases:–bothhandubelongtoS(cid:2)+;–hisacompactlysupporteddistributionanduisatempereddistribution.TheSecondExchangetheoremLet˜h=Fhand˜u=Fu.Accordingto(12.35)and(12.29)weobtaintheSecondExchangetheorem(whichisvalidwhen˜hand˜usatisfythesamehypothesesashanduabove,respectively):F(cid:9)˜h˜u(cid:10)=12πF˜h∗F˜u.(12.36)12.3.2.FourierseriesPeriodicdistributionsAfunctionu,deﬁnedinR,isperiodicwithperiodT>0(or,inabbreviation,isT-periodic),ifu(t+nT)=u(t)foreveryrealnumbertandeveryrationalintegern,inotherwordsifallshiftedfunctionsu(nT)=δ(nT)∗uareequaltou.Thisdeﬁnition,withthislastformulation,canbeextendedtothecaseofadistributionu∈D(cid:2).Everyperiodicdistributionistempered.TrigonometricseriesLet(an)beasequenceofcomplexnumbers.Wesaythatthissequenceisslowlyincreasingifthereexistaconstantcandanintegerksuchthat|an|≤c|n|k(12.37)390LinearSystemsforalln(cid:5)=0.ThesetofallslowlyincreasingsequencesisaC-vectorspacedenotedbys(cid:2)(forajustiﬁcationofthisnotation,see[95]).Foreverysequence(an)∈s(cid:2),theseriesu(t)=+∞(cid:11)n=−∞ane−i2πTnt(12.38)convergesinS(cid:2).(Intheexpression(12.38)weabusethelanguage,andthecorrectformulationisu=(cid:11)+∞n=−∞ane−i2πTn•.)Indeed,letφ∈S;then3e−i2πTn•,φ4(cid:1)(cid:1)+∞−∞e−i2πTntφ(t)dt=Fφ(cid:15)2πTn(cid:16).WeknowthatFφ∈S,thusthesequencewithgeneraltermanFφ(cid:15)2πTn(cid:16)decreasesfasterthan1n2atinﬁnity,forexample,andthustheseries(cid:11)+∞n=−∞an3e−i2πTn•,φ4isabsolutelyconvergent.Wethuscannowdeﬁnethesumofseries(12.38)by: u,φ!=(cid:11)+∞n=−∞an3e−i2πTn•,φ4,asusual.WeimmediatelyseethatuisaT-periodicdistribution.OnecanshowthatanyT-periodicdistributionuisofthisformandseries(12.38)iscalledtheFourierseriesexpansionofu.FouriercoefﬁcientsTheabovecoefﬁcientsanaretheFouriercoefﬁcientsofu.Thedifﬁcultyincalculatingthemisthatseries(12.38)isingeneralnotconvergentinthe“classic”sense.1)ConsiderﬁrstthecasewheretheT-periodicdistributionuiswrittenasu=(cid:12)n∈ZU(nT)(withU(nT)=δ(nT)∗U)wherethedistributionUhasitssupportincludedinanopenintervaloftheform(α,α+T);wethenhaveforeverynan=1T(cid:2)α+Tαu(t)ei2πTntdt.(12.39)2)Inthegeneralcase,wecanproceedasfollows:integratetheseriesu−a0termbytermk+2times(whereksatisﬁes(12.37)).Wethenobtainaquantityf,whichisaprioriatempereddistributionandiswrittenasf=(cid:12)n(cid:12)=0bne−i2πTn•Appendix1:Analysis391wherebn=an(−i2πTn)k+2.Thesequence(bn)tendsto0asfastas1n2asntendstoinﬁnity,thustheseriesfisnormallyconvergent(thatistosay,ifwewritegn=bne−i2πTn•,theseries(cid:11)n(cid:23)gn(cid:23)∞=(cid:11)n|bn|isconvergent)andwecanwriteforanyrealnumberα(cid:2)α+Tαf(t)ei2πTmtdt=(cid:12)n(cid:12)=0bn(cid:2)α+Tαe−i2πT(n−m)tdt=TbmthereforetheFouriercoefﬁcientsbnoffcanbecalculatedaccordingtobn=1T(cid:2)α+Tαf(t)ei2πTntdt.NotethatfisacontinuousT-periodicfunction.Oncethebn’sareknown,wehavefromtheabovean=(cid:15)−i2πTn(cid:16)k+2bn,n(cid:5)=0.CaseofDiraccomb;PoissonsummationformulaTheDiraccombTisobviouslyaT-periodicdistribution.Wecanapplyformula(12.39)withα=−T/2andweobtainan=1T(cid:2)T2−T2+∞(cid:12)k=−∞δ(t−kT)ei2πTntdt=1T(cid:2)T2−T2+∞(cid:12)k=−∞δ(t−kT)ei2πnkdt=1T(cid:2)T2−T2δ(t)dtthusan=1Tforeveryn.Asaresult,+∞(cid:12)n=−∞δ(t−nT)=1T+∞(cid:12)n=−∞e−i2πTnt.(12.40)Thus,replacingtbyωandTby2πT:+∞(cid:12)n=−∞e−iωnT=2πT+∞(cid:12)n=−∞δ(ω−n2πT).Consequently,accordingto(12.32)wehavethePoissonsummationformula:F(cid:20)+∞(cid:11)n=−∞δ(t−nT)&(ω)=2πT+∞(cid:11)k=−∞δ(ω−k2πT).(12.41)392LinearSystemsInotherwords,theFouriertransformofthe(timedomain)T-periodicDiraccombis,uptoafactorof2πT,the(frequencydomain)2πT-periodicDiraccomb(becauseweworkwithangularfrequencies:ifweworkwithfrequenciesν=ω2π,thisperiodicitybecomes1T).REMARK436.–ThePoissonsummationformulaisoftenexpressedinadifferentbutequivalentmanner.Accordingto(12.30),wehaveforanyfunctionφ∈S, FT,φ!= T,Fφ!,anequalitywhichmakesitpossibletodetermineFTfromT.(i)WithT=2π,itcanbewrittenaccordingto(12.41)as(cid:12)k∈Zφ(k)=(cid:12)n∈ZFφ(2nπ).(ii)IftheFouriertransformisdeﬁnedby(12.28),thissummationformulaissimpler(andthisisthemostclassicform):(cid:12)k∈Zφ(k)=(cid:12)n∈ZFφ(n).Itremainsvalidmoregenerallyincasesthanφ∈S:see([35],sectionXXII.12).FourierseriesexpansionandFouriertransformTheT-periodicdistributionudeﬁnedby(12.38)admitsaFouriertransformandaccordingto(12.33)wehave(Fu)(ω)=+∞(cid:12)n=−∞an(cid:2)+∞−∞e−i(ω−2πTn)tdt=+∞(cid:12)n=−∞2πanδ(cid:21)ω−n2πTt(cid:22)(12.42)where(an)∈s(cid:2).Conversely,if(an)∈s(cid:2),theright-handsideof(12.42)istheFouriertransformofaT-periodicdistributionu,thusthisFouriertransformbelongstoS(cid:2).Theformula(12.42),whichgeneralizes(12.41),showsthecloserelationshipthatexistsbetweentheFourierseriesexpansionandtheFouriertransform,whenwedealwithdistributions.Wehaveindeedobtainedthefollowingresult:THEOREM437.–AT-periodicdistribution(whichwecaninterpretasatime-domainsignal)hasarayspectrum,theseraysare,intheangularfrequencydomain,separatedby2πTandweightedwiththeFouriercoefﬁcientsan.Appendix1:Analysis39312.3.3.FouriertransformsofsequencesDeﬁnitionLeta=(an)∈s(cid:2).ItsFouriertransformisthesumoftheseries(Fa)(θ)=+∞(cid:11)n=−∞ane−inθ.(12.43)Thisisseries(12.38)whereonereplaces2πtTwithθ.Accordingtotheabove,Faisa2π-periodicdistribution.ItthusadmitsaFourierseriesexpansionofform(12.43).Asaresult,Fisanisomorphismfroms(cid:2)ontothespaceof2π-periodicdistributions.ThecalculationoftheinverseFouriertransformisnothingbutthecalculationoftheFouriercoefﬁcientsofa2π-periodicdistribution.Inthecasewherethesequence(an)convergesto0asfastas1n2forntendingtoinﬁnity,wehaveshownthatan=12π(cid:1)π−π(Fa)(θ)einθdθ.(12.44)Fouriertransforminl2Ifbotha=(an)andb=(bn)belongtol2,wecancalculateaccordingto(12.4) a,b!2=(cid:11)+∞n−∞anbn.By(12.44),thisquantityis,writingα=Faandβ=Fb:+∞(cid:12)n−∞anbn=12π(cid:2)π−π¯α(θ)β(ς)+∞(cid:12)n−∞ein(ς−θ)dθdς.Inaddition,accordingto(12.40),+∞(cid:12)n−∞ein(ς−θ)=+∞(cid:12)n=−∞δ(θ−ς−2πn).WeﬁnallyobtainthePlancherel–Parsevalformula a,b!2=12π(cid:1)π−π(cid:15)Fa(cid:16)(θ)(Fb)(θ)dθ.(12.45)OnecanshowthattheFouriertransformisanisomorphismfroml2ontothespaceof2π-periodicfunctionswhicharesquare-integrableon[−π,π],whenthisspaceisequippedwiththescalarproductintheright-handsideof(12.45).Theconvolutionalgebras(cid:2)+Lets(cid:2)+bethespaceofallpositivelysupportedsequencesbelongingtos(cid:2).Oneeasilyshowsthat,foranytwoelementsaandbofs(cid:2)+,theconvolutionproducta∗biswell-deﬁnedandbelongstos(cid:2)+;thuss(cid:2)+isaconvolutionalgebrahavingthesequenceδ0asaunitelement;thisoneisdeﬁnedby(δ0)n=1ifn=0and(δ0)n=0ifnot.394LinearSystemsFouriertransformofaconvolutionproductConsidertwosequencesa=(an)andb=(bn),theconvolutionproductandtheFouriertransformofwhicharewell-deﬁned;aandbcanbeelementsofs(cid:2)+,forexample.Wehave[F(a∗b)](θ)=+∞(cid:12)n=−∞+∞(cid:12)k=−∞akbn−ke−inθ=+∞(cid:12)k=−∞+∞(cid:12)n=−∞ake−inθkbn−ke−i(n−k)θ=(Fa)(θ)(Fb)(θ);asaresultwegettheExchangetheorem(inthesameformas(12.35)):F(a∗b)=FaFb.(12.46)12.3.4.LaplacetransformIntroductionTheLaplacetransform(offunctionsorofdistributions)isanextensionoftheFouriertransform.Asaﬁrststep,wewilldiscusstheunilateral(orone-sided)Laplacetransform,applicabletopositivelysupportedfunctionsordistributions.Thebilateral(ortwo-sided)Laplacetransform,whosetheoryismoredifﬁcult,willonlybebrieﬂymentionedattheendofthissection(foracompletediscussionofthisquestion,see[106],ChapterVIII).Wehavedeﬁnedinsection12.2.3thefunctionεα:t→e−αt.LetT∈D(cid:2)+andsupposearealnumberα0existssuchthatεα0T∈S(cid:2)+.Alsoletα≥α0.Wehaveεα=εα0εα−α0anditisobviousthatεα0εα−α0T∈S(cid:2)+.Thus,εαT∈S(cid:2)+foranyα≥α0.ThuswecandeﬁnethesetA+ofalldistributionsT∈D(cid:2)+forwhichthereexistsarealnumberα0suchthatεαT∈S(cid:2)+wheneverα≥α0.ItisclearthatA+isacommutativeconvolutionalgebra.Itisunitary,becauseδ∈A+;furthermore,S(cid:2)+⊂A+⊂D(cid:2)+.Aswewillsee,A+isthespaceofdistributionsadmittingaunilateralLaplacetransform.Appendix1:Analysis395DeﬁnitionLetu∈A+andγ=inf(cid:31)α∈R:εαu∈S(cid:2)+ .TherealnumberγiscalledtheabscissaofconvergenceoftheLaplacetransformofu.Thesetofthoseα∈Rforwhichεαu∈S(cid:2)+isthereforetheinterval|γ,+∞),anintervalthatcanbeeitheropenorclosedatγ.TheLaplacetransformˆu=Luisafunctionofthecomplexvariabledeﬁnedforα∈|γ,+∞)byˆu(α+iω)=F{εαu}(ω).(12.47)Therefore,accordingto(12.27)and(12.15)ˆu(s)=(cid:2)+∞0−u(t)e−stdt,Re(s)∈|γ,+∞).(12.48)Strictlyspeaking,thisexpressiononlymakessensewhenuisafunction,but,usingthe“integralnotation”(12.14),itcanbeextendedtothecasewhereuisadistribution.Onecanshowthatˆuisholomorphic(seesection12.4.1)intheopenhalf-planeRe(s)>γ.ItisclearthattheLaplacetransformationLisC-linear.Alsonotethatifu∈S(cid:2)+,thenˆu(iω)=(Fu)(ω).UsefulLaplacetransformsuˆu(s)γ11s0δ1−∞δ(τ)e−τs−∞˙δs−∞δ(n)sn−∞e−αt1(t)1s+α−αtme−αt1(t)m!(s+α)m+1−αe−αtsin(ωt)1(t)ω(s+α)2+ω2−αe−αtcos(ωt)1(t)s+α(s+α)2+ω2−α396LinearSystemsExchangetheoremWeeasilyextendthe“Exchangetheorem”toLaplacetransforms:ifhandubothbelongtoA+,andiftheirLaplacetransformshaveabscissaeofconvergenceγ1andγ2respectively,thenh∗u∈A+andthisconvolutionproducthasaLaplacetransformwhoseconvergenceabscissaisγ=max(γ1,γ2);furthermore,L(h∗u)=LhLu.(12.49)LaplacetransformsofderivativesCaseofapositivelysupporteddistributionLetu∈A+.Weknowthat˙u=˙δ∗u,thusL(˙u)(s)=sˆu(s)(12.50)Byinduction,weobtainforanynon-negativeintegernL(cid:15)u(n)(cid:16)(s)=snˆu(s).(12.51)CaseofadifferentiablefunctionConsidernowafunctionu,deﬁnedanddifferentiableinanopenneighborhoodof[0,+∞)andthederivativeofwhichislocallyintegrable.Bydeﬁnition,the(unilateral)LaplacetransformofuistheLaplacetransformofthepositivelysupporteddistributionu+=1uifu+belongstoA+.Asaresult,Lu(cid:1)Lu+.ThisLaplacetransformisthusgivenbytheformula(12.48)(where0−canbereplacedby0).Wehavedu+dt=˙u1+uδ(Leibnizformula),fromwhich,accordingto(12.20),du+dt=˙u1+δu(0).Accordingto(12.50),L(cid:9)du+dt(cid:10)(s)=s(Lu+)(s),thuss(Lu+)(s)=L(˙u)(s)+u(0),i.e.L(˙u)(s)=sˆu(s)−u(0).(12.52)Appendix1:Analysis397Extension:caseofthesumofanntimescontinuouslydifferentiablefunctionandofapositivelysupporteddistributionWeareoftenled,incontroltheory,toconsidersignalsoftheformu=f+T(12.53)wherefisafunctionthatisdeﬁnedandntimescontinuouslydifferentiableinanopenneighborhoodof[0,+∞)(n≥1)9andwhereT∈A+.Asintheabove,the(unilateral)LaplacetransformofucanbedeﬁnedastheLaplacetransformofthepositivelysupporteddistributionu+=f++Tandisthusgivenbytheformula(12.48),butthistimeitisessentialuse0−asthelowerlimitofintegration.Now,uandfhavethesamerestrictiontoeveryopeninterval(−ε,0),10whereε>0isasufﬁcientlysmallrealnumber.Therefore,therestrictionofutosuchanintervalisanntimescontinuouslydifferentiablefunctionandfurthermore:u(i)(cid:15)0−(cid:16)=f(i)(0),0≤i≤n−1.(12.54)Writing(12.53)andthentakingtheLaplacetransformoftheobtainedexpression,wegetL(˙u)(s)=L(cid:9)˙T(cid:10)(s)+L(cid:9)˙f(cid:10)(s).Asaresult,accordingto(12.50)and(12.52)L(˙u)(s)=sˆT(s)+sˆf(s)−f(0)thusfrom(12.54)L(˙u)(s)=sˆu(s)−u(cid:15)0−(cid:16).Byinduction,wecanestablishthat:L(cid:9)u(n)(cid:10)(s)=snˆu(s)−n−1(cid:12)i=0sn−1−iu(i)(cid:15)0−(cid:16).9.Moreprecisely,itsufﬁcestoassumethatuisntimesdifferentiableinanopenneighborhoodof[0,+∞)andthatitsnthderivativeislocallyintegrable.10.ThisisintuitivelyclearsinceTispositivelysupported.Forageneraldeﬁnitionofthenotionofrestrictionofadistributiontoanopenset(see[35],section17.13).398LinearSystemsDenotethequantityu(i)(0−)(i≥0)by∂i0u0;then,inparticular,∂00=1andu0=u(0)(0−)(∂0canviewedasadifferentialoperatoronthevaluesatinstant0−).11Wehave:n−1(cid:12)i=0sn−1−iu(i)(cid:15)0−(cid:16)=n−1(cid:12)i=0sn−1−i∂i0u0=sn−∂n0s−∂0u0.thereforeL(cid:15)u(n)(cid:16)(s)=snˆu(s)−sn−∂n0s−∂0u0.(12.55)InverseLaplacetransformBromwich–SchwartztheoremThistheoremcharacterizestheLaplacetransformsofdistributionsandisstatedinthefollowingmanner([106],sectionVIII.4):considerafunctionofthecomplexvariables(cid:3)→f(s),whichisholomorphicinthehalf-planeRe(s)>γ;thisfunctionistheLaplacetransformofadistributionu∈A+ifandonlyifthereexistsarationalintegernandahalf-planeRe(s)(cid:3)β>γsuchthatthefunctions→(1+|s|)−nf(s)isboundedinthishalf-plane.InversionofaLaplacetransformCase1:BromwichformulaSupposethat,intheabove,n=−2,thusf(s)decreasesattheinﬁnityatleastasfastas1s2(iff(s)isarationalfunction,thismeansthatitisofrelativedegreeofatleast2:seesection13.6.1).Thusthereexistsaconstantcsuchthat|f(α+iω)|≤cα2+ω2forα>min(β,0).Thereforethefunctionoftherealvariablefα:ω→f(α+iω)belongstoL1andwecancalculate12π(cid:15)Ffα(cid:16)(t)=12π(cid:2)+∞−∞fα(iω)eiωtdω.Afterthechangeofvariables=α+iωweget:12π(cid:15)Ffα(cid:16)(t)=e−αtu(t)11.Thisnotionisimproperbecause,forexample,˙u(cid:15)0−(cid:16)cannotbederivedfromu(cid:15)0−(cid:16).Itwouldbemorerigorous–butmisleading–todenotetheabovequantity∂i0u0as∂i0u.Appendix1:Analysis399whereu(t)=12πiα+i∞(cid:2)α−i∞f(s)estds.(12.56)Thus,F{εαu}(ω)=f(α+iω),whichshowsthatf(s)=ˆu(s)and(12.56)istheformulaoftheinverseLaplacetransform,calledtheBromwichformula.Wewillseeinsection12.4.4thatthisfunctionuiscontinuousandpositivelysupported.Case2:Schwartz’smethodSupposenowthatn>−2.Wehaves−nf(s)=s2g(s)whereg(s)=s−(s+2)f(s).Thefunctions(cid:3)→s2g(s)isboundedinthehalf-planeRe(s)(cid:3)α>min(β,0),thuswecanapplytheBromwichformulatothefunctiong:thepositivelysupportedfunctionvdeﬁnedbyv(t)=12πi(cid:2)α+i∞α−i∞g(s)estdsadmitsaLaplacetransformg(s).Butsincef(s)=sn+2g(s),f(s)istheLaplacetransformofthedistributionv(n+2).ThisshowsthateverydistributionbelongingtoA+isaﬁniteorderderivativeofacontinuousfunction.ThisalsoshowsthattheLaplacetransformisabijectionfromA+ontothesetoffunctionsofthecomplexvariablecharacterizedbytheBromwich–Schwartztheorem,asetwhichwecanthusdenoteasLA+.SinceA+isaconvolutionalgebraandtheLaplacetransformtransformstheconvolutionproductintotheordinaryproduct,LA+isanalgebrafortheordinaryproduct(ascanalsobedirectlyveriﬁed).InitialvaluetheoremandﬁnalvaluetheoremLetubeafunctionadmittingaLaplacetransformˆu.Onecanprovethefollowingresults[95](becarefulaboutthehypotheses!):1)Ifuissuchthatlimt→+∞u(t)exists,thentheabscissaofconvergenceγofˆusatisﬁesγ≤0andwehavetheﬁnalvaluetheorem:lims∈R,s→0+sˆu(s)=limt→+∞u(t).2)Ifuadmitsalimitat0fromtheright,denotedasu(0+),wehavetheinitialvaluetheorem:lims∈R,s→+∞sˆu(s)=u(0+).400LinearSystemsBilateralLaplacetransformLetusnowgeneralizethemethodusedinthebeginningofthissection.Letu∈D(cid:2);thesetofrealnumbersαsuchthatεαu∈S(cid:2)isanintervalΓ=|γ−,γ+|ofR(whichcanbe,dependingonthecase,eitheropenorclosedatγ−oratγ+).IfΓ(cid:5)=∅,thesetBc={s∈C:Re(s)∈Γ}isthebandofconvergenceoftheLaplacetransformofu.Thistransform,denotedasˆu=Lu,isafunctionofthecomplexvariabledeﬁnedforα∈|γ−,γ+|byrelation(12.47)oralsoby(withtheusualabuseoflanguage)ˆu(s)=+∞(cid:2)−∞u(t)e−stdt,s∈Bcwhichgeneralizes(12.48);ˆu(s)isholomorphicintheinterior˚BcofBc(if˚Bc(cid:5)=∅).Ifu∈D(cid:2)+,thenγ+=+∞andthenwecomebacktotheunilateralLaplacetransform.ExtensionoftheExchangetheoremLetΓbeanon-emptyopenintervalofRandletS(cid:2)(Γ)bethesetofalldistributionsu∈D(cid:2)suchthatεαu∈S(cid:2)foreveryα∈Γ.OnecanshowthatS(cid:2)(Γ)isacommutativeconvolutionalgebra.The“Exchangetheorem”(12.49)isstillvalidwhenbothhandubelongtoS(cid:2)(Γ).Itfollowsthat(12.51)isalsostillvalidbecauseδ(n)∈S(cid:2)(Γ)foreverynon-emptyopenintervalΓofRcontainingzero.*Paley–Wiener–SchwartztheoremWedenotebyEthespaceofindeﬁnitelydifferentiablefunctionsfromRintoC.Thisspaceisequippedwiththefollowingtopology:asequence(ϕn)convergestoϕinEifforeveryintegerk≥0,ϕ(k)nconvergesuniformlytoϕ(k)oneverycompactset.OnecanshowthatEisaFréchetspace.ItsdualE(cid:2)isthespaceofcompactlysupporteddistributions.UsingthePaley–Wiener–Schwartztheorem([106],sectionVII.8),([35],sectionXXII.18)onecancharacterizetheelementsofE(cid:2)usingtheirLaplacetransforms.Foranentirefunctionf(s)(seesection12.4.1below)tobetheLaplacetransformofadistributionwithsupportincludedin[−a,a](a≥0),itisnecessaryandsufﬁcientthatthereexistsanintegern≥0andaconstantc≥0suchthatforeverys∈C,|f(s)|≤c(1+|s|)nea|Res|.(comparewiththeBromwich–Schwartztheorem.)Appendix1:Analysis40112.3.5.z-transformThez-transformplaysthesameroleforsequencesastheLaplacetransformfordistributions.LiketheLaplacetransform,itisageneralizationoftheFouriertransform.Weﬁrstwillconsiderthe“unilateral”z-transform.The“bilateral”z-transformisdiscussedattheendofthissection.DeﬁnitionLetx=(xn)n∈Zbeasequenceofcomplexnumbers,assumedtobepositivelysupported(section12.2.1).Letρ=inf(cid:31)r>0:(cid:15)xnr−n(cid:16)∈s(cid:2) andsupposeρ<+∞.Foreveryr∈|ρ,+∞)(wheretheinterval|ρ,+∞)isopenorclosedatρdependingonthesituation),thesequence(xnr−n)belongstos(cid:2).ThissequencethusadmitsaFouriertransformF(cid:31)xnr−n (θ)=+∞(cid:12)n=0xnr−ne−inθ=+∞(cid:12)n=0xn(cid:15)reiθ(cid:16)−n.Letustakethepowerseriesinz−1X(z)=+∞(cid:12)n=0xnz−n.(12.57)Accordingtotheabove,thisseriesconvergesforeveryzsuchthat|z|∈|ρ,+∞),sinceX(cid:15)reiθ(cid:16)=F(cid:31)xnr−n (θ).(12.58)ThefunctionX:z(cid:3)→X(z)ofthecomplexvariableziscalledthe(unilateral)z-transformofx,itisdeﬁnedfor|z|∈|ρ,+∞)andisholomorphicintheopenset|z|>.Inthisopenset,theseries(12.57)isabsolutelyconvergent.TherealnumberiscalledtheradiusofconvergenceofX.Thez-transformZ:x(cid:3)→XisC-linear.z-transformofanadvancedsequenceWedeﬁnetheadvanceoperatorq,alsocalledtheshift-forwardoperator,actsonsequencesofcomplexnumbersinthefollowingmanner:qxn=xn+1.(12.59)402LinearSystemsThez-transformofthesequenceqxisZ{qx}(z)=(cid:11)+∞n=0xn+1z−n=z[X(z)−x0].Generalizingthisrationale:Z(cid:31)qkx (z)=zk#X(z)−k−1(cid:12)n=0xnz−n$.(12.60)ExchangetheoremLetx=(xn)andy=(yn)betwopositivelysupportedsequences,thez-transformsofwhichhavearadiusofconvergenceof1and2,respectively.Then,thepositivelysupportedsequencex∗yhasaz-transformwhoseradiusofconvergenceisρ=max(1,ρ2)andZ{x∗y}(z)=X(z)Y(z).(12.61)Inparticular,letδk(k≥0)bethesequencedeﬁnedbyδk(n)=1ifn=k,δk(n)=0ifnot12.Thesequenceδkispositivelysupported,itsz-transformisz−k.Foreverysequencex=(xn),δk∗xisthedelayedsequenceq−kxn=xn−k.Asaresult,Z(cid:31)q−kx (z)=Z{δk∗x}(z)=z−kX(z).(12.62)Inversez-transformAccordingtoequation(12.58)whichestablishestherelationshipbetweentheFouriertransformandthez-transform,wehaveforanyr>xnr−n=F−1X(cid:15)reiθ(cid:16)=12π(cid:2)π−πX(cid:15)reiθ(cid:16)einθdθfromwhich,afterthechangeofvariablez=reiθxn=12πi5|z|=rX(z)zn−1dz.(12.63)12.Inordernottocomplicatethenotation,wewritethesequenceδkhereasafunctionofn.Appendix1:Analysis403Usefulz-transformsWedeﬁnetheunitstep1asthesequencedeﬁnedby1n=1ifn≥0,1n=0ifn<0.(xn)X(z)δ010δkz−k01zz−11(an1n)zz−a|a|(n1n)z(z−1)21(cid:15)n21n(cid:16)z(z+1)(z−1)31sin(nωT)1nzsinωTz2−2zcosωT+11cos(nωT)1nz2−zcosωTz2−2zcosωT+11(12.64)InitialvaluetheoremandﬁnalvaluetheoremOnecanshowthefollowingresults[95]:1)lim|z|→+∞X(z)=x0(initialvaluetheorem).2)Iflimn→+∞xnexists,thenX(z)hasaradiusofconvergence≤1andlimz∈R,z→1+(z−1)X(z)=limn→+∞xn(ﬁnalvaluetheorem).Bilateralz-transformLetx=(xn)beasequenceofcomplexnumbers,let))ρ−,ρ+))=(cid:31)r>0:(cid:15)xnr−n(cid:16)∈s(cid:2) (12.65)andsuppose|ρ−,ρ+|(cid:5)=∅.Foreveryr∈|ρ−,ρ+|thesequence(xnr−n)belongstos(cid:2)andthusadmitsaFouriertransformF(cid:31)xnr−n (θ)=+∞(cid:12)n=−∞xnr−ne−inθ=+∞(cid:12)n=−∞xn(cid:15)reiθ(cid:16)−n.TheseriesX(z)=+∞(cid:12)n=−∞xnz−n(12.66)404LinearSystemsconvergesforallzsuchthat|z|∈|ρ−,ρ+|andsatisﬁestherelation(12.58).Forz=reiθwithrequaltoρ−orρ+(ifoneoftheseelementsbelongsto|ρ−,ρ+|),theseries(12.66)convergencesinS(cid:2).LetCc={z∈C:|z|∈|ρ−,ρ+|}.ThissetCciscalledtheannulusofconvergenceofX.ThefunctionofthecomplexvariableX:z(cid:3)→X(z)iscalledthe(bilateral)z-transformofxandisdeﬁnedinCc.Intheinterior˚CcofCc(ifitisnon-empty),theseries(12.57)isabsolutelyconvergentandX(z)isholomorphic.Ifthissequencexispositivelysupported,(12.66)becomesidenticalto(12.57)andρ+=+∞.ExtensionoftheExchangetheoremWearenowgoingtoextendtheExchangetheorem(12.61)tothecaseofthebilateralz-transform,aswehavedoneatsection12.3.4forthebilateralLaplacetransform.LetΓbeanon-emptyopenintervalincludedin[0,+∞)andlets(cid:2)(Γ)(resp.,l1(Γ))bethesetofsequencesofcomplexnumbers(xn)suchthat(r−nxn)∈s(cid:2)(resp.,(r−nxn)∈l1)foreveryr∈Γ.Aseasilyshown,s(cid:2)(Γ)=l1(Γ),andsincel1isaconvolutionalgebra(section12.2.1),s(cid:2)(Γ)isonetoo.TheExchangetheorem(12.61)isalsovalidwhenxandybothbelongtos(cid:2)(Γ).WenowdeducethatZ(cid:31)qkx (z)=zkX(z)(12.67)whereZdenotesthebilateralz-transform(ofcourse,thisequalitydoesnotcontradict(12.60),andthereaderisrequestedtowonderwhy).12.4.FunctionsofonecomplexvariableAsseenabove,aLaplacetransformandaz-transformarefunctionsofonecomplexvariable,anditisthusimportanttostudysomeofthepropertiesofthesefunctions.12.4.1.HolomorphicfunctionsDeﬁnitionofaholomorphicfunctionAfunctions→f(s)isholomorphicinanon-emptyopensubsetΩofCifforanys0∈Ω˙f(s0)=lims→s0,s(cid:12)=s0f(s)−f(s0)s−s0exists.ThesetofallholomorphicfunctionsinΩisdenotedbyO(Ω).Appendix1:Analysis405AnalyticfunctionAfunctionofthecomplexvariables→f(s)isanalyticinΩif,foranypointzofC,thereexistsanon-emptyopendiscDz,r={s∈C:|s−z|<r}containedinΩsuchthatfisthesumofapowerseriesins−zwhichconvergesinDz,r,thatistosayfadmitsaTaylorseriesexpansionintheneighborhoodofz:f(s)=+∞(cid:12)k=0(s−z)kk!f(k)(z).(12.68)IdentityofthetwonotionsLetpbeacomplexnumberandletjbeapositiveinteger.Wehave1(s−p)j=1(−p)j1(cid:9)1−sp(cid:10)j.Thisfunctionisthesumofapowerseriesinswithradiusofconvergence|p|.Bychangingtheoriginoftheplane,itfollowsthatifp(cid:5)=z,thissamefunctionisthesumofapowerseriesins−zwithradiusofconvergence|p−z|.Nowletf(z)beanyrationalfunctionandletPbethesetofitsdistinctpoles,sothatf(s)isholomorphicintheopensetC\P(whereC\PdesignatesthecomplementofPinC).From(13.60),(13.61)andtheabove,itfollowsthatf(s)isanalyticinC\P.Asaresult,holomorphyandanalyticityaresynonymousasfarasrationalfunctionsareconcerned.AccordingtoGoursat’stheorem([35],sectionIX.10,Problem2)thisholdstrueforallfunctionsofonecomplexvariable.Inaddition,letz∈C\Pandr=minp∈P|z−p|.Powerseries(12.68)hasaradiusofconvergenceofr,thusitconvergesuniformlyinthecloseddisc|s−z|≤foranyρ<r.AnalyticcontinuationprincipleThefollowingisprovedin,e.g.,([25],IV.2.3)and([35],(9.4.3)):THEOREM438.–LetΩbeanopenconnectedsubsetofthecomplexplaneandf∈O(Ω).Thefollowingconditionsareequivalent:(i)thereexistsapointz∈Ωsuchthatforallintegersn≥0,f(n)(z)=0;(ii)thereexistapointz∈ΩandanopenneighborhoodN⊆Ωofzsuchthatf|N=0;(iii)thereexistsacompactinﬁnitesubsetHofΩsuchthatf(z)=0forallz∈H.(iv)f=0(i.e.,f(s)=0foralls∈Ω).406LinearSystemsEntirefunctionsIfafunctionofonecomplexvariableisholomorphicinC,thenseries(12.68)convergesuniformlyinanyboundedsubsetofC.Suchafunctionissaidtobeentire.Thus,thesetofallentirefunctionsisO(C).MeromorphicfunctionsLetΩbeanopenconnectedsubsetofC.AcomplexfunctionhissaidtobemeromorphicinΩifthereexistf,g∈O(Ω),g(cid:5)=0,suchthath=f/g.Letz∈Ω;thereexistsarationalintegerqsuchthath(s)=(s−z)ql(s)wherel(z)(cid:5)=0,andthisrepresentationisunique.Ifq<0,hhasapoleoforder−qatz;andifq>0,hissaidtohaveazerooforderqatz.Thereexistsarealr>0suchthath(s)=(cid:12)ν≥qaν(s−z)ν,aq(cid:5)=0foranys∈Ωsuchthat|s−z|<r;theseriesintheright-handmemberoftheaboveequalityiscalledaLaurentseries(andistheLaurentexpansionofhatz).ThisLaurentseriesisabsolutelyconvergentforeverysintheopendisk∆(z;r)withcenterzandradiusr,andisnormally–thusuniformly–convergentinanycloseddisk¯∆(z;ρ)withcenterzandradiusρ,0<ρ<r.Ifq<0,i.e.,ifzisapoleofh,thena−1iscalledtheresidueofhatzandisdenotedasRes(h;z).12.4.2.FunctionsofamatrixLetfbeananalyticfunctionintheneighborhoodof0andletρbetheradiusofconvergenceofthepowerseriesf(s)=+∞(cid:12)k=0aksk,ak=f(k)(0)k!.(12.69)Inotherwords,ρ=sup(cid:19)c≥0:+∞(cid:12)k=0|ak|ck<+∞6.LetA∈Cn×n.WecallspectralradiusofmatrixAthequantityr(A)=max{|λ|:λ∈Sp(A)}whereSp(A)isthespectrumofA(section13.3.3).Onecanshowthattheseriesf(A)=+∞(cid:12)k=0akAkAppendix1:Analysis407isconvergentifr(A)<ρ([52],sectionV.4).Assumingthatthisconditionholds,wehavethefollowingresult:PROPOSITION439.–Letλ∈CbeaneigenvalueofAandletx∈CnbeaneigenvectorofAassociatedwithλ.Then,f(λ)isaneigenvalueoff(A)andxisaneigenvectoroff(A)associatedwithf(λ).PROOF.WehaveAx=λx,thusf(A)x=(cid:11)+∞k=0akAkx=(cid:11)+∞k=0akλkx=f(λ)x.ExponentialofmatrixTheexponentialfunctionf(s)=escanbeexpandedasfollows:es=+∞(cid:12)k=0skk!,withaninﬁniteradiusofconvergence(i.e.itisanentirefunction);asaresult,ifA∈Cn×n,theexponentialofthismatrixisdeﬁnedbytheserieseA=+∞(cid:12)k=0Akk!(12.70)whichconvergesforanysquarematrixA.WehaveinparticulareλIn=eλInandthuse0n×n=In.(12.71)Ontheotherhand,onecaneasilyshowthatiftwosquarematricesBandCareofthesameorderandcommute,theneB+C=eBeC.(12.72)Inparticular,Band−Bcommute,thereforee0n×n=eBe−B,whichprovesthate−B=(cid:15)eB(cid:16)−1.Finally,ifBandCaretwosquarematrices,considertheirdiagonalsumB⊕C(seesection13.1.4).ItisimmediatethateB⊕C=eB⊕eC(12.73)408LinearSystemsLogarithmofmatrixThefunctionf(s)=ln(1+s)(s∈R)canbeexpandedasfollows:ln(1+s)=+∞(cid:12)k=1(−1)k−1skk(12.74)withradiusofconvergenceρ=1.DEFINITION440.–Thepowerseriesintheright-handsideof(12.74),whichconvergesforallcomplexnumbersssuchthat|s|<1,13istheprincipalbranchofln(1+s).Inthecomplexplane,thereareseveral“branches”ofthelogarithm,“inverse”oftheexponentialfunction,asshownherebelow(formoredetails,see[25]).PROPOSITION441.–Letf(s)betheprincipalbranchofln(1+s).Allotherdeterminationsofln(1+s)areoftheformf(s)+2kπi(wherekisaninteger).PROOF.Considertwocomplexnumbersxandysuchthatex=ey.Thisequalityisequivalenttoex−y=1,i.e.tox−y=2kπi(k∈Z).IfA∈Cn×n,wecanthusdeﬁneln(In+A)bytheexpressionln(In+A)=+∞(cid:12)k=1(−1)k−1Akkprovidedthatr(A)<1.12.4.3.IntegrationinthecomplexplaneIntegrationalongapathPathApathisapiecewisecontinuouslydifferentiablefunctionfromaninterval[a,b]ofRintothecomplexplaneC.Itisthusa“sufﬁcientlyregularly”parametrizedcurveofthecomplexplane,whichwecandenoteasγ:[a,b](cid:20)t(cid:3)→γ(t)∈C.Itisoriented,becausewhenthevariablettraverses[a,b]fromatob,thepointγ(t)traversesthiscurveinawell-determinedsense.IfthereexistsanopensubsetΩofCsuchthatγ([a,b])⊂Ω,thenγiscalledapathinΩ.Thispathγisclosedifγ(a)=γ(b).13.Itconvergesalsofors=1.Appendix1:Analysis409IntegrationLetf(s)beameromorphicfunctionintheopensetΩ⊂CandletPbethesetofitsdistinctpoles.LetalsoγbeapathinΩandwhichdoesnotpassthroughanypointofP.Thenwedeﬁnetheintegraloffalongthepathγ:thisisthequantity(cid:2)γf(s)ds=(cid:2)baf(γ(t))˙γ(t)dt.IndexofapointwithrespecttoaclosedpathLetpbeapointofthecomplexplaneandletγ:[a,b](cid:20)t(cid:3)→γ(t)∈Cbeaclosedpathnotpassingthroughp.Thequantityj(p;γ)=12πi(cid:2)γdss−p(12.75)iscalledtheindexofpwithrespecttoγ.Thisindexisarationalintegerandisinterpretedasthenumberofturnsthatγgoesaroundp(inthedirectsense);equivalently,wecansaythatj(p;γ)isthenumberofturnsthatsgoesaroundp,inthedirectsense,byfollowingtheclosedpathγ.Indeed,letnbethenumberofturnsasdeﬁnedaboveandwriteh(t)=(cid:2)ta˙γ(τ)γ(τ)−pdτ.Writeγ(τ)−p=(τ)eiθ(τ),(τ)>0(polarformofγ(τ)−p).Then˙γ(τ)γ(τ)−p=˙(τ)(τ)+iθ(τ),andthush(b)=i∆θ,where∆θisthevariationoftheargumentofs−pwhenstraversestheclosedpathγ.Wehave∆θ=2πn.Noticethatifγ1,γ2:I→Caretwoclosedpathswhichdonotpassthrough0,thenγ1γ2:I(cid:20)t(cid:3)→γ1(t)γ2(t)∈Cisagainaclosedpathwhichdoesnotpassthrough0,andj(0;γ1γ2)=j(0;γ1)+j(0;γ2).(12.76)410LinearSystemsIntegrationofelementaryfunctionsalongaclosedpathLetk≥0.Then(cid:1)skds=sk+1k+1+const.Therefore,foranyclosedpathγ,(cid:1)γskds=0.WededucethatforanypolynomialQ(s),(cid:1)γQ(s)ds=0.Ontheotherhand,leth(s)=1(s−p)k,k≥2Wehave(cid:2)h(s)ds=11−k(s−p)1−k+const.Asaresult,foranyclosedpathγnotpassingthroughp,(cid:1)γh(s)ds=0.ResiduetheoremThistheoremisoneofthemostimportantonesinthetheoryoffunctionsofonecomplexvariable.Asaresultof(13.60),(13.61),(12.75)andoftheabove,iff(s)isarationalfunctionandifγisaclosedpathnotpassingthroughanypoleoff(s),wehave(cid:2)γf(s)ds=2πi(cid:12)p∈Pj(p;γ)Res(f;p).(12.77)AsubsetΩofCisconvexifwhenevertwopointsaandbbelongtoΩ,thesegment[a,b]={(1−t)a+tb:0≤t≤1}isincludedinΩ.Theequality(12.77)stillholdswhenfisameromorphicfunctioninanopenconvex14setΩ⊂CandwhentheclosedpathγisinΩ(Cauchy’sresiduetheorem)[103].Cauchy’sintegralformulaLetfbeaholomorphicfunctioninanon-emptyopenconvex15subsetΩofthecomplexplane.LetzbeapointofΩandγbeaclosedpathinΩ,whichdoesnotpassthroughz.14.SeeRemark442.15.SeeRemark442.Appendix1:Analysis411Thefunctionf(s)s−zismeromorphicinΩandhasauniquepolez;theresidueofthisfunctionatzisf(z).Byapplyingtheresiduetheorem(12.77)tof(s)s−z,wethusobtain“Cauchy’sintegralformula”:j(z;γ)f(z)=12πi(cid:2)γf(s)s−zds(12.78)Wecangeneralizethisformulausingtheexpansion(12.68),whichconvergesuniformlyinthecloseddisk|s|≤rifr>0issmallenoughforthisdisktobeincludedinΩ.Theresidueoff(s)(s−z)k+1atzisf(k)(z)k!;therefore,weget:j(z;γ)f(k)(z)=k!2πi(cid:2)γf(s)(s−z)k+1ds,k≥0.(12.79)REMARK442.–*AnopenconnectedsubsetΩofthecomplexplaneiscalledsimplyconnectedif,roughlyspeaking,everyclosedpathinΩcanbecontinuouslyshrunkuntiltobereducedtoonepoint;suchasubsetΩisan“openconnectedsubsetwithoutholes”(soisanyconvexopenset).Intheabove,“convex”canbeeverywherereplacedby“simplyconnected”.*MaximummodulusprincipleLEMMA443.–Iff(s)isholomorphicinΩ={s:|s−s0|<r}andif|f(s)|≤|f(s0)|foralls∈Ω,thenf(s)isconstantinΩ.PROOF.Wemayassumethatf(s0)(cid:5)=0.Accordingto(12.78),whenever0<ρ<rf(s0)=12π(cid:2)2π0f(cid:15)s0+ρeiθ(cid:16)dθorequivalently(cid:2)2π0(cid:15)1−f(cid:15)s0+ρeiθ(cid:16)/f(s0)(cid:16)dθ=0.Therealpartoftheintegrandis≥0andiszeroonlywhenf(s0)=f(cid:15)s0+ρeiθ(cid:16).Nowwecanstatethemaximummodulusprinciple:THEOREM444.–LetΩbeanopensubsetofthecomplexplane,let¯Ωbeitsclosure,andletfbeafunctionwhichisbothcontinuousin¯ΩandholomorphicinΩ.If|f(s)|admitsamaximumin¯Ω,thismaximumisattainedonthefrontier∂Ω=¯Ω\Ω.PROOF.*Assumethatthemaximumisattainedataninteriorpointz.TheconnectedcomponentC(z)ofzinΩisopenforΩislocallyconnected,and∂C(z)⊂∂Ω.Hence,byTheorem438andLemma443,fisconstantinΩ,thusfisconstantin¯Ωbycontinuity,andtherefore|f(s0)|=|f(z)|atsomepoints0of∂Ω.*412LinearSystems12.4.4.ApplicationstoinversetransformsCalculationsandpropertiesoftheinverseLaplacetransformLetustakearationalfunctionf(s)andsupposethatf(s)isofrelativedegreeatleast2(withoutlossofgenerality,accordingtosection12.3.4).LetPbethesetofitsdistinctpolesandletαbearealnumbersuchthatα>Re(p),∀p∈P.Thenweknow,accordingto(12.56),thatf(s)istheLaplacetransformofafunctionuandthatu(t)=12πiα+i∞(cid:2)α−i∞f(s)estds.Wewillshowontheonehandhowwecaneasilycarryoutthiscalculationusingresiduesandontheotherhandthatthisfunctionuispositivelysupported.LetustaketheintegralJ(t,A)=(cid:1)α+iAα−iAf(s)estds,A>0.1)Firstlett≥0.Wecompletethepaths=α+iθ,θ∈[−A,A]bythesemi-circleCα−deﬁnedbys=α+Aeiϕ,ϕ∈(cid:25)π2,3π2(cid:26),suchthataclosedpathγA−isformed(seeFigure12.1).Thereexistsaconstantc>0suchthat|f(s)|≤cA2foranys∈Cα−providedthatAissufﬁcientlylarge.Ontheotherhand,foranys∈Cα−,))est))=)))eRe(st)+iIm(st))))=)))eRe(st))))≤eαt,(12.80)AiAiCAFigure12.1.ClosedpathAppendix1:Analysis413therefore)))(cid:1)Cα−f(s)estds)))≤ceαtA2(cid:1)Cα−ds=ceαtA2πA.Thisquantitytendsto0asA→+∞.Thus,limA→+∞J(t,A)=limA→+∞(cid:1)γA−f(s)estds.Inaddition,theclosedpathγA−turnsinthedirectsenseonetimearoundallthepolesoff(s)whenAissufﬁcientlylarge,andthusalsoaroundthepolesoff(s)estsinceestisentire.Applyingtheresiduetheorem(12.77),wethenobtainu(t)=(cid:12)p∈PRes(f(s)est;p),t≥0.(12.81)Forexample,letf(s)=1(s−p)n,n≥2.Wehaveest=epte(s−p)t=ept(cid:11)+∞k=0(s−p)kk!tk.Thisfunctionhasauniquepoles=panditsresidueatthispoleistn−1ept(n−1)!.AsaresultL−1(cid:20)1(s−p)n&(t)=tn−1ept(n−1)!,t≥0.(12.82)Notethatthisformularemainsvalidforn=1.2)Nowsupposet<0.Theupperbound(12.80)isnolongervalidinCα−,whichwewillreplacebythecomplementarysemi-circleCα+deﬁnedbys=α+Aeiϕ,ϕ∈(cid:25)−π2,π2(cid:26).Wenowintegratef(s)estalongtheclosedpathγA+,deﬁnedastheunionofthepaths=α+iθ,θ∈[−A,A]andofCα+.Thisclosedpathdoesnotencloseanyofthepolesoff(s)andthus12πi(cid:1)α+i∞α−i∞f(s)estds=0fort<0.Therefore,wecanspecify(12.82)bywritingL−1(cid:7)1(s−p)n(cid:8)(t)=tn−1ept(n−1)!1(t).(12.83)THEOREM445.–Letˆf(s)bearationalfunction,letPbethesetofitsdistinctpoles,andletρ∈Zbeitsrelativedegree(seesection13.6.1).i)Thefunctionˆf(s)istheLaplacetransformofadistributionf∈A+,theabscissaofconvergenceofthisLaplacetransformisγ=maxp∈PRe(p)andthisdistributionisoftheformf=−ρ(cid:12)i=0qiδ(i)+g1(byconvention,thesumiszeroifρ>0),wherethefunctiongisanalyticandoftheform(cid:11)k,jtkepjt.414LinearSystemsii)Thisdistributionfistempered(thusadmitsaFouriertransform)ifandonlyifγ≤0.iii)Therationalfunctionˆf(s)isproper(inotherwords,wehaveρ≥0)ifandonlyifthedistributionfisoftheformq0δ+gwhereq0(cid:1)lim|s|→∞f(s)(thecasewhereˆf(s)isstrictlypropercorrespondstothecasewhereq0=0).iv)Foreveryp∈[1,+∞),thefollowingpropertyholds:thefunctiongbelongstoLpifandonlyifγ<0;thisisalsoanecessaryandsufﬁcientconditionforgtoadmitaboundedFouriertransform.Proofi)Accordingto(13.60)wehaveˆf(s)=ˆq(s)+ˆg(s),whereˆq(s)isapolynomialandwhereˆg(s)isastrictlyproperrationalfunction.Thepolynomialˆq(s)isnon-zeroifandonlyifρ≤0anditisthenoftheformˆq(s)=−ρ(cid:12)i=0qisi.ItsinverseLaplacetransformisthusq=−ρ(cid:12)i=0qiδiwhichisatempereddistribution.Wecandecomposethestrictlyproperrationalfunctionˆg(s)intosimpleelements;eachofthesesimpleelementsistheLaplacetransformofafunctionoftheform(12.83)andthecorrespondingabscissaofconvergenceisRe(p).Wededucefromtheretheexpressionofγ.Inaddition,eachofthesefunctionsiscontinuous(andevenanalytic)exceptattheorigin;thesameistrueforg=L−1{ˆg}.ii)Thefunctiongisslowlyincreasing–thusfisatempereddistribution–ifandonlyifγ≤0.iii)Therationalfunctionˆf(s)isproper(resp.,strictlyproper)ifandonlyifthepolynomialˆq(s)isaconstant(resp.,iszero).iv)Itisagainsufﬁcienttothinkofthedecompositionofˆg(s)intoitssimpleelementsandthenmakeuseoftheirinverseLaplacetransforms.Notethatifγ<0,theng∈L∞,buttheconverseisnottrue.Forexample,L−1(cid:31)1s =1(t):thisfunctionisboundedbutγ=0.Moreover,onecanhaveγ=0andg/∈L∞:forexample,L−1(cid:31)1s2 =t1(t).Considerthefollowingexample:L−1(cid:31)s+1s =δ+1:thisisatempereddistribution.Thefunctiong,inthiscase,isdeﬁnedbyg(t)=1,t≥0;itisaslowlyincreasingfunction.Wehave(Fg)(ω)=(Lg)(iω)=1iωifω(cid:5)=0.ThisFouriertransformisnotbounded(sinceγ=0)andisnotevenafunction:thisisthedistribution1iP1ω,whereP1ωisthe“principalvalue”of1ω[106].Appendix1:Analysis415Calculationoftheinversez-transformApplicationoftheresiduetheoremLetf(z)bearationalfunction.Accordingto(12.57),f(z)isthez-transformofapositivelysupportedsequence(xn)ifandonlyiff(z)isaproperrationalfunction.LetPbethesetofdistinctpolesoff(z)andlet=maxp∈P|p|.Letr>andletγbetheclosedpathz=reiθ,θ∈[0,2π].Formula(12.63)canbewrittenas:xn=12πi5γf(z)zn−1dz.(Wecanalsodirectlyestablishthisformulafromtheresiduetheoremafterthechangeofvariables=z−1;f(z)admitsapowerseriesexpansionins=z−1.)Accordingtotheresiduetheorem(12.77):xn=(cid:12)p∈PRes(cid:15)f(z)zn−1;p(cid:16),n≥0.(12.84)DecompositionintosimpleelementsandpowerseriesexpansionLetusnowdiscussanothermethodwhichisoftenfasterforthecalculationofinversez-transforms.Theproperrationalfunctionf(z)isalsoarationalfunction(notnecessarilyproper)ins=z−1.Indeed,f(z)isanirreduciblerationalfunctionN(z)D(z).Letn=d◦(D).WehaveN(z)D(z)=N(z)znD(z)zn=N∗(cid:15)z−1(cid:16)D∗(z−1)(12.85)whereN∗andD∗areobviouslypolynomials.Wecannowapplythedecomposition(13.60),(13.61)tof∗(cid:15)z−1(cid:16)=f(z).Writethisdecompositionintheformf∗(cid:15)z−1(cid:16)=Q∗(cid:15)z−1(cid:16)+(cid:12)p∈P(cid:12)1≤j≤nPαpj(1−pz−1)jwherePisthesetofdistinctpolesoff(z)andnPisthemultiplicityofthepolep∈P.ThepolynomialQ∗(cid:15)z−1(cid:16)isoftheformQ∗(cid:15)z−1(cid:16)=m(cid:12)k=0ckz−k416LinearSystemsanditsinversez-transformistheﬁnitesequencec={c0,...,cm}.Wethusknowhowtoﬁndtheinversez-transformoff(z)ifweknowhowtocalculatetheinversez-transformofatermoftheform1(1−pz−1)j.Wehave1(1−pz−1)j=+∞(cid:12)k=0(cid:21)j+k−1k(cid:22)pkz−kwhere(cid:15)j+k−1k(cid:16)isthebinomialcoefﬁcient(j+k−1)!(j−1)!k!.Asaresult,foranyk≥0,Z−1(cid:19)1(1−pz−1)j6(k)=(cid:21)j+k−1k(cid:22)pk.(12.86)ConsequencesEssentialconsequencesoftheabove,inparticularof(12.86),aregatheredinthefollowingtheorem:THEOREM446.–Arationalfunctionf(z),whosesetofdistinctpolesisP,isthez-transformofapositivelysupportedsequencex=(xn)ifandonlyiff(z)isproper.Theradiusofconvergenceofthisz-transformisthenρ=maxp∈P|p|.Thesequence(xn)isslowlyincreasing,thusadmittingaFouriertransform,ifandonlyifρ≤1.Inaddition,thefollowingconditionsareequivalent:(i)ρ<1;(ii)x∈l1;(iii)theFouriertransformFxisbounded.12.4.5.ArgumentprincipleTheargumentprincipleplaysakeyroleinthestudyofthestabilityofclosed-loopsystems.Letustaketheirreduciblerationalfunctionf(s)=(mk=1(s−zk)(nk=1(s−pk)(12.87)wherethezk’sandpk’sarethezerosandpolesoff(s)respectively.Whentheyaremultiple,theyappearseveraltimesin(12.87).Thelogarithmicderivativeoff(s)isdf(s)f(s)(thisisthederivativeoflnf(s)).Wehavedf(s)f(s)=m(cid:12)k=1dss−zk−n(cid:12)k=1dss−pk.(12.88)Appendix1:Analysis417Supposenowγ:[a,b]→Caclosedpathnotpassingthroughanyofthezk’snorpk’s.Theimageofγbyfistheclosedpathηdeﬁnedbyη(t)=f(γ(t)).Integratingtheleft-handmemberof(12.88)alongthepathγ,wehave(cid:2)γdf(s)f(s)=(cid:2)ba˙f(γ(t))˙γ(t)f(γ(t))dt.Nowletusintegratedssalongη:(cid:2)ηdss=(cid:2)ba˙η(t)η(t)dt=(cid:2)ba˙f(γ(t))˙γ(t)f(γ(t))dt.Therefore,byintegrating(12.88)alongγandbyusing(12.75)weobtainj(0;η)=m(cid:12)k=1j(zk;γ)−m(cid:12)k=1j(pk;γ).Letusnowchoosetheclosedpathγinsuchawaythat,morespeciﬁcally,γencirclesclockwise(i.e.intheindirectsense)onetimenzzerosandnppolesoff(s)(takingintoaccountmultiplicities),whereasitdoesnotenclosetheotherpolesandzerosofthisrationalfunction(anddoesnotpassthroughanyofthesepolesandzeros).Wethenhavej(zk;γ)=j(pk;γ)=−1forthezerosandpoleswhichareenclosedandj(zk;γ)=j(pk;γ)=0forthosethatarenot.Asaresult:j(0;η)=np−nz.(12.89)WecannowstateCauchy’sargumentprinciple:THEOREM447.–Thenumberoftimestheimageγ{f(s)}turnsaroundtheorigininthedirectsenseisequaltonp−nz,wherenpandnzarethenumberofpolesandzerosrespectively(multiplicitiesincluded)enclosedbyγintheclockwisesense.12.5.DifferentialequationsBelowthereaderwillﬁndasummaryofthetheoryofdifferentialequations,aswellassomecomplements.Thenatureoftheproblemsencounteredbythecontrolengineermakesitnecessarytostudylineardifferentialequationswithconstantcoefﬁcientsunderhypotheseswhicharemoregeneralthanintheusualapproach.12.5.1.GeneralitiesClassicalnotionofasolutionLetbethedifferentialequation˙x=F(t,x)(12.90)418LinearSystemswhereFisafunctionfromI×KnintoKn(withK=RorC)andwhereIisanintervalofRoftheform|t1,+∞),−∞≤t1<+∞.Fromaconcretepointofview,wealwayshaveK=R;however,forcalculations,itisoftenmoreconvenienttoembedRinC,thustoassumeK=C.Andthisiswhatwearegoingtodohere.Afunctionx:I(cid:20)t(cid:3)→x(t)∈Cnisasolution(intheclassicsense)ofequation(12.90)ifxisabsolutelycontinuousanditsderivativeinthesenseofdistributionssatisﬁes(12.90)almosteverywhere.TheCauchyproblemLet(t0,x0)∈I×Cn.TheCauchyproblemconsistsofhavingtodetermineafunctionxwhichisasolutionof(12.90)andwhichsatisﬁestheinitialconditionx(t0)=x0.(12.91)Thisobviouslyequivalenttotheproblemofdeterminingasolutiontotheintegralequationx(t)=x0+(cid:2)tt0F(τ,x(τ))dτ.FortheCauchyproblemtohaveoneandonlyonesolutionontheentireintervalI,functionFmustsatisfycertainconditions,speciﬁedhereafter.(Formoregeneralconditions,underwhichtheuniquenessofthesolutionisnotguaranteed,see[30],Chapter2.)Theinitialcondition(12.91)includestheinitialinstantt0andtheinitialstatex0(thisterminologyisonlyclassicwhenequation(12.90)representsasystem).TheCauchy-LipschitztheoremThefollowing,calledtheCauchy-Lipschitztheorem,isfundamental,butitsproofisoutsidethescopeofthisbook(see[111],PropositionC.3.8).SupposethatthefunctionFsatisﬁesthefollowinghypotheses:i)Thefunctiont(cid:3)→F(t,η)islocallyintegrableonI,foranyη∈Cn;ii)Thefunctionη(cid:3)→F(t,η)iscontinuousinCn,foranyt∈I.iii)Thereexistsalocallyintegrablefunctionα:I→R+suchthatforanyη,ς∈Cnandanyt∈I,(cid:23)F(t,η)−F(t,ς)(cid:23)≤α(t)(cid:23)η−ς(cid:23).(12.92)Thenthedifferentialequation(12.90)admitsauniquesolutionon[t0,+∞)whichsatisﬁestheinitialcondition(12.91).Appendix1:Analysis419AfunctionFsatisfyingconditioniii)issaidtobegloballyLipschitz(theadverb“globally”referstothefactthat,in(12.92),ηandςcanvaryinthewholeCnforauniquefunctionα).Inparticular,ifthefunction(t,η)(cid:3)→F(t,η)iscontinuousanddifferentiablewithrespecttothesecondvariable,andifthefunctionη(cid:3)→∂F∂η(t,η)islocallyuniformlybounded,thenalltheaboveconditionshold.DifferentialequationofhigherorderConsiderthedifferentialequationoforderny(n)=G(cid:9)t,y(n−1),...,y(cid:10)(12.93)whereGisafunctionfromI×Cp×...×CpintoCp,andwhereIisanintervalofRdeﬁnedasbefore.Inordernottomakethepresentationcumbersome,weassumeinwhatfollowsthatp=1wheneverwearedealingwithdifferentialequationsofthistype,exceptwhenotherwisestated.Wecomebacktothepreviouscasebywriting⎧⎪⎪⎪⎨⎪⎪⎪⎩x1=y(n−1),x2=y(n−2),...xn=y.(12.94)Indeed,thedifferentialequation(12.93)isequivalenttothesystemofdifferentialequations(cid:20)˙x1=G(t,x1,...,xn),˙xk+1=xk,1≤k≤n−1whichisofform(12.90).Theinitialstateatinstantt0is,accordingto(12.94),x(t0)=(cid:23)y(n−1)(t0)...y(t0)(cid:24)T.(12.95)LineardifferentialequationThedifferentialequation(12.90)issaidtobelinearifthemappingη(cid:3)→F(t,η)isafﬁne,i.e.ifF(t,η)isoftheformF(t,η)=A(t)η+f(t).Thedifferentialequationcanthusbewrittenas˙x=A(t)x+f(t).(12.96)420LinearSystemsInthiscase,theconditionsoftheCauchy-Lipschitztheoremaresatisﬁedifbothfunctionst(cid:3)→A(t)andt(cid:3)→f(t)arelocallyintegrableonI.Thisisthecase,forexample,ifthesefunctionsarepiecewisecontinuous*(or,moregenerally,regulated[35])*.LineardifferentialequationsofhigherorderConsideralineardifferentialequationofordernoftheform*∂n+n(cid:12)i=1∂n−iai+y=*n(cid:12)i=1∂n−ibi+u(12.97)where∂=d/dtandforanyi∈{1,...,n},thecoefﬁcientsaiandbiarefunctionsoftdeﬁnedontheintervalIandsatisfythefollowingproperty(P):(P)Thefunctionsaiandbiaren−itimesdifferentiableintheintervalIandtheirderivativeofordern−iispiecewisecontinuous*(or,moregenerally,regulated)*inthisinterval.Ontheotherhand,uisafunctionoft,deﬁnedinI,andisassumedtosatisfyProperty(P’)wearegoingtospecifybelow.Insteadofproceedingasin(12.94),wedeﬁnethevariablexasfollows:⎧⎪⎪⎨⎪⎪⎩x1=y,∂x1=−a1x1+b1u+x2,...∂xn−1=−anx1+bnu+xn.(12.98)Equality(12.97)canbesimpliﬁedas∂xn=−anx1+bnu.(12.99)Wethusobtainthedifferentialequation˙x=⎡⎢⎢⎢⎢⎢⎢⎢⎣−a110···0−a20............0......0.........01−an00···0⎤⎥⎥⎥⎥⎥⎥⎥⎦x+⎡⎢⎢⎢⎢⎢⎢⎢⎣b1.........bn⎤⎥⎥⎥⎥⎥⎥⎥⎦u,(12.100)y=(cid:25)10······0(cid:26)x.(12.101)System(12.100)isofform(12.96)withthefunctiont(cid:3)→A(t)whichisobviouslylocallyintegrableinI,andthefunctiont(cid:3)→f(t)willhavethissamepropertyifthefunctiont(cid:3)→u(t)satisﬁesthefollowingproperty(P’):(P’)Thefunctionuispiecewisecontinuous*(or,moregenerally,regulated)*intheintervalI.Appendix1:Analysis42112.5.2.Lineardifferentialequations:constantcoefﬁcientsMatrixformConsiderthedifferentialequation(12.96),wherethematrixA(t)∈Cn×nisconstant.Thisequationisthuswrittenas˙x=Ax+f(t)(12.102)Byatranslationoftheoriginoftime,theproblemcomesdowntothecasewheretheinitialinstantist0=0;thuswecanassumethatI=[0,+∞),andthefunctionf:I(cid:20)t(cid:3)→f(t)∈CnisassumedtobelocallyintegrableonI.HomogenousequationThehomogenousequationassociatedwith(12.102)istheoneobtainedwhenf=0.Itcanthusbewrittenas˙x=Ax.(12.103)ByreplacingAbyAtin(12.70)(seesection12.4.2),weobtaineAt=+∞(cid:12)k=0tkAkk!=In+tA+t2A22!+t3A33!...(12.104)Wecandifferentiatethispowerseriestermbytermandwegetddt(cid:15)eAt(cid:16)=A+tA2+...=A(cid:21)In+tA+t2A22!+...(cid:22)=AeAt,(12.105)thereforethefunctiont(cid:3)→eAtisasolutionof(12.103).CalculationofeAtThereexistnumerouswaystocalculateeAt.OneofthemconsistsinreducingAtoitsJordanform(section13.3.4,Theorem530).AccordingtotheJordantheorem,thereexistsachangeofbasismatrixPsuchthatJ=P−1APisadiagonalsumofJordanblocksJλ,k;eachoftheseblocksappearsinthediagonalsumanumberoftimesthatisequaltothegeometricmultiplicityoftheeigenvalueλandisassociatedwiththeelementarydivisor(s−λ)k.ItisimmediatethatA=PJP−1andthataccordingto(12.104),eAt=PeJtP−1.422LinearSystemsAccordingto(12.73),weareledtocalculateeJλ,kt.WehaveJλ,k=λIk+J0,kwhereIkandJ0,kcommute;thus,by(12.72)eJλ,kt=eλteJ0,kt.(12.106)TheJordanblockJ0,kisthematrixofdimensionk×kdeﬁnedbyJ0,k=⎡⎢⎢⎢⎢⎣00···01.....................0···10⎤⎥⎥⎥⎥⎦;asaresult,accordingto(12.104),eJ0,kt=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣10······0t1...0t22!t.....................0tk−1(k−1)!tk−2(k−2)!···t1⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦.(12.107)Ofcourse,inthecasewherethematrixAisdiagonalizable,thesecalculationsaresimpler.Indeed,wethenhaveJ=diag(λ1,...,λn)wheretheλi’s,1≤i≤n,aretheeigenvalues(notnecessarilydistinct)ofA.WethenobtaineJt=diag(cid:15)eλ1t,...,eλnt(cid:16).UseoftheinverseLaplacetransformDeﬁnition(12.48)oftheLaplacetransformextendswithoutdifﬁcultytothecaseofvector-valuedfunctions(i.e.fromRintoCn)ormatrix-valuedfunctions(fromRintoCn×m).WecancalculateeAtusingthisgeneralizedLaplacetransform.Wehaveindeed(12.52)withu(t)=eAt,thusu(0)=Inaccordingto(12.71).Andby(12.105),wegetsˆu(s)−In=Aˆu(s),fromwhichL(cid:15)eAt1(t)(cid:16)=(sIn−A)−1.(12.108)AmethodtocalculateeAtconsistsofcalculatingallentriesofthematrix(sIn−A)−1,andthendeterminingtheirinverseLaplacetransforms,whicharetheentriesofeAt1(t).Appendix1:Analysis423SolutionsofthehomogenousequationIfϕisanyvectorinCn,thefunctionx(t)=eAtϕ(12.109)istheuniquesolutionof(12.103)satisfyingtheinitialconditionx(0)=ϕ.Allthesolutionsof(12.103)arethusoftheform(12.109),whereϕspansCn.ThissetofsolutionsisthusaC-vectorspaceofdimensionn,generatedbythenfunctionsηi(t)=eAtεi,1≤i≤n,where(εi)1≤i≤nisthecanonicalbasisofCn.(Thesenfunctionsηi(t),1≤i≤n,arelinearlyindependentbecauseeAtisinvertible.)Letλ1,...,λqbethedistincteigenvaluesofA.Eacheigenvalueλi(1≤i≤q)correspondstooneorseveralJordanblocks;letmibethemaximalorderoftheseJordanblocks,i.e.theorderofmultiplicityofλiasarootoftheminimalpolynomialofA.Accordingto(12.106)and(12.107),allsolutionsof(12.103)areoftheformx(t)=q(cid:12)i=1eλitpi(t)(12.110)wherepi(t)isapolynomialintheindeterminatet,withcoefﬁcientsinCn,andofdegreemi−1.SolutionsofthecompleteequationIfzisaparticularsolutionofequation(12.102),itisimmediatethatallsolutionsof(12.102)areoftheformx=y+z,whereyspansthesetofsolutionsofthehomogenousequation(12.103).ThesesolutionsthusformanafﬁneC-spaceofdimensionn.Wedetermineaparticularsolutionof(12.102)byapplyingthemethodof“variationoftheconstant”tothesolutionsofthehomogenousequation(12.103).Wesawthatanysolutionof(12.103)isoftheform(12.109).Themethodofvariationoftheconstantconsistsinreplacingtheconstantvectorϕbyanabsolutelycontinuousfunctiont(cid:3)→ϕ(t)∈Cn.Inotherwords,welookforasolutionxof(12.102)intheformx(t)=eAtϕ(t).(12.111)Byusingthisin(12.102),wegetAeAtϕ(t)+eAt˙ϕ(t)=AeAtϕ(t)+f(t)fromwhich˙ϕ(t)=e−Atf(t)424LinearSystemsandthusϕ(t)=x0+(cid:2)t0e−Aτf(τ)dτ,x0∈CnAccordingto(12.111),weobtainx(t)=eAtx0+(cid:2)t0eA(t−τ)f(τ)dτ.(12.112)Thefunctionintheright-handsideof(12.112)istheuniquesolutionof(12.102)satisfyingtheinitialconditionx(0)=x0.UseoftheLaplacetransformWerecognizein(12.112)aconvolutionproduct.Thisisnotsurprising,forwecansolve(12.102)usingtheLaplacetransform.Wethenobtainfrom(12.102)and(12.52)sˆx(s)−x0=Aˆx(s)+ˆf(s)fromwhichˆx(s)=(sIn−A)−1x0+(sIn−A)−1ˆf(s)andweobtain(12.112)accordingto(12.108).LineardifferentialequationofhigherorderDecompositionoftheproblemInthecasewherethecoefﬁcientsareconstant,wecanconsideralineardifferentialequationofamoregeneralformthan(12.97),thatisa(∂)y=b(∂)u,(12.113)a(∂)=∂n+a1∂n−1+...+an,b(∂)=bk∂n−k+...+bn,bk(cid:5)=0,k∈Zwhereuisgivenandyistheunknown.DEFINITION448.–Thedifferentialequation(12.113)is(i)strictlyproperifk≥1,(ii)properifk≥0,(iii)improperifk<0.Appendix1:Analysis425Wecanadoptthefollowingapproach[120]:thevariableuisassumedtobeoftheformu=f+T,wherefisanindeﬁnitelydifferentiablefunctioninIandwhereT∈A+(see(12.53)).ByperformingtheEuclideandivisionofb(∂)bya(∂)(seesection13.1.3),wegetb(∂)=a(∂)q(∂)+r(∂)whered◦(r)<d◦(a),andwhered◦(q)=−kifk≤0andq=0ifnot.Equation(12.113)isequivalenttoa(∂)(y−q(∂)u)=r(∂)uaswellas,bywritingz=y−q(∂)u,toa(∂)z=r(∂)u,(12.114)y=z+q(∂)u.(12.115)Puttingw=y−z,weobtainw=q(∂)u.(12.116)SolutionsofthehomogenousdifferentialequationWecanproceedwiththedifferentialequation(12.114)aswehavedonewith(12.97),replacinginthislastequationybyzandb(∂)byr(∂).Wethenobtainthedifferentialequation(12.100)withthecoefﬁcientsbi(1≤i≤n)replacedbythecoefﬁcientsriofr(∂).Allcoefﬁcientsareconstant.ThematrixAisacompanionofthepolynomiala(s)=sn+a1sn−1+...+an(seesection13.4.3);a(s)isthusthecharacteristicpolynomialofAandisalsocalledthecharacteristicpolynomialofthedifferentialequation(12.113).SinceAiscyclic,a(s)isalsotheminimalpolynomialofthismatrix(section13.4.3,Corollary568).Therefore,thedistinctrootsλi(1≤i≤q)ofa(s)arethedistincteigenvaluesofA.Moreover,themultiplicityordermiofλiasarootofthepolynomiala(s)istheintegermialreadyencounteredwhenanalyzingequation(12.110);toλi,asaneigenvalueofA,therecorrespondsauniqueJordanblockwhichhasordermi.Thuswecanstatethefollowingresult:THEOREM449.–ThesolutionsofthehomogenousdifferentialequationconstituteaC-vectorspaceofdimensionn.AbasisofthisvectorspaceisformedbythenC-linearlyindependentfunctionst(cid:3)→tk−1eλit,1≤k≤mi,1≤i≤q.426LinearSystemsSolutionsofthecompleteequationTakingtheLaplacetransformof(12.114)andusing(12.55),weobtainanexpressionoftheformˆz(s)=r(s)a(s)ˆu(s)+˜r(s,∂0)u0−˜a(s,∂0)z0a(s)where˜r(s,∂0)(resp.,˜a(s,∂0))isapolynomialwithrespecttothetwovariablessand∂0,ofdegreed◦(r)−1or−∞(resp.,n−1or−∞)withrespecttoeachofthesevariables;thisdegreeisdenotedasd◦(˜r)(resp.,d◦(˜a))inwhatfollows.Inthesamemanner,takingtheLaplacetransformof(12.116)weobtainˆw(s)=q(s)ˆu(s)+˜q(s,∂0)u0where˜q(s,∂0)isapolynomialwithrespecttothetwovariablessand∂0,ofdegreeequaltod◦(q)−1or−∞withrespecttoeachofthesevariables;thisdegreeisdenotedasd◦(˜q)inthesequel.Finally,wehave,accordingto(12.115)ˆy(s)=b(s)a(s)u(s)+˜r(s,∂0)u0−˜a(s,∂0)z0a(s)+˜q(s,∂0)u0.(12.117)Letˆyf(s)=b(s)a(s)u(s).Thisquantityisobtainedfrom(12.117)byputtingz(i)(0−)=0(0≤i≤d◦(˜a))andu(i)(0−)=0(0≤i≤max(d◦(˜r),d◦(˜q))),(“zeroinitialconditions”).ItsinverseLaplacetransformis,accordingto(12.22)and(12.49),fort≥0yf(t)=(cid:2)t+0−g(t−τ)u(τ)dτ,whereg=L−1(cid:20)b(s)a(s)&.(12.118)ThisisanelementofA+,calledtheforcedresponse.Wenowwriteˆylr(s)=˜r(s,∂0)u0−˜a(s,∂0)z0a(s).(12.119)Thisisastrictlyproperrationalfunctionwithrespecttos;itthusadmits,accordingtoTheorem445,aninverseLaplacetransformwhichisanindeﬁnitelydifferentiablefunctionylr.Whentheinitialconditionsz(i)(0−)(0≤i≤d◦(˜a))andu(i)(0−)=0(0≤i≤d◦(˜r))vary,ylrspans,accordingtoTheorem449,aC-vectorspaceofdimensionn,havingabasisconsistingofthenfunctionsspeciﬁedintheabove-citedAppendix1:Analysis427theorem.Thefunctionsbelongingtothisvectorspacearereferredtoastheregularfreeresponses.Lastly,wewriteˆyli(s)=˜q(s,∂0)u0.(12.120)If˜q(s,∂0)(cid:5)=0,theinverseLaplacetransformylispans,astheinitialconditionsvary,aC−vectorspaceofdimensionequaltoρ,whereρ=1+d◦(˜q),havingasabasisthedistributionsδ,˙δ,...,δ(ρ−1).Thedistributionsbelongingtothisvectorspacearecalledtheirregularfreeresponses.Wecannowgathertheresultswehaveobtainedinthefollowingtheorem,whereρ=1+d◦(˜q)=d◦(q).THEOREM450.–i)Supposeuisoftheformu=f+T,wherefisanindeﬁnitelydifferentiablefunctioninIandwhereT∈A+.Thenthesolutionsyofthedifferentialequation(12.113)areofthesameform.Theycanbedecomposedaccordingtoy=ylr+yli+yf,whereyfistheforcedresponse,obtainedwithzeroinitialconditionsandgivenby(12.118),ylristheregularfreeresponsewhoseLaplacetransformisgivenby(12.119),andyliistheirregularfreeresponsewhoseLaplacetransformisgivenby(12.120).ii)TheregularfreeresponsesformaC-vectorspaceofdimensionn,abasisofwhichisformedbythenfunctionsinTheorem449.iii)Theirregularfreeresponsesarezeroifk≥0andtheyformaC-vectorspaceofdimension−kifk<0,abasisofwhichisformedbythedistributionsδ,˙δ,...,δ(−k−1).iv)Asaresult,thefreeresponsesofthedifferentialequation(12.113)formaC-vectorspaceofdimensionmax(n,n−k),16andareall“regular”(thatistheyarealllocallyintegrablefunctions)ifandonlyifk≥0.REMARK451.–Theorem450becomessimplerwhenk≥0(caseofa“properdifferentialequation”)sincetheirregularfreeresponsesarethenreducedto0(inotherwords,allfreeresponsesareregular).Supposethisisthecaseand,inaddition,uisalocallyintegrablefunction;then,accordingtoTheorem445andthepropertiesoftheconvolutionproduct(section12.2.2),theforcedresponseyfisalocallyintegrablefunctionifk≥0andacontinuousfunctionifk>0.16.In[120],thisquantitymax(n,n−k)isreferredtoastheorderofthedifferentialequation(12.113),forobviousreasons.428LinearSystems12.6.Functionsofseveralvariables;optimizationThepresentationonfunctionsofseveralvariablesmadehereisextremelysuccinct(withonlyafewproofs,andlimitedtothecaseofreal-valuedfunctions).Forageneralpresentation,see([35],ChapterVIII).12.6.1.FunctionsofclassC1LetΩbeanon-emptyopensubsetofRnandx∗∈Ω.WesaythatafunctionJ:Ω→Radmitsapartialderivative∂J∂xi(x∗)withrespecttothevariablexiatthepointx∗ifthepartialmappingJi:xi(cid:3)→J(cid:15)x∗1,...x∗i−1,xi,x∗i+1,...,x∗n(cid:16)isdifferentiableatx∗i;andinthiscasewehavebydeﬁnition∂J∂xi(x∗)=dJidxi(x∗i).ThefunctionJissaidtobedifferentiableatthepointx∗ifthereexistsalinearform,denotedbydJ(x∗)andcalledthederivativeofJatx∗,suchthatJ(x∗+h)−J(x∗)=dJ(x∗)h+o((cid:23)h(cid:23))(12.121)whereo((cid:23)h(cid:23))isafunction,deﬁnedintheneighborhoodof0andsuchthatlim(cid:10)h(cid:10)→0(cid:10)h(cid:10)(cid:12)=0o((cid:23)h(cid:23))(cid:23)h(cid:23)=0.InthecanonicalbasisofRn,dJ(x∗)isrepresentedbytherowmatrixDJ(x∗)=(cid:25)∂J∂x1(x∗)...∂J∂xn(x∗)(cid:26)calledtheJacobianmatrixofJatx∗.Ifweidentifythevectorh=(h1,...,hn)withthecolumnmatrix(cid:25)h1...hn(cid:26)T,wehavedJ(x∗)h=DJ(x∗)h,inawaythatleadsustoidentifythederivativedJ(x∗)withtheJacobianmatrixDJ(x∗).Thecolumnvector∇J(x∗)=DJ(x∗)TisthegradientofJatx∗.ThefunctionJissaidtobeofclassC1ifitisdifferentiableatanypointofΩandifitsderivativedJ:x→dJ(x)iscontinuous.OnecanshowthatJisofclassC1if,andonlyifitadmitspartialderivatives∂J∂xiwithrespecttoallitsvariablesatanypointofΩandifthesepartialderivativesarecontinuous.Appendix1:Analysis42912.6.2.FunctionsofclassC2LetJ:Ω→Rbeafunctionadmittingapartialderivative∂J∂xi(x)atanypointx∈Ωandconsiderthepartialmapping(DJ)i,j:xj(cid:3)→∂J∂xi(cid:15)x∗1,...x∗j−1,xj,x∗j+1,...,x∗n(cid:16).Ifitisdifferentiableatthepointx∗j∈Ω,wesaythatJadmitsasecondorderpartialderivative∂2J∂xi∂xj(x∗)withrespecttothevariablesxiandxjatx∗,andbydeﬁnition∂2J∂xi∂xj(x∗)=d(DJ)i,jdxj(cid:15)x∗j(cid:16).ThefunctionJissaidtobetwicedifferentiableatthepointx∗ifitisofclassC1andifitsderivativedJ:Ω→(Rn)(cid:2)isdifferentiableatx∗(where(Rn)(cid:2)isthedualofRn:seesection12.1.2;(Rn)(cid:2)isidentiﬁedwiththeR-vectorspaceofrowmatriceswithnentriesbelongingtoR,i.e.withR1×n).ThederivativeofdJatx∗iscalledthesecondderivativeofJatthatpointandisdenotedasd2J(x∗).ItisanelementofL(Rn,L(Rn,R)),representedinthecanonicalbasesbythesquarematrixofpartialderivativesoforder2,HJ(x∗)=(cid:9)∂2J∂xi∂xj(x∗)(cid:10)1≤i≤n,1≤j≤ncalledtheHessianmatrixofJatx∗.Thismatrixissymmetric(∂2J∂xi∂xj=∂2J∂xj∂xi).Leth1,h2betwovectorsofRn;wehave,basedontheaboveidentiﬁcationsd2J(x∗)(h1,h2)=hT1HJ(x∗)h2.(12.122)ThefunctionJissaidtobeofclassC2ifitistwicedifferentiableatanypointofΩandifitssecondderivatived2J:x→d2J(x)iscontinuous.OnecanshowthatJisofclassC2ifandonlyifitadmitssecondorderpartialderivatives∂2J∂xi∂xjwithrespecttoallitsvariablesatanypointofΩandifthesepartialderivativesarecontinuous.WeleaveittothereadertodeﬁnebyinductionthepthderivativedpJ(x∗),aswellasafunctionofclassCp.12.6.3.Taylor’sformulaSeth1=handhp=(cid:15)hp−1,h(cid:16)forp>1.430LinearSystemsTaylor’sformulawithYoung’sremainderLetJ:Ω→Rbeafunctionwhichisp−1timesdifferentiableinΩandptimesdifferentiableatpointx∗.ThereforeJ(x∗+h)=J(x∗)+p(cid:12)k=11k!dkJ(x∗)hk+o((cid:23)h(cid:23)p)(12.123)(Forp=1,thisformulaisnothingbutthedeﬁnitionofthederivativedJ(x∗).)Taylor’sformulawithLagrange’sremainderLetJ:Ω→Rbeafunctionwhichhasaderivativeororderp−1inΩ.Supposetheclosedsegment[x∗,x∗+h]iscontainedinΩandJadmitsaderivativeoforderpatanypointoftheopensegment(x∗,x∗+h).17Thenthereexistsθ∈(0,1)suchthatJ(x∗+h)=J(x∗)+p−1(cid:12)k=11k!dkJ(x∗)hk+1p!dpJ(x∗+θh)hp(12.124)12.6.4.Convexity,coercivity,ellipticityFormoredetailsonwhatfollows,theinterestedreadermayconsult[29].ConvexityAnon-emptysubsetΩofRnissaidtobeconvexifforanypointsaandbofΩ,thesegment[a,b]isincludedinΩ.LetJ:Ω→R,whereΩisconvex.ThefunctionJissaidtobeconvex(resp.,strictlyconvex)ifforanydistinctpointsaandbofΩandanyλ∈(0,1),J((1−λ)a+λb)≤(1−λ)J(a)+λJ(b)(resp.,J((1−λ)a+λb)<(1−λ)J(a)+λJ(b)).Letusrecallthefollowingdeﬁnitions,whereΩdenotesanon-emptypartofRn:–ThefunctionJ:Ω→Radmitsaglobal(resp.,strictglobal)minimumatx∗∈ΩifJ(x∗)≤J(x)foranyx∈Ω(resp.,J(x∗)<J(x)foranyx∈Ω,x(cid:5)=x∗);wethenwritex∗∈argminx∈ΩJ(x)(resp.,x∗=argminx∈ΩJ(x)).17.Thesegment[a,b](resp.,(a,b))isthesetofallpointsoftheform(1−λ)a+λb,λ∈[0,1](resp.,λ∈(0,1)).Seesection12.4.3.Appendix1:Analysis431–ThefunctionJ:Ω→Radmitsalocal(resp.,strictlocal)minimumatx∗∈ΩifthereexistsaneighborhoodVofx∗inΩsuchthattherestrictionofJtoVadmitsaglobal(resp.,strictglobal)minimumatx∗.Convexityplaysakeyroleinthetheoryofoptimizationforthefollowingreason:THEOREM452.–LetΩbeaconvexsubsetofRnandJ:Ω→R.IfJadmitsalocalminimumatx∗andisconvex(resp.,strictlyconvex),thenthisminimumisglobal(resp.,strictglobal).Notethatastrictlyconvexfunctiondoesnotnecessarilyadmitaminimum.Thisisthecase,forexample,ofJ(x)=1/xinΩ=(0,+∞).AnecessaryconditionforafunctiontoadmitalocalminimumistheEulercondition,animmediateconsequenceof(12.121):PROPOSITION453.–LetΩbeanon-emptyopensubsetofRnandJ:Ω→Rbeadifferentiablefunction.ForJtoadmitalocalminimumatpointx∗,theEulerconditiondJ(x∗)=0musthold.Thefollowingisaconsequenceof(12.123)and(12.124):PROPOSITION454.–LetΩbeaconvexopensubsetofRnandletJ:Ω→RbefunctionofclassC2.ThefunctionJisconvexifandonlyifHJ(x)≥0foreveryx∈Ω.IfHJ(x)>0foreveryx∈Ω,thenJisstrictlyconvex.Ontheotherhand,thefollowingisaclassicresult:THEOREM455.–LetΩbeaconvexopensubsetofRnandletJ:Ω→Rbeadifferentiablefunction.IfJisconvexandthereexistsasolutiontotheEulerequationdJ(x∗)=0,thenJ(x∗)isaglobalminimumofJ.IfinadditionJisstrictlyconvex,thesolutionx∗hereaboveisuniqueandJadmitsastrictglobalminimumatthispoint.CoercivityLetΩbeanunboundedpartofRnandJ:Ω→Rbecontinuousfunction.Thisfunctionissaidtobecoerciveiflim(cid:10)x(cid:10)→+∞x∈ΩJ(x)=+∞.THEOREM456.–LetΩbeanunboundedclosedpartofRn;everycoercivefunctionJ:Ω→Radmitsaglobalminimum.432LinearSystemsPROOF.Let˜x∈ΩandΦ={x∈Ω:J(x)≤J(˜x)}.ThesetΦisclosed(becauseJiscontinuous)andbounded,thuscompact.Asaresult,therestrictionofJtoΦadmitsaminimum(seetheproofofTheorem444).ThishereisobviouslyaglobalminimumofJ.EllipticityLetJ:Rn→RbeafunctionofclassC2.Thisfunctionissaidtobeellipticifthereexistsarealδ>0suchthatforeveryx∈Rn,HJ(x)−δIn≥0.THEOREM457.–LetJ:Rn→Rbeanellipticfunction;thisfunctionisstrictlyconvexandcoercive.PROOF.ItisobviousthatJisstrictlyconvex.Inaddition,accordingto(12.124),foranypointsxandx∗suchthatx(cid:5)=x∗J(x)=J(x∗)+dJ(x∗)(x−x∗)+12d2J(y)(x−x∗)2forsomey∈(x∗,x).Accordingto(12.122)andtheconditionofellipticity,J(x)≥J(x∗)+dJ(x∗)(x−x∗)+δ2(cid:23)x−x∗(cid:23)2,thusJ(x)→+∞as(cid:23)x(cid:23)→+∞.COROLLARY458.–LetJ:Rn→Rbeanellipticfunction;thisfunctionadmitsastrictglobalminimum,attainedatapointx∗whichistheuniquesolutionoftheEulerequationdJ(x∗)=0.12.6.5.OptimizationalgorithmsTheprincipaloptimizationalgorithms(forproblemswithoutconstraintsandexceptfortheconjugategradientsalgorithm)arebrieﬂydescribedbelow.GradientmethodLetΩbeanon-emptyopensubsetofRnandJ:Ω→Rbeadifferentiablefunction.Letθ∈Ωandh∈Rnbesuchthatθ+h∈Ω.Wehave(seesection12.6.3)J(θ+h)−J(θ)=dJ(θ)h+o((cid:23)h(cid:23))(12.125)anddJ(θ)=∇J(θ)T.LEMMA459.–Lethbeoftheform−ρ∇J(θ),ρ>0.ThenJ(θ−ρ∇J(θ))<J(θ)if∇J(θ)(cid:5)=0andifρ>0issufﬁcientlysmall.Appendix1:Analysis433PROOF.Accordingto(12.125)J(θ−ρ∇J(θ))−J(θ)=−ρ(cid:23)∇J(θ)(cid:23)2+o(ρ).Anincrementhasaboveisinthedirectionoppositetothatofthegradient.Lemma459showsthatthisdirectionisadirectionofdescent,i.e.inthisdirectionthecostfunctionJdecreases,atleastforasmallincrement.The“gradientmethod”isaniterativeminimizationmethodofthefunctionJ.Fromapointθ(0)∈Ω,wewillconstructasequence(cid:9)θ(k)(cid:10)k≥0ofpointsofΩ,calledaminimizingsequence,ofthefollowingmanner:θ(k+1)=θ(k)−ρk∇J(cid:9)θ(k)(cid:10)whereρk≥0,while∇J(cid:9)θ(k)(cid:10)(cid:5)=0.Recallthatifthereexistsθ(k)suchthat∇J(cid:9)θ(k)(cid:10)=0andifbothΩandJareconvex,thenJ(cid:9)θ(k)(cid:10)isaglobalminimumofJ(seesection12.6.4,Theorem455),thusθ(k)isthevalueofthevectorofparametersθwearelookingfor.Incertaincases,the“step”ρkischosentobeconstant(withrespecttok)toreducethecalculations:thisistheﬁxed-stepgradientmethod.Wecanalso,atthecostofmoreimportantandextensivecalculations(butforbetterefﬁciency),optimizethestepρkbyminimizingateachiterationkthefunctionofasinglevariable˜Jk(ρ)=J(cid:9)θ(k)−ρ∇J(cid:9)θ(k)(cid:10)(cid:10)(withρ≥0).Thisiswhatwecallaunidirectionalminimization(madeinthedirectiondk=−∇J(cid:9)θ(k)(cid:10)(cid:5)=0).Denoteasρ∗ktheoptimalstep,ifitexists.THEOREM460.–SupposethatΩ=RnandthatJisofclassC2andiselliptic(section12.6.4).Thentheunidirectionalminimizationproblemadmitsauniquesolutionandwecanwriteρ∗k=argminρ≥0˜Jk(ρ).PROOF.SincethefunctionJiscoercive,soisobviously˜Jktoo.Asaresult,accordingtoTheorem456(section12.6.4),˜Jkadmitsaglobalminimumintheunbounded434LinearSystemsclosedconvexset[0,+∞).Inaddition,d˜Jkdρ(ρ)=−dJ(cid:9)θ(k)−ρ∇J(cid:9)θ(k)(cid:10)(cid:10)∇J(cid:9)θ(k)(cid:10),(12.126)d2˜Jkdρ2(ρ)=d2J(cid:9)θ(k)−ρ∇J(cid:9)θ(k)(cid:10)(cid:10)(cid:9)∇J(cid:9)θ(k)(cid:10),∇J(cid:9)θ(k)(cid:10)(cid:10)=(cid:9)∇J(cid:9)θ(k)(cid:10)(cid:10)THJ(cid:9)θ(k)−ρ∇J(cid:9)θ(k)(cid:10)(cid:10)∇J(cid:9)θ(k)(cid:10)≥δ(cid:29)(cid:29)(cid:29)∇J(cid:9)θ(k)(cid:10)(cid:29)(cid:29)(cid:29)2>0,therefore˜Jkisstrictlyconvex(accordingtoProposition454ofsection12.6.4).Theminimumof˜Jkin[0,+∞)isthusstrictandunique(accordingtoTheorem455).REMARK461.–Theoptimalstepρ∗kbelongsnecessarilyto(0,+∞).Indeed,ifwehadρ∗k=0,wewouldhaveJ(cid:9)θ(k)−ρ∇J(cid:9)θ(k)(cid:10)(cid:10)>J(cid:9)θ(k)(cid:10)foranyρ>0,whichisimpossibleaccordingtoLemma459.Asaresult,ρ∗kischaracterizedbytheEulerequationd˜Jkdρ(ρ∗k)=0,whichyields∇J(cid:9)θ(k+1)(cid:10)T∇J(cid:9)θ(k)(cid:10)=0accordingto(12.126).Inotherwords,thedirectionsoftwosuccessivedescentsareorthogonal.Onecanshowthefollowingresult([29],Theorem8.4-3):THEOREM462.–UnderthehypothesesofTheorem460,theoptimal-stepgradientmethodconverges(i.e.(cid:9)J(cid:9)θ(k)(cid:10)(cid:10)→minJ).Thepointisnowtoexplicitlydeterminetheoptimalstepρ∗k.Thisisnotpossibleinthegeneralcaseanditisthennecessarytomakeuseofasearchbydichotomies.OneexceptiontothissituationisthatwherethecostfunctionJisquadratic(andelliptic),i.e.isoftheformJ(θ)=12θTAθ+bTθwhereAisasymmetricrealpositivedeﬁnitematrix.Letwk=Aθ(k)+b=∇J(cid:9)θ(k)(cid:10).Itiseasytoverifythatρ∗k=(cid:23)wk(cid:23)2wTkAwk.Appendix1:Analysis435Newton-RaphsonmethodTheNewton-Raphsonmethod–likeallmethodsbelow–isamethodofdescent.LetJ:Rn→RbeafunctionofclassC2andassumethatJiselliptic.WehavebyapplyingtheTaylor-Youngformulaintheneighborhoodofθ(k)(section12.6.3)J(θ)=Jk(θ)+o(cid:21)(cid:29)(cid:29)(cid:29)θ−θ(k)(cid:29)(cid:29)(cid:29)2(cid:22)whereJk(θ)isthe“secondorderapproximation”ofJintheneighborhoodofθ(k),i.e.settingHk=HJ(cid:9)θ(k)(cid:10),Jk(θ)=J(cid:9)θ(k)(cid:10)+∇J(cid:9)θ(k)(cid:10)(cid:9)θ−θ(k)(cid:10)+12(cid:9)θ−θ(k)(cid:10)THk(cid:9)θ−θ(k)(cid:10).ThefunctionJkisobviouslyellipticandthusadmitsastrictglobalminimumatthepointθ(k+1)characterizedbytheEulerequation∇Jk(cid:9)θ(k+1)(cid:10)=0(section12.6.4,Corollary458).Wehave∇Jk(θ)=∇J(cid:9)θ(k)(cid:10)+Hk(cid:9)θ−θ(k)(cid:10),andthereforeθ(k+1)=θ(k)−H−1k∇J(cid:9)θ(k)(cid:10).(12.127)REMARK463.–(i)Contrarytothegradientmethod,theNewton-Raphsonmethoddoesnotrequireunidirectionalminimization(nevertheless,see(iii)below).(ii)InthecasewhereJisquadratic(andalsoelliptic),theNewton-Raphsonconvergesinoneiteration,whereasingeneralthegradientmethodconvergesinaninﬁnitenumberofiterations[29].Foranon-quadraticfunctionJ,whenθisclosetotheoptimum,Jk(θ)isagoodapproximationofJ(θ),thustheNewton-Raphsonmethodconvergesrapidly.Itishowevertobeavoidedwhenθisstillfarawayfromtheoptimumandwewouldthenpreferthegradientalgorithm.(iii)Inordertoavoidthe“blocked”situationsfarawayfromtheoptimum,wecanimprovetheNewton-Raphsonmethodbymakingaunidirectionalminimizationateachiteration.Inthiscase,(12.127)isreplacedby⎧⎨⎩θ(k+1)=θ(k)−ρ∗kH−1k∇J(cid:9)θ(k)(cid:10)ρ∗k=argminρ≥0J(cid:9)θ(k)−ρH−1k∇J(cid:9)θ(k)(cid:10)(cid:10)(withofcourseρ∗k=1inthecaseofaquadraticfunction).Wearriveatamethodofdescentwithadirectiongivenbydk=−H−1k∇J(cid:9)θ(k)(cid:10).436LinearSystemsNewton-GaussmethodThebigdisadvantageoftheNewton-RaphsonmethodisthelargeamountofcalculationsnecessaryforthedeterminationoftheHessianmatrixHkateachiterationk.Thisamountcanbereducedinthecaseofaquadraticcriterion,i.e.J(θ)=12(cid:12)i∈Iji(θ)2whereIisaﬁnitesetofindicesandwherethefunctionsji:Rn→RareofclassC2.WegetdJ(θ)=(cid:12)i∈Iji(θ)dji(θ),HJ(θ)=(cid:12)i∈I(cid:23)∇ji(θ)∇ji(θ)T+Hji(θ)ji(θ)(cid:24).Intheaboveexpression,thecalculationoftheHji(θ)’sisdisadvantageous.TheNewton-Gaussmethodneglectstheseterms,whichanywayarezeroifthefunctionsjiarelinear.WethusobtaintheapproximationHk(cid:9)(cid:11)i∈I∇ji(cid:9)θ(k)(cid:10)(cid:9)∇ji(cid:9)θ(k)(cid:10)(cid:10)T.(12.128)Besidessimplifyingthecalculations,anotheradvantageisthatthematrixontheright-handsideof(12.128)isalwayssymmetricrealnon-negativedeﬁnite,whichisanessentialpointfordktoactuallybeadirectionofdescent(seebelow).Quasi-NewtonmethodsLetJ:Rn→RbeafunctionofclassC1.Consideriterationsoftheformθ(k+1)=θ(k)+ρkdk(12.129)ρk>0,whereeachdirectiondkisoftheformdk=−Gk∇J(cid:9)θ(k)(cid:10)(12.130)Gkbeingasymmetricrealmatrix.Wehavethefollowing:THEOREM464.–AsufﬁcientconditionfordktobeadirectionofdescentisthatGkbepositivedeﬁnite.Appendix1:Analysis437PROOF.Wehave,accordingtotheTaylor-YoungformulaJ(cid:9)θ(k)+ρdk(cid:10)=J(cid:9)θ(k)(cid:10)−ρ∇J(cid:9)θ(k)(cid:10)TGk∇J(cid:9)θ(k)(cid:10)+o(ρ),thusJ(cid:9)θ(k)+ρdk(cid:10)<J(cid:9)θ(k)(cid:10)if∇J(cid:9)θ(k)(cid:10)(cid:5)=0,Gk>0andifρ>0issufﬁcientlysmall.Wecallaniterativemethodoftheform(12.129),(12.130)aquasi-NewtonmethodwheneverGk>0.SupposeJisofclassC2andiselliptic.Thenwecanoptimizethestepρkbyaunidirectionalminimization,whichleadstoa“quasi-Newtonmethodwithoptimalstep”.FollowingthesamerationaleasintheproofofTheorem460andinRemark461,weindeedobtainthefollowing:THEOREM465.–Let˜Jk(ρ)=J(cid:9)θ(k)+ρdk(cid:10).Theunidirectionalminimizationproblem˜Jk(ρ)→minadmitsauniquesolutionρ∗k=argminρ≥0˜Jk(ρ)>0characterizedbytheEulerconditionwhichisequivalentto∇J(cid:9)θ(k+1)(cid:10)Tdk=0.Twoquasi-Newtonmethodshavebeendiscussedsofar:–thegradientmethod,whichcorrespondstoGk=In;–theNewton-Raphsonmethod,whichcorrespondstoGk=H−1k(amatrixwhichispositivedeﬁniteifJiselliptic).Intermediatestrategiescanbeconsidered,forexampleGk=(cid:20)In,1≤k<k0H−1k,k≥k0wherek0issuchthatθ(k0)is“sufﬁcientlyclose”totheoptimum.Thismethodmakesitpossibletohaveafasterconvergenceintheneighborhoodoftheoptimumthanthegradientmethod.Ontheotherhand,forpointsfurtherawayfromtheoptimum,weavoidpossibledifﬁcultiessuchas,forexample,gettingasingularHessianmatrixinthecasewhereJisnotelliptic.Inordertoavoidasingularityin438LinearSystemsthecalculationsattheneighborhoodoftheoptimum,wecantaketheprecautionofreplacinghereaboveHkbyHk+εkIn,whereεk>0isasufﬁcientlysmallrealnumber.ByreplacingagainHkbyitsapproximation(12.128)fromtheNewton-Gaussmethod,weobtaintheLevenberg-Marquardtmethodwhichisveryefﬁcient.12.7.ProbabilisticnotionsThissectionconsistsofsummariesandcomplements.Formoredetailsonthetheoryofmeasureandonthatofprobabilities,see,e.g.[103]and[83],respectively.12.7.1.Probabilityspaceσ-algebrasandmeasurabilityLetΩbeanon-emptyset.Aσ-algebraFoverΩisasetofpartsofΩcontainingtheemptysetandwhichisstablebypassingintocomplementaswellasbycountableunion;thepair(Ω,F)iscalledaprobabilizablespace(thisnotionissynonymoustothatofmeasurablespace).Anintersectionofσ-algebrasisagainaσ-algebra.LetEbeanon-emptysetofpartsofΩ;thesmallestσ-algebracontainingEiscalledtheσ-algebrageneratedbyE.IfΩisatopologicalspace(section12.1.1),theσ-algebrageneratedbytheopensubsetsofΩistheBorelσ-algebraofΩ(andtheelementsofthisσ-algebraarecalledtheBorelsetsofΩ).Let(Ω,F)and(Y,T)betwoprobabilizablespaces;afunctionY:Ω→Yissaidtobe(F,T)-measurable(orF-measurableifYisatopologicalspaceandTisaBorelσ-algebraofY)ifforanyB∈T,Y−1(B)∈F.ItisimmediatethatY−1(T)isaσ-algebra,itisalsothesmallestamongtheσ-algebrasGforwhichYis(G,T)-measurable.Moregenerally,let(Yi,Ti)i∈Ibeafamilyofprobabilizablespacesand(Yi)i∈IbeafamilyoffunctionsYi:Ω→Yi.Itisalsoclearthat7i∈IY−1i(Ti)isaσ-algebra,anditisthesmallestamongalltheσ-algebrasGforwhicheachoftheYi’s(i∈I)is(G,T)-measurable.DEFINITION466.–WecallY−1(T)theσ-algebrageneratedbyYand7i∈IY−1i(Ti)theσ-algebrageneratedbythefamily(Yi)i∈I.Appendix1:Analysis439ProbabilityLet(Ω,F)beaprobabilizablespace.Ameasureofprobability(or,moresuccinctly,aprobability)PonsuchaspaceisapositivemeasuresuchthatP{Ω}=1,whichwealsowriteasP{Ω}=(cid:1)ΩdP(ω)=1.Thenthetriple(Ω,F,P)iscalledaprobabilityspace.REMARK467.–AsimpleandimportantcaseisthatwhentheprobabilitymeasurePisdeﬁnedbyadensityp;inthiscase,Ω=Rn,FistheBorelσ-algebraBnofRn,dP(x)=p(x)dx,wherep(x)≥0,dxistheLebesguemeasureonRn,and(cid:2)Rnp(x)dx=1.12.7.2.RandomvariableGeneralnotionsLet(Ω,F,P)beaprobabilityspace;arandomvariablewithvaluesinaprobabilizablespace(Y,T)isan(F,T)-measurablemappingY:Ω→Y.(ArandomvariableisthusafunctionΩ(cid:20)ω(cid:3)→Y(ω)∈Y;thedependenceofYwithrespecttoωexpressesthe“randomdraws”thatwecanperformfromYand,forﬁxedω,a“realization”ofYisavalueY(ω).)Arandomvariableissaidtobereal(resp.,complex)iftheprobabilizablespace(Y,T)isthesetofreal(resp.,complexnumbers)numbersequippedwithitsBorelσ-algebra.Aneventis“almostsure”ifitsprobabilityisequalto1;inparticular,tworandomvariablesXandY,withvaluesinthesameprobabilizablespace(Y,T),arealmostsurelyequalifP{X=Y}=1.DEFINITION468.–(i)LetF1andF2betwosub-σ-algebrasofF;thesesub-σ-algebrasaresaidtobeindependentifforanyA1∈F1andanyA2∈F2,P{A1∩A2}=P{A1}P{A2}.(ii)LetYbearandomvariableandGbeasub-σ-algebraofF.WesaythatYisindependentofGifthelatterandtheσ-algebrageneratedbyYareindependent.(iii)LetY1andY2betworandomvariables;thesearesaidtobeindependentiftheσ-algebrastheygenerateareindependent.TheprobabilitylawofarandomvariableYwithvaluesin(Y,T)istheimageprobabilityofPbyY,i.e.theprobabilityνYdeﬁnedon(Y,T)byνY(B)=P(cid:31)Y−1(B) ,B∈T.440LinearSystemsSupposeY1andY2aretworandomvariableswithvaluesintheprobabilizablespaces(Y1,T1)and(Y2,T2)respectively.ForanyB1∈T1andanyB2∈T2,ν(Y1,Y2)(B1×B2)=P{Y1∈B1,Y2∈B2}=P(cid:31)Y−11(B1)∩Y−12(B2) .TheserandomvariablesareindependentifandonlyifforallsetsB1andB2asabove,P(cid:31)Y−11(B1)∩Y−12(B2) =P(cid:31)Y−11(B1) P(cid:31)Y−12(B2) .Wededucethefollowing:PROPOSITION469.–TheaboverandomvariablesY1andY2areindependentifandonlyifν(Y1,Y2)(B1×B2)=νY1(B1)νY2(B2),∀B1∈T1,∀B2∈T2.RandomvariablesoftheﬁrstorderLetXbearandomvariablewithvaluesinthemeasurablespace(Kn,Bn)whereBnistheBorelσ-algebraofKn(K=RorC);abusingthelanguage,wewillsaythatXhasitsvaluesinKn.18ThisrandomvariableissaidtobeoftheﬁrstorderifE[(cid:23)X(cid:23)]=(cid:2)Ω(cid:23)X(ω)(cid:23)dP(ω)<+∞where(cid:23).(cid:23)isthestandardEuclideanorHermitiannorm(section12.1.2).Byidentifyingtwoalmostsurelyequalrandomvariables(whichwewilldointhesequel19),thesetofrandomvariablesoftheﬁrstorderwithvaluesinKnisdenotedasL1(Ω,F,P;Kn),orL1(Ω,F,P)ifn=1andK=R;thisisaBanachspaceequippedwiththenorm(cid:23)X(cid:23)1(cid:1)E[(cid:23)X(cid:23)].ThequantityE[X]=(cid:1)ΩX(ω)dP(ω)iscalledtheexpectationofX.IfK=R,E[X]isexpressedasafunctionoftheprobabilitylawνXofXaccordingtoE[X]=(cid:2)RnxdνX.(12.131)18.WecanalwayscomebacktothecasewhereK=RbyidentifyingCwithR2,thusCnwithR2n,equippedwithitsBorelσ-algebra.19.Thisissimilartowhatwasdoneinsection12.2.2.Thistime,however,themeasureconsideredistheprobabilityP,insteadoftheLebesguemeasure.Appendix1:Analysis441RandomvariablesofthesecondorderTherandomvariableXissaidtobeofthesecondorderif(cid:23)X(cid:23)2isarandomvariableoftheﬁrstorder.ThesetofrandomvariablesofthesecondorderwithvaluesinKnisdenotedasL2(Ω,F,P;Kn),orL2(Ω,F,P)ifn=1andK=R;thisisaHilbertspaceequippedwiththescalarproduct X,Y!=E[X∗Y](where(.)∗designatestheconjugate-transpose:seesection13.5.3);theassociatedHilbertnormisdenotedas(cid:23)X(cid:23)2.WehaveL2(Ω,F,P;Kn)⊂L1(Ω,F,P;Kn).Ifn=1,|E[X]|2≤E(cid:23)|X|2(cid:24);thequantityσ2X=E(cid:23)|X|2(cid:24)−|E[X]|2isthevarianceofXandσXisitsstandarddeviation;ifn≥1,thematrixQX=E(cid:25)(X−E[X])(X−E[X])∗(cid:26)iscalledthecovariancematrixofX.LetXandYbetworealrandomvariablesofthesecondorder.ThenXYisarandomvariableoftheﬁrstorderandaccordingto(12.131)E[XY]=(cid:2)R2xydν(X,Y)(x,y).PROPOSITION470.–(i)IftherandomvariablesXandYareindependent,thenE[XY]=E[X]E[Y].(ii)Ifinadditiononeofthemiscentered,thenE(cid:23)|X+Y|2(cid:24)=E(cid:23)|X|2(cid:24)+E(cid:23)|Y|2(cid:24).PROOF.(i)AccordingtoProposition469,dν(X,Y)(x,y)=dνX(x)dνY(y),thusE[XY]=(cid:2)RxdνX(x)(cid:2)RdνY(y)=E[X]E[Y].WehaveE(cid:23)|X+Y|2(cid:24)=E(cid:23)|X|2(cid:24)+E(cid:23)|Y|2(cid:24)+2E[XY];asaresult,(ii)isanimmediateconsequenceof(i).DistributionfunctionandprobabilitydensityLetX=(X1,...,Xn)bearandomvariablewithvaluesintheprobabilizablespace(Rn,Bn)whereBnistheBorelσ-algebraofRn.ThedistributionfunctionofX,denotedasFX,isdeﬁnedonRnbyFX(x1,...,xn)=P{X1<x1,...,Xn<xn}.442LinearSystemsThedistributionfunctionofXdeterminesitsprobabilitylaw.SupposethattheprobabilitylawofXadmitsadensityδX,calledtheprobabilitydensityofX,thatistosaythatthemeasureνXisabsolutelycontinuouswithrespecttotheLebesguemeasuredx,i.e.dνX=δXdx(12.132)(Remark467,section12.7.1).WethenhaveFX(x1,...,xn)=(cid:2)X(x)δX(ξ)dξ(12.133)wherex=(x1,..,xn),X(x)=(1≤i≤n(−∞,xi)andξ=(ξ1,...,ξn);ontheotherhand,ifXisoftheﬁrstorder,wethenhave,accordingto(12.131),(12.132),E[X]=(cid:1)RnxδX(x)dx.(12.134)ThefollowingresultisadirectconsequenceofProposition469andof(12.133):PROPOSITION471.–LetXandYbetwoindependentvariableswithvaluesinRnandRmrespectively.(i)TheyareindependentifandonlyifthedistributionfunctionF(X,Y)ofthepair(X,Y)satisﬁes,forany(x,y)∈Rn×Rm,theequalityF(X,Y)(x,y)=FX(x)FY(y).(ii)If(X,Y)admitsaprobabilitydensityδ(X,Y),thenXandYadmitprobabilitydensitiesδXandδYrespectively,theformergivenbyδX(x)=(cid:2)Rmδ(X,Y)(x,y)dyandthelatterbyasimilarexpression.Inaddition,XandYareindependentifandonlyifforany(x,y)∈Rn×Rm,δ(X,Y)(x,y)=δX(x)δY(y).GaussianrandomvariableTheaboverandomvariableissaidtobeGaussianifitsprobabilitydensityisGaussian.Thatis,δX(x)=1√(2π)ndetQXexp(cid:7)−(1/2)(x−¯x)TQ−1X(x−¯x)(cid:8)Appendix1:Analysis443where¯x=E[X]andQXisthecovariancematrix(assumedinvertible)ofX.If¯x=0andQX=In,thenthecorrespondingprobabilitylawiscalledthereducedGaussian(ornormal)law.Gaussianrandomvariablesareparticularlyimportantduetothecentrallimittheorem:THEOREM472.–Let(Xn)beasequenceofindependentrealrandomvariablesofthesecondorder,withexpectation¯x,standarddeviationσ,andthesameprobabilitylaw.Then,asn→+∞,therandomvariableYn=1σ√nn(cid:12)k=1(Xk−n¯x)convergesinlawtowardsthereducednormallaw(i.e.theprobabilitylawofYnweakly*convergestothereducednormallaw–see[83]formoredetails).IfinadditioneachXnhasaprobabilitydensity,thentheprobabilitydensityofYnconvergesuniformlytothatofthereducednormallaw.12.7.3.ConditionalexpectationCaseofrandomvariablesofthesecondorderTheconditionalexpectationcanbedeﬁnedforrandomvariablesoftheﬁrstorderbywayofaslightlydifﬁcultapproachandisnotnecessaryforthisbook.Wethuswillonlyconsiderthecaseofrandomvariablesofthesecondorder.Let(Ω,F,P)beaprobabilityspace,letX∈L2(Ω,F,P;Kn)andletGbeasub-σ-algebraofF.LEMMA473.–(i)ThereexistsauniquerandomvariableˆX∈L2(Ω,G,P;Kn)suchthat(cid:29)(cid:29)(cid:29)X−ˆX(cid:29)(cid:29)(cid:29)2=minY∈L2(Ω,G,P;Kn)(cid:23)X−Y(cid:23)2.(ii)ThisrandomvariableischaracterizedbytherelationE[Y∗X]=E(cid:23)Y∗ˆX(cid:24),∀Y∈L2(Ω,G,P;Kn).(iii)ThemappingX(cid:3)→ˆXisK-linearfromL2(Ω,F,P;Kn)ontoL2(Ω,G,P;Kn)andhasanorm1.PROOF.Asalreadyseen,L2(Ω,F,P;Kn)andL2(Ω,G,P;Kn)areHilbertspaces,andL2(Ω,G,P;Kn)⊂L2(Ω,F,P;Kn).Itsufﬁcesthereforetoapplytheorthogonalprojectiontheorem(Theorem429,section12.1.2).444LinearSystemsDEFINITION474.–(i)TheaboverandomvariableˆXiscalledtheconditionalexpectationofXwithrespecttotheσ-algebraGandisdenotedasE[X|G].(ii)LetYbearandomvariablewithvaluesintheprobabilizablespace(Y,T)andconsidertheσ-algebraG=Y−1(T)generatedbyY;E[X|G]isalsocalledtheconditionalexpectationofXwithrespecttotherandomvariableYandisdenotedasE[X|Y].(iii)BygivingtoYavaluey∈Y,E[X|Y]becomestheelementofKndenotedasE[X|Y=y].Letusnowestablishseveralpropertiesoftheconditionalexpectation.THEOREM475.–(i)ThemappingX(cid:3)→E[X|G]isK-linear.(ii)IfXisG-measurable,thenE[X|G]=X.(iii)E[E[X|G]]=E[X].(iv)Giventwoσ-algebrasHandGsuchthatH⊂G⊂F,wehaveE[E[X|G]|H]=E[X|H]=E[E[X|H]|G].PROOF.(i)isareformulationofLemma473(iii).(ii)IfXisG-measurable,thenX∈L2(Ω,G,P;Kn),thusE[X|G]=X.(iii)LetY=ej,thejthvectorofthecanonicalbasisofKn.ItisclearthatY∈L2(Ω,G,P;Kn),thusaccordingtoLemma473(ii),E[Xj]=E(cid:23)ˆXj(cid:24).Proceedingthiswayforanyj∈{1,...,n},weobtainE[X]=E(cid:23)ˆX(cid:24).(iv):WecanobtaintheorthogonalprojectionE[X|H]ofXontoL2(Ω,H,P;Kn)byﬁrsttakingitsorthogonalprojectionE[X|G]ontoL2(Ω,G,P;Kn),andthentheorthogonalprojectionofE[X|G]ontoL2(Ω,H,P;Kn)⊂L2(Ω,G,P;Kn),whichprovestheﬁrstequality.Thesecondimmediatelyfollowsfrom(ii)sinceE[X|H]isG-measurable.SupposenowthatXandYaretworandomvariablesofthesecondorder,assumedtoberealforthesakeofsimplicity,andletGbeasub-σ-algebraofF.PROPOSITION476.–(i)IfYisG-measurableandessentiallybounded(withrespecttotheprobabilitymeasureP),thenE[XY|G]=YE[X|G].(ii)IfXisindependentofG,thenE[X|G]=E[X].PROOF.(i)WehaveYE[X|G]∈L2(Ω,G,P)andforanyZ∈L2(Ω,G,P),E[YE[X|G]Z]=E[XYZ]accordingtoLemma473(ii),whichprovestheresult.(ii)XisindependentofanyY∈L2(Ω,G,P),thusE[XY]=E[X]E[Y]=E[E[X]Y],andtheresultfollowsfromLemma473(ii).CasewhereaprobabilitydensityexistsSupposenowthatK=R,andthat(X,Y)isarandomvariablewithvaluesinRn×Rm,whichadmitsaprobabilitydensity(x,y)(cid:3)→δ(X,Y)(x,y)(section12.7.2).Appendix1:Analysis445WecallthefunctiondeﬁnedbyδY=yX(x)=δ(X,Y)(x,y)δY(y)theconditionaldensityofXwithrespecttoY=y;accordingtoProposition471(ii),δY(y)=(cid:1)Rnδ(X,Y)(x,y)dx.Accordingtothesameproposition,therandomvariablesXandYarethusindependentifandonlyifδY=yX(x)=δX(x)forany(x,y)∈Rn×Rm.Inthegeneralcase,thisisofcoursenottrue;instead,E[X|Y=y]=(cid:1)RnxδY=yX(x)dxwhichissimilarto(12.134).Chapter13Appendix2:Algebra13.1.Commutativeringsandﬁelds13.1.1.GeneralitiesThenotionofringAringRisasetequippedwithanaddition+,suchthat(R,+)isanadditivegroup,andwithamultiplication×whichisdistributiverelativetotheadditionandsatisﬁestheusualproperties;wesupposethatthereexistsaunitelement,denotedby1,suchthat1a=a1=aforanya∈R.Recallthatanyelementahasanopposite−a(suchthata+(−a)=0)sinceRisanadditivegroup.TheinvertibleelementsofR(i.e.theelementsuforwhichthereexistsaninversedenotedbyu−1,suchthatuu−1=u−1u=1)arecalledtheunitsofthatring.Twoelementsaandbaresaidtobeassociates(orassociated)ifthereexistunitsυandυ(cid:2)suchthata=υbυ(cid:2).Forexample,intheringZofrationalintegers,wheretheunitsare−1and1,nand−nareassociates.Letusreviewafewexamplesofringsandthenotionsthatgowiththem.RingsofmatricesWedenotethesetofsquarematricesofordernwithrealentriesasRn×n;thisisaring.Itsunitsarethematriceswhosedeterminantisnon-zero(itsunitelementistheidentitymatrix).NotethatfortwomatricesAandB,wehaveingeneralAB(cid:5)=BA;themultiplicationofmatricesisthusnon-commutative.Ontheotherhand,theproductABcanbezerowhileneitherAnorBiszero;AandBarethencalledzerodivisors(Aontheleft,Bontheright).DEFINITION477.–Aringissaidtobecommutativewhenitsmultiplicationiscommutative;aringthathasnozerodivisorsissaidtobeintegral,ortobeadomain.Therefore,acommutativeintegralringiscalledacommutativedomain.447Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.448LinearSystemsFromtheabove,itfollowsthatRn×nisanon-commutativeandnon-integralring.Inwhatfollows,allringsarecommutativedomains,exceptwhenotherwisestated.PolynomialringsAtypicalexampleofringisthesetK[s]ofallpolynomialsintheindeterminateswithcoefﬁcientsbelongingtotheﬁeldK(K=RorC).Theunitsarethepolynomialsofdegreezero,i.e.theconstantnon-zeropolynomials(byconvention,thedegreeofthezeropolynomialis−∞).Ifg(s)andh(s)aretwopolynomials,wehavetheequalityg(s)h(s)=h(s)g(s):theringK[s]isthuscommutative.Inaddition,ifg(s)h(s)=0,wemusthaveg(s)=0orh(s)=0,sothatK[s]isintegral.Apolynomialissaidtobemonicifthecoefﬁcientofitshighestdegreetermis1.Itisclearthattwomonicpolynomialswhichareassociatedarenecessarilyequal.Apolynomialp(s)∈K[s]ofdegreen≥0hasnrootsinC.Forexample,thepolynomialp(s)=(cid:15)s2+1(cid:16)(s−r)k(k≥1)hask+2rootsinC,formingtheset{i,−i,r,...,r},whererisrepeatedktimes.Thesetofthedistinctrootsofthispolynomialis{i,−i,r},buttherootrhasanorderofmultiplicity(or,forshort,amultiplicity)equaltok.RingsofformalpowerseriesTakeathirdexample:thesetK[[s]]offormalpowerseriesinswithcoefﬁcientsbelongingtoK,whichiscomposedofallelementsoftheforma(s)=(cid:12)n≥0ansn.(13.1)Thispowerseriesisformalinthesensethatwedonotconcernourselveswiththequestionofconvergence:this“formalpowerseries”isnothingbutthesequenceofcoefﬁcients(an),exceptthatwedeﬁneonformalseriesanadditionandamultiplicationinthefollowingmanner:(cid:12)n≥0ansn+(cid:12)n≥0bnsn=(cid:12)n≥0(an+bn)sn,(cid:12)n≥0ansn.(cid:12)n≥0bnsn=(cid:12)n≥0cnsnwherethesequence(cn)istheconvolutionproductof(an)and(bn)(seesection12.2.1);sincethetwolastsequencesareonlydeﬁnedinthesetofnaturalnumbersN(butcanbeextendedtothesetofrationalintegersZbypositivelysupportedsequences),thesequence(cn)iswell-deﬁned.Appendix2:Algebra449TheringK[[s]]iscommutativeandonecanshowthatitisintegral[25].AunitofK[[s]]isaformalpowerseriesoftheform(13.1)suchthata0(cid:5)=0.Itsinverseisthusoftheform(cid:11)n≥0bnsnwithb0=1a0.RingsofholomorphicfunctionsLetΩbeanon-emptyopensubsetofC.ThesetO(Ω)ofallholomorphicfunctionsinΩ(section12.4.1)isacommutativedomain.Fields,ﬁeldoffractionsLetRbearing.Ifnon-zeroelementsofRareinvertible,Riscalledadivisionring.Aﬁeldisacommutativedivisionring.ConsideracommutativedomainR.Thesetofallelementsoftheformba,whereb∈Randabelongstothecomplementof{0}inR(denotedbyR(cid:2){0}orbyR×)isaﬁelddenotedasQ(R),andcalledtheﬁeldoffractionsofR.TheﬁeldoffractionsofZisQ,i.e.theﬁeldofrationalnumbers;32,−53,etc.,areelementsofQ.TheﬁeldoffractionsofK[s]istheﬁeldK(s)ofrationalfunctionsinswithcoefﬁcientsintheﬁeldK(formoredetailsaboutrationalfunctions,seesection13.6.1).TheﬁeldoffractionsofK[[s]]istheﬁeldK((s))ofLaurentserieswithcoefﬁcientsintheﬁeldK,andtheelementsofwhichareoftheform(cid:11)n≥νansn,whereν∈Zandan∈K.TheﬁeldoffractionsofO(Ω)(seeabove)istheﬁeldM(Ω)ofallmeromorphicfunctionsinΩ(section12.4.1).ApolynomialcanbeconsideredasaspecialmeromorphicfunctioninC.Then,arootofthispolynomialisnothingbutazeroofthismeromorphicfunction.Likewise,arationalfunctioncanbeconsideredasaspecialmeromorphicfunctionsinC.*DifferentialﬁeldAdifferentialﬁeldisaﬁeldKequippedwithaderivationδ:a→aδsatisfyingLeibniz’srule:(ab)δ=abδ+aδb[31].Forexample,theﬁeldC(t)ofrationalfunctionsinthevariabletandwithcomplexcoefﬁcients,equippedwiththeusualderivativewithrespecttot,isadifferentialﬁeld.AconstantofKisanelementa∈Kwhosederivativeaδiszero.ThesetofconstantsofKisaﬁeldk⊂K,calledtheﬁeldofconstantsofK.Thederivativeaδisoftendenotedas˙a.VectorspaceLetKbeaﬁeld1,calledtheﬁeldofscalars(forexample,RorC).AvectorspaceoverK(alsocalledaK-vectorspace)isasetEequippedwithanadditionfromE×E1.Oradivisionring.450LinearSystemsintoEsatisfyingtheusualproperties(insuchawaythatEisanadditivegroup)aswellaswithamultiplicationfromK×EintoE.Wecanaddorsubtracttwovectors,thatistwoelementsofE,andwecanmultiplyavectorbyascalar.ThemostclassicexampleofK-vectorspaceisKn,thesetofallelementsoftheform(x1,...,xn),xi∈K,i∈{1,...,n}.Thisvectorspaceisdetailedinsection13.3.1.ThesetsK[s],K[[s]],K(s)andK((s))arealsoK-vectorspaces(ofinﬁnitedimension,contrarytoKn).AlgebraLetKbeaﬁeldandletEbeasetsatisfyingthefollowingconditions:(i)Eisaring(resp.,acommutativering);(ii)EisK-vectorspace;(iii)themultiplicationoftheringEiscompatiblewiththemultiplicationfromK×EintoE,inthesensewhereλ(ab)=(λa)b=a(λb)foranya∈E,b∈E,λ∈K.SuchasetEiscalledanunitaryK-algebra(resp.,acommutativeunitaryK-algebra).Theadjective“unitary”meansthatthereexistsaunitelementinthisalgebra2.Forexample,thesetsK[s],K[[s]],K(s)andK((s))areunitarycommutativeK-algebras.ThesetKn×nisanon-commutativeunitaryK-algebra.*ThisdeﬁnitionofaK-algebraextendstothecasewhereKisacommutativering,replacingcondition(ii)by(ii’):EisaK-module.*13.1.2.DivisibilityIdealAnidealina(commutative)ringRisasubgroupIoftheadditivegroupRsuchthatforanyr∈Randanya∈I,ra∈I.SuchanidealIissaidtobegeneratedbyasetJ⊂RifanyelementofIisoftheform(cid:12)λrλaλ,aλ∈J,where(rλ)isaﬁnitelysupportedsequenceofelementsofR.WesaythatJisageneratingsetofI,andthisidealissaidtobeﬁnitelygeneratedifJisﬁnite.AprincipalidealinRisanidealgeneratedbyauniqueelementaandisdenotedas(a)orRa.Itisclearthat(1)=R.2.Onecandeﬁnenon-unitaryalgebras,whichdonotadmitaunitelement(andthusarenotrings).Oneexampleofanon-unitaryalgebraisgiveninsection12.2.2(algebraK+).Appendix2:Algebra451MultipleanddivisorAmultipleofanelementaofRisanelementoftheformba,b∈R.Leta(cid:5)=0andbbetwoelementsofR;wesaythataisadivisorofb,whichwedenoteasa|b,ifbisamultipleofa,whichisequivalentto(b)⊂(a).Then,thereexistsauniqueelementcsuchthatb=ca,andthatwewritec=ba.Forexample,intheringZ,3=62.lcmLetaandbbetwonon-zeroelementsofaringR.Thesetofmultiplesofaistheideal(a).Thesetofallcommonmultiplesofaandbisthus(a)∩(b).Supposethisidealisprincipal,i.e.oftheform(m).Thiselementmisaleastcommonmultiple(lcm)ofaandb,sinceeverycommonmultipleofaandbisamultipleofm.Anyotherlcmofaandbisassociatedwithm.Wedenotelcm(a,b)thesetofalllcm’sofaandb.Thisextendstoanynumberofnon-zeroelementsai,i∈{1,...,n}:anlcmoftheseelements(ifitexists)isanelementmsuchthat(m)=∩ni=1(ai).IfR=K[s],lcm(a,b)designatestheuniquelcmofaandbwhichisamonicpolynomial.gcdandGCDdomainLetaandbbetwonon-zeroelementsofaringR.Anelementdiscalledagreatestcommondivisor(gcd)ofaandbifdisadivisorofaandbandifanydivisorofaandbdividesd.Everyothergcdofaandbisassociatedwithd;thesetconsistingofalltheseelementsisdenotedasgcd(a,b).IfR=K[s],gcd(a,b)designatestheuniquegcdofaandbwhichisamonicpolynomial.Onecanshowthefollowing([31],section3.1,Exercises7&8):LEMMA478.–(i)Ifnon-zeroelementsaandbofaringRadmitanlcmm,theyadmitagcddsuchthatab=dm(theexistenceofagcddoesnotingeneralimplythatofanlcm).(ii)InaringR,allpairsofnon-zeroelementsadmitalcmifandonlyifallpairsofnon-zeroelementsadmitagcd.Theabovelemmaleadstothefollowing:DEFINITION479.–AGCDdomainisa(commutative)domainRsuchthatanytwonon-zeroelementsofthisringadmitagcd.452LinearSystemsCoprimenessTwonon-zeroelementsaandbofaringRaresaidtobecoprime(orrelativelyprime)iftheyhavenocommondivisorsexceptunits,inotherwordsifoneoftheirgcd’sis1.AtomsandprimesAnatominaringRisanon-zeroelementwhichisonlydivisiblebytheunitsofRandbyitself.AprimeelementinR(oraprime,forshort)isanon-zeroelementpwhichisanonunitandcannotdividetheproductoftwoelementsofRwithoutdividingoneofthem(*inotherwords,itisanelementpsuchthattheprincipalideal(p)isprime*).EveryprimeinRisanatomandtheconverseholdstrueifRisaGCDdomain([10],sectionVI.13,RemarkafterProposition14).IntheringZ,theprimesaretheprimenumbers2,3,5,7,11,etc.andtheirassociates−2,−3,−5,−7,−11,etc.InC[s],theprimesarethepolynomialsoftheﬁrstdegree.InR[s],theprimesarethepolynomialsoftheﬁrstdegreeandthosepolynomialsoftheseconddegreewhichdonothaverealroots.ArepresentativesystemofprimesinadomainRisafamily(pi)ofprimesinRsuchthateveryprimeinR(ifany)isassociatedwithoneandonlyonepi.IfR=K[s](K=RorC),thechosenrepresentativesystemalwaysconsistsofmonicpolynomials.Uniquefactorizationintoprimes,UFD’sLetRbearing,let(pi)bearepresentativesystemofprimesinRandleta∈R×.Ifacanbeuniquelywrittenintheforma=υ’ipαii(13.2)whereυisaunitofRandthenon-negativeintegersαi’sarezeroexceptforaﬁnitenumberofthem,wesaythataadmitsuniquefactorizationintoprimesgivenby(13.2);thequantityl(a)=(cid:12)iαiisthencalledthelengthofa.DEFINITION480.–AcommutativedomainRiscalledauniquefactorizationdomain(UFD)ifeverynon-zeroelementofRadmitsuniquefactorizationintoprimes.Onecanprovethefollowing([91],sectionX.1):iftheringRisaUFD,thenR[X](whereXdesignatesanindeterminate)isagainaUFD.WededucebyinductionthatK[X1,...,Xn]isaUFD.PROPOSITION481.–AUFDisaGCDdomain.Appendix2:Algebra453PROOF.InaUFD,letabegivenby(13.2)andletb=υ(cid:2)(ipβii;thend=’ipmin(αi,βi)i,m=’ipmax(αi,βi)iareagcdandanlcmofaandbrespectively.BézoutdomainsDEFINITION482.–A(commutative)Bézoutdomainisacommutativedomaininwhichanyﬁnitelygeneratedidealisprincipal.SupposeRisaBézoutdomainandleta,bbetwonon-zeroelementsofR;(a)+(b)isthesmallestidealcontaining(a)and(b).Thisidealisgeneratedbyaandb,thusitisprincipal,andthereexistsdsuchthat(a)+(b)=(d).Itisclearthatdisagcdofaandb.Wehavethusproventhefollowing:PROPOSITION483.–ABézoutdomainisaGCDdomain.Leta1,...,anbenon-zeroelementsofaBézoutdomainR;anelementdisagcdoftheseelementsifandonlyif(d)=(cid:11)1≤i≤n(ai).Thefollowingisprovedin([103]section15.15):PROPOSITION484.–LetΩbeanopenconnectedsubsetofC.TheringO(Ω)isaBézoutdomain.Inparticular,theringO(C)ofallentirefunctions(section12.4.1)isaBézoutdomain.13.1.3.PrincipalidealdomainsDEFINITION485.–(i)Acommutativedomainiscalleda(commutative)principalidealdomainifeveryidealinthisringisprincipal.(ii)ANoetherianringisaringinwhicheveryidealisﬁnitelygenerated.THEOREM486.–Thefollowingconditionsareequivalent:(i)Risaprincipalidealdomain;(ii)RisaNoetherianringwhichisaBézoutdomain;(iii)RisbothaUFDandaBézoutdomain.PROOF.Theequivalencebetween(i)and(ii)isobvious.Fortheequivalencebetween(i)and(iii),see([11],sectionVII.2,Exercise17andsectionVII.3,Exercise10).AﬁeldFisatrivialexampleofaprincipalidealdomain,foritsonlyidealsare{0}=(0)andF=(1).454LinearSystemsEuclideandomainDEFINITION487.–(A)AnEuclidean(commutative)domainisacommutativedomainRinwhichwehavedeﬁnedanEuclideanfunction.Thatistosay,amappingθfromRintoN∪{−∞}(whereNisthesetofnon-negativeintegers)suchthat:(i)θ(0)=−∞;(ii)foranyelementsaandbofR×,θ(ab)≥θ(a);(iii)foranyainRandbinR×,thereexistelementsqandrofRsuchthata=bq+randθ(r)<θ(b)(Euclideandivisionofabyb:qisthequotientandrtheremainder).(B)AcommutativedomainissaidtobestronglyEuclideanifcondition(ii)isreplacedbythefollowingstrongercondition(ii’):foranyelementsaandbofR,θ(a−b)≤max{θ(a),θ(b)},andforanyelementaandbofR×,θ(ab)=θ(a)+θ(b);inthiscase,theEuclideanfunctionθiscalledadegree.REMARK488.–(i)ThequotientandremainderoftheEuclideandivisioninthecommutativedomainRareuniqueifandonlyiftheringisstronglyEuclidean.(ii)AnelementυofaEuclideanringisaunitifandonlyifθ(υ)=θ(1);ifa(cid:5)=0isnotaunit,θ(a)>θ(1).(iii)TheringZofrationalintegersisEuclidean(withθ(n)=|n|ifn(cid:5)=0)butnotstronglyEuclidean.TheringK[s]isthemosttypicalexampleofastronglyEuclideandomain(θisthenthedegreeofapolynomialintheusualsense:θ=d◦).THEOREM489.–AnEuclideandomainisaprincipalidealdomain.PROOF.LetIbeanon-zeroidealinaEuclideandomainR.Amongthenon-zeroelementsofI,consideroneoftheelementsbofminimumdegree.LetxbeanyelementofIandperformtheEuclideandivisionofxbyb;wehavex=bq+rwithθ(r)<θ(b),thusθ(r)=−∞,inotherwordsr=0andx∈(b).WethushaveI=(b).Non-EuclideanprincipalidealdomainsThereexistprincipalidealdomainsthatarenotEuclideandomains.AtypicalexampleisK[[s]].Wecannotdeﬁnethedegreeofaformalpowerseries.Ontheotherhand,wecandeﬁneitsorder.Theorderω(a)oftheformalpowerseries(13.1),assumedtobenon-zero,isthesmallestintegerksuchthatak(cid:5)=0.Weputω(0)=+∞.AunitofK[[s]]isaformalpowerseriesofzeroorder.Aformalpowerseriesa(s)oforderkisoftheformskυ(s),whereυ(s)isaunitinK[[s]].Itisclearthata(s)|b(s)ifandonlyifω(a)≤ω(b).AllidealsinK[[s]]areoftheform(cid:15)sk(cid:16)anditfollowsthatK[[s]]isaprincipalidealdomain.Furthermore,K[[s]]admits(amongtheproperideals,i.e.thosethataredifferentfromK[[s]])auniquemaximalidealwhichis(s);aringthatadmitsauniquemaximalidealissaidtobelocal.TheringK[[s]]isthusaprincipalidealdomainwhichislocal.Appendix2:Algebra45513.1.4.MatricesovercommutativeringsMatrixcalculationsThesetofmatriceshavingprowsandmcolumns(saidtobeofsizep×m)withentriesinacommutativeringR,isdenotedasRp×m.Asquarematrixofsizen×nissaidtobeofordern.Thebasicoperationsonmatrices(additionandmultiplicationoftwomatrices,multiplicationofamatrixbyascalar)areassumedtobeknown.TheyaredeﬁnedinthesamemanneroveracommutativeringRasoverRorC.TheidentitymatrixofordernisdenotedasIn.TheelementoftheithrowandjthcolumnofamatrixAisdenotedasaij.LetA∈Rp×m;thematrixAT∈Rm×p,theelementoftheithrowandthejthcolumnofwhichisaji,iscalledthetransposeofA.DiagonalsumoftwomatricesLetA1∈Rp1×m1andA2∈Rp2×m2.ThematrixA=(cid:27)A100A2(cid:28),wherethezerosdesignateblocksofzerosofappropriatesizes,isdenotedbyA=A1⊕A2andiscalledthediagonalsumofA1andA2.WecandeﬁneA1⊕A2⊕A3=(A1⊕A2)⊕A3,andsoon.DeterminantLetusgooverafewpropertiesofdeterminantsagain:OnRn×n,thedeterminantistheuniquen-linearalternatingformwithrespecttothecolumnsofthematricesofthissetandsuchthatdetIn=1;thisremainstrueifwereplacecolumnsbyrows.Asaconsequence,ifwedenotebyA•j,1≤j≤n,thecolumnsofthematrixA,detA=0ifandonlyifthecolumnsofAareR-linearlydependent,inotherwordsifthereexistelementscj∈R,1≤j≤n,notallzeros,suchthat(cid:11)nj=1cjA•j=0;thisisalsotruefortherowsAi•.Anotherconsequence(obtainedbyexchangingrowsandcolumns)isthatdetA=detAT.IfAandBbothbelongtoRn×n,det(AB)=det(BA)=detAdetB.ConsiderthematrixofordernA=(cid:27)A10A3A2(cid:28),(13.3)456LinearSystemswhereA1∈Rn1×n1,A2∈Rn2×n2,A3∈Rn2×n1withn1+n2=n.ThendetA=detA1detA2.Inparticular,det(A1⊕A2)=detA1detA2.Finally,ifRisaﬁeldandA=(cid:27)XYZT(cid:28),(13.4)whereXandTaresquarematricesandXisnon-singular,detA=detXdet(cid:15)T−ZX−1Y(cid:16).(13.5)MinorsandcofactorsLetA∈Rp×m.AminorofordernofA(wheren≤min{p,m})isthedeterminantofasquaresubmatrixofAofordern(obtainedbysuppressingrowsandcolumnsofA).Aprincipalminorisaminorformedbysuppressingrowsandcolumnswithsameindices.NowletA∈Rn×n;denotebymijtheminorofordern−1obtainedbysuppressingtheithrowandjthcolumnofA.Thecofactorofaijisαij=(−1)i+jmij.Thematrixαwithentriesαij,1≤i≤n,1≤j≤n,iscalledthecofactormatrixofA.WehavedetA=n(cid:12)j=1aijαij=n(cid:12)i=1aijαij(developmentsofthedeterminantalongtheithrow,andthenthejthcolumn,whichareparticularcasesoftheLaplaceexpansionofA:see[10],sectionIII.8.6).Theaboveequalitiesmakeitpossibletocalculatethedeterminantofasquarematrixofordernfromthedeterminantsofsquarematricesofordern−1andthus,byrepeatingthisprocedure,tocalculatethedeterminantofanysquarematrix,becausethedeterminantofasquarematrixoforder1(i.e.ofanelementofR)isequaltothematrixitself.RankTherankrofamatrixA∈Rp×misthemaximalorderofthenon-zerominorsofA.ThisrankisequaltothenumberofrowsandthenumberofcolumnsofAthatarelinearlyindependent.Ofcourse,r≤min{p,m}.Appendix2:Algebra457Ifr=m,Aissaidtoberight-regularorfullcolumnrank;ifr=p,Aissaidtobeleft-regularorfullrowrank;ifAiseitherright-orleft-regular,itissaidtobesemiregular.Finally,asquarematrixAthatisbothleft-andright-regularissaidtoberegular(ornon-singular).AnelementofacommutativedomainRcanbeconsideredasanelementoftheﬁeldoffractionsF=Q(R)ofthisring(wethensaythatwehave“embeddedRinF”).ThismakesA∈Rp×manelementofFp×m.WethuscanaprioridistinguishtherankofAoverR(thatiswhenAisconsideredasanelementofRp×m)andtherankofAoverF(whenAisconsideredasanelementofFp×m);infact,onecanshowthatthesetwonotionscoincide.Forthecalculationoftherank,itismoreefﬁcienttoworkovertheﬁeldF,sincethenotionofrankoveraﬁeldismorefamiliarandconvenientthanthatofrankoveraring.Wewillseelaterefﬁcientmethodsofcalculationoftherankofamatrixoveraﬁeld(Corollary501ofsections13.2.3and13.5.7).AmatrixisregularoverRifandonlyifitisinvertibleoverF.EXAMPLE490.–ConsiderthecasewhereR=K[s].AmatrixA(s)∈K[s]p×miscalledapolynomialmatrix.Accordingtotheabove,therankofAoverK[s]anditsrankoverK(s)coincide.AverydifferentnotionistherankofA(s)overKwhenthevariablestakesonaparticularvalue.Considerthefollowingmatrix:A(s)=(cid:27)s101(cid:28).(13.6)WehavedetA(s)=s,thustherankofA(s)overR(denotedbyrkRA(s))isequalto2,becausedetA(s)isnotthezeropolynomial.Ontheotherhand,overK=RorC,therankofA(s)isequalto2ifs(cid:5)=0andto1ifs=0.Thevalues=0isarootofdetA(s).SylvesterinequalityandSylvesterdomainLetA∈Rp×nandB∈Rn×m;ifRisaﬁeld,onecanshowthefollowing,calledtheSylvesterinequality(seeforexample[26])rk(A)+rk(B)−n≤rk(AB)≤min{rk(A),rk(B)};(13.7)inaddition,theabovetwoinequalitiesbecomeequalitiesifp=nandAisinvertible.IfRisaring,certainprecautionshavetobetaken.DEFINITION491.–ASylvesterdomainisacommutativedomainRoverwhichwhenevertwomatricesA∈Rp×nandB∈Rn×maresuchthatAB=0,thenrk(A)+rk(B)≤n.Wenowcanstatethefollowing([31],Chapter5):458LinearSystemsTHEOREM492.–(i)Theinequalityontherightsideof(13.7)isvalidoveranycommutativedomainRandtheoneontheleftsideisvalid(foranymatricesA∈Rp×nandB∈Rn×m)ifandonlyifRisaSylvesterdomain.(ii)ABézoutdomainandaﬁeldareSylvesterdomains.InverseofasquarematrixConsiderthecofactormatrixαofamatrixA∈Rn×n.ItstransposeαTiscalledtheclassicaladjointmatrixortheadjugatematrixofA.Onecanshowthat:αTA=AαT=detA.InAnecessaryandsufﬁcientconditionforAtobeinvertibleoverF(thatisasanelementofFn×n,andthustohaveaninverseinthisset)isdetA(cid:5)=0,sincethenA−1=1detAαT.(13.8)Inotherwords,anecessaryandsufﬁcientconditionforAtobeinvertibleoverFisthatAbenon-singular.IfthesubmatricesA1andA2ofthematrixAdeﬁnedby(13.3)areinvertibleoverF,thenAisinvertibleoverFandA−1=(cid:27)A−110−A−12A3A−11A−12(cid:28).(13.9)Finally,westatethe“Inversionlemma”:LEMMA493.–LetA,B,C,DbematriceswithentriesinaﬁeldF,ofsizen×n,n×m,m×mandm×nrespectively,andsuchthatAandCareinvertibleoverF.Then(A+BCD)−1=A−1−A−1B(cid:15)DA−1B+C−1(cid:16)−1DA−1.InvertiblematricesoveraringLetRbeacommutativedomain.Accordingto(13.8),amatrixA∈Rn×nisinvertibleoverR(or,moresuccinctly,invertible)ifandonlyifitsdeterminantisaunitinR.ThesetofinvertiblematricesinRn×nisdenotedasGLn(R);itisamultiplicativegroup,calledthegenerallineargroupofsquarematricesofordernoverR.ThesubgroupofGLn(R)formedofmatricesofdeterminantequalto1(calledunimodularmatrices)isthespeciallineargroupofthesquarematricesofordernoverRandisdenotedasSLn(R)([10],n◦III.8.3).Appendix2:Algebra459ItisimportanttomakeadifferencebetweenaninvertiblematrixoverFandaninvertiblematrixoverR.Forexample,thematrix(13.6)isinvertibleoverF=K(s)anditsinverseisA−1(s)=(cid:27)1s−1s01(cid:28).ItisclearthatA−1(s)∈K(s)2×2butthatA−1(s)/∈K[s]2×2.ThematrixA(s)isthusnotinvertibleoverR.EquivalenceofmatricesTwomatricesA∈Rp×mandB∈Rp×maresaidtobeleft-equivalent(resp.,right-equivalent),whichwedenoteasAl∼B(resp.,Ar∼B)ifthereexistsamatrixU∈GLp(R)(resp.,V∈GLm(R))suchthatB=U−1A(resp.,B=AV).ThematricesAandBarethenofthesamerank.TwomatricesA∈Rp×mandB∈Rp×maresaidtobeequivalent,whichwedenoteasA∼B,ifthereexisttwomatricesU∈GLp(R)andV∈GLm(R)suchthatB=U−1AV.ElementaryandsecondaryoperationsElementaryoperationsThe3matricesU1,U2andU3belowareinvertiblematricesofR2×2:U1=(cid:27)0110(cid:28),U2=(cid:27)1α01(cid:28),U3=(cid:27)100υ(cid:28)whereα∈RandυisaunitofR.LetA∈R2×m;itisimmediatethat:U1AisobtainedfromAbypermutingrows1and2ofthismatrix;U2AisobtainedbyaddingtotheﬁrstrowofAthesecondrowmultipliedbyα;U3AisobtainedbymultiplyingthesecondrowofAbyυ.Inamoregeneralmanner,wedeﬁne3typesofelementaryoperationsontherowsofamatrixA∈Rp×m:(i)permutingtworowsofA;(ii)addingtotheithrowofAthejthrow(j(cid:5)=i)multipliedbyanelementofR;(iii)multiplyingarowofAbyaunitinR.SecondaryoperationsAsecondaryoperationontherowsisdeﬁnedinthefollowingmanner:(iv)Left-multiplytworowsofAbyamatrixU4∈GL2(R).Eachoftheelementaryorsecondaryoperationsontherowscorrespondstotheleft-multiplicationbyaninvertiblematrixoverR.460LinearSystemsWedeﬁneinthesamemanner3typesofelementaryoperationsonthecolumnsandonetypeofsecondaryoperations;eachofthemcorrespondstoaright-multiplicationbyaparticularinvertiblematrix.Theimportanceofelementaryandsecondaryoperationswillbecomeobviousinsection13.2.13.1.5.BézoutequationGeneralcaseLeta,bandcbe3elementsofaBézoutdomainR,whereaandbarenotbothzero.WecallBézoutequationanequationoftheformax+by=c(13.10)withunknownsxandy.Thisequationplaysaveryimportantroleincontroltheory.THEOREM494.–(i)TheBézoutequation(13.10)admitsasolutionifandonlyifc∈(d)whered∈gcd(a,b).Suppose(x0,y0)isasolutionofthisequation.Alltheothersolutionsareoftheformx=x0+qbd,y=y0−qad,whereqspansR(parameterizationofthesolutionsbyq).(ii)IfRisastronglyEuclideandomain,thereexistsauniquesolution(x,y)suchthatd◦(y)<d◦(cid:15)ad(cid:16).PROOF.(i)ItisclearthattheBézoutequation(13.10)hasnosolutionifd(cid:4)c.Supposenowthatd|c;letα,βandγbesuchthata=αd(thatisα=ad),b=βdandc=γd.Then(13.10)isequivalenttoαx+βy=γ(13.11)whereαandβarecoprime.ThusthereexistelementszandwofRsuchthatαz+βw=1,andthereforeα(γz)+β(γw)=γ.TheBézoutequationthusadmitsasolution(γz,γw).Ifnow(x0,y0)isanysolutionof(13.10)or,inanequivalentmanner,of(13.11),everysolution(x,y)satisﬁesα(x−x0)+β(y−y0)=0.Takingintoaccountthecoprimenessofαandβ,α|(y−y0)andβ|(x−x0).ThusthereexistsanelementqofRsuchthatx−x0=qβandy−y0=−qα,whichinturnprovidestheparameterizationofthesolutions.(ii)Wehavefromtheabovey0=qα+y.IfthedomainRisstronglyEuclidean,weobtainthisexpressionbyperformingtheEuclideandivisionofy0byα,qdesignatingthequotientandytheremainder;thusthereexistsauniquesolution(x,y)suchthatd◦(y)<d◦(α).Appendix2:Algebra461BézoutequationoverK[s]SylvestertheoremLetbetwopolynomialsa(s)=a0sn+a1sn−1+...+anandb(s)=b0sm+b1sm−1+...+bm,wherea0(cid:5)=0andb0(cid:5)=0.TheSylvestermatrixΣ(a,b)ofthesetwopolynomialsisthesquarematrixofordern+mdeﬁnedbyΣ(a,b)=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣a00b00...a1...b1b00...a2...a0...b1...0......a1bm......b0an...a20bm...b10.........0......···0an0···0bm⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦orthetransposeofthismatrix.Therearemcolumnscomprisingcoefﬁcientsaiandncolumnscomprisingcoefﬁcientsbi.ThedeterminantofthismatrixiscalledtheSylvesterresultant.TheSylvestertheoremstatesthatitisnon-zero(inotherwords,theSylvestermatrixisinvertible)ifandonlyifthepolynomialsa(s)andb(s)arecoprime([10],n◦IV.6.6).SylvestersystemassociatedwithaBézoutequationConsidertheBézoutequation(13.10).AccordingtoTheorem494,eitherthisequationdoesnotadmitasolution,oritcomesdowntotheBézoutequation(13.11)wherethepolynomialsα(s)andβ(s)arecoprime.Inthesecondcase,whichwillhenceforthbetheonlyoneofinteresttous,wearethusledbacktoresolvinganequationoftheform(13.10)wherethepolynomialsa(s)andb(s)arecoprime.Write⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩a(s)=a0sα+a1sα−1+...+aαb(s)=b0sβ+b1sβ−1+...+bβc(s)=c0sγ+c1sγ−1+...+cγx(s)=x0sξ+x1sξ−1+...+xξy(s)=y0sυ+y1sυ−1+...+yυwherea0andc0arenon-zero.Theunknownsarex0,...,xξ,y0,...,yυandarethusofthenumberξ+υ+2.Suppose,withoutlossofgenerality,thatα+ξ≥β+υ.Theequationsareobtained462LinearSystemsbyequatingthecoefﬁcientsoftermsofthesamedegreein(13.10).Wenecessarilyhaveγ+1=α+ξ+1,andthusγ=α+ξ.Asaresult,thereareasmanyequationsasthereareunknownsifandonlyifξ+υ+2=α+ξ+1,thatisυ=α−1.(13.12)AccordingtoTheorem494,withd=1,weknowthereexistsauniquesolution(x(s),y(s))suchthatυ≥d◦(y)satisﬁescondition(13.12).Itisthissolutionthatwewilldeterminebelow.Byequatingthecoefﬁcientsofthesamedegreein(13.10),weobtainthelinearsystem(13.13)below,whichwewillcallthe“Sylvestersystem”associatedwiththeBézoutequationunderconsideration.⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣a00···············0a1a00b0......a1......b1...............a0......b00aα......a1bβ...b1b00aα......0......b1..................bβ...0···0aα0···0bβ⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣x0x1...xξy0y1...yυ⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣c0c1...cαcα+1......cα+ξ⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦(13.13)ThesquarematrixMofthissystemisoforderξ+2+υ.Thenumberofcolumnsthatcontainthecoefﬁcientsai(resp.,bi)isξ+1(resp.,υ+1).ThematrixMisoftheformM=(cid:27)A0(cid:27)Σ(a,b)(cid:28)whereAisasquarelowertriangularmatrix,oforder(α−β),andwhosealldiagonalentriesareequaltoa0.ThissubmatrixAisthusinvertibleorempty(α−βisthenumberofcoefﬁcientsabovetheﬁrstcoefﬁcientb0thatareequalto0whenonelooksatthematrixMfromlefttoright).Asaresult,theSylvestersystem(13.13)admitsauniquesolutionsinceΣ(a,b)isinvertible(accordingtotheSylvestertheorem),thepolynomialsa(s)andb(s)beingcoprimebyassumption.Thesystem(13.13)canbesimpliﬁedwhenthematrixAisnon-empty,thatiswhenα>β(whichisoftenthecase).Then,thepolynomialsa(s),c(s)andx(s)canbeassumedtobemonic;theﬁrstequationoftheSylvestersystembecomestrivialandAppendix2:Algebra463wecanremovethetermx0(equalto1)fromtheunknownsbysuppressingtheﬁrstrowandtheﬁrstcolumnofthematrixM,aswellastheﬁrstelementofthevectorofunknownsandofthevectorintheright-handmemberwheretheci’sarereplacedbyci−aifor1≤i≤α.Wethusobtaintheformasindicatedinsection6.4.5.13.2.MatricesoverprincipalidealdomainsInthissection,unlessotherwisestated,Risacommutativeprincipalidealdomain.However,wewilluseﬁnerhypothesesonacase-by-casebasis.13.2.1.InvertiblematricesoverprincipalidealdomainsOnecanshowthatanyleft-multiplicationbyaninvertiblematrixoverRisacompositionofaﬁnitenumberofelementaryandsecondaryoperationsontherows(eachoftheseoperationscanofcoursebeusedmorethanonce):see([91],sectionX.7,Prop.16).InthemoreparticularcasewhereRisanEuclideandomain,onecanshowthattheuseofsecondaryoperationsisnotnecessary([91],sectionX.7,Theorem17);itcanneverthelessprovidesimpliﬁcations.13.2.2.HermiteformColumnHermiteformTHEOREM495.–LetRbeacommutativeBézoutdomain.(i)AmatrixA∈Rp×misleft-equivalenttoanuppertriangularmatrix,calledacolumnHermiteformofA:(cid:27)T∗00(cid:28)(13.14)whereTisasquareuppertriangularmatrix.(ii)ThereexistsapermutationmatrixP∈GLm(R)suchthatthecolumnHermiteformofAPis(13.14)whereTisregularoforderequaltor=rkRA.PROOF.Thisproofisimportantbecauseitisconstructive,thatisinconcretecases,wedeterminethecolumnHermiteformofamatrixbyrepeatingtherationalebelow.WewilllimitourselvestothecasewhereR=K[s](forthecasewhereRisacommutativeBézoutdomain,see[67]or[22]).1)Supposetheﬁrstcolumnisnon-zero.Bypermutingrows,weareledtothecasewherethecoefﬁcienta11issuchthat−∞<d◦(a11)≤d◦(aj1),foranyindexj∈{1,...,p}.Multiplytheﬁrstrowbytheinverseoftheleadingcoefﬁcientofa11,464LinearSystemsandthenperformtheEuclideandivisionoftheaj1’s(j(cid:5)=1)bya11,i.e.writeaj1=a11qj1+¯aj1,whered◦(¯aj1)<d◦(a11).Fromthejthrow(j(cid:5)=1),subtracttheﬁrstonemultipliedbyqj1,thenwrite¯a11=a11.Theﬁrstcolumnofthematrixthenobtainediscomposedofthe¯aj1andd◦(¯aj1)<d◦(¯a11)ifj(cid:5)=1.Wecancontinuetheprocessuntiltheonlynon-zerotermoftheﬁrstcolumnistheﬁrstone(whichiswithindex(1,1)inthematrix).2)Havingdonethat,ifthesecondcolumnisnon-zero,proceedinthesamemannerforthesubmatrixobtainedbysuppressingtheﬁrstrowandtheﬁrstcolumn.Theﬁrstcolumnobtainedforthissubmatrixeventuallyhasthesamepropertyastheﬁrstcolumnofthewholematrix.Itsﬁrstcoefﬁcientiswithindex(2,2)inthelatter.3)WenowperformtheEuclideandivisionofthecoefﬁcientwithindex(1,2)(inthewholematrix)bythatwithindex(2,2),thenwesubtractfromtheﬁrstrowthesecondrowmultipliedbythequotientofthisdivision,andweobtaind◦(¯a12)<d◦(¯a22).4)Continuingthisway,weobtaintheformdesiredforpart(i).5)(ii)isnowobvious.RowHermiteformByexchangingtherolesoftherowsandthecolumns,weobtainthefollowing:THEOREM496.–LetRbeacommutativeBézoutdomain.(i)AmatrixA∈Rp×misright-equivalenttoalowertriangularmatrix,calledarowHermiteformofA:(cid:27)T0∗0(cid:28)(13.15)whereTisasquarelowertriangularmatrix.(ii)ThereexistsapermutationmatrixP∈GLp(R)suchthattherowHermiteformofPAis(13.15)whereTisregularoforderequaltor=rkRA.13.2.3.SmithformTHEOREM497.–AmatrixA∈Rp×m,ofrankr,isequivalenttoamatrixoftheformΣ=diag(α1,...,αr,0,...,0)Appendix2:Algebra465wheretheαi,1≤i≤r,areallnon-zeroandaresuchthatαi|αi+1,1≤i≤r−1.3Thesediagonalelementsαiareuniquelydetermineduptoassociates.DEFINITION498.–ThematrixΣistheSmithformofAandtheelementsαi,1≤i≤r,areitsinvariantfactors.TwomatricesA∈Rp×mandB∈Rp×mareequivalentifandonlyiftheyhavethesameSmithform(theSmithformofamatrixisthusalsocalleditsSmithnormalform,or,forshort,itsnormalform).Letusdeﬁneanelementarydivisorring(inthecasewheresucharingisacommutativedomain).DEFINITION499.–AnelementarydivisorringisaBézoutdomainRinwhichwhenever(a)+(b)+(c)=R,thereexistpandqsuchthat(pa)+(pb+qc)=R.REMARK500.–ThestatementofTheorem497remainsvalidwhenRisanelementarydivisorring.Allprincipalidealdomainsdomainsareelementarydivisorringsbutherearetwoexampleselementarydivisorringswhicharenotprincipalidealdomains:(i)theringO(C)ofentirefunctions([67],section5);(ii)theringE=R(s)[e−s]∩O(C)(theelementsofEarecalledpseudo-polynomials;Ewasintroducedin[54]andusedin[86],[55]forthestudyofsystemswithcommensuratedelays).ProofofthetheoremWewillonlygiveheretheconstructivepartoftheproof.ForaproofofuniquenessoftheSmithform(guaranteedundertheconditionthateachinvariantfactorcanbereplacedbyanassociate),seeforexample([10],ChapterVII).WethuswillshowhowonecanconstructtheSmithformofamatrixA.WelimitourselvestothecasewhereRisanEuclideandomain.IfA=0,thereisnothingtoprove.ObtainingadiagonalformIfA(cid:5)=0,byapermutationofcolumnsweareledtothecasewheretheﬁrstcolumnofAisnon-zero.ProceedingasinTheorem495,wearrive,usingelementaryorsecondaryoperationsonrows,tothecasewherethisﬁrstcolumnhasauniquenon-zeroelementa11.Nowdothesamefortheﬁrstrow:theEuclideandivisionofa1j(j>1)bya11iswrittenasa1j=a11q1j+¯a1j,whered◦(¯a1j)<d◦(a11).Usingelementaryorsecondaryoperationsoncolumns,wethusobtain(a11,¯a12,...,¯a1m)astheﬁrstrow.3.Abusingthelanguage,diag(α1,...,αr,0,...,0)representsamatrix(squareornot,dependingonthecontext),theelementsoftheprincipaldiagonalofwhichareα1,...,αr,0,...,0andalltheotherentriesarezero.466LinearSystemsByapermutationofcolumns,webringto(1,1)position,amongtheseelements,oneofthosethatarenon-zeroandofminimumdegree.Wecannowre-iteratetheabovewholeprocess(byﬁrstoperatingontherows,andthenonthecolumns);theseiterationswillnecessarilystopbecauseeachtimethedegreeofthetermwithindex(1,1)decreases.Wethusﬁnishbyobtainingamatrix¯A,equivalenttoA,andoftheform¯A=β1⊕¯A1.Dothesamewiththesubmatrix¯A1,andsoon.Weﬁnallyobtaintheformdiag(β1,...,βr,0,...,0)wheretheβi’s,1≤i≤r,areallnon-zero.Nonetheless,theyingeneraldonotsatisfytherequireddivisibilityproperty.ObtainingthedivisibilitypropertyConsiderthesubmatrixB=diag(β1,β2).Letγ1∈gcd(β1,β2),insuchawaythat(accordingtotheBézouttheorem)thereexistxandyinRsuchthatxβ1+yβ2=γ1.Thereexists¯β1inRsuchthatβ1=γ1¯β1.Weobtain(cid:27)1y01(cid:28)(cid:27)β100β2(cid:28)(cid:27)x110(cid:28)=(cid:27)γ1β1β20(cid:28)∼(cid:27)γ100¯β1β2(cid:28)thuswecanlowerthedegreeofβ1exceptifβ1|β2forinthiscaseγ1=β1.Bycontinuingthisprocedure,weﬁnallyobtaindiag(β1,...,βr,0,...,0)∼diag(α1,...,αr,0,...,0)whereαi|αi+1,1≤i≤r−1.Theconstructivepartofthetheoremisthusproven.EquivalenceoveraﬁeldCOROLLARY501.–AmatrixA∈Fp×m(whereFisaﬁeld),ofrankr,isequivalenttothematrixΣ=(cid:27)Ir000(cid:28).Indeed,wecanapplythepreviousresult,butasdivisibilityistrivialinaﬁeld,theinvariantfactorscanbetakenas1.Weobtainthisformbyusingonlytheﬁrstpartoftheaboveprocedure,whichitselfalsobecomesconsiderablysimpler.Thismethodisanefﬁcientwayofcalculatingtherankofamatrixoveraﬁeld.Wewillseeanevenmoreefﬁcientmethod–fromanumericalpointofview–later(section13.5.7)whenF=CorR.Appendix2:Algebra467DirectcalculationofinvariantfactorsTheinvariantfactorsofamatrixA∈Rp×m,ofrankr,satisfythefollowingproperty,whichcanbeemployedfortheirdirectcalculation(whichincertaincasescanbeadvantageous,especiallywhenAistriangular):PROPOSITION502.–Letα1,...,αrbetheinvariantfactorsofA.Thenα1isagcdoftheelementsofAandforanyintegerq∈{1,...,r},(qi=1αiisagcdofthenon-zerominorsoforderqofA.(Inparticular,ifA∈Rn×nisnon-singular,(ni=1αi=detA.)ExampleLetR=K[s]andA=diag(β1,β2,β3)whereβ1=s+2,β2=(s+1)(s+2),β3=(s+1)(s+3).WegetfromProposition502α1=gcd(β1,β2,β3)=1,α2=(s+1)(s+2),α3=(s+1)(s+2)(s+3).MarkingoutelementaryoperationsTheadvantageofusingrowandcolumnelementaryandsecondaryoperationsisthatitallowsonetoeasilydeterminetheinvertiblematricesUandVsuchthatU−1AV=Σ,whereΣistheSmithformofA.Indeed,letM=(cid:27)AIpIm0(cid:28).ByoperatingontheﬁrstprowsandtheﬁrstmcolumnsofM,weobtain(cid:27)U−100Im(cid:28)M(cid:27)V00Ip(cid:28)=(cid:27)ΣU−1V0(cid:28).Thismethodcanalsobeapplied,ofcourse,todetermineaninvertiblematrixthatwillallowonetotransform(byleft-orright-equivalence)amatrixAintooneofitsHermiteforms.468LinearSystemsExampleOverR=K[s],letA=(cid:27)sss2ss2s4(cid:28);thenM=⎡⎢⎢⎢⎢⎣sss210ss2s401100000100000100⎤⎥⎥⎥⎥⎦∼⎡⎢⎢⎢⎢⎣s00100s(s−1)0−111−1s20001−s(s+1)0000100⎤⎥⎥⎥⎥⎦;fromwhichΣ=(cid:27)s000s(s−1)0(cid:28),U−1=(cid:27)10−11(cid:28),V=⎡⎣1−1s201−s(s+1)001⎤⎦.13.2.4.ElementarydivisorsLetαj+1,...,αrbethenon-invertibleinvariantfactorsofamatrixAdeﬁnedoveraprincipalidealdomainR.Ifwefactorizeeachoftheseinvariantfactorsintoprimes,theytaketheformofproductsofpairwisecoprimetermsoftheformpnk,wherethepk’sareprimesinR.DEFINITION503.–Thesepnk’saretheelementarydivisorsofA.Thenumberoftimesweencounteroneoftheseelementarydivisorsinalltheabovedecompositionsintoprimesisitsmultiplicity(oritsorderofmultiplicity).ExampleOverR=K[s],letA∼diag(α1,α2,α3,0,...,0),withα1(s)=(s−1)2(s−2),α2(s)=(s−1)2(s−2)2,α3(s)=(s−1)2(s−2)2(s−3)Theelementarydivisorsare:δ1(s)=(s−1)2(oforder3)δ2(s)=s−2(oforder1)Appendix2:Algebra469δ3(s)=(s−2)2(oforder2)δ4(s)=s−3(oforder1).CalculationofinvariantfactorsfromelementarydivisorsAsseenintheaboveexample(andasaresultofthedeﬁnition),thecalculationoftheelementarydivisorsfromtheinvariantfactorsisimmediate.Conversely,knowingtheelementarydivisorsofamatrix,wecancalculateitsinvariantfactors.Itsufﬁcestoconstructatableinwhicheachrowiscomposedofthepowersofthesameprime,repeatedanumberoftimesequalitsorderofmultiplicity,thesepowersbeingindecreasingorder.Theproductofthecolumnsthusprovides,inreverseorder,theinvariantfactors.Usingthepreviousexample:(s−1)2(s−1)2(s−1)2(s−2)2(s−2)2s−2s−311α3(s)α2(s)α1(s)13.2.5.SmithzerosConsiderthecasewhereR=C[s].LetA∈C[s]n×m,andletα1(s),...,αr(s)beitsinvariantfactors.Letα(s)=(ri=1αi(s).Therootsofα(s)arecalledtheSmithzerosofA.Intheaboveexample,theSmithzerosofAformtheset{1,1,1,1,1,1,2,2,2,2,2,3}.Indeed,thenumberoftimesaSmithzerozisrepeatedinthissetisequaltoitsorderofmultiplicitywhenzisconsideredasarootofthepolynomialα(s).LetzbeaSmithzeroofAandlet(s−z)ν1,...,(s−z)νk(1≤ν1≤...≤νk)betheelementarydivisorsofAthataremultiplesofs−z,eachoftheseelementarydivisorsrepeatedanumberoftimesequaltoitsorderofmultiplicity.Weadoptthefollowingdeﬁnition[19]:DEFINITION504.–Theintegersν1,...,νkarethestructuralindicesoftheSmithzeroz(orofthematrixAatz),ρ=νkistheorderofthiszeroand(cid:11)ki=1νiisitsdegree.470LinearSystemsNoticethatifA∈C[s](thatisifthispolynomialmatrixisonlyapolynomial),theSmithzerosofthismatrixaretherootsofthispolynomial.LetzbeoneoftheseSmithzeros;ithasonlyonestructuralindex,equaltoitsorder,toitsdegree,andtotheorderofmultiplicityoftherootz.Letuscontinuewiththeexampleofsection13.2.4:theSmithzero1hasstructuralindices{2,2,2},itsorderis2,itsdegreeis6.TheSmithzero2hasstructuralindices{1,2,2},itsorderis2,itsdegreeis5.TheSmithzero3hasauniquestructuralindex1;itsorderanditsdegreearebothequalto1.13.2.6.DivisibilityofmatricesLeft-divisorLetRbearing,letE∈Rn×k,E(cid:5)=0,andletL∈Rn×n.WesaythatLisaleft-divisorofEifthereexistsamatrixX∈Rn×msuchthatE=LX(whichimpliesrkL≥rkEaccordingtotheSylvesterinequality:seeTheorem492,section13.1.4).NowletA∈Rn×n(cid:1)andB∈Rn×m.WesaythatL∈Rn×nisacommonleft-divisorofAandBifLisaleft-divisorofthematrixE(cid:1)(cid:25)AB(cid:26).Greatestcommonleft-divisorLetA,BandEbeasabove;L∈Rn×nisagreatestcommonleft-divisor(gcld)ofAandBifLisaleft-divisorofEandifanyleft-divisorofEisaleft-divisorofL.THEOREM505.–SupposethatRisaBézoutdomainandletr(cid:1)rk(cid:25)AB(cid:26).(i)ThereexistsamatrixL∈Rn×n,ofrankr,suchthat(cid:25)AB(cid:26)r∼(cid:25)L0(cid:26),andLisagcldofAandB.(ii)Thesetofallgcld’sofAandBisthesetofallmatriceswhichareright-equivalenttoL.PROOF.AccordingtoTheorem495(section13.2.2),weknowthat(cid:25)AB(cid:26)r∼(cid:25)L0(cid:26),whereL∈Rn×nisobviouslyofrankr.WeeasilydeducethatLisagcldofAandB.Foradetailedproofof(ii),see([114],section4.1,Lemma2).Left-primenessandcoprimenessDEFINITION506.–(i)LetE∈Rn×kbeamatrixofrankn;Eissaidtobeleft-primeifEisright-invertibleoverR.(ii)LetA∈Rn×n(cid:1)andB∈Rn×mbesuchthatE(cid:1)(cid:25)AB(cid:26)isofrankn;thematricesAandBaresaidtobeleft-coprimeifEisleft-prime.REMARK507.–IfRisnotaBézoutdomain,thereexistotherweakerformsofleft-primenessofamatrix(seeforexample[121]).Appendix2:Algebra471Right-divisibilityWhathasjustbeensaidaboutleft-divisibilitytransposesinanobviouswaytoright-divisibility.Inparticular,Eisright-primeifandonlyifETisleft-prime;thematricesAandCareright-coprimeifandonlyifATandCTareleft-coprime.Likewise,Theorem505transposesinanobviouswaytothecaseofright-coprimeness(thedetailsarelefttothereader).13.2.7.CoprimefactorizationsLetRbeacommutativedomain,letF=Q(R)beitsﬁeldoffractions(seesection13.1.1)andletG∈Fp×m.DEFINITION508.–Apairofmatrices(Dl,Nl)∈Rp×p×Rp×misaleft-coprimefactorizationofGoverRif:DlisinvertibleoverF,G=D−1lNl,andthematrices{Dl,Nl}areleft-coprime.Inthesamemanner,wedeﬁnearight-coprimefactorization(Nr,Dr)ofG=NrD−1r.Left-coprimefactorizationshavethepropertybelow(thecorrespondingstatementforright-coprimefactorizationsislefttothereader).LEMMA509.–Supposethataleft-coprimefactorization(Dl,Nl)ofGoverRexists;then(D(cid:2)l,N(cid:2)l)isaleft-coprimefactorizationofGoverRifandonlyifthereexistsaninvertiblematrixU∈Rp×psuchthat(cid:25)DlNl(cid:26)=U(cid:25)D(cid:2)lN(cid:2)l(cid:26).PROOF.If(D(cid:2)l,N(cid:2)l)isaleft-coprimefactorizationofGoverR,(cid:25)D(cid:2)lN(cid:2)l(cid:26)isright-invertibleandG=D(cid:2)−1lN(cid:2)l.ThusthereexistmatricesX(cid:2)andY(cid:2)overRsuchthatD(cid:2)lX(cid:2)+N(cid:2)lY(cid:2)=I,andso,left-multiplyingthisrelationbyDlD(cid:2)−1l,DlX(cid:2)+Y(cid:2)=DlD(cid:2)−1l,thereforeDlD(cid:2)−1l∈Rp×p.Bysymmetry,D(cid:2)lD−1l∈Rp×p.Asaresult,DlD(cid:2)−1l=Uisinvertibleand(cid:25)DlNl(cid:26)=U(cid:25)D(cid:2)lN(cid:2)l(cid:26).Theconverseisobvious.DEFINITION510.–AmatrixG∈Fp×madmitsadoubly-coprimefactorizationoverRif,withtheabovenotation,(cid:27)∗∗DlNl(cid:28)(cid:27)−Nr∗Dr∗(cid:28)=IwheretheasterisksdenotesubmatriceswithentriesinR.472LinearSystemsThefollowingisrelatedtothedoubly-coprimefactorization:DEFINITION511.–LetE∈Rn×kbeamatrixofrankn;Eissaidtobecompletableifthereexistsamatrix∗suchthat(cid:27)E∗(cid:28)isinvertibleoverR.LetRbeacommutativedomain,letF=Q(R)beitsﬁeldoffractions,andletM(F)bethesetofallmatricesofﬁnitesizewithentriesinF.Theresultbelowcanbeeasilyproven([114],section8.1)andjustiﬁesDeﬁnition510(ii):LEMMA512.–SupposethatG∈M(F)admitsaleft-coprimefactorization(Dl,Nl)overR;thenGadmitsaright-coprimefactorizationoverRifandonlyifE(cid:1)(cid:25)DlNl(cid:26)iscompletable(inotherwordsifGadmitsadoubly-coprimefactorizationoverR).DEFINITION513.–AcommutativedomainRhavingthefollowingpropertyiscalledanHermitering:anyrowA=(cid:25)a1···an(cid:26)suchthat(cid:12)1≤i≤n(ai)=Riscompletable.AllSylvesterdomains(Deﬁnition491,section13.1.4)areHermiteringsbuttheconversedoesnothold([31],section5.5).Onecanprovethefollowing([114],section8.1):THEOREM514.–(A)Thefollowingconditionsareequivalent:(i)RisaBézoutdomain;(ii)everymatrixG∈M(F)admitsbothaleft-coprimefactorizationandaright-coprimefactorizationoverR;(iii)everymatrixG∈M(F)admitsadoublycoprimefactorizationoverR.(B)Thefollowingconditionsareequivalent:(i)RisaHermitering;(ii)ifG∈M(F)admitseitheraleft-oraright-coprimefactorizationoverR,thenitadmitsadoubly-coprimefactorizationoverR.13.2.8.BézoutmatrixequationsLeftBézoutequationLetRbearing,letA∈Rn×n(cid:1)andB∈Rn×mbetwomatricessuchthatrk(cid:25)AB(cid:26)=n,andletC∈Rn×n.ThefollowingequationiscalledaleftBézoutmatrixequation:AX+BY=C(13.16)wherethematricesX∈Rn(cid:1)×nandY∈Rm×naretheunknowns.Appendix2:Algebra473THEOREM515.–SupposeRisaBézoutdomain,andletLbeagcldofAandB.Thenequation(13.16)admitsasolutionifandonlyifCisaright-multipleofL.PROOF.ThereexistmatricesA(cid:2)∈Rn×n(cid:1)andB(cid:2)∈Rn×msuchthatA=LA(cid:2)andB=LB(cid:2),thusforanymatricesX∈Rn(cid:1)×nandY∈Rm×n,AX+BY=L(A(cid:2)X+B(cid:2)Y);theconditionisthereforenecessary.Conversely,supposethatC∈Rn×nisaright-multipleofL,andthusoftheformC=LM.WeknowthatthereexistsaninvertiblematrixVsuchthat(cid:25)AB(cid:26)V=(cid:25)L0(cid:26).BydecomposingVasV=(cid:27)V11V12V21V22(cid:28)withthepropersizes,weobtain(cid:20)AV11+BV21=L,AV12+BV22=0.Asaresult,AV11M+BV21M=LM=C,and(V11M,V21M)isasolutionof(13.16),whichcompletestheproof.RightBézoutequationWeleaveittothereadertotransposeTheorem515tothecaseofa“rightBézoutmatrixequation”XA+YB=C.13.3.Homomorphismsofvectorspaces13.3.1.VectorspacesThenotionofK-vectorspaceisclassicwhenKisaﬁeld4,whichthereadercanassumetobeRorC(forfurtherdetails,seesection13.4.1).BasisHere,weareonlyconcernedwithﬁnite-dimensionalK-vectorspaces.AK-vectorspaceEissaidtobeofdimensionnwhenanybasisofEhasnelements.Tomakethisnotionclear:aﬁnitesequence(ei)1≤i≤nofelementsofEisabasisofEifanyvectorxofEcanbeexpressedinauniquemannerasaK-linearcombinationofvectorsofthisbasis,thatisx=n(cid:12)i=1xiei.(13.17)4.Avectorspacecanbedeﬁnedoveradivisionring.474LinearSystemsThexi∈Kin(13.17)arethecomponentsofxinthebasisunderconsideration.Thecolumn-matrixX=[x1,...,xn]Tistherepresentativematrix(ortherepresentative,forshort)ofxinthisbasis.WhatwehaveseensofarshowsthatthechoiceofabasismakesitpossibletorepresentanyvectorofEbyanelementofKn.Usingatermspeciﬁedlater,Eis“isomorphic”toKn.Therefore,Knisthe“model”ofallK-vectorspacesofdimensionn.The“canonicalbasis”(γi)1≤i≤nofKnisdeﬁnedinthefollowingmanner:γi=(0,...,0,1,0,...,0),i∈{1,...,n}wherethe1islocatedattheithposition.Inthisbasis,therepresentativeof(x1,...,xn)isthecolumnmatrix[x1,...,xn]T,whichwewillalsocalla“columnvector”.QuotientspaceLetE1beasubspaceofE.WecanconsiderthefollowingequivalencerelationR:xRy⇔x−y∈E1.ThesetconsistingoftheequivalenceclassesisagainaK-vectorspace,calledthequotientspaceE/E1.DirectsumLetE1,E2betwosubspacesofthesamevectorspaceE.WedenoteasE1+E2thesubspaceofEconsistingofallelementsx=x1+x2(x1∈E1,x2∈E2);E1+E2iscalledthesumofE1andE2.IfE1∩E2=0(where0denotesthesubspaceofEconsistingofzeroalone),theaboveexpressionofxisuniqueandthesumofE1andE2issaidtobe“direct”;itisthendenotedasE1⊕E2.LetE1,E2betwovectorspaces.TheproductE1×E2isthesetofallpairs(x1,x2)wherex1∈E1andx2∈E2;obviously,E1×E2hasastructureofvectorspace.Byidentifyingx1andx2with(x1,0)and(0,x2)respectively,theproductE=E1×E2(sometimescalledtheexternaldirectsumofE1andE2)canbeidentiﬁedwithE1⊕E2whereE1andE2areconsideredassubspacesofE.LetbethedirectsumE=E1⊕E2;(13.18)E2iscalledasupplementofE1.(Suchasupplementisnotunique.)Thenletx=x1+x2,wherex1∈E1andx2∈E2;x1andx2areuniquelydeterminedinfunctionAppendix2:Algebra475ofx.Thevectorx1iscalledthecomponentofxinE1andthemapp1:x(cid:3)→x1iscalledtheprojectionofEontoE1paralleltoE2.LetB1=(εi)1≤i≤n1beabasisofE1andB2=(ηi)1≤i≤n2abasisofE2;then(cid:15)ε1,...,εn1,η1,...,ηn2(cid:16)isabasisBofE=E1⊕E2;wedenotethisbasisbyB18B2andwecallittheconcatenationofbasesB1andB2(thisisnotasimpleunionsincetheorderofthebasisvectorsisimportant,asspeciﬁedabove).Asaresult:dim(E1⊕E2)=dimE1+dimE2.(13.19)Thefollowingisclassicandimportant:THEOREM516.–LetEbeaK-vectorspace;everysubspaceofEadmitsasupplement.COROLLARY517.–(Theoremoftheincompletebasis).LetEbeaK-vectorspaceofdimensionnandlet(xi)1≤i≤ρbeasequenceofρlinearlyindependentvectors(ρ<n).Thereexistsasequence(xi)ρ+1≤i≤nofvectorsofEsuchthat(xi)1≤i≤nisabasisofE.PROOF.LetE0bethesubspaceofEgeneratedbythevectorsxi(1≤i≤ρ)andlet˜E0beasupplementofE0.Letxρ+1beanon-zerovectorbelongingto˜E0.Thevectorsxi(1≤i≤ρ+1)areK-linearlyindependent.ContinuethisconstructionandsupposewehavedeterminedkK-linearlyindependentvectorsxρ+1,...,xρ+k(withρ+k<n).LetEkbethesubspaceofEgeneratedbythevectorsxi(1≤i≤ρ+k)andlet˜EkbeasupplementofEk.Letxρ+k+1beanon-zerovectorbelongingto˜Ek.Thevectorsxi(1≤i≤ρ+k+1)areK-linearlyindependent.Thisconstructioniscompletewhenρ+k+1=n.13.3.2.HomomorphismsandmatricesHomomorphismsLetEandFbetwoK-vectorspaces,suchthatdimE=nanddimF=m.AK-linearmappingufromEintoFisalsocalledahomomorphism(ofvectorspaces)fromEintoF.Foranyx∈E,thevectoru(x)∈Fisoftendenotedasu.xorux.Thekernelofu,denotedaskeru,isthesubspaceofEdeﬁnedbykeru={x∈E:u.x=0}.476LinearSystemsTheimageofu,denotedbyimu,isthevectorsubspaceofFdeﬁnedbyimu={u.x;x∈E}.Thehomomorphismu,ifitisinjective(thatisifkeru=0),iscalledamonomorphism.Ifitissurjective(i.e.ifimu=F),itiscalledanepimorphism(fromEontoF).Ifitisbothinjectiveandsurjective,i.e.bijective,itiscalledanisomorphism(fromEontoF).Inthiscase,thevectorspacesEandFaresaidtobeisomorphic(whichwedenoteasE∼=F).Twosuchvectorspaceshaveexactlythesameproperties:makingcalculationsineitheroneamountstodoingintheotheroneby“transporting”thecalculationswiththeisomorphismu(ortheinverseisomorphismu−1);thisiswhythesespacesareoftenidentiﬁed.CanonicalepimorphismLetE1beasubspaceofE.ThemappingφthatmapsavectorxofEtoitsclassinE/E1isanepimorphism:itiscalledthecanonicalepimorphismfromEontoE/E1.Obviously,φ.x=0ifandonlyifx∈E1;inotherwords,kerφ=E1.InclusionConsiderthemappingifromE1intoEwhich,toavectorxinE1,associatesthissameelementx,nowconsideredtobeinE;iisamonomorphismandiscalledtheinclusion(orthecanonicalinjection)fromE1intoE.CanonicaldecompositionofahomomorphismThediagraminFigure13.1belowiscommutative;itrepresentsthecanonicaldecompositionofahomomorphismufromEintoF.Inthisdiagram,˜uistheepimorphismfromEontoimu,suchthat˜u.x=u.x,∀x∈E;φisthecanonicalepimorphismfromEontoE/keru;iistheinclusionfromimuintoF;∼=designatesanisomorphism.ApplicationtoadirectsumConsiderthedirectsum(13.18)andtheprojectionp1fromEintoE1paralleltoE2.ThecanonicaldecompositionofthisepimorphismisrepresentedbythediagraminFigure13.2below.WehaveE/E2∼=E1andthus,accordingto(13.19)(seesection13.3.1):dim(E/E2)+dimE2=dimE.Appendix2:Algebra477uiu~EIm uFE/(Keru)Figure13.1.CanonicaldecompositionofahomomorphismREMARK518.–LetubeahomomorphismfromEintoF,andletE1andF1besubspacesofEandFrespectively,suchthatu(E1)⊂F1.Ifx1andx2havethesamecanonicalimageinE/E1,thenux1andux2havethesamecanonicalimageinF/F1.Therefore,thereexistsahomomorphism¯u:E/E1→F/F1calledthehomomorphisminducedbyu,makingthediagrambelowcommutative,whereφandψdenotethecanonicalepimorphismfromEontoE/E1andfromFontoF/F1,respectively:Eu−→F↓φ↓ψE/E1¯u−→F/F1NotethatifF1={0},thenF/F1=F,andtheconditionu(E1)⊂F1(whichisnecessaryandsufﬁcientfor¯utoexist)isequivalenttoE1⊂keru.RankofahomomorphismTherankofahomomorphismu:E→Fisdeﬁnedby:rku=dim(imu).21EEE p1E1E/E2Figure13.2.Decompositionofaprojection478LinearSystemsSinceimu∼=E/keru,wehaverku+dim(keru)=dimE.(13.20)MatrixrepresentationMatrixofahomomorphismLetu:E→Fbeahomomorphism,(ei)1≤i≤nbeabasisofEand(εi)1≤i≤mbeabasisofF.Inthesebases,weassociateamatrixA∈Km×nwithuinthefollowingmanner:theelementaijoftheithrowandjthcolumnofAistheithcomponentofu.ejinthebasis(εi)1≤i≤m.5Letx∈Eandy=u.x∈F;letX=[x1,...,xn]Tbetherepresentativeofxinthebasis(ei)1≤i≤n,andletY=[y1,...,ym]Tbetherepresentativeofyinthebasis(εi)1≤i≤m.Wehave:y=u.x=u.m(cid:12)j=1xjej=m(cid:12)j=1xju.ej;asaresult,yi=m(cid:12)j=1aijxj,sothatY=AX.(13.21)ChangeofbasisConsideranewbasis(e(cid:2)i)1≤i≤nofE.ThechangeofbasismatrixPfrom(ei)1≤i≤nto(e(cid:2)i)1≤i≤nisthematrixoftheidentityofE(denotedbyIE),fromEequippedwiththebasis(e(cid:2)i)1≤i≤nontoEequippedwiththebasis(ei)1≤i≤n.TheentrypijofthismatrixP∈Kn×nisthustheithcomponent,inthebasis(ei)1≤i≤n,ofe(cid:2)j(inotherwords,thejthcolumnofPconsistsofthecomponentsofe(cid:2)jinthebasis(ei)1≤i≤n).IfXandX(cid:2)aretherepresentativesofasamevectorx∈Einthebases(ei)1≤i≤nand(e(cid:2)i)1≤i≤nrespectively,wehaveaccordingto(13.21)X=PX(cid:2).(13.22)Everychangeofbasismatrixisinvertibleand,conversely,everyinvertiblematrixcanbeconsideredasachangeofbasismatrix.5.Adifferentconventionisusedinsection13.4.Appendix2:Algebra479ChangeofbasisandequivalenceLetusdothesameinF:let(ε(cid:2)i)1≤i≤mbeanewbasisofFandletQ∈Km×mbethechangeofbasismatrix.Last,letA(cid:2)bethematrixrepresentingthehomomorphismuinthenewbasesandletY(cid:2)betherepresentativeofy=u.xinthebasis(ε(cid:2)i)1≤i≤m.WehaveY(cid:2)=A(cid:2)X(cid:2),andtherefore,accordingto(13.21)and(13.22)A(cid:2)=Q−1AP.(13.23)Thus,twomatricesrepresentthesamehomomorphismifandonlyiftheyareequivalent(section13.1.4).Inparticular,thesimplestpossibleformofamatrixrepresentingahomomorphism(ofvectorspaces)isfurnishedbyCorollary501(section13.2.3).Thereadercanverifythatthenotionofrank,asdeﬁnedinthepresentparagraph,isidenticaltothatdeﬁnedinsection13.1.4(inthecasewheretheringconsideredisaﬁeld).TranspositionLetu:E→F(wheretheK-vectorspacesEandFareﬁnite-dimensional),andletE∗andF∗bethedualspacesofEandF,respectively(section12.1.2).Thereexistsauniquehomomorphismtu:F∗→E∗suchthatforanyx∈Eandanyy∗∈F∗, tuy∗,x!= y∗,ux!,andtuiscalledthetransposeofu.Let(ei)1≤i≤nbeabasisofE.Thelinearformse∗ideﬁnedby e∗i,ej!=δij(1≤i≤n,1≤j≤n)whereδijistheKroneckerindex(deﬁnedbyδij=0ifi(cid:5)=j,δii=1),formabasisofE∗,and(e∗i)1≤i≤niscalledthedualbasisof(ei)1≤i≤n.Let(ei)1≤i≤nand(εi)1≤i≤mbebasesofEandF,respectively.Inthesebases,uisrepresentedbyamatrixA.Wecaneasilyverifythatinthedualbases(ε∗i)1≤i≤mand(e∗i)1≤i≤n,tuisrepresentedbythematrixAT,i.e.thetransposeofmatrixA(section13.1.4).13.3.3.EndomorphismsofvectorspacesEndomorphismsandautomorphismsLetEbeaK-vectorspaceofdimensionn.AnendomorphismuofEisahomomorphismfromEintoitself.Thisendomorphismisinjectiveifandonlyifdim(keru)=0,which,accordingto(13.20),isthesameassayingthatrku=n,orthatuissurjective.OnesuchendomorphismiscalledanautomorphismofE.480LinearSystemsMatrixrepresentationOnceabasisofEischosen,anendomorphismuisrepresentedbyamatrixA∈Kn×n.ThismatrixAisinvertibleif,andonlyifuisanautomorphism.LetE1beasubspaceofE,ofdimensionn1.WesaythatE1isinvariantunderuifu.E1⊂E1(whereu.E1={u.x1:x1∈E1}).ThenletE2beasupplementofE1andletbeabasisofEthatistheconcatenationofabasisofE1andabasisofE2.Inthisnewbasis,thematrixArepresentingutakestheformA=(cid:27)A1∗0∗(cid:28)(13.24)whereA1∈Kn1×n1.ThismatrixA1represents,inthebasisofE1considered,therestrictionu1ofutoE1(thinkingofthisrestrictionasanendomorphismofE1).DiagonalsumofendomorphismsLetE1,...,EqbesubspacesofaK-vectorspaceE,suchthatE=E1⊕...⊕Eq.Inaddition,foranyi∈{1,...,q},letuibeanendomorphismofEi.Ontheotherhand,letxbeavectorofEandletxibeitscomponentinEi(i∈{1,...,q}).WecandeﬁnetheendomorphismuofEwhichassociatesui.xiwitheachxiforanyi∈{1,...,q}.Thisendomorphismiscalledthediagonalsumoftheendomorphismsuiandisdenotedasu1⊕...⊕uq(byanalogywithadiagonalsumofmatrices).Conversely,letubeanendomorphismofE=E1⊕...⊕Eqsuchthatforeveryi∈{1,...,q},Eiisinvariantunderu.Then,denotingtherestrictionofutoEiasui(thinkingofthisrestrictionasanendomorphismofEi),wehaveu=u1⊕...⊕uq.ConsiderabasisBofE,oftheform81≤i≤qBi,whereforeachi∈{1,...,q},BiisabasisofEi.Eachendomorphismuiisrepresented,inthebasisBi,byasquarematrixAi;andaccordingto(13.24),theendomorphismu=u1⊕...⊕uqisrepresented,inthebasisB,bythematrixA1⊕...⊕Aq.ChangeofbasisandsimilarityLetubeanendomorphismofaK-vectorspaceEofdimensionn,BbeabasisofEandA∈Kn×nbethematrixrepresentinguinthisbasis.LetB(cid:2)beanotherbasisofE,PbethechangeofbasismatrixfromBtoB(cid:2),andA(cid:2)∈Kn×nbethematrixrepresentinguinthebasisB(cid:2).Accordingto(13.23),wehaveA(cid:2)=P−1AP.(13.25)Appendix2:Algebra481TwomatricesAandA(cid:2)ofKn×nsatisfyingsucharelationaresaidtobesimilar[10]orconjugate[31](whichwedenoteasA≈A(cid:2)).Accordingto(13.25),detA(cid:2)=detP−1detAdetP=detA,(13.26)andthusthedeterminantofasquarematrixdependsonlyontheendomorphismuthatthismatrixrepresents.Wecancallitthedeterminantofthisendomorphismanddenoteitasdetu.EigenvaluesandeigenvectorsAnelementλ∈Kiscalledaneigenvalueoftheendomorphismuifthereexistsanon-zerovectorx∈Esuchthatu.x=λx,inotherwords(λIE−u).x=0.(13.27)Inthiscase,xiscalledaneigenvectorassociatedwiththeeigenvalueλ.Itisclearthatthereexistvectorsx(cid:5)=0satisfying(13.27)ifandonlyifker(λIE−u)(cid:5)=0,thusifdet(λIE−u)=0.(13.28)Wecallthepolynomialpu(s)=det(sIE−u).thecharacteristicpolynomialofu.Asaresult,λ∈Kisaneigenvalueoftheendomorphismuifandonlyifλisarootofitscharacteristicpolynomial.Onecanprovethefollowing([10],n◦III.8.1):LEMMA519.–Thecharacteristicpolynomialpu(s)canbewrittenaspu(s)=sn+n(cid:12)k=1(−1)k∆ksn−kwhere∆1=Tru(thetraceofu,i.e.thesumofalleigenvaluesofu)and∆n=detu.LetAbethematrixrepresentinguinanybasisofE;then∆kisthesumoftheprincipalminorsoforderkofA.WeassumeinwhatfollowsthatthecharacteristicpolynomialoftheendomorphismconsideredhasitsrootsinK(whichisobviouslyensuredifK=Cor,moregenerally,ifKisanalgebraicallyclosedﬁeld).ThesetofalleigenvaluesofuiscalleditsspectrumandisdenotedasSp(u).482LinearSystemsAusefullemmaLetA∈Kn×mandB∈Km×nbetwomatrices.LEMMA520.–(i)Thenon-zeroeigenvaluesofABandthoseofBAcoincide.(ii)In+ABisinvertibleifandonlyifIm+BAisinvertibleandinthatcaseB(In+AB)−1=(Im+BA)−1B.PROOF.(i)λ∈KisaneigenvalueofABifandonlyifthereexistsanon-zerovectorx∈Knsuchthat(λIn−AB)x=0.Supposeλ(cid:5)=0andwritey=Bx.Theny(cid:5)=0and(λIm−BA)y=0,whichshowsthatλisaneigenvalueofBA.Bysymmetry,theconverseholdstoo.(ii)ThematrixIn+ABisinvertibleifandonlyif−1isnotaneigenvalueofAB,andthisholdsifandonlyifIm+BAisinvertibleaccordingto(i).Letthenv∈Knbeanyvectorandy=B(In+AB)−1v=Buwithu=(In+AB)−1v.Wethushaveu+Ay=v,fromwhichBAy=Bv−Bu=Bv−y,andﬁnallyy=(Im+BA)−1Bv.SinceB(In+AB)−1v=(Im+BA)−1Bvforanyv∈Kn,wegetthedesiredidentity.MultiplicitiesofaneigenvalueAlgebraicmultiplicityLetλ∈Kbearootofpu(s)andletσbetheorderofmultiplicityofthisroot,sothatpu(s)=(s−λ)σπλ(s)whereπλ(s)isapolynomialwhichisnotdivisiblebys−λ.Wecallσthealgebraicmultiplicityoftheeigenvalueλ.EigenspaceandgeometricmultiplicityTheeigenspaceassociatedwiththeeigenvalueλisEλ=ker(λIE−u).Thegeometricmultiplicityoftheeigenvalueλisρ=dimEλ.LEMMA521.–Theinequalityρ≤σisalwayssatisﬁed.PROOF.Let(εi)1≤i≤nbeabasisofE,theﬁrstρelementsofwhichformabasisofEλ;inthisbasis,uisrepresented,accordingto(13.24),byamatrixoftheformA=(cid:27)Λ∗0B(cid:28)whereΛ=diag(λ,...,λ),λrepeatedρtimes.Asaresult,det(sIn−A)=(s−λ)ρdet(sIn−ρ−B),thus(s−λ)ρdividespu(s),whichprovesthatρ≤σ.Appendix2:Algebra483DiagonalizableendomorphismsAnendomorphismuofEissaidtobediagonalizableifthereexistsabasisofEinwhichuisrepresentedbyadiagonalmatrixA.Itisimmediatethat,inthiscase,theeigenvaluesofuarefoundonthediagonalofAandthattheimageofanyvectorεofthisbasisbyuisoftheformu.ε=λε,thusthebasisinquestionisconstitutedofeigenvectors.Asaresult,anecessaryconditionforutobediagonalizableisthatuhasnK-linearlyindependenteigenvectors.Itisclearthatthisisalsoasufﬁcientcondition.Letuslookatthisinmoredetail.Letλ1,...,λkbethedistincteigenvaluesofu,σ1,....,σkbetheiralgebraicmultiplicitiesandρ1,....,ρkbetheirgeometricmultiplicities.First,wehave(cid:11)ki=1σi=d◦(pu)=n.Ontheotherhand,Eλi∩Eλj=0(i(cid:5)=j).(13.29)Indeed,ifx∈Eλi∩Eλj,i(cid:5)=j,wehaveux=λix=λjx,thus(λi−λj)x=0,fromwhichx=0becauseλi(cid:5)=λj.Foranyi∈{1,...k},EλiisinvariantunderuandtherestrictionuλiofutoEλiisrepresented(whateverthebasisofEλiconsidered)bythediagonalmatrixλiIρi.Asaresult:Ifρi=σi,∀i∈{1,...,k},thenE=Eλ1⊕...⊕Eλk,u=uλ1⊕...⊕uλkandthisendomorphismisrepresentedbythediagonalmatrixA=(cid:15)λ1Iρ1(cid:16)⊕...⊕(cid:15)λkIρk(cid:16)inabasisconstitutedofeigenvectors.Ifthereexistsanindexj∈{1,...,k}suchthatρj<σj,therewillnotbenK-linearlyindependenteigenvectorsanduisnotdiagonalizable.Wethushaveobtainedthefollowing:THEOREM522.–AnendomorphismuofEisdiagonalizableifandonlyifthegeometricmultiplicityofeachofitseigenvaluesisequaltoitsalgebraicmultiplicity.ThisholdsifandonlyifthereexistsabasisofEthatconsistsofeigenvectorsofu,andthenuisrepresentedinthisbasisbyadiagonalmatrix.484LinearSystemsPolynomialsofendomorphismsLetp(s)=sm+p1sm−1+···+pmbeapolynomialofK[s].Ontheotherhand,letubeanendomorphismoftheK-vectorspaceE.Writep(u)=um+p1um−1+···+pmIEwhereuiistheithiterationofu,deﬁnedbyinductionaccordingtou0=IEandu.ui=ui+1,i≥0;p(u)isanendomorphismofE.MinimalpolynomialTHEOREM523.–Thereexistsanon-emptysubsetAofK[s]consistingofthosepolynomialsp(s)thatannihilateu,i.e.whicharesuchthatp(u)=0.ThissetAisanidealinK[s].Thereexistsauniquepolynomialqu(s)inAwhichismonicandofminimaldegree.PROOF.Let{e1,...,en}beabasisofEandconsidertheithelementeiofthisbasis.Then+1elementsei,u.ei,...,un.eiareK-linearlydependentsincedimE=n.Thereforethereexistn+1coefﬁcientsγijofK,notallzero,suchthat(cid:11)n+1j=1γijuj−1.ei=0;thus,puttingγi(s)=n+1(cid:12)j=1γijsj−1weobtainγi(u).ei=0.Thereforeγ(s)=(ni=1γi(s)isapolynomialsuchthatforanyi∈{1,...,n},γ(u).ei=0andthusγ(u).x=0,∀x∈E.Asaresult,γ(u)=0.Thus,thesetAisnon-emptysinceγ(s)∈A.ItisclearthatAisanadditivegroup.Ifω(s)∈Aandifϕ(s)∈K[s]isamultipleofω(s),i.e.thereexistsψ(s)∈K[s]suchthatϕ(s)=ω(s)ψ(s),thenϕ(u)=ω(u)ψ(u)=0,andsoϕ(s)∈A.ThereforeAisanidealinK[s];andsincethisringisaprincipalidealdomain,theidealAisprincipal,andthereexistsauniquemonicpolynomialqu(s)suchthatA=(qu).DEFINITION524.–Thepolynomialqu(s)iscalledtheminimalpolynomialofu.LEMMA525.–Therootsoftheminimalpolynomialaretheeigenvaluesofu.PROOF.LetustemporarilyaddthehypothesisthatKcontainstheeigenvaluesofuandtherootsofqu.1)Ifµ∈Kisarootofquandisnotaneigenvalueofu,wecanwritequ(s)=(s−µ)q(cid:2)u(s),whereq(cid:2)u(s)∈K[s].Itisclearthatu−µIEisanautomorphism,thusqu(u)=0impliesq(cid:2)u(u)=0,whichisimpossiblesinceAppendix2:Algebra485d◦(q(cid:2)u)<d◦(qu).2)Conversely,foranyeigenvalueλofu,theassociatedeigenspaceEλisonlyannihilatedbythemultiplesofs−λ,thuss−λmustbeadivisorofqu(s).ThefollowingpropositionisanobviousconsequenceofLemma525:PROPOSITION526.–Thefactorizationofqu(s)intoprimesisoftheformqu(s)=k’i=1(s−λi)βiwhereβi≥1,i∈{1,...,k}.13.3.4.*JordanformThissectionprovidesaconstructiveproofofthereductiontoJordanform6.GeneralizedeigenspacesConsidertheexpressionoftheminimalpolynomialqu(s)ofanendomorphismu,givenbyProposition526.THEOREM527.–Let˜Eλi=ker(λiIE−u)βi.Thesespaces˜Eλihavethefollowingproperties:(i)˜Eλiisinvariantunderu;(ii)˜Eλi∩˜Eλj=0ifi(cid:5)=j;(iii)E=˜Eλ1⊕...⊕˜Eλk;(iv)˜Eλi⊃Eλi,and˜Eλi=Eλiifandonlyifβi=1.PROOF.Wehaves(λi−s)βi=(λi−s)βis,thusu(λiIE−u)βi=(λiIE−u)βiu.Therefore,ifxisavectorofEsuchthat(λiIE−u)βix=0,then(λiIE−u)βiux=0,whichmeansthat˜Eλiisinvariantunderu.(ii)Supposethatx∈˜Eλi∩˜Eλj,i(cid:5)=j.Sincethepolynomials(λi−s)βiand(λj−s)βjarecoprime,thereexist,accordingtotheBézouttheorem,polynomialsv(s)andw(s)inK[s]suchthatv(s)(λi−s)βi+w(s)(λj−s)βj=1.Asaresult,v(u)(λiIE−u)βi.x+w(u)(λjIE−u)βj.x=x,6.Theapproachtakenhereisthemosttraditional.Anothermoreabstractapproachispresentedinsection13.4.2.486LinearSystemsthusx=0.(iii)Let˜E=˜Eλ1⊕...⊕˜Eλk;if˜E(cid:5)=E,thissubspace˜EwilladmitasupplementinE(section13.3.1,Theorem516).Nowsupposethatx(cid:5)=0isavectorbelongingtothissupplement:itisclearthatwewouldhavequ(u).x(cid:5)=0,whichisimpossible.(iv)isobvious.DEFINITION528.–Ifβi>1,˜Eλiiscalledthegeneralizedeigenspaceassociatedwiththeeigenvalueλi.AccordingtoTheorem527,wehaveu=˜uλ1⊕...⊕˜uλkwhere˜uλiistherestrictionofuto˜Eλi.Tofurtherstudytheendomorphismu,wearenowledtostudyanyoneofitsrestrictions˜uλi.Theproblemcomesdowntothecasewhereλi=0bywriting˜vλi=˜uλi−λiI˜Eλi.Theminimalpolynomialof˜vλiisobviouslysβi.Thisstudyiscarriedoutbelow,withasimpliﬁednotation.NilpotentendomorphismsSo,letvbeanendomorphismofaK-vectorspaceEofdimensionn,theminimalpolynomialofwhichisqv(s)=sm,m≤n.Wethushavevm=0:thisendomorphismissaidtobenilpotent.Ontheotherhand,vr(cid:5)=0,∀r∈{0,...,m−1}.CyclicsubspaceSincevm−1(cid:5)=0,thereexistsavectore1ofEsuchthatvm−1e1(cid:5)=0.Thevectorse1,v.e1,...,vm−1.e1areK-linearlyindependent.Indeed,supposethereexistscalarsξ1,...,ξm,notallzero,suchthatm(cid:12)i=1ξivm−ie1=0,(13.30)andletξjbetheﬁrstnon-zeroscalarofthelist(ξi)1≤i≤m.Byapplyingtheoperatorvj−1to(13.30),weobtainξjvm−1e1=0,whichisimpossible.LetE1bethesubspacegeneratedbythevectorse1,v.e1,...,vm−1.e1;thissubspaceadmitsabasis(cid:31)e1,v.e1,...,vm−1.e1 ,andisobviouslyinvariantunderv.Asubspacehavingthisdoubleproperty(i.e.asubspacethatisinvariantundervandadmitsabasishavingtheaboveparticularform)issaidtobev-cyclic,andweAppendix2:Algebra487call(cid:31)e1,v.e1,...,vm−1.e1 av-cyclicbasisofE1.Wecalle1av-cyclicgeneratorofthisbasis,aswellasofE1.Therestrictionv1ofvtoE1isrepresented,inthecyclicbasisconsidered,bythesquarematrixofordermJ0,m=⎡⎢⎢⎢⎢⎣00···01.....................0···10⎤⎥⎥⎥⎥⎦alltheelementsofwhicharezero,exceptthoseonthesubdiagonal,whichare1.ThematrixJλ,m=J0,m+λImiscalledtheJordanblockofordermrelativetoλ.DecompositionintocyclicsubspacesIfn=m,theentirevectorspaceEisv-cyclicandthereisnothingmoretosayaboutit.Supposem<n.Itisclearthatimvr⊂imvr(cid:1)ifr≥r(cid:2)andimvm=0,thusthereexistsanintegerm2∈{1,...,m}suchthatimvm2⊂E1andimvm2−1∩E1(cid:5)=0.Thus,letε2beanon-zerovectorofEsuchthatvm2−1.ε2/∈E1andletµ0,...,µm−1bethecomponentsofvm2.ε2inthebasis(cid:31)e1,v.e1,...,vm−1.e1 ofE1.Writingthatvm−m2vm2ε2=0,weimmediatelyshow(usingthefactthatthevectorsvm−m2e1,...,vm−1.e1areK-linearlyindependent)thatµi=0(1≤i≤m2−1),thusvm2.ε2=µm2vm2e1+...+µm−1vm−1e1.Nowlete2=ε2−(cid:15)µm2e1+...+µm−1vm−m2−1e1(cid:16).(13.31)Thenvm2−1.e2/∈E1andvm2.e2=0.Thus,(cid:31)e2,ve2...,vm2−1.e2 isav-cyclicbasisofav-cyclicsubspaceE2,anditiseasilyshownthatE1∩E2=0.Continuingthisway,weconstructaﬁnitenumberνofv-cyclicsubspacesEi,suchthatdimEi+1≤dimEiandE=E1⊕...⊕Eν.TherestrictionviofvtoEiisrepresented,inav-cyclicbasisofEi,bythelowertriangularJordanblockJ0,miandwehavev=v1⊕...⊕vν.(13.32)488LinearSystemsThisendomorphismisthusrepresented,inabasisofEthatconsistsoftheconcatenationofthev-cyclicbasesofthev-cyclicsubspacesEi,1≤i≤ν,bythelowertriangularmatrixJ0,m1⊕...⊕J0,mν.(13.33)REMARK529.–(i)Inthebasis(cid:31)fi,1=vmi−1.ei,...,fi,mi=ei ofEi,viisrepresentedbytheuppertriangularJordanblockJT0,mi.Wehaveindeedtherecurrencerelationfi,j=v.fi,j+1,1≤j≤mi−1.(13.34)Therefore,J0,mi≈JT0,mi.(ii)Itisclearthatfi,1∈kerv;butwecannotgenerate,startingfromanyelementofkerv,av-cyclicsubspaceEibytherecursiveprocedure(13.34):thisprocedureneedstobefollowedintheotherdirection,fromanon-zeroelementofkervmi−1.SimilarityinvariantsandelementarydivisorsLetubeanendomorphismofaK-vectorspaceEofdimensionnandletA∈Kn×nbeamatrixrepresentinguinabasisofE.TheinvariantfactorsofsIn−Aareunchangedunderchangeofbasis,thustheyonlydependontheendomorphismu.Amongthem,thosewhicharenotinvertible(thatis,notequalto1)arecalledthesimilarityinvariantsofu(orofA).Likewise,theelementarydivisorsofsIn−Adependonlyontheendomorphismuandarealsocalledtheelementarydivisorsofthisendomorphism(orofA).IfKcontainsallrootsofpu(s),theseelementarydivisorsareoftheform(s−λ)l,whereλisaneigenvalueofu.ItisclearthattheJordanblockJ0,mihasauniquesimilarityinvariantwhichissmi.Therefore,thesimilarityinvariantsof(13.32)aresmν,...,sm1andtheycoincidewiththeelementarydivisorsofthisnilpotentendomorphism.JordantheoremLetubeanendomorphismofaﬁnite-dimensionalK-vectorspaceE,suchthatallrootsofitscharacteristicpolynomialpu(s)belongtoK.TheJordantheorembelowisadirectconsequenceoftheabove:THEOREM530.–ThevectorspaceEcanbeexpressedasadirectsumofu-cyclicsubspacesEλ,l,whereEλ,lisassociatedwiththeelementarydivisor(s−λ)lofu(λ∈Sp(u)).Choosingau-cyclicbasisineachofthesesubspaces,uisrepresentedbyadiagonalsumofJordanblocksJλ,l,eachoftheseblocksappearinginthisdiagonalsumanumberoftimesequaltothemultiplicityorderoftheelementarydivisor(s−λ)l.ThenumberofblocksJλ,lappearinginthisdiagonalsum,fortheAppendix2:Algebra489sameeigenvalueλbutdifferentvaluesofl,isequaltothegeometricmultiplicityoftheeigenvalueλ.Thematrixobtainedinthiswayislowertriangular,andiscalledtheJordanformofu.TwomatriceshavingthesameJordanformaresimilar.DEFINITION531.–LetustakeabasisofEinwhichtheendomorphismuisrepresentedbyitsJordanform.Thevectorsofthisbasisarecalledthegeneralizedeigenvectorsofu,andageneralizedeigenvectorxforwhichthereexistsλ∈Sp(u)andk≥1suchthatx∈ker(λIE−u)kissaidtobeassociatedwiththeeigen-valueλ.COROLLARY532.–AnendomorphismisdiagonalizableifandonlyifallitsJordanblocksareoforder1,thatisiftherootsofitsminimalpolynomialareallsimple.COROLLARY533.–Letubeanendomorphism;detuistheproductoftheeigenvaluesofu(repeatingeacheigenvalueinthisproductanumberoftimesequaltoitsalgebraicmultiplicity).FromTheorem530andRemark529(i),wededucethefollowingresult:PROPOSITION534.–EverymatrixA∈Kn×nissimilartoitstranspose.Theproofofthefollowingcorollaryisnoweasy:COROLLARY535.–LetEbeaﬁnite-dimensionalK-vectorspace,ubeanendomorphismofEandtubethatendomorphismofE∗whichisthetransposeofu(section13.3.2).Theendomorphismsuandtuhavethesamesimilarityinvariantsandinparticulareacheigenvalueofuisaneigenvalueoftu.Letλandµbeeigenvaluesofu,letxbeageneralizedeigenvectorofuassociatedwithλ(Deﬁnition531)andlety∗beageneralizedeigenvectoroftuassociatedwithµ;ifλ(cid:5)=µ,thenwehave y∗,x!=0.Cayley-HamiltontheoremLetαj+1(s),...,αn(s)bethesimilarityinvariantsofu(wherejisthenumberofinvariantfactorsofsIn−Athatareequalto1).AccordingtoTheorem530,thefactthatαi|αi+1(j+1≤i≤n−1)andequality(13.26)(section13.3.3),wehavethefollowingresult:PROPOSITION536.–Theminimalpolynomialqu(s)andthecharacteristicpolynomialpu(s)ofanendomorphismu:E→E(wheredimE=n)canbeexpressedasafunctionofitssimilarityinvariantsαi(s)(j+1≤i≤n)inthe490LinearSystemsfollowingmanner:qu(s)=αn(s)(13.35)pu(s)=n’i=j+1αi(s)(13.36)Therefore,theminimalpolynomialqu(s)dividesthecharacteristicpolynomialpu(s)(i.e.pu(s)∈A:seeTheorem523insection13.3.3).Wethusobtainthefollowingresult,calledtheCayley-Hamiltontheorem:THEOREM537.–Foranyendomorphismuofaﬁnite-dimensionalK-vectorspaceE,theequalitypu(u)=0issatisﬁed.ExampleofreductiontoJordanformLetA=⎡⎢⎢⎢⎢⎣0000110011−110−100000−100000⎤⎥⎥⎥⎥⎦.WehavepA(s)=det(sI5−A)=s5;thusthematrixAhasauniqueeigenvalueλ=0,whichisofalgebraicmultiplicity5.Nevertheless,wecaneasilyverifythatdimkerA=2,thustheeigenvalueλ=0isofgeometricmultiplicity2.ThusAisnotdiagonalizableaccordingtoTheorem522(section13.3.3),andissimilartothediagonalsumoftwoJordanblocksaccordingtoTheorem530.Apriori,thesemaybeeitheroforder1and4,oroforder2and3.ThereadercanasanexerciseverifythattheSmithformofsI5−Aisdiag(cid:15)1,1,1,s2,s3(cid:16),thusthesimilarityinvariantsofAares2ands3;itfollowsthattheelementarydivisorsofAares2ands3,thereforeA≈J0,3⊕J0,2.TheminimalpolynomialisqA(s)=s3.Inaddition,E=E1⊕E2whereE1andE2arecyclicsubspacesofdimension2and3,respectively.Appendix2:Algebra491InordertodetermineE1,letuschooseageneratore1suchthatA2e1(cid:5)=0.7WehaveA2=⎡⎢⎢⎢⎢⎣0000000000100110000000000⎤⎥⎥⎥⎥⎦.TheﬁrstcolumnofA2isnon-zero,thuswecantakee1=[1,0,...,0]T;Ae1andA2e1arethentheﬁrstcolumnofAandA2,respectively,i.e.[0,1,−1,0,0]Tand[0,0,1,0,0]T.Therefore,(cid:31)e1,Ae1,A2e1 isacyclicbasisofE1.Letusnowchooseavectorε2suchthatAε2doesnotbelongtoE1.Thevectorε2=[0,0,0,0,1]Tsatisﬁesthiscondition,sinceAε2=[1,1,0,−1,0]T(ﬁfthcolumnofA).Ontheotherhand,wehaveA2ε2=A2e1;letustake,accordingto(13.31),e2=ε2−e1=[−1,0,0,0,1]T.ThechangeofbasismatrixthenobtainedisP=(cid:25)e1,Ae1,A2e1,e2,Ae2(cid:26)=⎡⎢⎢⎢⎢⎣100−11010000−11010000−100010⎤⎥⎥⎥⎥⎦ThereadercanverifythatP−1AP=J0,3⊕J0,2.NotethatthedeterminationofPismucheasierbythepreviousdeterminationofthestructureoftheJordanformofA,i.e.bythecalculationofitselementarydivisors.13.4.*Thelanguageofmodules13.4.1.GeneralnotionsDeﬁnitionThenotionofmoduleisaverypracticalwayofefﬁcientlyintroducingthekeyconceptsofsystemstheory[42].Amoduleisanalogoustoavectorspace,butinsteadofthescalarsbeingelementsofaﬁeld,theseareelementsofaring.7.Here,bythesameabuseoflanguageasusual,weidentifyavectorofR5withitsrepresentativeinthecanonicalbasisofthisspace.492LinearSystemsLetEbeavectorspacedeﬁnedoveraﬁeldK(Kcanbe,forexample,theﬁeldofrealorcomplexnumbers),letvbeanelementofEandletλ(cid:5)=0beanelementofK.Ifλv=0,thenv=0,since(1/λ)λv=0.Thisrationaleisnolongervalidifλhasnoinverse,whichcouldbethecaseifKwerearing,notaﬁeld.NowletAbeanyring.AnA-moduleMisasetequippedwithanaddition+:M×M→M(whichiscommutativeandmakesManabeliangroup)andwithamultiplicationA×M→M:(λ,m)(cid:3)→λm(foraleftmodule,i.e.whenthescalarsmultiplywiththeelementsofthismodulefromtheleft)suchthat–λ(m1+m2)=λm1+λm2–λ1(λ2m)=(λ1λ2)m–(λ1+λ2)m=λ1m+λ2m–1m=mforanyλ,λ1,λ2∈Aandanym,m1,m2∈M.IfAisaﬁeldoradivisionringK,thenMisaK-vectorspace.ElementarynotionsLetMbeanA-module.AsubmoduleNofMisanA-moduleincludedinM.WecandeﬁneaquotientmoduleM/N(whereNisasubmoduleofM),asumM1+M2andadirectsum(orexternaldirectsum)M1⊕M2oftwoA-modulesM1andM2,exactlyaswedidinsection13.3.1forvectorspaces.AhomomorphismofA-module(alsocalledanA-homomorphism)isanA-linearmappingf:M→N(whereMandNareA-modules).Welikewisedeﬁneamonomorphism,anepimorphismandanisomorphismofA-modules(thelatterisagaindenotedas∼=).Onecanshowthefollowing(see[91],sectionIII.10and[102],Chapter2):THEOREM538.–(i)Thecanonicaldecompositionofahomomorphism(seethecommutativediagraminFigure13.1),thenotionofinducedhomomorphism(seeRemark518)andthenotionofprojectionontoasubmoduleparalleltoasupplementarysubmodule(seethecommutativediagraminFigure13.2)arestillvalideveninthecaseofahomomorphismofA-modules.(ii)LetM(cid:2)andM(cid:2)(cid:2)besubmodulesofanA-moduleM.ThenM(cid:2)M(cid:2)∩M(cid:2)(cid:2)∼=M(cid:2)+M(cid:2)(cid:2)M(cid:2)(cid:2).(iii)LetM,M(cid:2)andM(cid:2)(cid:2)beA-modulessuchthatM(cid:2)(cid:2)⊂M(cid:2)⊂M.ThenM/M(cid:2)∼=M/M(cid:2)(cid:2)M(cid:2)/M(cid:2)(cid:2).Appendix2:Algebra493(iv)LetMbeanA-moduleandM(cid:2)beasubmoduleofM.Thereexistsaone-to-onecorrespondencebetweensubmodulesSofM/M(cid:2)andtheintermediatesubmodulesΣbetweenM(cid:2)andM(thatissuchthatM(cid:2)⊂Σ⊂M)givenbyS(cid:3)→Σ(cid:1)ϕ−1(S)whereϕ:M→M/M(cid:2)isthecanonicalepimorphism.(v)LetM,M(cid:2),M(cid:2)(cid:2),N(cid:2)andN(cid:2)(cid:2)beA-modulessuchthatM=M(cid:2)⊕M(cid:2)(cid:2),N(cid:2)⊂M(cid:2)andN(cid:2)(cid:2)⊂M(cid:2)(cid:2).ThenwehavethecanonicalisomorphismM(cid:2)⊕M(cid:2)(cid:2)N(cid:2)⊕N(cid:2)(cid:2)∼=M(cid:2)N(cid:2)⊕M(cid:2)(cid:2)N(cid:2)(cid:2).FinitelygeneratedmodulesAnA-moduleMissaidtobeofﬁnitelygeneratedifitisgeneratedbyaﬁnitenumberofelementsm1,...,mk,i.e.foranyx∈M,thereexistλ1,...,λk∈Asuchthatx=(cid:11)1≤i≤kλimi(thisexpressionisingeneralnon-unique).WethenwriteM=(cid:23)(mi)1≤i≤k(cid:24)Aorsimply[m]A,wheremistheﬁnitesequence(mi)1≤i≤k(whichcanbeidentiﬁedwiththecolumnmatrix[m1...mk]T).FreemodulesAbasisofanA-moduleMisalsodeﬁnedasinsection13.3.1.Butwhereaseveryvectorspaceadmitsabasis,thosemodulesthatadmitabasisarequiteparticularandarecalledfreemodules.AﬁnitelygeneratedfreemoduleLisisomorphictoadirectsumk9i=1Ai=Ak,whereeachAiisamoduleisomorphictoA(whenthelatterisconsideredasamoduleoveritself).TheintegerkiscalledtherankofthefreemoduleL.PresentationofamoduleLEMMA539.–LetMbeanA-modulegeneratedbykelementsmi,1≤i≤k.ThenMisisomorphictothequotientofafreeA-moduleofrankk.PROOF.Let(ci)1≤i≤kbethecanonicalbasisofAkandletϕ:Ak→MtheA-homomorphismdeﬁnedbyϕ(ci)=mi,1≤i≤k.Itisclearthatϕisanepimorphism,thusM∼=Ak/kerϕaccordingtoTheorem538(i).THEOREM540.–LetM=[m]AbeaﬁnitelygeneratedA-module,wherem=[m1...mk]T.Thefollowingconditionsareequivalent:(i)M∼=Ak/kerϕandkerϕisﬁnitelygenerated.(ii)ThereexistsanA-homomorphismf:Aq→Aksuchthat494LinearSystemsM∼=Ak/imf(cid:1)cokerf.8(iii)ThereexistsamatrixR∈Aq×ksuchthatthegeneratorsmi,1≤i≤k,areonlyrelatedbytheequalityRm=0.(13.37)PROOF.1)(i)⇒(ii):IfMisﬁnitelygenerated,thenM∼=Ak/kerϕaccordingtoLemma539.Supposekerϕisgeneratedbyqelements.ApplyingLemma539tothemodulekerϕ⊂Ak,thereexistsanepimorphismg:Aq→kerϕ.Letf:Aq→AkbetheA-homomorphismdeﬁnedbyf(x)=g(x),x∈Aq.Thenimf=kerϕ.2)(ii)⇒(iii):Let(ai)1≤i≤qand(ci)1≤i≤kbethecanonicalbasesofAqandAk,respectively,andwritef(ai)=k(cid:12)j=1rijcj,1≤i≤q;(13.38)letRbethematrix(rij)(1≤i≤q,1≤j≤k).Letmj=ϕ(cj),1≤j≤k,whereϕ:Ak→Ak/imfisthecanonicalepimorphism.ThenthegeneratorsmiofAk/imfarerelatedbytheonlyequality(13.37).3)(iii)⇒(i):SeeRemark542.DEFINITION541.–AnA-moduleMsatisfyingoneofthethreeequivalentconditionsinTheorem540issaidtobeﬁnitelypresented.Therelation(13.37)iscalledapresentationofMandthematrixRappearinginthisrelationiscalledamatrixofdeﬁnition(ormatrixofpresentation)ofM.REMARK542.–IfwerepresenttheelementsofAqandAkbyrowsinthecanonicalbases,thenRisthematrixoffinthesebasesandfisidentiﬁedwiththeright-multiplicationbyR(writtenf=•R)9.Accordingto(13.38),f(Aai)isthesubmoduleofAkgeneratedbytheithrowofR.ThemoduleM=[m]AisrelatedtothedeﬁnitionmatrixRbytheisomorphismM∼=coker(•R)=Ak/kerϕ,whereϕ:Ak→Ak/kerϕisthecanonicalepimorphism.Adeﬁnitionmatrixofaﬁnitelypresentedmoduleisnon-unique.Wehaveindeedthefollowingresult([31],section0.6):THEOREM543.–LetMbeaﬁnitelypresentedA-modulewithdeﬁnitionmatrixR∈Aq×k;thenR(cid:2)∈Aq(cid:1)×k(cid:1)isagainadeﬁnitionmatrixofMifandonlyifcoker(•R(cid:2))∼=coker(•R).ThematricesRandR(cid:2)arethensaidtobeleft-similarandthisimpliesk−q=k(cid:2)−q(cid:2)(thisintegeriscalledthecharacteristicofM).IfR(cid:2)∼R,thenRandR(cid:2)areleft-similar,buttheconversedoesnothold.8.Ak/imf(cid:1)cokerfiscalledthecokerneloff.9.Thisconventionisadoptedthroughoutsection13.4butonlyinthatsection.Therearegoodreasonsforthis(see[15],[22]).Appendix2:Algebra495SupposefromhereonthattheringAisacommutativedomain.Onecanprovethefollowingresult([11],ChapterI):THEOREM544.–IfAisNoetherian,thenanyﬁnitelygeneratedA-moduleisﬁnitelypresented.TheNoetherianconditionistoorestrictiveforcertainapplications(especially,aBézoutdomainisnotNoetherianunlessitisaprincipalidealdomain)andthisiswhythefollowingisuseful:DEFINITION545.–AringAiscoherentifeveryﬁnitelygeneratedidealinAisﬁnitelypresented.Bézoutdomains,Noetherianrings,areallcoherent.Wehavethefollowingresult([31],TheoremA.9,p.555):THEOREM546.–IftheringAiscoherent,thenthecategoryofﬁnitelypresentedA-modulesofisclosedundertakingﬁnitelygeneratedsubmodules,ﬁnitedirectsums,kernelsandcokernels,*andthusitisanabeliansubcategoryofthecategoryofallA-modules.*Onecaneasilyprovethefollowing:THEOREM547.–LetMbeanA-modulewithdeﬁnitionmatrixR∈Aq×k.ThemoduleisMfreeifandonlyifRiscompletable.TorsionLetλ(cid:5)=0beanelementofAandletmbeanelementofM.Asalreadysaid,theequalityλm=0doesnotimplym=0,unlessλisaninvertibleelementofA.AnelementofMsatisfyingsuchanequalityiscalledatorsionelementandanelementthatisnotoftorsioniscalledfree.Theonlytorsionelementofavectorspaceis0.ThesetoftorsionelementsofanA-moduleMisasubmoduleofM,andisreferredtoasthetorsionsubmoduleofM,denotedbyT(M).AmoduleMsuchthatT(M)=0(thatisT(M)isreducedtotheelement0,orinotherwordsMonlycontainsfreeelements)issaidtobetorsion-free.ForanyA-moduleM,thequotientM/T(M)istorsion-free.AllfreeA-modulesaretorsion-free,whiletheconversedoesnotholdingeneral.Wehavethefollowing([10],n◦II.7.10&ChapterVII),([31],section0.3):THEOREM548.–(A)LetMbeaﬁnitelypresentedA-moduleandR∈Aq×kbeapresentationmatrixofM.TheA-moduleMisoftorsionifandonlyifRis496LinearSystemsleft-invertibleoverF=Q(A).(B)IfAisaprincipalidealdomain(resp.,aBézoutdomain),thenanysubmodule(resp.,anyﬁnitelygeneratedsubmodule)ofafreeA-moduleisfree.CyclicmodulesAcyclicA-moduleisamoduleΓgeneratedbyauniqueelementm,i.e.Γ=[m]A=Am.Wecalltheannihilatorofm(andwedenoteasAnn(m))thesubsetaofAsuchthatam=0,thatisλm=0,∀λ∈a.Itisclearthataisanideal.Letϕ:A→Γbetheepimorphismdeﬁnedbyϕ(λ)=λm;wehavekerϕ=a,thusΓ∼=A/a.Conversely,letabeanidealinAandletψ:A→A/abethecanonicalepimorphism.ThemoduleA/aiscyclic,generatedbyψ(1).IndecomposablemodulesDEFINITION549.–AnA-moduleMissaidtobedecomposableifitisthedirectsumoftwosubmodulesdifferentfrom0andM,andissaidtobeindecomposableotherwise.Wehavethefollowing([10],ChapterI):LEMMA550.–LetabeanidealinA.ThecyclicmoduleA/aisdecomposableifandonlyifthereexisttwoidealsbandc,differentfrom0andA,suchthatA=b+canda=b∩c;then,A/a∼=A/b+A/c.13.4.2.ModulesoverprincipalidealdomainsExceptwhenotherwisestated,Risaprincipalidealdomaininthesequel.PrimarydecompositionofacyclicmoduleSinceanyidealinRisprincipal,itisgeneratedbyauniqueelementaandisthusoftheformRa=(a).LetΓ∼=R/(a)beacyclicR-module.(i)Ifa=0,thenΓ∼=R(0)=Risafreemoduleofrank1.(ii)Ifa(cid:5)=0,thenthecyclicmoduleΓistorsion,andΓ=0ifandonlyifaisaunitofR.Inwhatfollows,wewillusethefollowingresult(validwhenRisaBézoutdomain):PROPOSITION551.–(i)Letb,c∈R×betwocoprimeelements.Then,R(bc)∼=R(b)⊕R(c).(ii)LetpbeaprimeinRandnbeapositiveinteger;thenthemoduleR(pn)isindecomposable.Appendix2:Algebra497PROOF.(i)Leta=bc.Sincebandcarecoprime,wehave(b)+(c)=Rand(b)∩(c)=(a).Thus,Assertion(i)isaconsequenceofLemma550.(ii)SupposeR(pn)isdecomposable.AccordingtoLemma550,thereexistelementsb,c∈Rthatarecoprimeandsuchthatpn∈lcm(b,c).Thisisobviouslyimpossible.GivenanonunitaofR,letusconsidertheuniquefactorizationofthiselementintoprimes(section13.1.2),nowwrittenintheforma=υ’ipkii,ki≥0.AccordingtoProposition551,itisclearthatR(a)∼=,iR(cid:9)pkii(cid:10)(13.39)andthatthemodulesR(cid:9)pkii(cid:10)(ki(cid:5)=0)areindecomposable.Thetermspkiiwhicharenotequalto1arecalledtheelementarydivisorsofthecyclicmoduleM∼=R(a).Amodulethatisadirectsum,j∈JR(pji)(Jﬁnite)issaidtobeprimary(wewillencountersuchmodulesintheexplicitdecompositioninTheorem556below).CanonicaldecompositionofamoduleLetMbeaﬁnitelygeneratedmoduleoveraprincipalidealdomainR.AccordingtoProposition544(section13.4.1),Misﬁnitelypresented,thusM=[m]Aisdeﬁnedbyarelationsuchthat(13.37)whereR∈Rq×k.ThereexistmatricesU∈GLq(R)andV∈GLk(R)suchthatU−1RV=ΣwhereΣ=diag(α1,...,αr,0,...,0)istheSmithformofR(Theorem497,section13.2.3).Thepolynomialsαi,1≤i≤r,aretheinvariantfactorsofR.Theyarenon-zeroandsuchthatαi|αi+1,1≤i≤r−1.Writem=Vv,wherev=[v1...vk]T.ThenM=[v]Randequation(13.37)ofsection13.4.1isequivalenttodiag(α1,...,αr,0,...,0)⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣v1...vrvr+1...vk⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦=0.(13.40)498LinearSystemsIfq>r,(13.40)(andthus(13.37))includesq−rtrivialequations0=0,whichcanbesuppressed.Wethuscanassumeq=r;thenequation(13.40)reducesto:αivi=0,1≤i≤r.(13.41)For1≤i≤r,viisatorsionelementwhichgeneratesthecyclictorsionmodule[vi]R∼=R(αi),andthismoduleiszeroifandonlyifαiisinvertible.Supposethatthenumberofinvertibleelementsinthelist(αi)1≤i≤risequaltoj;thenweonlyneedtoconsidertheαi’s,j+1≤i≤r.Forr+1≤i≤k,vigeneratesthefreecyclicmodule[vi]R∼=R(0)=R.WehaveM=[v]R=,j+1≤i≤k[vi]R.Hereabove,T(M)=,j+1≤i≤r[vi]R,andΦ=,r+1≤i≤k[vi]Risafreemoduleofrankk−rsince(vi)r+1≤i≤kisabasisofΦ(settingΦ=0ifr=k).WehavethusobtainedthedecompositionM=T(M)⊕Φ(13.42)whereΦisafreesubmoduleofM,suchthatΦ∼=Rk−r.Inaddition,T(M)∼=,j+1≤i≤rR(αi).(13.43)DEFINITION552.–Theelementsαi,j+1≤i≤r(uniquelydetermineduptoassociates)arecalledtheinvariantfactorsofthemoduleM.Theintegerk−riscalledtherankofthemoduleM.REMARK553.–Theterminologyof([10],ChapterVII)isslightlydifferentandisjustiﬁedbythefollowingrationale:(i)Ratherthantheelementsαi,j+1≤i≤r,wecan,inamore“intrinsic”manner,considertheidealsgeneratedbytheseelements,i.e.theak−i+1=(αi),j+1≤i≤r.(iii)Inaddition,Φ∼=,r+1≤i≤kR(0);thek−rzeroidealsai(1≤i≤k−r)inthissumcanbetakenintoaccountinthesamewayastheabovenon-zeroidealsai(k−r+1≤i≤k−j).TheinvariantfactorsofM,inthesenseof([10],ChapterVII),areintheendtheprincipalidealsa1,...,ak−j(someofwhichmaybezero);thesearesuchthata1⊂a2...⊂ak−j(cid:5)=RandM∼=,1≤i≤k−jR/ai(13.44)(theprincipalidealsaiareuniquelydeterminedbytheseconditions).Appendix2:Algebra499Wethushavethefollowing:THEOREM554.–LetRbeaprincipalidealdomainandMbeaﬁnitelygeneratedRmodule(or,moregenerally,letRbeanelementarydivisorringandMbeaﬁnitelypresentedR-module).ThenMisthedirectsumofitstorsionsubmoduleT(M)andofafreesubmodule(ofthesamerankasM).Inaddition,T(M)decomposesaccordingto(13.43)asafunctionofitsnon-zeroinvariantfactorsαior(αi)(j+1≤i≤r)andMdecomposesaccordingto(13.44)asafunctionofallitsinvariantfactorsai(1≤i≤k−j)(“canonicaldecompositionofthemoduleM”).PROPOSITION555.–LetRbeaBézoutdomainandMabeaﬁnitelygeneratedR-module.(i)Mdecomposesaccordingto(13.42)(whereΦisafreemodule).(ii)ThemoduleMisfreeifandonlyifitistorsion-free.(iii)SupposenowthatMisﬁnitelypresented;Mhasaleft-regulardeﬁnitionmatrixR,MisfreeifandonlyifRisequivalentto(cid:25)Ir0(cid:26)andMistorsionifandonlyifRisregular.PROOF.(i):See([31],section5.1,Theorem1.3).(ii)isanobviousconsequenceof(i).(iii):AccordingtoTheorem495(section13.2.2),theproblemcomesdowntothecasewherethedeﬁnitionmatrixR∈Rq×kofMisincolumnHermiteform,andthentothecaseq=r(r=rkB)bysuppressingtheq−rtrivialequations0=0.ThemoduleMisfreeifandonlyifRiscompletable,thusequivalentto(cid:25)Ir0(cid:26).Besides,accordingtoTheorem548(i),MistorsionifandonlyifR,nowofrankr,isleft-invertibleoverQ(R),thusinvertibleoverthatﬁeld,andﬁnallyregularoverR.TheoryofelementarydivisorsThecompletetheoryofelementarydivisorsofaﬁnitelygeneratedmoduleMoveraprincipalidealdomainRcanimmediatelybededucedfromTheorem554andfromtheprimarydecompositionofacyclicmodule.Theresultmaybestatedasfollows:THEOREM556.–Let(pi)bearepresentativesystemofprimesinR(section13.1.2).Thereexistintegersµ(0)≥0,ni≥0andµ(πi)≥0,whereπi=pnii,withthefollowingproperties:theseintegersareuniquelydeterminedandarezeroexceptforaﬁnitenumberofthem,andinthedecomposition(13.42),T(M)∼=9i(cid:9)R(πi)(cid:10)µ(πi),Φ∼=Rµ(0).DEFINITION557.–Theπi=pnii,i∈I(ortheideals(πi)theygenerate)arecalledtheelementarydivisorsofmoduleM,andtheintegersµ(πi)aretheirmultiplicities.Ifµ(0)>0,thisinteger(whichistherankofM)iscalledthemultiplicityoftheelementarydivisor0.500LinearSystemsREMARK558.–JustasTheorem554isareformulationofTheorem497(section13.2.3),Theorem556isareformulation(evenmoreprecise)ofwhathasbeenstatedinbeginningofsection13.2.4.Thisiswhythetheoryofmodulespresentedinthissectioncanbeconsideredasalanguage–whichprovestobeextremelyuseful.SmithzerosofamoduleLetR∈Rq×k,whereR=C[∂].TheSmithzerosofRandtheirmultiplicitieshavebeendeﬁnedinsection13.2.5.ThesequantitiesonlydependontheelementarydivisorsofR,whichthemselvesonlydependonT(M),whereM∼=coker(•R).Thesezeroscanthusbecalled,inamoreintrinsicmanner,theSmithzerosofthemoduleT(M)[19].Deﬁnition504(section13.2.5)remainsvalid,mutatismutandis.ForanyﬁnitelygeneratedtorsionR-moduleT,Z(T)denotesthesetofitsSmithzeros(eachofthemrepeatedanumberoftimesequaltoitsdegree)andε(T)denotesthesetofitselementarydivisors(eachofthemrepeatedanumberoftimesequaltoitsmultiplicity).Thefollowingisprovenin[19]:LEMMA559.–LetT1andT2betwoﬁnitelygeneratedtorsionR-modules.(i)IfT2⊂T1,thenZ(T1)=Z(T2)˙∪Z(T1/T2)where˙∪designatesthe“disjointunion”10.(ii)IfT1∩T2=0,thenZ(T1⊕T2)=Z(T1)˙∪Z(T2)andε(T1⊕T2)=ε(T1)˙∪ε(T2).ComplementonquotientmodulesLetRbeaprincipalidealdomain,MbeaﬁnitelygeneratedR-moduleandFbeafreesubmoduleofM.LEMMA560.–(i)ThereexistsamaximalfreesubmoduleΦFofMwhichcontainsF.(ii)WehaveM=T(M)⊕ΦF.PROOF.*(i):LetLFbethesetofallfreesubmodulesofMthatcontainsF,orderedbyinclusion.Thissetisinductive;indeed,letCbeachainofLF,i.e.atotallyorderedsubset,andF1=:L∈LFL;thenthesubmoduleF1ofMistorsion-free,anditisfreeaccordingtoProposition555(ii);itcontainsF,thusitbelongstoCandisitslargestelement.Statement(i)thereforederivesfromtheZornLemma.(ii):SupposeT(M)⊕ΦF(cid:5)=Mandletm∈M,m/∈T(M)⊕ΦF;thenΦF(cid:5)=[m]R+ΦFandmisafreeelement,thusthemodule[m]R+ΦFistorsion-free,andsoisfree;thismodulethusbelongstoLF,whichcontradictsthefactthatΦFisamaximalelementofthisset.*LetNbeasubmoduleofM;accordingtoProposition555(i),thereexistsafreesubmoduleFofNsuchthatN=T(N)⊕F.WehaveT(N)⊂T(M)and10.Forexample,{x,y}˙∪{x,z}={x,x,y,z}([91],sectionI.8).Appendix2:Algebra501accordingtoLemma560,thereexistsafreesubmoduleΦFofMsuchthatM=T(M)⊕ΦFandF⊂ΦF.WritingΦN=ΦF,weobtainthefollowing:PROPOSITION561.–ThereexistsafreesubmoduleΦNofMsuchthatM=T(M)⊕ΦNandN=T(N)⊕(ΦN∩N).IfΦ(cid:2)NisanotherfreesubmoduleofMsuchthatM=T(M)⊕Φ(cid:2)NandN=T(N)⊕(Φ(cid:2)N∩N),thenΦ(cid:2)N∼=ΦNandΦ(cid:2)N/(Φ(cid:2)N∩N)∼=ΦN/(ΦN∩N).PROOF.WehaveF=ΦN∩F=ΦN∩N.AssumeΦ(cid:2)Nisfree,M=T(M)⊕Φ(cid:2)NandN=T(N)⊕(Φ(cid:2)N∩N).ThenΦ(cid:2)N∼=M/T(M)∼=ΦN;inaddition,T(N)⊆T(M)andΦN∩N⊆N,Φ(cid:2)N∩N⊆N,thusbyTheorem538,bothmodulesbelowareisomorphictoM/N:T(M)/T(N)⊕ΦN/(ΦN∩N)∼=T(M)/T(N)⊕Φ(cid:2)N/(Φ(cid:2)N∩N),henceΦN/(ΦN∩N)∼=Φ(cid:2)N/(Φ(cid:2)N∩N)by([31],section8.2,Corollary2.5).13.4.3.StructureofendomorphismsInthisparagraph,RistheprincipalidealdomainK[∂],whereK=RorC;∂istheindeterminateandthusinprincipleplaysapurelyformalrole,butitisconvenienttothinkof∂astheusualderivatived/dt.CompanionmatricesassociatedwithacyclicmoduleSinceRisaprincipalidealdomain,everyidealainRisprincipal,andthusisoftheformRa=(a),a∈R.Asaresult,ifΓ=[w]RisacyclicR-module,thereexistsapolynomiala=a(∂)∈R(chosentobemonic)suchthatΓ∼=R(a)anda(∂)issuchthata(∂)w=0.(13.45)Wesaythatequation(13.45)isanon-trivialhomogenousdifferentialequationif0(cid:5)=a(∂)isanon-invertiblepolynomial(i.e.ofdegree≥1).LetΓbethecyclicmodulewithgeneratorwdeﬁnedby(13.45),wherea(∂)(cid:5)=0isamonicpolynomialofdegreen≥1,thatisa(∂)=∂n+a1∂n−1+...+an,ai∈K.502LinearSystemsWritexi=∂n−iw(1≤i≤n)andx=(cid:25)x1···xn(cid:26)T.Weget∂x=⎡⎢⎢⎢⎢⎢⎢⎣−a1−a2······−an1000.....................00···010⎤⎥⎥⎥⎥⎥⎥⎦x,(13.46)∂xT=xT⎡⎢⎢⎢⎢⎢⎢⎢⎣−a110···0−a20.....................0............1−an···000⎤⎥⎥⎥⎥⎥⎥⎥⎦.(13.47)ThematricesC1(a)andC2(a)intheright-handmemberof(13.46)and(13.47)arecalledthecompanionmatricesofthepolynomiala(∂).ThereexisttwoothercompanionmatricesC3(a)andC4(a),obtainedbywritingtheequations∂η=C3(a)ηand∂ηT=ηTC4(a),withη=(cid:25)xn···x1(cid:26)T.TheexplicitexpressionsofC3(a)andC4(a)arelefttothereader.PROPOSITION562.–(i)ThecharacteristicpolynomialofthecompanionmatricesCi(a),i∈{1,...,4},isa=a(∂).(ii)ThecyclicmoduleΓ∼=R(a),consideredasaK-vectorspace(denotedasEa)isofdimensionn=d◦(a).PROOF.(i)Weobtaindet(∂In−C1(a))=a(∂)bydevelopingthisdeterminantwithrespecttotheﬁrstrow.Theothercompanionmatricesofa(∂)aresimilartoC1(a)(since,accordingtoProposition534ofsection13.3.4,amatrixissimilartoitstranspose),andthushavethesamecharacteristicpolynomialasthismatrix.(ii)Accordingto(13.46),theelementsx1,...,xnareK-linearlyindependentand(xi)1≤i≤nisabasisofEa.REMARK563.–(i)Themapping∂:M→MisK-linear,thusisanendomorphismAaofEa.Since(cid:31)xn,∂xn,...,∂n−1xn isabasisofEa,thisvectorspaceisAa-cyclicandtheabovebasisisAa-cyclic(section13.3.4).ThevectorxnisanAa-cyclicgeneratorofEa(andoftheabovebasis).AnymatrixrepresentingtheendomorphismAaofEaissimilartoacompanionmatrixofa(∂)andissaidtobecyclic.(ii)Lety=(cid:11)1≤i≤nYixi∈EaandletY=[Y1...Yn]betherowrepresentingyinthebasisx=(xi)1≤i≤n=[x1...xn]T(seeRemark542,section13.4.1).Sincey=Yx,theendomorphism∂=AaisthemapY(cid:3)→YC1(a)inthebasisx.Appendix2:Algebra503REMARK564.–Inwhatfollows,C(a)designatesoneofthecompanionformsCm(a),wherem∈{1,...,4}ischosenonceandforall.RationalcanonicalformofanendomorphismConsiderthedifferentialequation∂x=Ax(13.48)whereA∈Kn×nrepresents,inthebasisx=(xi)1≤i≤nofE∼=Kn,anendomorphismu(adoptingtheconventioninRemark542ofsection13.4.1).Thedifferentialequation(13.48)isalsowrittenasR(∂)x=0,whereR(∂)=∂In−A.AccordingtoCorollary555(ii)(section13.4.2),itdeﬁnesaﬁnitelygeneratedtorsionR-moduleM.Themap∂:M→Misidentiﬁedwithu.11Theseobservationscanbecompletedbythefollowing:THEOREM565.–LetMbeaﬁnitelygeneratedR-module.ThemoduleMistorsionifandonlyifitisaﬁnite-dimensionalK-vectorspace.PROOF.(i)IfMistorsion,thenM=T(M)satisﬁestherelation(13.43)ofsection13.4.2andeachcyclictorsionmoduleR(αi)isaﬁnite-dimensionalK-vectorspaceaccordingtoProposition562.(ii)Conversely,letMbeanR-modulewhichisaﬁnite-dimensionalK-vectorspaceandlet(xi)1≤i≤nbeabasisofM.Foranyi∈{1,...,n},∂xiisaK-linearcombinationofthexk,1≤k≤n,thusthereexistsamatrixA∈Kn×nsuchthattherelation(13.48)issatisﬁed.ThemoduleMisthustorsion.ThetorsionmoduleM=T(M)deﬁnedby(13.48)admitsdecomposition(13.43).LetEαibethecyclicmoduleR(αi)(j+1≤i≤r),consideredasaK-vectorspace.AccordingtoRemark563,∂:R(αi)→R(αi)isanendomorphismAαiofEαiandthelatterspaceisAαi-cyclic.InanAαi-cyclicbasis,AαiisthusrepresentedbyacompanionmatrixC(αi).Wehavethereforethefollowing:THEOREM566.–LetEbeaﬁnite-dimensionalK-vectorspaceandletubeanendomorphismofE.(i)Ecanbeexpressedasadirectsumofu-cyclicsubspacesE=,j+1≤i≤rEαi(13.49)suchthattherestrictionAαiofutoEαiisrepresented,inau-cyclicbasis,byacompanionmatrixC(αi).(ii)Thepolynomialsαi(∂)(j+1≤i≤r)arethe11.Herewetakeadvantageofthefactthattheindeterminate∂isidentiﬁedwithd/dt.Anequivalentbutmoreabstractapproachconsistsinusingtheformalismof([10],sectionVII.5).504LinearSystemssimilarityinvariantsofu(section13.3.4);iftheseareorderedinsuchawaythatαi|αi+1(j+1≤i≤r−1),thedecomposition(13.49)isunique.(iii)Intheconcatenationoftheaboveu-cyclicbases,theendomorphismuisrepresentedbythediagonalsum9j+1≤i≤rC(αi)(“rationalcanonicalformoftheendomorphismu”).DEFINITION567.–Thenumberoftermsofthesum(13.39)(i.e.r−j)iscalledthecyclicindexofu.Theendomorphismuissaidtobecyclicifitscyclicindexisequalto1(thatisifuisrepresentablebyacyclicmatrixinanybasisandbyacompanionmatrixinau-cyclicbasis:seeRemark563).Recallthattheminimalpolynomialofuisαr(∂)andthatitscharacteristicpolynomialis(j+1≤i≤rαi(∂)(Proposition536,section13.3.4).WededucefromTheorem566thefollowing:COROLLARY568.–Anendomorphismiscyclicifandonlyifitsminimalpolynomialisequaltoitscharacteristicpolynomial.JordanformLetK=C;thenaprimepolynomialp(∂)isoftheform∂−r,r∈C,andanelementarydivisorisoftheformπ(∂)=(∂−r)k.AnindecomposablemoduleR(π)isaC-vectorspaceEπ.LetvbeageneratorofR(π),suchthat(∂−r)kv=0.PutXk−i=(∂−r)iv,1≤i≤k,andX=(cid:25)X1···Xk(cid:26)T.Weobtain∂X=Jr,kXwhereJr,kistheJordanblockoforderkrelativetorasdeﬁnedinsection13.3.4;Jr,krepresentstheendomorphism∂:R(π)→R(π)inthebasisXofEπ.Theorem530(section13.3.4)isnowadirectconsequenceofTheorem556(section13.4.2),byconcatenatingthebasesconstructedhereaboveforeachC-vectorspaceEπ,asπspansthesetofelementarydivisorsoftheendomorphismu(andtakingintoaccounttheirmultiplicities).13.5.OrthogonalityandsymmetryInwhatfollows,EisaHilbertspaceofﬁnitedimensionnoverK,whereK=RorC.Thisspaceisequippedwithascalarproduct .,.!(seesection12.1.2).Wewillbecarefulnottoconfusethelatterwithadualitybracket.Appendix2:Algebra50513.5.1.OrthonormalbasisLetB=(ei)1≤i≤nbeabasisofE.Thisbasisissaidtobeorthonormalif ei,ej!=δij,whereδijistheKroneckerindex(seesection13.3.2).Oneshows,usingthe“Gram-Schmidtorthogonalizationprinciple”(see,e.g.[91],aswellastheproofofTheorem579atsection13.5.7)thatwecanalwayschooseanorthonormalbasisinE.LetxandybetwovectorsofEwithcomponentsx1,...,xnandy1,...,yn,respectively,inthisbasis.Wehave x,y!=;n(cid:12)i=1xiei,n(cid:12)j=1yjej<=n(cid:12)i=1n(cid:12)j=1¯xiyj ei,ej!=n(cid:12)i=1¯xiyi=X∗Y(13.50)whereX=[x1...xn]T,Y=[y1...yn]TandwhereX∗=[¯x1...¯xn]T(conjugatetransposeofX).Thequantityintheright-handsideof(13.50)isthe“standardscalarproduct”onKn(thevector(x1,...,xn)ofthisspaceisidentiﬁedwiththecolumnmatrixX=[x1,...,xn]Twhichrepresentsitinthecanonicalbasis)and(13.50)makesitpossibletoidentifythespaceEwithKnequippedwiththestandardscalarproduct.13.5.2.OrthogonalityTwovectorsxandyaresaidtobeorthogonal(x⊥y)if x,y!=0.IfFisasubspaceofE,thesetofvectorsofEwhichareorthogonaltoallvectorsofFisasubspaceofE,calledtheorthogonalofF(anddenotedasF⊥).ItisimmediatethatF∩F⊥=0.OnecanalsoshowthatF+F⊥=E.Thus,FandF⊥aresupplementary.WecallF⊥theorthogonalsupplementofF,andEthe“orthogonaldirectsum”ofFandF⊥,whichwewriteasE=F⊥⊕F⊥.OnecanalsoshowthatF⊥⊥=F.NotethatFdoesnothaveauniquesupplement(asidefromthetrivialcasewhereF=0orF=E),whileFhasbydeﬁnitionauniqueorthogonalsupplement.506LinearSystems13.5.3.AdjointendomorphismTHEOREM569.–LetubeanendomorphismofE.Thereexistsauniqueendomorphismu∗ofE,calledtheadjointofu,suchthatforanyx,y∈E x,uy!= u∗x,y!.(13.51)Morespeciﬁcally,letA=(aij)bethematrixrepresentinguinanorthonormalbasisB;u∗istheendomorphismrepresented,inthissamebasis,byA∗(cid:1)¯AT=(¯aji)(conjugatetransposeofA).PROOF.Letz=uy.Accordingto(13.21),therepresentativeofzinthebasisBisZ=AY.Thus,by(13.50), x,uy!=X∗AY=(A∗X)∗Yandthetheoremisproven.PropertiesoftheadjointTHEOREM570.–(i)WehaveE=keru⊥⊕imu∗.(13.52)(ii)Themappingu→u∗isantilinear(section12.1.2)and(u∗)∗=u.(iii)Ifλisaneigenvalueofu,then¯λisaneigenvalueofu∗anddimker(λIE−u)=dimker(cid:15)¯λIE−u∗(cid:16).(iv)detu∗=detu.PROOF.(i)derivesfromthefollowingobservation:anelementofkeruisavectoryofEsuchthatuyisorthogonaltoallvectorsxofEandby(13.51)thisinturnmeansthatyisorthogonaltoimu∗.Theproofof(ii)iseasy.(iii)canbeprovedinthefollowingmanner:accordingto(13.52)wehaveforanyλ∈C,E=ker(λIE−u)⊥⊕im(cid:15)¯λIE−u∗(cid:16),thusrk(cid:15)¯λIE−u∗(cid:16)=n−dimker(λIE−u).Now,dimker(cid:15)¯λIE−u∗(cid:16)=n−rk(cid:15)¯λIE−u∗(cid:16)accordingto(13.20)(section13.3.2)andthusdimker(cid:15)¯λIE−u∗(cid:16)=dimker(λIE−u).(iv)isprovedasfollows:iftheendomorphismuisrepresentedinanorthonormalbasisbythematrixA,wehavedetu=detA=det¯A=det¯AT(seesection13.1.4orProposition534),fromwhichwegetdetu=detu∗.Appendix2:Algebra50713.5.4.UnitaryendomorphismAnendomorphismuissaidtobeunitaryifitpreservesthescalarproduct,thatisifforanyx,y∈E ux,uy!= x,y!.Thisisequivalentto u∗ux,y!= x,y!,thusalsotou∗=u−1.(13.53)Anendomorphismisunitaryifandonlyifittransformsanorthonormalbasisintoanotherorthonormalbasis.LetAbethematrixrepresentinganendomorphismuinanorthonormalbasis;itisclearthatuisunitaryifandonlyifA∗=A−1.(13.54)Amatrixsatisfying(13.54)issaidtobeunitary,andorthogonalifK=R(inthiscase,A∗=AT).Accordingtotheproperty(iv)inTheorem570and(13.53),iftheendomorphismuisaunitary,wehavedetu=±1.13.5.5.NormalendomorphismDEFINITION571.–AnendomorphismuofEissaidtobenormalifitcommuteswithitsadjoint:uu∗=u∗u.THEOREM572.–Letubeanormalendomorphism.(i)Foranyeigenvalueλofu,ker(λIE−u)=ker(cid:15)¯λIE−u∗(cid:16).(ii)Theendomorphismuisdiagonalizableinanorthonormalbasis.(iii)Conversely,adiagonalizableendomorphismuinanorthonormalbasisisnormal.PROOF.(i)Letλbeaneigenvalueofuandwritev=u−λIE.Itisclearthatavectorxisaneigenvectorofuassociatedwiththeeigenvalueλif,andonlyifxisaneigenvectorofvassociatedwiththeeigenvalue0.Onesuchvectorcanbetakentobeunitary.Inaddition,visanormalendomorphism.Thenlety=v∗x.Wehave(cid:23)y(cid:23)2= v∗x,v∗x!= vv∗x,x!= v∗vx,x!=0.Asaresult,y=0andxisaneigenvectorofv∗associatedwiththeeigenvalue0.Conversely,changingvtov∗,itisclearthatanyeigenvectorofv∗associatedwiththe508LinearSystemseigenvalue0isaneigenvectorofvassociatedwiththissameeigenvalue.Itfollowsthatkerv=kerv∗.(ii)Wethushave(kerv)⊥=(kerv∗)⊥=imvaccordingto(13.52)(section13.5.3).Therefore,therestrictionofvtoimvisinjective.Theonlyelementarydivisorsofvthataremultiplesofsarethereforeequaltos,becauseifthereexistsanintegerm>1andavectorxsuchthatvmx=0,wehavev(cid:15)vm−1x(cid:16)=0,thusvm−1x=0;byinduction,weobtainvx=0.Therootsoftheminimalpolynomialqu(s)arethussimple,whichprovesthatuisdiagonalizable(section13.3.4,Corollary532).Supposethatv,whichhasaneigenvalue0,alsohasanon-zeroeigenvalue˜µ.Letusshowthatkerv⊥ker(v−˜µIE).Letx∈kerv=kerv∗andy∈ker(v−˜µIE).Fromthefactthatv∗x=0,weget˜µ x,y!= x,˜µy!= x,vy!= v∗x,y!=0thus x,y!=0.Consideragaintheendomorphismu:wehavejustshownthatifλandµaretwodistincteigenvaluesofu,thenker(λIE−u)⊥ker(µIE−u).AccordingtotheGram-Schmidtorthogonalizationprinciple,wecanchooseanorthonormalbasisineacheigenspaceofu.TheconcatenationofthesebasesisanorthonormalbasisofEinwhichudiagonalizes.(iii)Letubeanendomorphism,representedinanorthonormalbasisbyadiagonalmatrixΛ=diag(λ1,...,λn).WehaveΛ∗=diag(cid:15)¯λ1,...,¯λn(cid:16),thusΛΛ∗=Λ∗Λ=diag(cid:9)|λ1|2,...,|λn|2(cid:10).13.5.6.Self-adjointendomorphismGeneralcaseDEFINITION573.–AnendomorphismuofEissaidtobeself-adjointifu∗=u.Letubeanendomorphismrepresented,inanorthonormalbasisB,byamatrixA;itisclearthatuisself-adjointifandonlyifA∗=A.OnesuchmatrixAissaidtobeHermitian(andsymmetricifK=R;inthiscase,A∗=AT).THEOREM574.–Aself-adjointendomorphismisdiagonalizableinanorthonormalbasisandallitseigenvaluesarereal.PROOF.Aself-adjointendomorphismuisnormal,thusisdiagonalizableinanorthonormalbasis.Inaddition,byTheorem572(i)(section13.5.5),foranyeigenvalueλofu,ker(λIE−u)=ker(cid:15)¯λIE−u(cid:16),thusλ=¯λ.Non-negativeorpositiveself-adjointendomorphismsDEFINITION575.–Aself-adjointendomorphismuissaidtobenon-negative(resp.,positive),12whichwecanwriteasu≥0(resp.,u>0)ifallitseigenvaluesare12.Suchanendomorphismisalsocallednon-negativedeﬁnite(resp.,positivedeﬁnite).Appendix2:Algebra509non-negative(resp.,positive);amatrixArepresentinguinanorthonormalbasisissaidtobeHermitian(symmetricifK=R)non-negative(resp.,positive)deﬁnite,whichwewriteasA≥0(resp.,A>0).Itisclearthatapositiveself-adjointendomorphismisinvertibleandisthusanautomorphism(seesection13.3.3).Letubeaself-adjointendomorphismandx=n(cid:12)k=1xkekbeavectorofE,where{e1,...,ek}isanorthonormalbasisofEformedbytheeigenvectorsofu,ekbeingassociatedwiththeeigenvalueλk.Wehave x,ux!=;n(cid:12)k=1xkek,n(cid:12)k=1xkλkek<=n(cid:12)k=1λk|xk|2.(13.55)Asaresult,–uisnon-negativeifandonlyif x,ux!≥0foranyx∈E.–uispositiveifandonlyif x,ux!>0foranyvectorx(cid:5)=0ofE.By(13.55),ifuisanon-negativeself-adjointendomorphism,wehavetheinequality x,ux!≤λmax(u)(cid:23)x(cid:23)2whereλmax(u)isthelargesteigenvalueofu.Inaddition,thetwosidesofthisinequalitybecomeequalwhenxisaneigenvectorassociatedwiththeeigenvalueλmax(u).Therefore,max(cid:10)x(cid:10)=1% x,ux!=%λmax(u).(13.56)Theproofofthefollowingisstraightforward:PROPOSITION576.–LetbetheHermitianmatrixA=(cid:27)A11A12A∗12A22(cid:28)whereA11>0.ThenA=(cid:27)I0A∗12A−111I(cid:28)(cid:27)A1100C(cid:28)(cid:27)I0A∗12A−111I(cid:28)∗,C=A22−A∗12A−111A12andA≥0(resp.,A>0)ifandonlyifC≥0(resp.,C>0).510LinearSystemsSquarerootsofaHermitianmatrixWewilldeﬁnetheHermitiansquarerootofanendomorphismu≥0(or,inanequivalentmanner,oftheHermitianmatrixQ≥0whichrepresentsitinanorthonormalbasis).OnesuchmatrixQdiagonalizesinanorthonormalbasis,thusthereexistsanunitarymatrixUsuchthatQ=U∗ΛU,whereΛ=diag{λ1,...,λn}andtheλi’saretheeigenvaluesofQ.SinceQ≥0,theλiarerealnumbers≥0.Write√Λ=diag(cid:31)√λ1,...,√λn .TheHermitiansquarerootofQisdeﬁnedby%Q=U∗√ΛU.Thisterminologyisjustiﬁedbythefollowingtwoproperties:(i)√Q≥0;(ii)√Q√Q=Q.Moregenerally,asquarematrixQofordernisHermitian(resp.symmetricreal)non-negativedeﬁniteifandonlyifthereexistsamatrixEwithcomplex(resp.,real)entriessuchthatQ=E∗E(resp.,Q=ETE)andthismatrixEcanbechosentobeleft-regular,thatishavingrrowsandncolumns,wherer=rkQ.Theabovelatterassertioncanbeprovedasfollows:letQbeaHermitiannon-negativedeﬁnitematrixofordernandofrankr,letλ1,...,λrbethenon-zeroeigenvaluesofQandletΛ0=diag{λ1,...,λr}.ThereexistsaunitarymatrixUsuchthatQ=U∗(cid:15)Λ0⊕0(cid:16)U=E∗EwhereE=(cid:25)Λ00(cid:26).AnymatrixEsuchthatQ=E∗EiscalledasquarerootofQ.Forexample,(cid:25)√20(cid:26)and(cid:25)−√20(cid:26)aretwoleft-regularsquarerootsofthematrix(cid:27)2000(cid:28)anditsuniquesymmetricsquarerootis(cid:27)√2000(cid:28).Asacomplement,seeCorollary586(section13.5.7).13.5.7.SingularvaluesNormofoperatorsinHilbertspacesLetEandFbetwoﬁnite-dimensionalHilbertspacesandletubeahomomorphismfromEintoF.Accordingtosection12.1.3,thenormofu(inducedbythenormsofEandF)isdeﬁnedby13(cid:23)u(cid:23)(cid:1)max(cid:10)x(cid:10)=1(cid:23)ux(cid:23).(13.57)13.Thefunctionx→(cid:1)ux(cid:1)iscontinuousinthecompactset(cid:1)x(cid:1)=1,andthusadmitsamaximuminthisset.Wethuscanreplacethesupbymax.Appendix2:Algebra511THEOREM577.–Foreveryhomomorphismu:E→F,wehavetheequality(cid:23)u(cid:23)=(cid:23)u∗(cid:23)=%λmax(u∗u)(cid:1)¯σ(u).PROOF.Wehave(cid:23)ux(cid:23)2= ux,ux!= u∗ux,x!andu∗uisclearlyanon-negativeself-adjointendomorphismofE.Wehavethusforanyx(cid:5)=0(cid:23)ux(cid:23)=% u∗ux,x!.Inaddition,accordingto(13.56)(section13.5.6),themaximum(13.57)isattainedbyputtingxasaunitaryeigenvectorofu∗uassociatedwiththelargesteigenvalueofthisendomorphism.Fortheequality(cid:23)u(cid:23)=(cid:23)u∗(cid:23),see([35],(11.5.2)).SupposethattheabovespacesEandFareofdimensionnandmrespectivelyandthatorthonormalbasesarechoseninthesetwospaces.Inthesebases,thehomomorphismuisrepresentedbyamatrixA∈Km×n.The“operatornorm”ofthismatrixisdeﬁnedby(cid:23)A(cid:23)=(cid:23)u(cid:23)andthisquantity¯σ(u)isequallydenotedas¯σ(A).Thisnormisclearlymultiplicative(seesection12.1.3).Notethataunitaryendomorphismhasanoperatornormequalto1;thisalsoholdsforaunitary(ororthogonal)matrix.Onecaneasilyshowthefollowingresult(seeforexample[35],(11.1.3)):PROPOSITION578.–LetA∈Kn×n;everyeigenvalueλofAsatisﬁes|λ|≤¯σ(A).SingularvaluedecompositionTHEOREM579.–LetA∈Km×n.Thereexistunitary(ororthogonalifK=R)matricesU∈Km×mandV∈Kn×nsuchthatU∗AV=diag(σ1,...,σp)∈Km×n,p=min(m,n),(13.58)whereσ1≥...≥σp≥0.Thesequantitiesσiareuniquelydetermined.Wehaveσ1=¯σ(A)andthelargestintegerrsuchthatσr(cid:5)=0istherankofA.PROOF.Accordingtotheabove,thereexistsaunitarycolumnvectoru1∈Knsuchthat(cid:23)Au1(cid:23)=σ1,whereσ1=¯σ(A).Therethusexistsaunitarycolumnvectorv1inKmsuchthatAu1=σ1v1.TheGram-Schmidtorthogonalizationprinciple,appliedtoKn,canbeexpressedasfollows:thereexistsamatrixV1∈Kn×(n−1)suchthat512LinearSystemsV=(cid:25)v1V1(cid:26)isaunitarymatrix.Similarly,thereexistsamatrixU1∈Km×(m−1)suchthatU=(cid:25)u1U1(cid:26)isaunitarymatrix.OneeasilyshowsthatU∗AVhasthefollowingstructure:U∗AV=(cid:27)σ1w∗0B(cid:28)(cid:1)A1.Wethushave(cid:23)A1(cid:23)≤(cid:23)U∗(cid:23)(cid:23)A(cid:23)(cid:23)V(cid:23)=(cid:23)A(cid:23).Ontheotherhand,A=UA1V∗,thus(cid:23)A(cid:23)≤(cid:23)U(cid:23)(cid:23)A1(cid:23)(cid:23)V∗(cid:23)=(cid:23)A1(cid:23).Consequently,(cid:23)A(cid:23)=(cid:23)A1(cid:23).Thecolumnvectorz=(cid:25)σ1wT(cid:26)Tissuchthat(cid:23)A1z(cid:23)2≥(cid:15)σ21+w∗w(cid:16)2=(cid:15)σ21+w∗w(cid:16)(cid:23)z(cid:23)2whichimpliesthat(cid:23)A1(cid:23)2≥σ21+w∗w.Butsince(cid:23)A1(cid:23)=(cid:23)A(cid:23)=σ1,thisimpliesw=0,fromwhichA1=σ1⊕Bwith(cid:23)B(cid:23)≤σ1.Continuingthisway,weobtaintheresultbyinduction.DEFINITION580.–Thequantitiesσi(1≤i≤p)arecalledthesingularvaluesofA.Theexpression(13.58)iscalledthesingularvaluedecompositionofA.14PROPOSITION581.–(i)LetA∈Km×nbeamatrixofrankrandσi(A),1≤i≤rbeitsnon-zerosingularvalues.Wehaveσi(A)=%λi(AA∗)=%λi(A∗A),1≤i≤r,whereλi(.)istheitheigenvalueofthematrixinparentheses(theseeigenvaluesarrangedindecreasingorder).(ii)AandA∗havethesamesingularvalues.(iii)LetA∈Kn×nbeaninvertiblematrix.Thenσi(cid:15)A−1(cid:16)=1σn−i+1(A).Inparticular,¯σ(cid:15)A−1(cid:16)=1σ(A),where¯σandσdenotethelargestandsmallestsingularvaluerespectively.PROOF.(i)LetΣ=diag(σ1,...,σr).Accordingto(13.58),wehaveU∗AV=(cid:27)Σ000(cid:28),thusU∗AA∗U=U∗AV(U∗AV)∗=(cid:27)Σ2000(cid:28);similarly,V∗A∗AV=(U∗AV)∗U∗AV,thus(i)isproven.(ii)isanimmediateconsequenceof(i).(iii)Letσi,1≤i≤n,bethesingularvaluesofA,arrangedindecreasingorder(theyareallnon-zero).Accordingto(13.58),thereexistunitarymatricesUandVsuchthatU∗AV=diag{σi},thusV∗A−1U=diag(cid:31)σ−1i (sinceU−1=U∗andV−1=V∗).ThesingularvaluesofA−1,arrangedindecreasingorder,arethusσ−1n,...,σ−11,whichproves(iii).14.Onecandeﬁnethesingularvaluedecompositionofahomomorphism,butthepresentationisfacilitatedbychoosingbasesandbyreasoningonthematrixrepresentingthishomomorphisminthechosenbases,aswhatwehavedonehere.Appendix2:Algebra513Pseudo-inverseGeneralcaseLetA∈Km×nbeamatrixofrankr≤min(n,m).LetΣ=diag(σ1,...,σr),whereσ1≥...≥σrarethenon-zerosingularvaluesofA.Thesingularvaluedecompositiontheorem(Theorem579)showsthatthereexisttwounitarymatricesU∈Km×mandV∈Kn×nsuchthatA=U(Σ⊕0)V∗.DEFINITION582.–Wecallapseudo-inverseofAamatrixA†∈Kn×msuchthatA†=V(cid:15)Σ−1⊕0(cid:16)U∗.Left-inversePROPOSITION583.–Supposer=n(whichimpliesm≥n).(i)ThematrixAisleft-invertibleandA†isaleft-inverseofA,thatisA†A=In;aleft-inverseisnon-uniqueifm>n.(ii)WehaveA†=(A∗A)−1A∗.PROOF.(i)WecanwriteAintheformA=U(cid:27)Σ0(cid:28)V∗,thereforeA†=V(cid:25)Σ−10(cid:26)U∗.WededucethatA†A=V(cid:25)Σ−10(cid:26)U∗U(cid:27)Σ0(cid:28)V∗=In.Inaddition,thereisnon-uniquenessinthecasem>nbecauseinthatcasethereexistseveralsolutionsLtotheequationLA=In,sincetherearenmunknownsinLforn2equations.Thisproves(i).(ii)Ontheotherhand,A∗A=V[Σ0]U∗U(cid:27)Σ0(cid:28)V∗=VΣ2V∗thus(A∗A)−1A∗=VΣ−2V∗V[Σ0]U∗=V(cid:25)Σ−10(cid:26)U∗=A†whichproves(ii).514LinearSystemsRight-inverseInterchangingtherolesofAandA∗,weobtainthefollowing:PROPOSITION584.–Supposethatr=m(whichimpliesn≥m).(i)ThematrixAisright-invertibleandA†isaright-inverseofA,thatisAA†=Im;aright-inverseisnon-uniqueifn>m.(ii)WehaveA†=A∗(AA∗)−1.ConditionnumberofamatrixDEFINITION585.–LetA∈Kn×nbeaninvertiblematrix.TheconditionnumberofthematrixAisthenumberκ(A)deﬁnedby:κ(A)=¯σ(A)σ(A)=(cid:23)A(cid:23)(cid:29)(cid:29)A−1(cid:29)(cid:29).Whenκ(A)isverylarge,thematrixAissaidtobeill-conditioned.Suchamatrixposesdifﬁcultiesindigitalcomputation:see[56].RelationsbetweensquarerootsofamatrixLetA∈Kr×nandB∈Kr×nbetwosquarerootsofthesamematrixQ∈Kn×n,Q≥0,and,forthesakeofsimplicity,supposethatAandBareleft-regular,thatisr=rkQ.ThefollowingresultisaconsequenceofTheorem579:COROLLARY586.–(i)ThereexistsaunitarymatrixU∈Kr×rsuchthatB=UA.(ii)Conversely,ifA∈Kr×nisasquarerootofQ≥0andifU∈Kr×risunitary,thenB=UAisagainasquarerootofQ.PROOF.(i)AccordingtoTheorem579,thereexisttwounitarymatrices˜UandVsuchthatA=˜U∗(cid:25)Σ0(cid:26)V,whereΣ=diag(σ1,...,σr)isthediagonalmatrixformedbythenon-zerosingularvaluesofA.WethushaveA∗A=V∗(cid:27)Σ∗0(cid:28)˜U˜U∗(cid:25)Σ0(cid:26)V=V∗(cid:27)Σ2000(cid:28)V.SinceA∗A=B∗B,thereexistsaunitarymatrixWsuchthatB=W∗(cid:25)Σ0(cid:26)V=W∗˜UA=UAwhereU(cid:1)W∗˜U∈Kr×risunitary.(ii)isobvious.Appendix2:Algebra51513.6.Fractionsandspecialrings13.6.1.RationalfunctionsSetK(s)p×mArationalfunctionf(s),withcoefﬁcientsintheﬁeldK=RorC,isthequotientoftwopolynomialswithcoefﬁcientsinK:f(s)=N(s)D(s)(13.59)whereD(s)isnotthezeropolynomial.ThesetoftheserationalfunctionsisdenotedbyK(s).ThissetisbothaﬁeldandaK-vectorspace,thusaK-algebra.ThesetofmatricesofrationalfractionswithprowsandmcolumnsisdenotedbyK(s)p×m.ThissetisbothaK-vectorspaceandaK(s)-vectorspace.Inaddition,wecanformtheproductofanytwoelementsofK(s)n×nandthisproductbelongstothissetwhichisthusaring(thisringisnon-commutativeifn>1),andthereforeaK(s)-algebra;thisalgebraisunitary,withunitelementIn.IrreduciblerationalfunctionsTherationalfunction(13.59)isirreducibleifN(s)andD(s)havenocommonfactor.Wecancomebacktothatcase,bycancelingthecommonfactors(ifany).Therefore,allrationalfunctionsareassumedtobeirreducibleinthesequel.Poles,zerosandresiduesArationalfunctionisameromorphicfunctionofaspecialkind,thusazero,apoleandtheirmultiplicities,aswellastheresidueatapole,aredeﬁnedforarationalfunctionasforameromorphicfunction(section12.4.1).Morespeciﬁcally,thezerosoff(s)aretherootsz1,...,zmofN(s)inC(withm=d◦(N)),whilethepolesofthisrationalfunctionaretherootsp1,...,pnofD(s)inC(withn=d◦(D)).LetZ(resp.,P)bethesetofdistinctzeros(resp.,poles)off(s).Therelativedegreeoff(s)istherationalintegerδ(f)=n−m,while−δ(f)issometimescalledthedegreeoff(see[10],ChapterIV),generalizingthenotionofdegreeofapolynomial.Iffandgaretworationalfunctions,thenδ(fg)=δ(f)+δ(g).BehavioratinﬁnityArationalfractionf(s)issaidtobeproper(resp.,strictlyproper,biproper)ifδ(f)≥0(resp.,δ(f)>0,δ(f)=0).Arationalfunctionthatisnotproperissaidtobeimproper.Itisclearthat516LinearSystemsf(s)isproperifandonlyiflim|s|→+∞|f(s)|<+∞;f(s)isstrictlyproperifandonlyiflim|s|→+∞|f(s)|=0;f(s)isbiproperifandonlyiflim|s|→+∞|f(s)|∈R(cid:2){0}.Moregenerally,amatrixG(s)belongingtoR(s)p×missaidtobeproper(resp.,strictlyproper)ifallitselementsareproper(resp.,strictlyproper).Itissaidtobebiproperifp=m,G(s)isinvertibleandproper,andG−1(s)isproper.DecompositionintosimpleelementsinC(s)PerformingtheEuclideandivisionofN(s)byD(s)(seesection13.1.3),weobtainN(s)=D(s)Q(s)+R(s),wherethequotientQ(s)isapolynomialandwheretheremainderR(s)isapolynomialsuchthatd◦(R)<d◦(D).Asaresult,f(s)=Q(s)+R(s)D(s)=Q(s)+g(s)(13.60)whereg(s)=R(s)D(s)isastrictlyproperrationalfunction.Thisdecompositionisunique.Ontheotherhand,g(s)=(cid:12)p∈P(cid:12)1≤j≤nPαpj(s−p)j(13.61)whereαpj∈C.Recallthatthecomplexnumberαp1istheresidueRes(f;p)offatthepolep(section12.4.1).13.6.2.Algebra(cid:1)H∞DeﬁnitionWedenoteby(cid:1)H∞thesetofrationalfunctionswithrealcoefﬁcients,whichi)areproper,ii)havenopolesintheclosedrighthalf-plane¯C+={s:Re(s)≥0}.Thering(cid:1)H∞Thesumoftwoelementsof(cid:1)H∞belongsto(cid:1)H∞.Theelementf(s)∈(cid:1)H∞hasanopposite−f(s).Theproductoftwoelementsof(cid:1)H∞belongsto(cid:1)H∞.Asaresult,(cid:1)H∞isaring.Thisringisacommutativedomain.Letfbeanon-zeroelementof(cid:1)H∞,letm+(f)bethenumberofitszerosin¯C+andletδ(f)beitsrelativedegree.Writeθ(f)=m+(f)+δ(f).Onecanprovethefollowing([114],section2.1):Appendix2:Algebra517THEOREM587.–Thefunctionθisadegreeonthering(cid:1)H∞.Asaresult,(cid:1)H∞isastronglyEuclideandomain,(andthusaprincipalidealdomain).Examples1)Letf(s)=(s−1)s(s+1)3.Wehavem+(f)=2,δ(f)=1,thusθ(f)=3.2)Letg(s)=(s+2)(s+3)(s+1)2Wehaveθ(g)=0,thusgisaunitof(cid:1)H∞(seesection13.1.3).Thealgebra(cid:1)H∞Ontheotherhand,(cid:1)H∞isanR-vectorspace,andthusisacommutativeR-algebra.Thespaceofoperators(cid:1)H∞Wewillnowleavepurealgebraandaddsomeanalyticalconsiderations.THEOREM588.–Themapping(cid:23).(cid:23)∞,from(cid:1)H∞intoR+,deﬁnedby(cid:23)f(cid:23)∞=supRe(s)≥0|f(s)|(13.62)isanormonthevectorspace(cid:1)H∞.Thisnormismultiplicative(seesection12.1.3),whichmakes(cid:1)H∞a“normedalgebra”.Last,wehavetheequality(cid:23)f(cid:23)∞=supω≥0|f(iω)|.(13.63)PROOF.Letf∈(cid:1)H∞.Sincefhasnopolesintheclosedrighthalf-planeandisaproperrationalfunction,thequantity(13.62)isﬁnite,thus(cid:23)f(cid:23)∞∈R+.Ifα∈R,itisclearthat(cid:23)αf(cid:23)∞=|α|(cid:23)f(cid:23)∞.Ifg∈(cid:1)H∞,thetriangleinequality(cid:23)f+g(cid:23)∞≤(cid:23)f(cid:23)∞+(cid:23)g(cid:23)∞obviouslyholds.Supposethat(cid:23)f(cid:23)∞=0.Letf∞=lim|s|→+∞f(s),insuchawaythath(s)=f(s)−f∞isastrictlyproperrationalfunction.Wehavef(s)=f∞+h(s)=0,∀s.Inaddition,lim|s|→+∞h(s)=0,thereforef∞=0andf=h.Accordingtosection12.4.4,fistheLaplacetransformofafunctionu∈L1.TheFouriertransformofuisthefunctionω(cid:3)→f(iω)=0,thusu=0andﬁnally518LinearSystemsf=0.Inaddition,itisclearthat(cid:23)fg(cid:23)∞≤(cid:23)f(cid:23)∞(cid:23)g(cid:23)∞.Theexpression(13.63)isaneasyconsequenceofthemaximummodulusprinciple(Theorem444).Let˜Σbetheconvolutionoperatoru(cid:3)→g∗u,whereg∈S(cid:2)+isadistributionwhoseLaplacetransformˆg(s)isaproperrationalfunction.Onecanprovethefollowing[34],[115]:THEOREM589.–Thefollowingﬁveconditionsareequivalent:(i)ˆg(s)∈(cid:1)H∞;(ii)thekernelgisoftheformg=g0δ+h,whereg0∈Randh∈L1;(iii)foranyp∈[1,+∞],˜ΣisacontinuouslinearoperatorfromLpintoLp;(iv)˜ΣisacontinuouslinearoperatorfromL2intoL2,ofwhichthenorm(inducedbythatofL2anddenotedasγ2(cid:9)˜Σ(cid:10))isequalto(cid:23)ˆg(cid:23)∞;(v)˜ΣisacontinuouslinearoperatorfromL∞intoL∞whosenorm(inducedbythatofL∞anddenotedasγ∞(cid:9)˜Σ(cid:10))isequalto|g0|+(cid:23)h(cid:23)1.Theset(cid:1)Hp×m∞isthatofallmatricesofsizep×m,theentriesofwhichbelongto(cid:1)H∞.ItisanR-vectorspace,anditisanon-commutativeR-algebraifp=m>1.Onecaneasilyverifythatthemapping(cid:23).(cid:23)∞,from(cid:1)Hp×m∞intoR+,deﬁnedby(cid:23)G(cid:23)∞=supRe(s)≥0¯σ(G(s))=supω≥0¯σ(G(iω))(13.64)isanormon(cid:1)Hp×m∞.AnelementG(s)∈(cid:1)Hp×m∞isthetransfermatrixofaconvolutionoperator˜ΣfromLm2intoLp2(withtheconventionofsection2.5.1).Onecanshow[122]thatthenormofthisoperator(inducedbythenormsofLm2andLp2anddenotedasγ2(cid:9)˜Σ(cid:10))isγ2(cid:9)˜Σ(cid:10)=(cid:23)G(cid:23)∞.(13.65)13.6.3.*AlgebraH∞Thenormedalgebra(cid:1)H∞isasubalgebraofaBanachalgebra(i.e.acompletenormedalgebra)denotedasH∞,and(cid:1)H∞=H∞∩R(s).ThespaceH∞iscalledaHardyspace.Afunctionofthecomplexvariablef(s)belongstoH∞if,andonlyif(i)fisanalyticintherighthalf-planeand(ii)(cid:23)f(cid:23)∞(cid:1)supRe(s)>0|f(s)|<+∞.Wethenhave(cid:23)f(cid:23)∞=ess.supω≥0|f(iω)|([53],Theorem2.3.1).Ontheotherhand,H∞isaGCDdomain[109]whichisneitheraUFD,noraBézoutdomain,buthasthefollowingproperty,asshownin[98]:Appendix2:Algebra519THEOREM590.–H∞isacoherentSylvesterdomain.WedenotebyHp×m∞theR-vectorspace(whichisanR-algebraifp=m)consistingofmatricesofsizep×mandwhoseallentriesbelongtoH∞.Thenormdeﬁnedonthisspaceis:(cid:23)G(cid:23)∞=supRe(s)>0¯σ(G(s)).ItisimmediatelyclearthatHp×m∞isaBanachspace,andaBanachalgebraifp=m.13.6.4.*ClassiﬁcationofringsWehavethefollowingclassiﬁcationoftheringsencounteredsofar:UFD→GCD(↑*ED→PID→EDR→BD→CSD→SD→HR+↓,NR→CRwhere→signiﬁes“ismorerestrictivethan”,andwhereED,PID,EDR,BD,CSD,SD,HR,NR,CR,UFDandGCDrespectivelymeansEuclideandomain,principalidealdomain,elementarydivisorring,Bézoutdomain,coherentSylvesterdomain,Sylvesterdomain,Hermitering,Noetherianring,coherentring,uniquefactorizationdomainandGCDdomain.13.6.5.*ChangeofringsRingoffractionsLetRbearingandSbeamultiplicativepartofR(thatistosayifs1,s2∈S,thens1s2∈S)notcontainingzero.WedenotebyS−1Rthesetofelementsoftheformr/s,r∈R,s∈S;oneeasilyshowsthatthissetisaring,calledtheringoffractionsofRwithdenominatorinS.Thefollowingtheoremsummarizestheresultsprovenin([11],ChapterVII,section1-3),([102],Chapter4),[60],([31],Theorem5.11),([79],Theorem3.8).THEOREM591.–IftheringRisaprincipalidealdomain(resp.,aBézoutdomain,auniquefactorizationdomain,aNoetherianring,acoherentring,aSylvestercoherentdomain,anelementarydivisorring),thensoisS−1R.520LinearSystemsExtensionoftheringofscalarsLetMbeanR-moduleandAbeanR-algebra(seesection13.1.1).ThenthetensorproductA⊗RMisthesetofallﬁnitelinearcombinations(cid:11)ai⊗mi,ai∈A,mi∈M;A⊗RMisanA-module.ThefunctorA⊗R−,fromthecategoryofR-modulesintothatofA-modules,isexactcovariant15andiscalledthefunctor“extensionoftheringofscalars”.TheR-homomorphismM(cid:20)m→1⊗m∈A⊗RMissaidtobecanonical(thisisnotanepimorphism).RestrictionoftheringofscalarsLetAbeanR-algebraandMbeanA-module.ThesetMhasacanonicalstructureofR-module;thismoduleisdenotedasM[R].ThefunctorM(cid:3)→M[R]isexactcovariantandiscalledthefunctor“restrictionoftheringofscalars”.Thisrelationbetweentheextensionandtherestrictionoftheringofscalarsisdetailedin([10],n◦II.5.2).Thereadershouldbeawarethattheseoperationsarenotinverseofoneanother.Forexample,since2isaunitofQ,Q⊗Z(Z/2Z)=0,whoserestrictiontoZ/2Zremainszero.ModulesoffractionsTheringoffractionsA=S−1RisanR-algebraandwhenAisdeﬁnedinthatway,A⊗RMisdenotedasS−1M.Thetensorproducta⊗m(a∈A,m∈M)canbedenotedasam([11],sectionII.2),thecanonicalhomomorphismθ:M→S−1Miswrittenasm→11m(where11istheunitelementofA)andaccordingto([102],Theorem3.71)kerθ={m∈M:∃s∈S,sm=0}.(13.66)LetA=K,theﬁeldoffractionsofR(seesection13.1.1);thetensorproductK⊗RMisaK-vectorspacedenotedbyM(K).SinceS=R(cid:2){0},wehaveaccordingto(13.66)kerθ=T(M).(13.67)Inparticular,ifMistorsion-free,itiscanonicallyisomorphicto(andidentiﬁedwith)θ(M)⊂M(K)accordingtoTheorem538(ii).Therefore,consideringelementsm1,...,mkofM,theseareR-linearlyindependentifandonlyifθ(m1),...,θ(mk)areK-linearlyindependent.Ontheotherhand,ifM(cid:2)⊂M,M(cid:2)(K)isidentiﬁedwithasubspaceofM(K)and(M/M(cid:2))(K)isidentiﬁedwithM(K)/M(cid:2)(K)([10],n◦II.7.10).15.Thenotionsofcategoryandfunctoraredetailedin[102](asfarascategoriesofmodulesareconcerned);seealso[91].Asuccinctaccountisgivenin[22].Chapter14SolutionsofExercises14.1.ExercisesofChapter1SolutionofExercise1Applyingthemeshruleandthenodalrule,weﬁnd:CdVdt=R1+R2R1R2i+(R2C+LR1)didt+LCd2idt2.SolutionofExercise2ThesimplestapproachistoapplytheLagrangeequations,whichyield:(M+2m)¨y+(cid:11)2i=1(mlicosθi¨θi−mlisinθi˙θ2i)−f=0li¨θi−gsinθi+¨ycosθi=0,i=1,2.SolutionofExercise3Volumeisconserved:Sdhdt=Q1+Q2−σ√2gh.Massisconserved:ddt(csSh)=c1Q1+c2Q2−csσ√2gh,whichtogetherwiththepreviousequationyields:Shdcsdt+cs(Q1+Q2)=c1Q1+c2Q2.521Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.522LinearSystemsSolutionofExercise4Volumeisconserved:Sdhdt=Q1+Q2−σ√2gh.Energyisconserved:ShdTsdt+Q1(Ts−T1)+Q2(Ts−T2)=0.Wenotethattheequationsarethesameasthoseinthepreviousexercise,theconcentrationsbeingreplacedbythetemperatures.14.2.ExercisesofChapter2SolutionofExercise53Wehavefrom(1.19),assumingzeroinitialconditionsandwritingu=f:(cid:15)m1s2+k(cid:16)ˆz1−kˆz2=ˆu,(cid:15)m2s2+k(cid:16)ˆz2−kˆz1=0.Therefore,puttingy=z2:G(s)=ˆyˆu=km1m2s2(cid:9)s2+km1+m2m1m2(cid:10).Thesystemthushasnotransmissionzeros,whilethetransmissionpolesare{0,0,iω0,−iω0}withω0=(cid:30)km1+m2m1m2.SolutionofExercise54Theoutput,thistime,isω,andwithzeroinitialconditions,ˆω(s)=sˆθ(s).ThetransferfunctionofthenewcontrolsystemconsideredisthereforeH(s)=sG(s),whereG(s)isgivenby(2.33),i.e.H(s)=ks2+2ςω0s+ω20.Thus,thesystemhasnotransmissionzerosandhastransmissionpoles{p1,p2}wherep1andp2aretherootsofthepolynomials2+2ςω0s+ω20.SolutionofExercise55Case(a):wehaveG(s)=1(s−1)3(s+1)(cid:27)(s+1)2(s−1)(s−1)20(s+1)3(cid:28)∼1(s−1)3(s+1)(cid:27)100(s−1)(s+1)5(cid:28)=#1(s−1)3(s+1)00(s+1)4(s−1)2$.SolutionsofExercises523ThedistinctpolesofG(s)arethuss=−1(simplepole)ands=1;thelatterhasstructuralindices{2,3},thusitsorderis3anditsdegreeis5.Thetransmissionorderofthesystemis5+1=6.Ontheotherhand,G(s)hasauniquezeros=−1;thisoneherehasauniquestructuralindexof4(thusitsorderanditsdegreearebothequalto4).Case(b)and(c):theSmith–MacMillanformofG(s)is(b)(cid:27)1(s+1)2(s+2)200s+2(cid:28);(c)(cid:27)1(s+1)2(s+2)00s(cid:28)andwecometothesameconclusionasabove.SolutionofExercise56Equilibriumpositionsoftheinverteddoublependulum:Theﬁrstequationyieldsf∗=0.Thesecondequationyieldssinθ∗i=0,i=1,2,fromwhichwegetθ∗i=0orπ(mod.2π).Linearizationofthesystematy∗=0,θ∗1=θ∗2=0:(cid:19)(M+2m)d2ydt2+ml1d2θ1dt2+ml2d2θ2dt2−f=0lid2θidt2−gθi+d2ydt2=0,i=1,2.SolutionofExercise57Equilibriumofvolume:Q∗1+Q∗2−σ√2gh∗=0.Equilibriumofconcentrationcs:c∗s(Q∗1+Q∗2)=c1Q∗1+c2Q∗2.Usingtheﬁrstequation,weobtainc1Q∗1+c2Q∗2=c∗sσ√2gh∗.Notethat,exceptifc1=c2,thevaluesofthedifferentvariablesatequilibriumareentirelydeterminedbyh∗andc∗s.Linearizationoftheequations:(cid:20)ddt∆h+σS%g2h∗∆h=1S(∆Q1+∆Q2)ddt∆cs+2σS%g2h∗∆cs=c1−c∗sSh∗∆Q1+c2−c∗sSh∗∆Q2.524LinearSystemsSolutionofExercise58ThelinearizedequationsoftheinvertedpendulumcanbeputintheformD(∂)y=N(∂)uwithD(∂)=(cid:27)(M+m)∂2ml∂2∂2l∂2−g(cid:28),N(∂)=(cid:27)10(cid:28)andy=[zθ]T,u=f.WehavedetD(∂)(cid:5)=0,thustherankofthesystemisequalto1.Thereisthusoneinput,whichisthecontrolandisnaturallytheforcef.Inthisrepresentation,whichisaleftform,thereisnolatentvariables.Wecanintroduceasintermediatevariablesvelocitiesv=dzdtandq=dθdt,whicharethenlatentvariables.SolutionofExercise59Thereareclearlytwoinputs,whichwewillpickas∆Q1and∆Q2.Itisnecessarytoregulate∆h,insuchawaythatthetankdoesnotoverﬂownorbecomeempty.Theaimofthemixeristomakeitpossibletoregulatetheconcentration.Thetwocontrolledvariablesarethus∆hand∆cs.SolutionofExercise60(i)Theequilibriumconditionsaref(x∗,u∗)=0,y∗=g(x∗,u∗).(ii)Write∆x=x−x∗,∆u=u−u∗,∆y=y−y∗.Weobtain∂∆x=A∆x+B∆u,∆y=C∆x+D∆uwithA=∂f∂x(x∗,u∗),B=∂f∂u(x∗,u∗),C=∂g∂x(x∗,u∗),D=∂g∂u(x∗,u∗).14.3.ExercisesofChapter3SolutionofExercise70ThestaticgainofthesystemisG(0)=0.WriteK=|G(iω)|2k2and=(cid:9)ωω0(cid:10)2.WeobtainK=(−1)2+4ς2.WeeasilyverifythatdKdbecomeszerowhen=1,thuswhenωr=ω0.Themaximumof|G(iω)|is|G(iωr)|=k2ς.SolutionsofExercises525SolutionofExercise71(a)Thestepresponseisthatofaﬁrstordersystem,thetransferfunctionofwhichisG(s)=k1+τs.Thestaticgainisk=0.1.Thetimeconstantτistheabscissaatwhichtheintersectionofthetangentattheoriginandthehorizontalaxisislocated,andtheordinateofwhichisthestaticgain.Wehavethusτ(cid:9)0.1s.(b)Thestepresponseisthatofasecondordersystemthathasnozero,andthetransferfunctionofwhichisthusoftheformG(s)=kω20s2+2ςω0s+ω20.Thestaticgainisk=10.Theovershootisoftheorderof37%,whichcorrespondstoadampingcoefﬁcientς(cid:9)0.3.Ontheotherhand,themaximumofthecurveisattainedatt=1s,thusπωp=1,fromwhichwealsohaveω0=π√1−ς2(cid:9)3.3rad/s.(c)Thissystemhasnoresonance.Theslopeoftheamplitudegoesfrom0to−40dB/decintheneighborhoodof0.1rad/s.Theargumentgoesfrom0◦to−180◦andis−90◦forω=0.1rad/sapproximately.Itisthereforeastablesecondordersystemwithundampednaturalangularfrequencyω0=0.1rad/sandwithadampingcoefﬁcientςbetween0.7and1.Itisdifﬁculttobemorespeciﬁcregardingς.Thestaticgainisequalto10(i.e.20dB).SolutionofExercise72(a)WehaveG(s)=λ(n−rk=1(zk−s)(nk=1(pk−s).(b)Thesystemiswith“negativestart”ifandonlyifρ<0.(c)Wehaveρ=y(r)(0+)G(0)=(n−rk=1(cid:9)−1zk(cid:10)(nk=1(cid:9)−1pk(cid:10)since,accordingtotheInitialvaluetheorem(section12.3.4),y(r)(cid:15)0+(cid:16)=lims∈R,s→+∞srG(s).526LinearSystems(d)Considerthedenominator(nk=1(cid:9)−1pk(cid:10).Ifapolepkisreal,wehave−1pk>0sincethispolebelongstothelefthalf-plane(forthesystemisstable).Ifapolepkiscomplex,theconjugateterm−1¯pkalsoappearsintheproduct.Wehave(cid:9)−1pk(cid:10)(cid:9)−1¯pk(cid:10)=1|pk|2>0.Asaresult,thedenominatorispositive.Thisreasoningalsoappliestothetermsofthenumerator,exceptthosethatcorrespondtonon-negativerealzeros.(e)Accordingto(b)and(d),thesystemΣiswith“negativestart”ifandonlyifthenumberofnon-negativerealzerosisodd.(ThisresultisduetoVidyasagar[113];weshouldtakecarenottoconfuseasystemwith“negativestart”withanon-minimalphasesystem:thereexistnon-minimumphasesystemswhosestepresponseismonotonicincreasing,forexamplethesystemwithtransferfunctionG(s)=s2+2ςω0s+ω20ω20(s+1)2whereω0=10andς=−0.1.)(f)ThisresultiscoherentwiththestepresponsesinFigures3.14and3.15:thesystemswithtransferfunctionsen(s)andn(s)arewith“negativestart”forn=1andn=3andwith“positivestart”forn=2.Theintegernisalsothenumberofnon-negativerealzerosofthesetransferfunctions(aseasilyveriﬁed).14.4.ExercisesofChapter4SolutionofExercise100(i)–(iii)Bode,NyquistandBlackplots:Figure14.1.Bodeplot–Exercise100SolutionsofExercises527Figure14.2.Nyquistplot–Exercise100Figure14.3.Blackplot–Exercise100528LinearSystems(iv)Thenecessarygaintoobtainaphasemarginof60◦is−6.3dB,whichisabout0.48.Thedelaymarginisthereforeof2.4t.u.(t.u.=timeunit).Thegainmarginis(−20.3dB,+∞).SolutionofExercise101Questions(i)–(iv)areeasy:thefeedbacksystemisunstable.(v)Thisexampleshowsthatthe“Nyquistcriterion”obtainedwithaBromwichcontourthatencirclestheimaginarypolesontherightisfalse.SolutionofExercise102Question(i)iseasy:thefeedbacksystemisunstable.(ii)Thisexampleshowsthattheproposedstatementisincorrect.SolutionofExercise105WehaveLi,γ(s)=Lo,γ(s)=Pγ(s)=(cid:27)1s+1−γs+10s+2s+1(cid:28)gγ(s)=|I2+Lo,γ(s)|−1=2s+3(s+1)2.SincetheNyquistplotofgγ(s)(thatistheMIMONyquistplotofLo,γ(s))isentirelylocatedinsidetherighthalf-plane,thedistancefromthisplotto−1isequalto1,whateverthevalueofγis.(ii)SupposeA0isreplacedbyAε,thecontrolvariablebeingu=−y.Thefeedbacksystemequationbecomes˙y=(cid:27)−2γε−2(cid:28)y=Fy,where|sI2−F|=s2+4s+4−γε.ThefeedbacksystemisstableonconditionthatthetwoeigenvaluesofFlieinthelefthalf-plane,thatisγε<4.Thisfeedbacksystemisthusunstablewheneverγ≥4ε.(iii)WehaveMmi,γ=Mmo,γ=infω≥0σ(I2+Lo,γ(iω))andthereadercanverify,afterafewcalculations,thatthisquantitytendsto0asγ→+∞.(iv)Asaresult,Mmi,γ=Mmo,γisagoodindicatorofthelackofrobustnessoftheclosed-loopsystemforlargevaluesofγ,whereasthislackofrobustnessisabsolutelynotreﬂectedbytheMIMONyquistplot.14.5.ExercisesofChapter5SolutionofExercise107(i)Yes,sincePisanintegratorsystem(seesection5.1.2).(ii)Weusealead.Weneedaphaseleadϕd=29◦atω0=1rad/s,thusα=2.9andτ=0.59s.WededucefromtherethatKPD(s)=0.861+1.70s1+0.59s.(iii)No(asforthecontrollerdeterminedat(ii)).(iv)ThePIDcontrollerissuchthatϕd−ϕI=29◦.ChoosingS=ϕd+ϕI=90◦,weobtainϕd=59.5◦andϕI=30.5◦.ThecharacteristicsofthePIDcontrollerareﬁnallyasfollows:k=1;TI=5.1s;Td=0.95s;N=3.5.SolutionsofExercises52914.6.ExercisesofChapter6SolutionofExercise121(i)Ifδ0>0,theSylvestersystemiswrittenas⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣10······00······0a11..................a1.........b0......an......0b1...00......1......0.........a1bnb1b0.........0......b1...an......bn...0·········00···0bn⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣σ1σ2......σn+δ0−1r0r1...rn⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦=⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣c1−a1...cn−ancn+1............c2n+δ0⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦.Theorderofthematrixontheleftisstill2n+δ0andthenumberofzerosbelowthelastan(resp.,abovetheﬁrstb0)isequalto1(resp.,δ0−1).(ii)Ifδ0=0,itisnecessarytogobackto(13.13)insection13.1.5.WehaveAcl(∂)=c0∂2n+c1∂2n−1+...+c2nwherec0(cid:5)=1ifb0(cid:5)=0.SolutionofExercise1231)R(∂)=21∂2+31∂+10;S(∂)=∂3+14∂2+24∂;T(∂)=(∂+1)(∂+10).2)Seesection6.3.5.3)δ(cid:15)RS(cid:16)=1.SolutionofExercise124(i)R(∂)=(∂+1)2;S(∂)=∂(∂+2);T(∂)=∂+1.(ii)So(s)=ss+1;Mm=1.(iii)ThetransferfunctionbetweenrandyisG=BTAcl=1(s+1)2.ThestepresponseistheinverseLaplacetransformof1sG(s)=1s(s+1)2=1s−1s+1−1(s+1)2,whichis(1−te−t−e−t)1(t)(seesection12.4.4).Thisresponsethushasnoovershoot(andofcoursewithnostaticerror).SolutionofExercise125(i)Areasonablevalueofαisoftheorderof10(but,sincethesystempresentsnoparticulardifﬁculties–foritisopen-loopstableandminimumphase–wecanchooseasmallervalueofα).(ii)Withα=5,wetakeAs(∂)=(∂+1)(∂+5)andAcl(∂)=As(∂)(∂+1)2,fromtherewehaveR(∂)=5∂2+10∂+5,S(∂)=∂(cid:15)∂2+8∂+12(cid:16),T(∂)=(∂+1)(∂+5).(iii)TheadvantageoftheRSTcontrollerdeterminedinExercise124isitssimplicity,butitsdisadvantage,compared530LinearSystemsFigure14.4.BodeplotofE(s)–Exercise126withtheonedeterminedinthisexercise,isthatisdoesnotﬁlterthemeasurementnoiseandthatitgeneratesalessrapidroll-offoftheopen-looptransferfunctioninhighfrequencies;thiscouldmeanlessrobustnessagainstneglecteddynamicsatthesefrequencies.SolutionofExercise126(i)Theresultiscoherent,sincethetransferfunctionL(s)resemblesthatofapureintegrator(cid:15)1s(cid:16)inthelowfrequencies,asthisisthecaseforExercise124,withaslopewhichsteepensaround5rad/s(whichcorrespondstotheabsolutevalueofthepoleadded).(ii)TheBodeplotofE(s)isshowninFigure14.4forω0=30rad/s.Themaximumisattainedattheresonantangularfrequencyωr=ω0√1−2ς2(cid:9)ω0andwithavalueof12ς√1−ς2(cid:9)12ς=100,i.e.40dB.(iii)WiththeRSTcontrollerdeterminedinExercise125,thestabilityispreservedinpresenceofthemodelingerror,becauseforω≥30rad/s,|L(iω)|islessthan−40dB;thus|P(iω)E(iω)|remainslessthan0dBatthesefrequencies(andtheNyquistcriterioncanbeusedtoconcludestability).ThisisnotthecasewiththeRSTcontrollerdeterminedinExercise124(whereL(s)=1s).SolutionofExercise127(i)S(∂)=∂(∂+3),R(∂)=4∂2+7∂+1,T(∂)=(∂+1)2.(ii)S(∂)=∂(cid:15)∂2+4∂+7(cid:16),R(∂)=7∂2+12∂+1,T(∂)=(∂+1)3.(iii)ForQuestion(i),SolutionsofExercises531“tooslow”apoleischosen:itwouldbepreferabletoplaceitat−10forexample;forQuestion(ii),two“faster”polesoftheclosed-loopsystemmustbechosen.14.7.ExercisesofChapter7SolutionofExercise208(i)Let{A,B,C}beastaterepresentationoftheDCmotor,wherexisthespeciﬁedstatevector.WeobtainA=⎡⎣0100−λJKJ0−KL−RL⎤⎦,B=⎡⎣001L⎤⎦C=(cid:25)100(cid:26).(ii)ControllabilityandobservabilityareveriﬁedusingtheKalmancriterion(Theorems141and150).WehaveindeedΓ(A,B)=⎡⎣00KJL0KJL∗1L∗∗⎤⎦whichisofrank3sinceK(cid:5)=0(seesection1.3).Ontheotherhand,Ω(C,A)=⎡⎣10001000KJ⎤⎦isofrank3forthesamereason.SolutionofExercise209(i)Thestateequationis˙x=Ax+BuwithA=⎡⎢⎢⎣0−εσ20000100(1+ε)σ2001000⎤⎥⎥⎦,B=⎡⎢⎢⎣10−10⎤⎥⎥⎦.(ii)ThecharacteristicpolynomialofAispA(s)=s2(cid:15)s2+(ε+1)σ2(cid:16),thusthesystempolesare(cid:31)0,0,±√1+εσ .Thesystemisthereforeunstable.(iii)Weeasilyverify,usingtheKalmancriterion,thatthesystemiscontrollable.(iv)IfC=(cid:25)∗∗∗0(cid:26),thenthesystemisunobservable;itdoeshaveastructuresuchas(7.13)withA¯o=0.ThesystemisnotdetectableaccordingtoProposition171(section7.2.3)andDeﬁnition185(section7.3).(v)IfC=(cid:25)0001(cid:26),the532LinearSystemsKalmancriterionshowsthatthesystemisobservable.(vi)ThetransmissionzerosareequaltotheinvariantzerosaccordingtoTheorem179(i)(section7.2.6)andarethusthevaluess∈CforwhichtheRosenbrockmatrix(7.20)“loosesitsrank”.Weobtain{i.z.}={±σ}.Whenε(cid:16)1,twosystempolesapproachthetwoi.z.’sandthesystemtendstowardsunobservability.SolutionofExercise210(i)Thestateequationis˙x=Ax+BuwithA=⎡⎢⎢⎣00−λλ00−λρλρ10000100⎤⎥⎥⎦,B=⎡⎢⎢⎣1000⎤⎥⎥⎦.(ii)ThecharacteristicpolynomialofAispA(s)=s2(cid:15)s2+λ(ρ+1)(cid:16).Sinceλ(ρ+1)=km1+m2m1m2,thesystempolesare(cid:7)0,0,±i(cid:30)km1+m2m1m2(cid:8);thesevaluesaretheSmithzerosofthepolynomialmatrixD(s)accordingto(2.13),whichisclearlycoherentaccordingtoDeﬁnition17(section2.3.7).(iii)Itiseasytoverify,usingtheKalmancriterion,thatthesystemiscontrollable.(iv)IfC=(cid:25)0100(cid:26),theKalmancriterionshowsthatthesystemisunobservable.Theinterpretationisimmediate:bymeasuringonlythevelocity˙z2,wecannotdeterminethepositionz2.(v)Sincethesystemhasnoi.d.z.’s,wehave{h.m.}={o.d.z.}accordingtoCorollary176(section7.2.5).Theo.d.z.’saredeterminedusingProposition170(section7.2.3).Theo.d.z’sareindeedtheSmithzerosofthematrix(cid:27)sIn−AC(cid:28).Inthiscase,weeasilyshowthat{o.d.z.}={0}.Thus,{h.m.}={0}.(vi)WithC=(cid:25)0001(cid:26),weshow,usingtheKalmancriterion,thatthesystemisobservable.(vii)Withthischoice,thesystemisminimalanditst.z.’sarethusidenticaltoitsi.z.’s,i.e.tothetheSmithzerosoftheRosenbrockmatrix.Sincethelatterissquare,itsSmithzerosarerootsofitsdeterminant.Weseethatthisisaconstant,andsothesystemhasnotransmissionzeros.AnotherfasterwayofgettingtothisconclusionistousetheresultobtainedinExercise53.SolutionofExercise211(i)Thecontrollablecanonicalformis{A,B,C}withA=(cid:27)−RL−1LC10(cid:28),B=(cid:27)10(cid:28)C=(cid:25)1L0(cid:26).SolutionsofExercises533(ii)TheobservabilitymatrixisΩ=(cid:27)1L0−RL2−1L2C(cid:28).Ifthecapacitytendstoward+∞,thematrixΩbecomessingularandthesystembecomesunobservable(thechargeqofthecapacitorisnolongerobservable).SolutionofExercise212(i)Wecaneliminated2ydt2oftheequationsofmotionoftheinverteddoublependulumandweobtainthestaterepresentation˙x=Ax+BuwhereA=⎡⎢⎢⎣00100001a1a200a3a400⎤⎥⎥⎦,B=⎡⎢⎢⎣001/l11/l2⎤⎥⎥⎦witha1=(M+m)gMl1,a2=mgMl1,a3=mgMl2,a4=(M+m)gMl2.(ii)WestudythecontrollabilityusingtheKalmancriterion.SincethematrixΓ(A,B)issquare,itsufﬁcestoexamineonwhatconditionsitsdeterminantisnon-zero.Thisconditionisl1(cid:5)=l2(thereaderisrequestedtowonderwhy).(iii)TheKalmancriterionshowsthatthesystemisobservablewhentheoutputisx1.SolutionofExercise216(i){o.d.z.}={1}and{i.z.}=∅.(ii){i.d.z.}={1}and{i.z.}=∅.(iii)TheseresultsarecoherentwithTheorem179andshowthatwecannotexpecttoimprovethelatter.SolutionofExercise217(i)iseasy.For(ii),weproceedasinsection7.4.3andweobtainAc=⎡⎢⎢⎣−4−300100000−6−80010⎤⎥⎥⎦,Bc=⎡⎢⎢⎣10000100⎤⎥⎥⎦,Cc=(cid:27)13141112(cid:28).Thisformisnotunique:ifxdesignatesthestateoftheabovecanonicalform,x(cid:2)isequallythestateofthecontrollablecanonicalformwithx(cid:2)=(cid:25)x3x4x1x2(cid:26)T.Thisisduetothefactthattwoofthecontrollabilityindicesareequal;indeed,{µ1,µ2}={2,2}.534LinearSystemsSolutionofExercise218ThewholeexerciseconsistsinusingthedualityrelationsofCorollary153(section7.1.4)andtheobservationsthatfollowthiscorollary.Asaresult:(i)Theobservabilityindicesof(C,A)arethecontrollabilityindicesof(cid:15)AT,CT(cid:16).(ii)ThematricesBooandBohavenoparticularform.Thecanonicalformstobedeterminedarethusthoseof(C,A).Wehave(Coo,Aoo)=(cid:15)ATcc,CTcc(cid:16)and(Co,Ao)=(cid:15)ATc,CTc(cid:16),where(cid:15)ATcc,CTcc(cid:16)(resp.,(cid:15)ATc,CTc(cid:16))isthecanonicalformofcontrollability(resp.,thecontrollablecanonicalform)of(cid:15)AT,CT(cid:16).SolutionofExercise219(i)WeeasilyverifythatG(s)=D−1(s)N(s)andthatthematrices{D,N}areleft-coprime.(ii)LetH(s)=GT(s).WehaveH(s)=NT(s)D−T(s)where(cid:31)NT,DT areright-coprime.WedeterminearealizationofH(s)incontrollablecanonicalformbyproceedingasinsection7.4.3andwededucefromtherearealizationofG(s)inobservablecanonicalformbyusingtheresultsofExercise218.Thisrealization{Ao,Bo,Co}isobtainedbychoosingastheoutputy(cid:2)=(y2,y1),andisgivenbyAo=⎡⎢⎢⎢⎢⎣−41000−4000000−41010−50120−200⎤⎥⎥⎥⎥⎦,Bo=⎡⎢⎢⎢⎢⎣1−1000−10000⎤⎥⎥⎥⎥⎦,Co=(cid:27)1000000100(cid:28).Theobservabilityindicesare{ω1,ω2}={2,3}.Sincethesearealldifferent,thiscanonicalformofobservabilityisunique.SolutionofExercise220(i)ThecontrollabilitymatrixofΣisΓ=⎡⎣0001−390−48⎤⎦.SincerkΓ=2,Σisuncontrollableandhasonei.d.z.(for1=3−2).TheobservabilitymatrixofΣisΩ=⎡⎣1−1−121−5010−309000000⎤⎦T.SolutionsofExercises535Asaresult,rkΩ=2,Σisunobservableandhasoneo.d.z.(for1=3−2).(ii)ThesystempolesaretheeigenvaluesofAwhichislowertriangular;thesearethusthediagonalelementsofA,whichare{−1,−3,1}.(iii)Theﬁrstequationofthesystemis∂x1=−x1.Thus,−1isani.d.z.anditistheonlyoneaccordingto(i).Ontheotherhand,{A,B,C}isdirectlydecomposedaccordingtoobservabilityandhasauniqueo.d.z.whichisequalto1.AccordingtoProposition173(section7.2.4),{i.o.d.z.}=∅.Asaresult,accordingtoCorollary176(section7.2.5),{h.m.}={−1,1}.Atlast,accordingtoTheorem179(i)(section7.2.6),{t.p.}={s.p.}\{h.m.}={−3}.(iv)ThesystemΣisthusstabilisable(foralli.d.z.’sbelongstothelefthalf-plane)butnotdetectable(theo.d.z.belongstotherighthalf-plane).(v)TheRosenbrockmatrixisR(s)=⎡⎢⎢⎢⎢⎣s+1000−1s+30−1−14s−101000−1100⎤⎥⎥⎥⎥⎦∼⎡⎢⎢⎢⎢⎣0000000100s−1010000100⎤⎥⎥⎥⎥⎦.Itsrankis4fors(cid:5)=1andis3fors=1,thus{i.z.}={1}.SolutionofExercise2211)(i)Thesystemisneithercontrollablenorobservable.(ii)Itspolesare{−1,1,0}.(iii)(a)ThetransferfunctionisG(s)=C(sI3−A)B=1s.(b)Toﬁndthei.d.z.’s,weformthematrix(cid:25)sI3−AB(cid:26)=⎡⎣s+1000−1s−10000s1⎤⎦∼⎡⎣1000010000(s−1)(s+1)1⎤⎦.536LinearSystemsAsaresult,{i.d.z.}={1,−1}(seeProposition166,section7.2.2).(c)Toﬁnditso.d.z.’s,weformthematrix(cid:27)sI3−AC(cid:28)=⎡⎢⎢⎣s+100−1s−1000s−101⎤⎥⎥⎦∼⎡⎢⎢⎣10001000s−1000⎤⎥⎥⎦.Asaresult,{o.d.z.}={1}(seeProposition170,section7.2.3).(d)Accordingto(a),{t.p.}={0},thus{h.m.}={s.p.}\{t.p.}={−1,1}.Consequently,{i.o.d.z.}={i.d.z.}˙∪{o.d.z}\{h.m.}={1}.(iv)Thesystemisneitherstabilizablenordetectable.(v)Toﬁndtheinvariantzeros,weformtheRosenbrockmatrixR(s)=(cid:27)sI3−A−BC0(cid:28)=⎡⎢⎢⎣s+1000−1s−10000s−1−1010⎤⎥⎥⎦∼⎡⎢⎢⎣100001000010000(s−1)(s+1)⎤⎥⎥⎦;asaresult,{i.z.}={1,−1}.Thisresultcanequallybeobtained,moresimply,byapplyingTheorem179(iv)(section7.2.6),knowingthat{t.z.}=∅.SolutionofExercise222(i)ApplythePopov–Belevitch–Hautustest(Corollary139,section7.1.3,).(ii)Usingthecontrollability↔observabilityduality(Corollary153,section7.1.4),weobtainthefollowingcriterion:Σisobservableifandonlyifthereexistsno(right)eigenvectorofAthatwillannihilateC,thatis,nocolumnvectorv(cid:5)=0suchthatAv=λvandCv=0.SolutionofExercise223AccordingtotheTaylor’sformula,P(t)=2n+1(cid:12)j=0pj(t−t0)jSolutionsofExercises537withpj=P(j)(t0)/j!.Itisimmediatethatp0=y0andpj=0for1≤j≤n.Consequently,for0≤β≤n,P(β)(t1)=2n+1−β(cid:12)j=n+1j!(j−β)!∆j−βpj.Then+1coefﬁcientspj(n+1≤j≤2n+1)arethusobtainedbysolvingthesystemofn+1linearequations2n+1(cid:12)j=n+1∆jpj=y1−y0,2n+1−β(cid:12)j=n+1j!(j−β)!∆j−βpj=0,1≤β≤n.SolutionofExercise224(i)Wehavez1=z2+(m2/k)¨z2andf=(m1+m2)¨z2+(m1m2/k)z(4)2.Asaresult,z2isaﬂatoutputofthesystem.Thisﬂatoutputisthemostnaturalpossible.(ii)Theequilibriumconditionsarez2(t0)=z20,z2(t1)=z21,z(β)2(ti)=0,1≤β≤4,i∈{0,1}.14.8.ExercisesofChapter8SolutionofExercise263Letbethesystem˙x=Ax+Bu,y=Cx+Duandthestatefeedbackcontrolu=v−Kx.TheRosenbrockmatrixofthefeedbacksystemis(cid:27)sIn−A+BK−BC−DKD(cid:28)∼(cid:27)sIn−A−BCD(cid:28);theequivalenceisobtainedbysubtracting(cid:27)−BD(cid:28)Kfrom(cid:27)sIn−A+BKC−DK(cid:28),usingcolumnselementaryoperations.SolutionofExercise264(i)WecaneasilyshowthatΣiscontrollableandobservableusingtheKalmancriterion.(ii)G(s)=C(sI2−A)−1B=−5s2+s−2.SinceΣhasnohiddenmodes,itsinvariantzeroscoincidewithitstransmissionzeros–therearenone–,anditspolescoincidewithitstransmissionpoles,whichare{1,−2}(Theorem179(i),section7.2.6).(iii)Theanswerisyes,sinceConditions(i)and(ii)inProposition250hold.538LinearSystems(iv)System(8.33)isthuscontrollableandwecanplacethepolesoftheclosed-loopsystemusingthecontrol(8.34).WritingK=(cid:25)k1k2k3(cid:26)andidentifyingdet(sI3−F+GK)termbytermwith(s+2)(s+1)2=s3+4s2+5s+2,weobtaindet(sI3−F+GK)=s3+(k1−2k2+1)s2+(−3k1+k2−2)s−5k3whichyields⎧⎨⎩k1−2k2=33k1−k2=−75k3=−2andﬁnallywegetk1=−17/5=−3.4,k2=−16/5=−3.2,k3=−2/5=−0.4.ThepolesofLi(s)coincidewiththeeigenvaluesofF,whichare{−2,0,1}.Thecontrolisfoundtobeu=−Kpx−Ki(cid:2)e(t)dt+const.withKp=(cid:25)k1k2(cid:26)andKi=k3.(v)Sincetheclosed-loopsystemisstable,theNyquistplot(takingintoaccountthe“half-circleatinﬁnity”)enclosesinthedirectsensepoint−1anumberoftimeswhichisequaltothenumberofpolesofLi(s)belongingto¯C+,i.e.2times.SinceRule111(section6.3.5)isbeingapplied,themodulusmarginisequalto1.WecandeducefromtheseconsiderationsthattheNyquistplotofLi(s)hastheshapeshowninFigure14.5.Figure14.5.NyquistplotofLi(s)–Exercise264SolutionsofExercises539Figure14.6.NyquistplotofLi(s)–Exercise265SolutionofExercise265(i)WehaveshowninExercise209thatΣiscontrollableandobservable(withC=(cid:25)0001(cid:26)).(ii)ThepolesofΣare(cid:31)0,0,±√11 ,itsinvariantzerosare(cid:31)±√10 .(iii)SameanswerasinExercise264,forthesamereasons.(iv)K=(cid:25)−65.2−270.4−85.2−104.4−72(cid:26).(v)TheNyquistplotofLi(s)hastheshapeshowninFigure14.6,sinceMmi=1.SolutionofExercise266(i)Thestateequationsdirectlyexpressthedischargeequations(seesection1.4)andC=(cid:25)0α3(cid:26).(ii)UsingtheKalmancriterion,weimmediatelyshowthatthesystemiscontrollableandobservable.(iii)Thesystempolesare{−α2,−α3},theyarelocatedinthelefthalf-plane,andthusthesystemisstable.(iv)FormingtheRosenbrockmatrix,weshowthatthesystemhasnoﬁnitezeros.ThestaticgainisG(0)withG(s)=C(sI2−A)−1B,andsoG(0)=−CA−1B=0.01.(v)Thecontrollawwearelookingforisoftheform(8.35)withKp=(cid:25)1230.5(cid:26)andKi=0.625.ThechoiceofthispoleplacementisjustiﬁedbyRule111(section6.3.5).540LinearSystemsSolutionofExercise267(i)Takingasastatevectorx=(cid:25)θvh(cid:26)T,weobtainasystem{A,B,C}withA=⎡⎣−1τ100σ−1τ20010⎤⎦,B=⎡⎣1001τ200⎤⎦,C=(cid:25)001(cid:26).(ii)Systempoles:(cid:7)−1τ1,−1τ2,0(cid:8).Thesystemisunstable(and,moreprecisely,“marginallystable”:seeDeﬁnition183,section7.3).(iii)Sinceu=0,thematrixBisreplacedbyitssecondcolumnb2.Thesystemisobservablebutnotcontrollable(and{i.d.z.}=(cid:7)−1τ1(cid:8)).Sincetheﬁrstequationisτ1˙θ=−θ,θconvergesinevitablyto0.(iv)(a)Thistime,thematrixBisreplacedbyitsﬁrstcolumnb1.Thishasnoinﬂuenceontheobservability,butthesystemisnowcontrollable(thedeterminantofthecontrollabilitymatrixisσ2).(b)Weobtainacontrollawoftheform(8.35)withKp=(cid:25)19/101(cid:26)andKi=1.SolutionofExercise269TheonlymodiﬁcationneededisthatmatrixGofSystem(8.33)isnowwrittenas:G=(cid:27)BD(cid:28).14.9.ExercisesofChapter9SolutionofExercise297(i)Let˜K=(cid:27)˜k1˜k2(cid:28)betheobservergain.Wehavedet(cid:9)sI2−A+˜KC(cid:10)=))))s+2˜k1˜k1−22˜k2−1s+˜k2+1))))=s2+s(cid:9)2˜k1+˜k2+1(cid:10)+3˜k1+4˜k2−2.SolutionsofExercises541Identifyingthispolynomialtermbytermwith(s+5)2=s2+10s+25,weobtaintheequations(cid:20)2˜k1+˜k2=93˜k1+4˜k2=27hence˜k1=9/5and˜k2=27/5.(ii)Theobserverpoleslieontherealaxis,theyarenegativeandfastcomparedtothesystempoles,thustheycomplywiththeruleexpressedbyTheorem112(sinceallsystemzerosareatinﬁnity).SolutionofExercise298(i)Theobservergainis˜K=(cid:27)3217(cid:28).(ii)SamereasonasisinExercise297.SolutionofExercise299(i)Σisinacanonicalcontrollableform,thusitscharacteristicpolynomialcanbe“read”directlyonthematrixA.Itspolesare{1,−2}andΣisunstable.(ii)Transferfunction:G(s)=s+β(s−1)(s+2).Ifβ/∈{−1,2},thetransmissionpolesare{1,−2}andthesetofitstransmissionzerosis{−β}.Ifβ=−1(resp.,β=2),Σhasauniquetransmissionpole−2(resp.,1)andhasnoﬁnitetransmissionzero.(iii)Σisclearlycontrollable(see(i))andisobservableforβ/∈{1,−2}.(iv)UsingtheRosenbrockmatrix,weﬁndthatΣhasoneinvariantzero−β(regardlessofthevalueofβ).(v)Writingthatdet(sI2−A+BK)=s2+3s+2,weﬁndthatK=(cid:25)24(cid:26).Theequilibriumstateisx∗=−(A−BK)−1Bk0andthecorrespondingoutputisy∗=Cx∗.Wethusneedtohave−C(A−BK)−1Bk0=1,hencek0=2/β.(vi)(a)NeitherΣnorthecontrollerisanintegratorsystem,thusthereisanon-zerostaticerrorinthepresenceofanon-zerooutputdisturbance.(b)Theanswerisyes,sincethenumberofoutputsisequaltothenumberofinputsands=0isnotaninvariantzeroofΣ.(c)WeobtainKp=(cid:25)35(cid:26)andKi=2.(d)Rule111isbeingcompliedwith.(vii)(a):See(9.14).(b)Identifyingdet(cid:9)sI2−A+˜KC(cid:10)termbytermwiths2+11s+10,weobtain˜K=(cid:25)91(cid:26)T.SolutionofExercise300(i)TheKalmancriterionshowsthatΣisnotcontrollablebutobservable.Thepoles,whicharetheeigenvaluesofA,are{−1,1}.(ii)ThestabilizabilitycanbestudiedusingthePopov-Belevitch-Hautustest(Proposition186).Theuniquei.d.z.is542LinearSystems−1,thusΣisstabilizable.(iii)Letu=−(cid:25)k1k2(cid:26)x.Weobtaindet(sI2−A+BK)=s2+s(k1−k2)+k1−k2−1=(s+1)(s+k1−k2−1).Wethushavedet(sI2−A+BK)=(s+1)(s−λ)ifandonlyifk2+1−k1=λ.Asaresult,asolutionexistsbutisnotunique.Forλ=−1,aparameterizationofthesolutionsisk2=k,k1=k+1−λ,wherekisanarbitraryparameter.(iv)Thefull-orderobserverisgivenby(9.3)whereD=0andwhere˜K=(cid:25)˜k1˜k2(cid:26)Tissuchthatdet(cid:9)sI2−A+˜KC(cid:10)=(s+1)(s+10).Afteratermbytermcomparison,weobtain˜k1=11and˜k2=−11.(v)Inordertouse(9.34),putx(cid:2)=(cid:25)x2x1(cid:26)T.Weobtain˙x(cid:2)=A(cid:2)x(cid:2)+B(cid:2)u,y=C(cid:2)x(cid:2)withA(cid:2)=(cid:27)−1/2−3/2−1/21/2(cid:28),B(cid:2)=(cid:27)−11(cid:28),C(cid:2)=(cid:25)01(cid:26).Theonlystatetobereconstructedisx(cid:2)1=x2.WehaveA(cid:2)r=−1/2andC(cid:2)r=−1/2.Take=−10asanobserverpole.Thegain˜KrofthisobserverhastobechosensuchthatA(cid:2)r−˜KrC(cid:2)r=,thus˜Kr=(A(cid:2)r−)/C(cid:2)r=−19.Accordingto(9.38),theminimalobserverisgivenby(cid:20)˙z=−10z+198y+18u,ˆx2=z+19y.(vi)Intheparameterizationof(iv)withk=0weobtainu=−k1x1=−2yandsoanobserverisnotrequired.SolutionofExercise301(i)Σisdeﬁnedbytheleftform(cid:15)∂2+∂−1(cid:16)y=u.Incase(a),S(∂)=∂2+3∂,R(∂)=4∂2+7∂+1,T(∂)=∂+1.Incase(b),S(∂)=∂3+4∂2+7∂,R(∂)=7∂2+12∂+1,T(∂)=∂2+2∂+1.(ii)WehaveJ=0andF=(cid:27)−1110(cid:28),G=(cid:27)01(cid:28),H=(cid:25)10(cid:26).(a)u=−Kpx−Ki(cid:1)e(t)dt+const.withKp=(cid:25)22(cid:26),Ki=1.(b)Theminimalobserveris˙z=−z+y+u,ˆx1=y,ˆx2=z+y.Thefull-orderobserveris∂ˆx=Fˆx+Gu+L(y−Hˆx),L=(cid:27)11(cid:28).(c)Thetwostatefeedback/observersyntheseswithintegralactionareoftheform(9.30)andareidenticaltotheRSTcontrollerinQuestion(i)(a)inthecaseofaSolutionsofExercises543minimalobserverandtothatofQuestion(i)(b)inthecaseofafull-orderobserver.(iii)Thedrawbackofthesecontrollersisthattheydonotplacetheclosed-looppolesaccordingtotheconditionsinTheorem112,whichcanleadtoalackofrobustness.Tocorrectthisﬂaw,wecanchooseobserversthathavefasterpoles(at−10forexample,inthecaseoftheminimalobserver,andat{−10,−10}inthecaseofthefull-orderobserver),sinceΣhasallitszerosatinﬁnity.SolutionofExercise302Letbethesystem⎧⎨⎩∂x=Ax+Bu+d1y=Cx+Du+d2e=Ey−rwithsizesasspeciﬁedinsection9.2.1.Wegetz=E(Cx+Du+d2)−r=Hx+Ju+d3−rwhereH=ECandJ=ED.Ifthestatexisavailableforthecontrol,thesolutiondevelopedinsection8.3.2remainsvalid(changingthenotation)undertheconditionthatthefollowinghypothesesaresatisﬁed:–(A,B)iscontrollable;–thetransfermatrixE(sIn−A)−1B+JissemiregularoverR(s);–m≥pandthesystem{A,B,H,J}hasnoinvariantzerothatisarootofϕ(s).Inthepresentcase,thecontrol(8.38)hastobereplacedbyυ=−(cid:25)KpKε(cid:26)(cid:27)ˆηηε(cid:28)whereˆηisobtainedbyreconstructingthevariableη=ϕ(∂)xbymeansoftheobserver∂ˆη=Aˆη+Bυ+˜K(ϕ(∂)y−Cˆη−Dυ)whereυ=ϕ(∂)uandwhere˜KisagainmatrixsuchthatA−˜KChasallitseigenvaluesappropriatelychoseninthelefthalf-plane.Onesuchgaincanbechosenundertheconditionthatthefollowinghypothesisissatisﬁed:–(C,A)isobservable.Nowletˆxbeavariablesuchthatϕ(∂)ˆx=ˆη.Thecontrollawsolutionoftheproblemisﬁnallygivenbytherelation(8.39)ofsection8.3.2andbyu=−Kpˆx−Kεxε,whichreplaces(8.40).14.10.ExercisesofChapter10SolutionofExercise355Weobtainxd=0.Thestrictinequalityisthusessential.544LinearSystemsSolutionofExercise356(i)ThepolesofΣare{−2,−2}.(ii)WehaveA=−2I2+J0,2(withthenotationofsection13.3.4).WethushaveAd=exp(AT)=exp(−2T)exp(J0,2T)andexp(J0,2t)=I2+J0,2T=(cid:27)10t1(cid:28)because(J0,2)2=0.Asaresult,Ad=(cid:27)e−0.400.2e−0.4e−0.4(cid:28)=(cid:27)0.670300.13410.6703(cid:28).Ontheotherhand,Bd=(cid:1)T0eAtdtB=(cid:1)T0eAtBdtwitheAtB=(cid:27)e−2tte−2t(cid:28).Wehave(cid:1)T0e−2tdt=12(cid:15)1−e−2T(cid:16)=0.1648.Furthermore,(cid:1)te−2tdtisoftheforme−2t(at+b).Differentiatingthislastexpressionandidentifyingtheresultwithte−2t,wegeta=−1/2andb=−1/4.Therefore,(cid:2)T0te−2tdt=14(cid:25)1−(2T+1)e−2T(cid:26)=0.0154,andweobtainBd=(cid:27)0.16480.0154(cid:28).Ofcourse,Cd=C.(iii)WehaveGd(z)=C(zI2−Ad)−1Bd=0.0154z+0.0118z2−1.3406z+0.4493.ThepolesofΣdarethediagonalelementsofAd(sincethismatrixislowertriangular),i.e.{0.6703,0.6703}=(cid:31)epT,epT withp=−2.SolutionofExercise357(i)A=(cid:27)0100(cid:28),B=(cid:27)01(cid:28),C=(cid:25)10(cid:26).(ii)Ad=(cid:27)1T01(cid:28),Bd=(cid:27)T2/2T(cid:28)SolutionsofExercises545thus{Ad,Bd,C}isnotinobservablecanonicalform.(iii)ThetransferfunctionofΣdisGd(z)=T2(z+1)2(z−1)2(seeTable(10.14)),thusΣdisdescribedbytheleftformD(q)yd=N(q)udwithD(q)=(q−1)2,N(q)=T22(q+1).(iv)Takingintoaccountadelayτ=nT,theleftformofΣdbecomes(q−1)2qnyd=T22(q+1)ud.(14.1)(v)Thecorrespondingobservablecanonicalformis,forn=3,Ad=⎡⎢⎢⎢⎢⎣21000−10100000100000100000⎤⎥⎥⎥⎥⎦,Bd=⎡⎢⎢⎢⎢⎣000T2/2T2/2⎤⎥⎥⎥⎥⎦,Cd=(cid:25)10000(cid:26).(vi)Thereaderisaskedtocarefullydrawthesuggestedblockdiagram,whichwillmakeapparenta“delayline”.(vii)Thegeneralizationtoanynisthenevident.(viii)Equation(14.1)isaclassicleftformofadiscrete-timesystem.Asaresult,anRSTcontrollercanbeeasilydesignedusingtheinvokedmethods,anditisthenaveryeffectivepredictivecontrol.SolutionofExercise358ThefollowingformulasarecorrectifλisnotaneigenvalueofˇA:Ad=(cid:15)λI−ˇA(cid:16)−1(cid:15)λI+ˇA(cid:16),Bd=λT(cid:15)λI−ˇA(cid:16)−1ˇB,C=2TˇC(cid:15)λI−ˇA(cid:16)−1,D=ˇC(cid:15)λI−ˇA(cid:16)−1ˇB+ˇD.Ingeneral,D(cid:5)=0.SolutionofExercise359(i)isclearaccordingto(10.37).(ii)Wehave˜Ad=(1/T)(Ad−In)and˜Bd=(1/T)Bd.(iii)Accordingto(10.37),˜Ad→Aand˜Bd→B.Forsmallsamplingperiods,thequantizationrisksdestroyingalltheinformationcontainedinmatricesAdandBdaccordingto(i),whichisnotthecaseifweusethedeltaformalismaccordingtotheabove.(iv)Letbeforexampleacontrollerrepresentedbyastate-spacesystemusingtheoperatordelta,i.e.δηd=Fηd+Gzd,ud=Hηd+Jzd,whereηdis546LinearSystemsthestate,zdisthecontrollerinput,consistingofdiscretizedmeasurementsandofthereferencesignal,andwhereudisthediscrete-timecontrolcalculated.(iv)Usingthedeltaformalism,thecalculationsareorganizedasfollows:(1)AtinstantkT,(a)weacquiredsignalzd,(b)wecalculateud=µd+Jzdwhereµd=Hηd,aquantitywhichcanbecalculatedbeforehand,(c)weapplythecontrol.(2)BetweeninstantskTand(k+1)T,(a’)wecalculateνd(cid:1)Fηd+Gzd,(b’)wecalculateηd+1=Tνd+ηd,(c’)wecalculateµd+1=Hηd+1.Atinstant(k+1)T,wearereadytore-iteratethecalculationswithkchangingtok+1.Thecalculationsarethussimpleandfast,whichisinnowaythecasewiththeoperator∆;thisoperatorisveryusefulforthesynthesisofadiscrete-timecontrollerbutnotatallforitsimplementation.SolutionofExercise360(i)Gd(z)=1−az−a=Bd(z)Ad(z)wherea=exp(−T)andˇG(w)=Gd(cid:21)1+(T/2)w1−(T/2)w(cid:22)=−(cid:9)1−a1+a(cid:10)w+2T1−a1+aw+T21−a1+a.(ii)ForT→0+,1+a→2,1−a∼T,thusˇG(w)∼11+w=G(w)whereG(s)isthetransferfunctionofΣ.ThisisconsistentwithRemark343(ii).(iii)Itnowremainstoapplythemethoddiscussedinsection6.3.4andtotakeintoaccounttheresultsofExercise121(section6.5).ThuswetakeAcl(∆)=(∆+10/3)3andthepolynomialsˇS(∆),ˇR(∆)oftheformˇS(∆)=∆2+ˇσ1∆,ˇR(∆)=ˇr1∆+ˇr2.WithT=0.2,wegetˇG(w)=−0.05w+0.9992w2+0.9992w.SolvingtheSylvestersystem,weobtainˇσ1=11.56,ˇr1=25.61,ˇr2=37.16.Ontheotherhand,ˇT(∆)=κ(∆+10/3)2whereκissuchthatˇT(0)=ˇR(0)=ˇr2,whichyieldsˇT(∆)=3.34∆2+22.30∆+37.16.(iv)Thecorrespondingdiscrete-timeRSTcontrollerisobtainedbywriting(cid:25)Rd(z)Td(z)(cid:26)Sd(z)=(cid:25)ˇR(w)ˇT(w)(cid:26)ˇS(z)|w=2Tz−1z+1SolutionsofExercises547whichyieldsRd(q)=1.3603q2+0.3448q−1.0155,Sd(q)=q2−0.9278q−0.0722,Td(q)=2.7583q2−2.7583q+0.6896.WehaveSd(1)=0(integratorsystem),Rd(1)=Td(1)(nostaticerror)andRd(−1)(zerogainatNyquistfrequency).(v)WeagainusethemethodofExample352(ii).Thetransferfunctionofthepseudo-continuoussystemwhichwebeginthecomputationwithisgivenbyˇG(w)=1−(T/2)w1+(T/2)wGd(cid:21)1+(T/2)w1−(T/2)w(cid:22).Thispseudo-continuoussystemisdeﬁnedbytheleftformwithpolynomialsˇA(∆)=∆2+10.9967∆+9.9668,ˇB(w)=0.0997∆2−1.9934∆+9.9668.Thecharacteristicpolynomialofthepseudo-continuousclosed-loopis(seesection6.3.5)Acl(∆)=Ac(∆)(∆+10/3)(∆+2/T),Ac(∆)=(∆+10/3)(∆+2/T).SolvingtheSylvestersystem,wegetˇS(∆)=∆3+16.24∆2+168.70∆,ˇR(∆)=27.72∆2+314.38∆+371.60,ˇT(∆)=3.34∆3+55.74∆2+260.12∆+371.60,hence(aftersimpliﬁcationoftherootq=0,commontoallthepolynomials)weﬁnallygetSd(q)=q3−0.6813q2−0.0722q−0.2466,Rd(q)=1.4585q2+0.3448q−1.1137,Td(q)=2.7583q2−2.7583q+0.6896.Forinformationonly,thebehaviorofthecontrolledsystemisshowninFigure14.7whenthefollowingeventsoccur:(a)unitstepcommandatt=0;(b)stepdisturbance548LinearSystemsFigure14.7.Time-domainresponses–Exercise360addingattheoutputfromt=5.Wecanseetheresponseswiththeﬁrstcontroller(-)andwiththesecondone(--).Theabsolutevalueofthesensitivityfunction))))))11+Bd(z)Ad(z)Rd(z)Sd(z)))))))z=eiωT,expressedindB,isalsoshown,asafunctionofω,inFigure14.8.Thisshowsthatwiththetwocontrollers,themodulusmarginiscorrect(with,ofcourse,anadvantagefortheﬁrstcontroller,becausetheintroductionofapuredelaycanonlybedisadvantageous).SolutionofExercise361Itsufﬁcestoreplacetheangularfrequencyω0intheexpressionofD1(∆)by˜ω0=(2/Te)tan(Teω0/2).SolutionofExercise362(i)LetΣdbethesystemobtainedbydiscretizationofSystemΣwithsamplingperiodT>0,whereΣisdeﬁnedby˙x=Ax+Bu.ThenzisapoleofΣdifandonlyifz=esTwheresisapoleofΣ,accordingto(10.15)(section10.3.4)andProposition439(section12.4.2).Asaresult,zcannotbelongto(−∞,0).(ii)IfΣisadelaysystem,Σdhaspolesat0(seeExercise357).SolutionsofExercises549Figure14.8.Sensitivityfunction–Exercise360SolutionofExercise363(i)ThesystemΣd,associatedwiththeR-moduleM,hasani.d.z.whichis−1,itisthereforenotstabilizable.(ii)TheequationoftheB-moduleQ−1M=˘Misq˘yd=˘ud,andbyrestrictionoftheringofscalarsfromBtoCweobtain(1+∆/λ)˘yd=(1−∆/λ)˘ud,whichdeﬁnesthepseudo-continuoussystem˘Σ(seeExample347).Thissystemiscontrollable,whichdoesnotcontradictTheorem350norProposition346since−1isapoleofΣd.(iii)ThesystemΣd,whichhasapole−1,couldnothavebeenobtainedbydiscretizationofacontinuous-timesystemaccordingtoExercise362.14.11.ExercisesofChapter11SolutionofExercise421(i)Wehave(cid:27)ryy(0)−ryu(0)−ryu(0)ruu(0)(cid:28)(cid:27)ˆaˆb(cid:28)=(cid:27)−ryy(1)ryu(−1)(cid:28).(ii)Wecalculater(cid:2)yy(1),r(cid:2)yu(0)andr(cid:2)yu(−1)usingProposition367.Thesequantitiesallhaveanabsolutevalueoflessthan1andtheresultsareconsistent.(iii)Weobtainˆa=−0.6091andˆb=0.9636.(iv)Thepoleoftheidentiﬁedsystemisz=0.6091.Itisinsidetheopenunitcircle,thustheidentiﬁedsystemisstable.Itsstaticgainisˆbz−11+ˆaz−1forz=1,whichis2.4651.550LinearSystemsSolutionofExercise424(i)LetθCbethevectorwhosecomponentsarethecoefﬁcientsofthepolynomialCoftheARMAXmodel.Withthismodel,thetransferfunctionsoftheexpression(11.32)(section11.2.3)areoftheformG(cid:15)q−1,θ(cid:16)=B(cid:15)q−1,θs(cid:16)A(q−1,θs),H(cid:15)q−1,θ(cid:16)=C(cid:15)q−1,θC(cid:16)A(q−1,θs),andsothemodelcannotbeputintheform(11.35)ofsection11.2.5:thehypothesesofTheorem408(i)arenotinforce.(ii)Suppose˘G(cid:15)q−1(cid:16)=˘B(cid:15)q−1(cid:16)˘A(q−1)=G(cid:9)q−1,˘θs(cid:10)isthedeterministicpartofthe“true”system,andn(t)=˘C(cid:15)q−1(cid:16)˘D(q−1)w(t)isthe“actual”coloredmeasurementnoise,sothaty(t)=˘B(cid:15)q−1(cid:16)˘A(q−1)u(t)+˘C(cid:15)q−1(cid:16)˘D(q−1)w(t).InthequantityQ2oftheproofofTheorem408,theratio˜H=˘H/Hisoftheform˜H(cid:15)q−1(cid:16)=˘C(cid:15)q−1(cid:16)˘D(q−1)A(cid:15)q−1,θs(cid:16)C(q−1,θC).TominimizeQ2,wehavetomakethisratioequalto1,andthustoobtaintheequalityC(cid:15)q−1,θC(cid:16)=˘C(cid:15)q−1(cid:16)˘D(q−1)A(cid:15)q−1,θs(cid:16).Inordertohaveatthesametimeθs=˘θs,itisnecessarythatC(cid:15)q−1,θC(cid:16)=˘C(cid:15)q−1(cid:16)˘D(q−1)˘A(cid:15)q−1(cid:16),whichispossiblewithapowerseriesC(cid:15)q−1,θC(cid:16)=1++∞(cid:12)τ=1c(τ)q−τbutnotwithapolynomial.Bytruncatingtheabovepowerseries,weobtainagoodapproximationifasufﬁcientnumberoftermsarekept.WethuscanobtainacorrectestimationofthedeterministicpartbyusingapolynomialC(cid:15)q−1,θC(cid:16)whosedegreeislargeenough.SolutionsofExercises551SolutionofExercise425SameprincipleasusedinExercise424.SolutionofExercise426Wehavey(t)=Gi(cid:15)q−1,θ(cid:16)˜u(t)+Hc(cid:15)q−1(cid:16)Hi(cid:15)q−1,θ(cid:16)w(t).with˜u(t)=Gc(cid:15)q−1(cid:16)u(t),whichistheinputtobeconsidered.WedealwiththefactorHc(cid:15)q−1(cid:16)asinsection11.2.6.SolutionofExercise427(i)Yes,accordingtoTheorem417.(ii)UsingH(cid:15)q−1,θβ(cid:16)=1in(11.56),wealsoobtainabicausalbistablesecondordertransferfunctionH(cid:15)q−1,θs,θβ(cid:16),thusnc=2istheminimalnumberofcoefﬁcientswhichwewilluseforpolynomialC(cid:15)q−1(cid:16)oftheARMAXmodel(i.e.C(cid:15)q−1(cid:16)=1+c1q−1+c2q−2).Bibliography[1]B.D.OAnderson,J.B.Moore,OptimalFiltering,Prentice-Hall,EnglewoodCliffs,NJ,1979.[2]B.D.OAnderson,J.B.Moore,OptimalControl–LinearQuadraticMethods,Prentice-Hall,EnglewoodCliffs,NJ,1989.[3]K.J.Aström,B.Wittenmark,AdaptiveControl,Addison-Wesley,1989.[4]K.J.Aström,B.Wittenmark,Computer-ControlledSystems,TheoryandDesign,2nded.,Prentice-Hall,EnglewoodCliffs,NJ,1990.[5]J.Bass,Fonctionsdecorrélation,fonctionspseudo-aléatoiresetapplications,Masson,1984.[6]M.Benidir,B.Picinbono,“ExtendedtableforeliminatingthesingularitiesinRouth’sarray”,IEEETrans.Automat.Control,35(2),218–222,1990.[7]S.P.Bhattacharyya,H.Chapellat,L.H.Keel,RobustControl:TheParametricApproach,Prentice-Hall,EnglewoodCliffs,NJ,1995.[8]A.Blanc-Lapierre,B.Picinbono,Fonctionsaléatoires,Masson,1981.[9]H.W.Bode,NetworkAnalysisandFeedbackAmpliﬁerDesign,VanNostrand,1945.[10]N.Bourbaki,AlgebraIandII,Springer,1989–1990.[11]N.Bourbaki,CommutativeAlgebra,Chapters1–7,Springer,1989.[12]N.Bourbaki,FunctionsofaRealVariable–ElementaryTheory,Springer,2004.[13]H.Bourlès,“Surlarobustessedesrégulateurslinéairesquadratiquesmultivariables,optimauxpourunefonctionnelledecoûtquadratique”,C.RAcad.Sci.,SerieI,252,971–974,1981.[14]H.Bourlès,“Semi-cancellablefractionsinsystemtheory”,IEEETrans.Automat.Control,39(10),2148–2153,1994.[15]H.Bourlès,“Structuralpropertiesofdiscreteandcontinuouslineartime-varyingsystems:auniﬁedapproach”,AdvancedTopicsinControlSystemsTheory–LectureNotesfromFAP2004(F.Lamnabhi-Lagarrigue,A.LoriaandE.Panteley,eds),chap.6,pp.225–280,LectureNotesinControlandInformationSciences,vol.311,Springer,553Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.554LinearSystems2005.“Structuralpropertiesoflinearsystems–PartII:Structureatinﬁnity”,AdvancedTopicsinControlSystemsTheory–LectureNotesfromFAP2005(A.Loria,F.Lamnabhi-LagarrigueandE.Panteley,eds),chap.7,pp.259–284,LectureNotesinControlandInformationSciences,vol.328,Springer,2006.[16]H.Bourlès,“Impulsivesystemsandbehaviorsinthetheoryoflineardynamicalsystems”,ForumMathematicum,17(5),781–808,2005.[17]H.Bourlès,F.Aïoun,“ApprocheH∞etµ-synthèse”,LaRobustesse–analyseetsynthèsedecommandesrobustes,A.Oustaloup(co-ordinator),chap.3,pp.163–235,Hermès,Paris,1994.[18]H.Bourlès,F.Colledani,“W-StabilityandLocalInput-OutputStabilityResults”,IEEETrans.onAutom.Control,40(6),pp.1102–1108,1995.H.Bourlès,“Addendumto‘W-StabilityandLocalInput-OutputStabilityResults’”,IEEETrans.onAutomat.Control,45(6),1220–1221,2000.[19]H.Bourlès,M.Fliess,“Finitepolesandzerosoflinearsystems:anintrinsicapproach”,Int.J.Control,68(4),897–922,1997.[20]H.Bourlès,E.Irving,“LaméthodeLQG/LTR:uneapprochepolynômialetempscontinu/tempsdiscret”,RAIROAPII,25,545–592,1991.[21]H.Bourlès,B.Marinescu,“Polesandzerosatinﬁnityoflineartime-varyingsystems”,IEEETrans.Automat.Control,44,1981–1985,1999.[22]H.Bourlès,B.Marinescu,LinearTime-VaryingSystems:AnAlgebraic-AnalyticApproach,Springer-Verlag(forthcoming).[23]H.Bourlès,U.Oberst,“Dualityfordifferential-differencesystemsoverLiegroups”,SIAMJ.ControlOptim.,48,2051–2084,2009.[24]J.-P.Caron,J.-P.Hautier,Modélisationetcommandedelamachineasynchrone,EditionsTechnip,1995.[25]H.Cartan,ElementaryTheoryofAnalyticFunctionsofOneorSeveralVariables,DoverPublicationsInc.,1995.[26]C.-T.Chen,LinearSystemTheoryandDesign,Holt,RinehartandWinston,1984.[27]J.Chen,“Multivariablegain-phaseandsensitivityintegralrelationsanddesigntradeoffs”,IEEETrans.Automat.Control,43(3),373–385,1998.[28]P.Chevrel,H.Bourlès,“ReducedorderH2andH∞observers”,32ndIEEECDC,13–17DecemberSanAntonio(Texas),pp.2915–2916,1993.[29]P.G.Ciarlet,Introductionàl’analysenumériqueetàl’optimisation,Masson,1990.(Englishtranslation:IntroductiontoNumericalLinearAlgebraandOptimisation,CambridgeUniversityPress,1989.)[30]E.A.CoddingtonandN.Levinson,TheoryofOrdinaryDifferentialEquations,McGraw-Hill,1955.[31]P.Cohn,FreeRingsandtheirRelations,AcademicPress,1985.[32]P.Cohn,FurtherAlgebraandApplications,Springer,2003.Bibliography555[33]R.F.Curtain,H.J.Zwart,AnIntroductiontoInﬁniteDimensionalLinearSystemsTheory,Springer,1995.[34]C.A.Desoer,M.Vidyasagar,FeedbackSystems:Input-OutputProperties,AcademicPress,1975.[35]J.Dieudonné,Elémentsd’Analyse,Vol.ItoVI,Gauthier-Villars,1969–1975.(Englishtranslation:TreatiseonAnalysis,AcademicPress,1969–1978.)[36]J.Dieudonné,InﬁnitesimalCalculus,KershawPublishing,1973.[37]J.L.Doob,StochasticProcesses,JohnWiley,1953.[38]J.C.Doyle,G.Stein,“Robustnesswithobservers”,IEEETrans.Automat.Control,24,607–611,1979.[39]J.C.Doyle,B.A.Francis,A.R.Tannenbaum,FeedbackControlTheory,MacMillan,1992.[40]J.A.Farrell,M.M.Polycarpou,AdaptiveApproximationBasedControl-UnifyingNeural,FuzzyandTraditionalAdaptiveApproximationApproaches,Wiley,2006.[41]A.Feintuch,R.Saeks,SystemTheory–AHilbertSpaceApproach,AcademicPress,1982.[42]M.Fliess,“Somestructuralpropertiesofgeneralisedlinearsystems”,SystemsControlLett.,15,391–396,1990.[43]M.Fliess,“RemarkonWillems’trajectorycharacterizationoflinearcontrollability”,SystemsControlLett.,19,43–45,1992.[44]M.Fliess,“SomeremarksontheBrunovskycanonicalform”,Kybernetika,29(5),417–422,1993.[45]M.Fliess,“UneinterprétationalgébriquedelatransformationdeLaplaceetdesmatricesdetransfert”,LinearAlgebraAppl.,203–204,429–442,1994.[46]M.Fliess,H.Bourlès,“Discussingsomeexamplesoflinearsysteminterconnections”,SystemsControlLett.,27,1–7,1996.[47]M.Fliess,S.T.Glad,“Analgebraicapproachtolinearandnonlinearcontrol”,EssaysonControl:PerspectivesintheTheoryanditsApplications(H.L.TrentelmanandJ.C.Willems,eds),Birkhäuser,chap.8,223–267,1993.[48]M.Fliess,J.Lévine,Ph.Martin,P.Rouchon,“Flatnessanddefectofnon-linearsystems:introducingtheoryandexamples”,Int.J.Control,61(6),1327–1361,1995.[49]A.L.D.Franco,H.Bourlès,E.R.dePieri,H.Guillard,“RobustnonlinearcontrolassociatingrobustfeedbacklinearizationandH∞control”,IEEETrans.Automat.Control,51(7),1200–1207,2006.[50]J.S.Freudenberg,D.P.Looze,“Righthalfplanepolesandzerosanddesigntradeoffsinfeedbacksystems”,IEEETrans.Automat.Control,30(6),555–565,1985.[51]J.S.Freudenberg,D.P.Looze,FrequencyDomainPropertiesofScalarandMultivariableFeedbackSystems,Springer,1988.[52]F.R.Gantmacher,TheTheoryofMatrices,vol.1,Chelsea,1959.556LinearSystems[53]J.B.Garnett,BoundedAnalyticFunctions,AcademicPress,1981.[54]H.Glüsing-Lüerssen,“Abehavioralapproachtodelaydifferentialequations”,SIAMJ.ControlOpt.,35,480–499,1997.[55]H.Glüsing-Lüerssen,LinearDelay-DifferentialSystemswithCommensurateDelays:AnAlgebraicApproach,Springer,2001.[56]G.H.Golub,C.F.VanLoan,MatrixComputations,2nded.,TheJohnsHopkinsUniversityPress,1989.[57]G.C.Goodwin,K.S.Sin,AdaptiveFilteringPredictionandControl,Prentice-Hall,1984.[58]H.Gorecki,S.Fuksa,P.Grabowski,A.Korytowski,AnalysisandSynthesisofTimeDelaySystems,Wiley,1989.[59]J.K.Hale,S.M.VerduynLunel,IntroductiontoFunctionalDifferentialEquations,Springer,1993.[60]M.E.Harris,“Someresultsoncoherentrings”,Proc.Amer.Math.Soc.,17,474–479,1966.[61]P.Ioannou,G.Tao,“Frequencydomainconditionsforstrictlypositiverealfunctions”,IEEETrans.Automat.Control,32(1),53–54,1987.[62]A.Isidori,NonlinearControlSystems(3rded.),Springer,1995.[63]T.Kaczorek,LinearControlSystems–Volume1,JohnWiley,1992.[64]T.Kailath,LinearSystems,Prentice-Hall,1980.[65]R.E.Kalman,“Mathematicaldescriptionoflineardynamicalsystems”,SIAMJ.Control,Ser.A,1(2),152–192,1963.[66]I.Kaminer,A.M.Pascoal,P.P.Khargonekar,E.Coleman,“Avelocityalgorithmfortheimplementationofgain-scheduledcontrollers”,Automatica,31(8),1185–1191,1995.[67]I.Kaplansky,“Elementarydivisorsandmodules”,Trans.Amer.Soc.,66,464–491,1949.[68]V.Krishnan,NonlinearFilteringandSmoothing:AnIntroductiontoMartingales,StochasticIntegralsandEstimation,Wiley,1984.[69]V.Kucera,“Acontributiontomatrixquadraticequations”,IEEETrans.Automat.Control,17(3),344–347,1972.[70]P.Kundur,PowerSystemStabilityandControl,McGraw-Hill,1994.[71]H.Kwakernaak,“Optimallow-sensitivitylinearfeedbacksystems”,Automatica,5,279,1969.[72]H.Kwakernaak,R.Sivan,LinearOptimalControlSystems,Wiley,1972.[73]T.Y.Lam,LecturesonModulesandRings,Springer,1999.[74]I.D.Landau,Commandedessystèmes–Conception,identiﬁcationetmiseenœuvre,Hermès,2002.[75]I.D.Landau,A.Karimi,“ARecursiveAlgorithmforARMAXModelIdentiﬁcationinClosedLoop”,IEEETrans.onAutomat.Control,44(4),840–843,1999.Bibliography557[76]L.D.Landau,E.M.Lifshitz,Mechanics(3rded.),PergamonPress,1976.[77]P.deLarminat,Y.Thomas,Automatiquedessystèmeslinéaires-vol.1-3,Flammarion,1975–1977.[78]P.deLarminat,Automatique–commandedessystèmeslinéaires(2èmeed.),Hermès-science,1996.[79]M.D.Larsen,J.Lewis,T.S.Shores,“Elementarydivisorringsandﬁnitelypresentedmodules”,Trans.Amer.Math.Soc.,187(1),231–248,1974.[80]D.J.Leith,W.E.Leithead,“Surveyofgain-schedulinganalysisanddesign”,Int.J.Control,73(11),1001–1025,2000.[81]L.Ljung,SystemIdentiﬁcation–TheoryfortheUser,Prentice-Hall,1987.[82]L.Ljung,U.Forssell,“Analternativemotivationfortheindirectapproachtoclosed-loopidentiﬁcation”,IEEETrans.Automat.Control,44(11),2206–2209,1999.[83]M.Loève,ProbabilityTheory(3rded.),VanNostrandCo.,1963.[84]H.Logemann,“OntheNyquistcriterionandrobuststabilizationofinﬁnite-dimensionalsystems”,RobustControlofLinearSystemsandNonlinearControl(M.AKaashoek,J.H.vanSchuppenandA.C.M.Ran,eds),vol.II,Birkhäuser,627–634,1990.[85]H.Logemann,“Stabilizationandregulationofinﬁnite-dimensionalsystemsusingcoprimefactorizations”,LNCIS185,Springer,102–139,1993.[86]J.J.Loiseau,“Invariantfactorassignmentforaclassoftime-delaysystems”,Kybernetika,37(3),265–275,2001.[87]D.G.Luenberger,“Observingthestateofalinearsystem”,IEEETrans.Mil.Electron.,8,74–80,1964.[88]D.G.Luenberger,“Anintroductiontoobservers”,IEEETrans.Automat.Control,16,596–602,1971.[89]D.C.MacFarlane,K.Glover,RobustControllerDesignUsingCoprimeFactorPlantDescriptions,Springer,1990.[90]J.M.Maciejowski,MultivariableFeedbackDesign,Addison-Wesley,1989.[91]S.MacLane,G.Birkhoff,Algebra(2nded.),MacMillan,1979.[92]B.Marinescu,H.Bourlès,“Robustpredictivecontrolwithseparationproperty:areduced-statedesignforcontrolsystemswithnon-equaltimedelays”,Automatica,36,555–562,2000.[93]C.L.Matson,P.S.Maybeck,“OnanassumedconvergenceresultintheLQG/LTRtechnique”,IEEETrans.Automat.Control,36,123–125,1991.[94]U.Oberst,“Multidimensionalconstantlinearsystems”,ActaAppl.Math.,20,1–175,1990.[95]R.PalludelaBarrière,Coursd’automatiquethéorique,Dunod,1966.(Englishtranslation:OptimalControlTheory:ACourseinAutomaticControlTheory,DoverPublications,1980.)558LinearSystems[96]J.W.Polderman,J.C.Willems,IntroductiontoMathematicalSystemTheory,Springer,1998.[97]V.M.Popov,“Invariantdescriptionoflinear,time-invariantcontrollablesystems,SIAMJ.Control,10,252–264,1972.[98]A.Quadrat,“Thefractionalrepresentationapproachtosynthesisproblems:analgebraicanalysisviewpoint.PartI:(weakly)doublycoprimefactorizations.PartII:internalstabilization”,SIAMJ.ControlOptim.,42,266–299,300–320,2003.[99]R.Rabah,B.Bergeon,“Onstatespacerepresentationforlineardiscrete-timesystemsinHilbertspaces”,KharkovUniversityVestnik,514(50),53–62,2001.[100]H.H.Rosenbrock,State-SpaceandMultivariableTheory,Nelson,1970.[101]H.H.Rosenbrock,“Correctionto‘thezerosofasystem”’,Int.J.Control,20(3),525–527,1974.[102]J.J.Rotman,AnIntroductiontoHomologicalAlgebra,AcademicPress,1979.[103]W.Rudin,RealandComplexAnalysis(3rded.),McGraw-Hill,1987.[104]W.J.Ruth,J.S.Shamma,“Researchongainscheduling”,Automatica,36,1401–1425,2000.[105]C.E.Shannon,“CommunicationsinthePresenceofNoise”,Proc.IRE,37,pp.10–21,1949.[106]L.Schwartz,Théoriedesdistributions,Hermann,1966.[107]S.SkogestadandI.Postlethwaite,MultivariableFeedbackControl–AnalysisandDesign,Wiley,2001.[108]J.-J.Slotine,W.Li,AppliedNonlinearControl,Prentice-Hall,1991.[109]M.C.Smith,“Onstabilizationandtheexistenceofcoprimefactorizations”,IEEETrans.Automat.Control,34(9),1005–1007,1989.[110]T.Söderström,P.Stoica,SystemIdentiﬁcation,Prentice-Hall,1989.[111]E.D.Sontag,MathematicalControlTheory,Springer,1990.[112]V.delToro,BasicElectricMachines,Prentice-Hall,1990.[113]M.Vidyasagar,“Onundershootandnonminimumphasezeros”,IEEETrans.Automat.Control,31,440,1986.[114]M.Vidyasagar,ControlSystemSynthesis–AFactorizationApproach,MITPress,1987.[115]M.Vidyasagar,NonlinearSystemsAnalysis(2nded.),Prentice-Hall,1993.[116]J.C.Willems,TheAnalysisofFeedbackSystems,MITPress,1971.[117]J.C.Willems,“Paradigmsandpuzzlesinthetheoryofdynamicalsystems”,IEEETrans.Automat.Control,36,259–294,1991.[118]W.M.Wonham,“Randomdifferentialequationsincontroltheory”,ProbabilisticMethodsinAppliedMathematics,vol.2(A.T.Bharucha-Reid,ed.),131–220,AcademicPress,1970.Bibliography559[119]W.M.Wonham,LinearMultivariableControl–AGeometricApproach,Springer,1985.[120]L.A.Zadeh,C.A.Desoer,LinearSystemTheory,McGraw-Hill,1963.[121]E.Zerz,“Primenessofmultivariatepolynomialmatrices”,SystemsControlLett.,29,139–145,1996.[122]K.Zhou,J.C.Doyle,K.Glover,RobustandOptimalControl,Prentice-Hall,1996.IndexAactuator,25adjointclassical-,458advance,386algebra,450Banach-,518convolution-,379,385,393normed-,517sigma-,438Borel-,438unitary-,450almost-everywhere,377-surely,439annihilator,496approximationEuler,313Padé-,89associated-elements,447associates,447atom,452automorphism,387,479Bballclosed-,371open-,371unit-,372basis-ofavectorspace,473canonical-,474cyclic-,487dual-,479orthonormal-,505behaviorfree-,33bracketduality-,372Butterworthconﬁguration,233Ccategory,520abelian-,495Cauchyproblem,418characteristic-ofamodule,494nonlinear-,22chartHall-,109Nichols-,110classLebesgue-,377closure,370coefﬁcientdamping-,71Fourier-,390cofactor,456cokernel,494561Linear Systems        Henri Bourlès© 2010 ISTE Ltd.  Published 2010 by ISTE Ltd.562LinearSystemscomoment,3component,475connected-,370concatenation-oftwobases,475conditionEuler-,431Shannon-,285conjugatetranspose-ofamatrix,505constanttime-,65controllinear-quadratic-,xxLQ-,xx,229LQG-,xxpredictive-,319,545controller1-DOF-,1292-DOF-,1453-DOF-,145PD-,134PI-,135PID-,139RST-,144convergence,372abscissaof-,395annulusof-,404bandof-,400radiusof-,401strong-,375weak*-,372conversionADC-,290DAC-,290coprime-elements,452criterionKalman-controllability,180,297observability,184,301Kharitonov-,79Nyquist-,99MIMO-,103quadratic-,230Routh-,79Ddecade,68decibel,67decompositioncanonical--ofahomomophism,476Kalman-controllability,182general,187observability,185primary--ofamodule,497defect-ofatransfermatrix,48degree,454-ofaSmithzero,469-ofarationalfunction,515MacMillan-,48relative--ofarationalfunction,515delay,386densityconditional-,445cross-spectral-,325probability-,442Gaussian-,442spectral-,325derivative,428-inthesenseofdistributions,382logarithmic-,416partial-,428second-,429descentdirectionof-,433determinant-ofamatrix,455-ofanendomorphism,481diagramstandard-,122system-,56diffeomorphism,307Diraccomb,386distance,370distribution,381compactlysupported-,400Dirac-,383Index563singular-,381tempered-,381distributivity(left,right)-,60disturbance,25-rejection,113divisionEuclidean-,454divisor,451elementary-,488-ofamatrix,468-ofamodule,499greatestcommon-,451left-,470zero-,447domain,447Bézout-,453,460commutative-,447Euclidean-,454strongly-,454GCD-,451principalideal-,453Sylvester-,457UFD,452uniquefactorization-,452dualalgebraic-,372topological-,372Eeigenspace,482generalized-,486eigenvalue,481eigenvector,481generalized-,489elementfree-,495lengthofan-,452torsion-,495endomorphism,479adjoint-,506diagonalizable-,483nilpotent-,486non-negative-,508normal-,507positive-,508self-adjoint-,508unitary-,507energy-ofasignal,378kinetic-,6potential-,12epimorphism,476canonical-,476equalityKalman-,231equationalgebraicRiccati-,226,230Bézout-,460matrix-,472Lyapunov-,227normal-,333reduced-,25errormodeling-multiplicative-,111observation-,251prediction-,335reconstruction-,251estimatorconsistent-,337non-biased-,336asymptotically,336expansionLaplace-,456Laurent--ofameromorphicfunction.,406expectation,440conditional-,444exponential-ofamatrix,407extension-oftheringofscalars,520Ffactorinvariant-,465,498factorizationbicausalspectral-,329coprimedoubly-,471564LinearSystemsfactorization(Continued)coprime-left-,471unique-intoprimes,452ﬁeld,449-ofconstants,449-offractions,449differential-,449ﬁlteranti-aliasing-,290digital-,326Kalman-,xx,258ﬂat-output,210-system,210formcanonical--ofcontrollability,202,206Brunovski-,222controllable-,200,209observability,214observable-,199,214Hermite-,463Jordan-,489left,31normal-,465pseudo-continuous-,309rationalcanonical-ofanendomorphism,503right-,32Schur-,226Smith-,464Smith-MacMillan-,42,213-atinﬁnity,47formulaBass-Gura-,220Bromwich-,399Cauchy’sintegral-,411interference-,326Plancherel-Parseval-,388,393Poissonsummation-,283,391reciprocity-,387Shannoninterpolation-,286Taylor’s-withLagrange’sremainder,430withYoung’sremainder,430Torricelli’s-,15frequencynatural-,72undamped-,71normalizedangular-,284Nyquist-,284unitygain-,106function-ofamatrix,406absolutelycontinuous-,383analytic-,405antilinear-,373characteristic-,377coercive-,431continuous-,370convex-,430correlation-,322normalized,323cross-correlation-,322normalized,323differentiable-,428distribution-,441elliptic-,432entire-,406,453essentiallybounded-,378Euclidean-,454generalized-,381holomorphic-,404,449integrable-,377Lebesgue-measurable-,377Lipschitz-,419locallybounded-,379locallyintegrable-,379measurable-,438meromorphic-,406,449rapidlydecaying-,380rational-,515biproper-,516improper-,516irreducible-,515proper-,516strictlyproper-,516sensitivity-,97sinecardinal-,285slowlyincreasing-,380spectral-,324squareintegrable-,378test-,380Index565transfer-,37open-loop-,97PR,QSPR-,128stable-,63functionsequalalmosteverywhere-,377functor,520Laplace-,213Ggaincritical-,100static-,64gcd,451gcld,470generatorcyclic-,487generators-ofamodule,494-ofanideal,450gradient,428Hhiddenmode,192,297hold,288ﬁrst-order-,288sample-and-,289zero-order-,288homomorphism,475canonical-,520induced,477Iideal,450ﬁnitelygenerated-,450principal-,450proper-,454identiﬁabilitystructural-,344identiﬁcationclosed-loop,357direct,357indirect,357modiﬁeddirect,363parametric-,321imaginaryaxisindented-,100inclusion,476independent-randomvariables,439-sigma-algebras,439index-ofapointw.r.t.aclosedpath,409controllability-,205cyclic-,504Kronecker-,479observability-,214structural-,35,43-ofaSmithzero,469inequalitySchwarz-,373Sylvester-,457triangle-,370Young--forfunctions,379-forsequences,376inertia-matrix,5-tensor,5initialcondition,418injectioncanonical-,476integral-alongapath,409interpolationHermite’s-,215invariantsimilarity-,488isomorphism-oftopologicalvectorspace,371-ofvectorspace,476J,KJordanblock,487kernel-ofaconvolutionoperator-ondistributions,385-onfunctions,379-onsequences,376kineticmoment,4566LinearSystemsLlag,386Lagrangian,12lawFaraday’s-,14Hooke’s-,9Newton’s-,7probability-,439reducednormal-,443temporal-,330lcm,451lead,386-compensator,131lemma-inversion,458LFT,123lineargroupgeneral-,458special-,458logarithm-ofamatrix,408branchofthe-principal-,408loopshaping,115Mmargindelay-,106MIMO-,122gain-,106reduction,106modulus-,107input-,120output-,120phase-lag,106lead,106matrices(left,right)equivalent-,459conjugate-,481left-similar-,494similar-,481matrix(left,right)regular-,457-ofdeﬁnition-ofamodule,494adjugate-,458companion-,502completable-,472,495conditionnumberofa-,514controllability-,180,297covariance-,441cyclic-,502directterm-,177Hamiltonian-,226,230Hermitian-,508Hessian-,429input-,177invertible-,458Jacobian-,428left-invertible-,513non-singular-,457non-negativedeﬁnite-,509observability-,184orderofasquare-,455orthogonal-,507output-,177polynomial-,457positivedeﬁnite-,509prime-,470pseudo-inverse-,513regular,457right-invertible-,514Rosenbrock-,190scalar-,231semiregular-,457sizeofa-,455stability-,196,305state-,177Sylvester-,461symmetric-,508system-,190Toeplitz-,201transfer-,37,213open-loop-,97unimodular-,458unitary-,507measureabsolutelycontinuous-,442method-ofvariationoftheconstant,423gradient-,433Index567leastsquares-,332generalized,368recursive,334Levenberg-Marquardt-,438LQR-,229LTR-,260extended,268Newton-Gauss-,436Newton-Raphson-,435quasi-Newton-,437minimizationunidirectional-,433minimumglobal-,430strict-,430local-,430strict-,430minor,456principal-,456modelARMAX-,340ARX-,334BJ-,341OE-,340PEM-,341module,491(in)decomposable-,496cyclic-,496ﬁnitelygenerated-,493ﬁnitelypresented-,494free-,493primary-,497torsion,495torsion-free-,495moment-oforder1,322-oforder2,322monomorphism,476motionplanning,209multiple,451leastcommon-,451multiplicity-ofanelementarydivisor,468,499algebraic,482geometric-,482Nneglecteddynamics,111neighborhood,370noisecolored-,330pseudo-colored-,329pseudo-white-,327standarddeviation,327variance,327white-,330norm,372Euclidean-,374standard-,374Hermitian-,374standard-,374Hilbert-,373multiplicative-,375operator-,374,511pre-Hilbert-,373Oobserverfull-order-,251minimal-,277reduced-order-,275octave,68operationelementary-,459secondary-,459operatoradvance-,401convolution--ondistributions,385-onfunctions,379-onsequences,376delta-,320input-output-,49shift-forward-,401order-ofaSmithzero,469-ofapole,406-ofazero,406-ofapowerseries,454-ofasystem,33transmission-,45orthogonal,505-supplement,505568LinearSystemsPpath,408closed-,408phase,68plotBlack-,67Bode-,67Nyquist-,67,99MIMO-,103pointcritical-,99equilibrium-,23pole-atinﬁnity,46-ofameromorphicfunction,406-placement,146degreeofa-,35MacMillan-,43non-controllable-,190,296-atinﬁnity,54non-observable-,191,297orderofa-,35stable-,80system-,33,296transmission-,39,296polynomialcharacteristic-,98,425,481Hurwitz-,78minimal-,484monic-,448PRBS,328predictionoptimal-,334prewarping,308prime,452principle-ofactionandreaction,9-ofsuperposition,21argument-,416Gram-Schmidt-(orthogonalization),505,511internalmodel-,163,243maximummodulus-,411separation-,254,267probability,439-law,439productBlaschke-,117convolution--ofdistributions,385-offunctions,379-ofsequences,376,448scalar-,372standard-,505tensor-,520projection,475pseudo-polynomial,465pseudometric,371Q,Rquantization,281radiusspectral-,406rank-ofafreemodule,493-ofahomomorphism,477-ofamatrix,456-ofamodule,498-ofasystem,22reachability,297realization,197-ofarandomvariable,439minimal-,197regression-vector,332linear-,335regulatorproportional-,100relationBayard-Bode-,84Bode-,117representationpseudo-continuous-,309Rosenbrock-,31state-space-,33nonlinear-,62residue-ofameromorphicfunction,406-ofarationalfunction,516resonance,75-factor,75-frequency,75Index569response-ofasystem,49forced-,426free-,33,427frequency-,55impulse-,51step-,51restriction-oftheringofscalars,520ring,447-offractions,519coherent-,495commutative-,447division-,449elementarydivisor-,465Hermite-,472integral-,447local-,454Noetherian-,453roll-off,148root-ofapolynomial,448multiplicityofa-,448ruleLeibniz’s-,449Mason-,61mesh-,1nodal-,2Ssampling-frequency,281-period,281seminorm,371sensor,27sequenceCauchy-,371delayed-,402minimizing-,433positivelysupported-,376slowlyincreasing-,389seriesFourier-,390Laurent-,406,449normallyconvergent-,391power-,405formal-,448setBorel-,438bounded-,372closed-,370convex-,410,430dense-,370generating--ofanideal,450Lebesgue-mesurable-,377open-,369simplyconnected-,411shift,386signal-ofpositivetype,323centered-,322digital-,281discrete-time-,282discretized-,281meanofa-,322pseudo-random-,322persistentlyexciting,328rational,328random-,321ergodic-,330Gaussian-,330sampled-,282sampled-and-held-,288T-discretizable-,283signalsuncorrelated-,323singularvalue,512-balancing,126spaceBanach-,372compact-,370complete-,371conﬁguration-,11connected-,370Euclidean-,374ﬁnite-dimensional-,373,473Fréchet-,400Hardy-,518Hermitian-,374Hilbert-,373Lebesgue-,377locallycompact-,374metric-,370570LinearSystemsspace(Continued)Montel-,381normedvector-,371pre-Hilbert,372probability-,439probabilizable-,438quotient-,474topological-,369topologicalvector-,371vector-,449spectrum-aliasing,286-ofamatrix,406-ofasignal,388-ofanendomorphism,481ray-,388,392squarerootHermitian-,510stabilityclosed-loop-,97open-loop-,63standarddeviation,441state,33dimensionofa,33partial-,31pseudo-,31stepoptimal-,433unit-,378,403submoduletorsion-,495subspacecyclic-,486invariant-,480sum-ofvectorspaces,474diagonal--ofendomorphisms,480-ofmatrices,455direct-,474external-,474supplement,474support-ofadistribution,381-ofafunction,378-ofasequence,376Sylvesterresultant,461synthesisstatefeedback/observer-,253system,xv,418-withnegativestart,92augmented-,122bicausal-,294biproper-,54bistable-,306causal-,294strictly-,294control-,28controllable-,146,179,2970-,297derivator-,43detectable-,196determined-,22discretized-,290feedback-standard-,95holonomic-,11integrator-,43linear-,21linearapproximationofa-,24linearizable-,24minimal-,45minimumphase-,83MISO-,31nonlinear-,21observable-,183,3010-,301proper-,52strictly-,53pseudo-continuous-,311quotient-controllable-,182non-observable-,185sampled-,290SIMO-,31SISO-,30stabilizable-,146,196stable-,63,195,304marginally-,196,304state-space-,33Sylvester-,462time-delay-,85,465time-invariant-,21time-varying-,21Index571underdetermined-,22well-deﬁned-feedback-,59well-formed-,205well-posed-,96TtestPBH-0-controllability,2990-observability,303controllability,179,299detectability,196observability,184,303stabilizability,196theorem-oftheincompletebasis,475Bochner,324Bromwich-Schwartz-,398Cauchy-Lipschitz-,418Cayley-Hamilton-,490centrallimit-,443exchange-,389,394,396,400,402,404ﬁnalvalue-,399,403Fisher-Riesz-,378Goursat’s-,405implicitmapping-,11initialvalue-,331,399,403Jordan-,488orthogonalprojection-,373Paley-Wiener-Schwartz-,400residue-,410Riesz-,373robuststability-,111,122sampling-,284secondexchange-,389singularvaluedecomposition-,511smallgain-,103spectralfactorization-,328Sylvester-,461topology,369induced-,370strong-,372weak*-,372torsor,3force-,6kinematic-,3kinetic-,4momentofa-,3trace-ofanendomorphism,481transformbilinear-,306delta-,320Fourier--ofdistributions,387-ofsequences,393Laplace-,36bilateral-,400inverse-,412unilateral-,394Tustin,308z-bilateral-,403inverse-,415unilateral-,401transpose-ofahomomorphism,479-ofamatrix,455U,V,Zuniondisjoint-,500unit-element,447-ofaring,447-oftime,25variable-ofasystem,20control-,25controlled-,28independent-,25input-,25latent-,28output-,28random-,439Gaussian,442reduced-,25variance,441572LinearSystemsvectorcharacteristic-,3column-,474parameter-,321unitary-,372zero-atinﬁnity,46-ofameromorphicfunction,406blocking-,40,297-atinﬁnity,48input-decoupling-,190,296-atinﬁnity,54input-outputdecoupling-,192,297invariant-,189,296MacMillan-,43output-decoupling-,191,297Smith--ofamodule,500-ofapolynomialmatrix,469stable-,80system-,194,297transmission-,39,296
